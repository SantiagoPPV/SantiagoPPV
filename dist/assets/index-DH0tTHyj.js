var qI=Object.defineProperty;var dw=e=>{throw TypeError(e)};var KI=(e,t,r)=>t in e?qI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var _g=(e,t,r)=>KI(e,typeof t!="symbol"?t+"":t,r),Ag=(e,t,r)=>t.has(e)||dw("Cannot "+r);var fe=(e,t,r)=>(Ag(e,t,"read from private field"),r?r.call(e):t.get(e)),st=(e,t,r)=>t.has(e)?dw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),We=(e,t,r,n)=>(Ag(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Nr=(e,t,r)=>(Ag(e,t,"access private method"),r);var sf=(e,t,r,n)=>({set _(a){We(e,t,a,r)},get _(){return fe(e,t,n)}});function GI(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var un=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function no(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function VI(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var XA={exports:{}},Xp={},YA={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tu=Symbol.for("react.element"),HI=Symbol.for("react.portal"),XI=Symbol.for("react.fragment"),YI=Symbol.for("react.strict_mode"),JI=Symbol.for("react.profiler"),ZI=Symbol.for("react.provider"),QI=Symbol.for("react.context"),e4=Symbol.for("react.forward_ref"),t4=Symbol.for("react.suspense"),r4=Symbol.for("react.memo"),n4=Symbol.for("react.lazy"),uw=Symbol.iterator;function o4(e){return e===null||typeof e!="object"?null:(e=uw&&e[uw]||e["@@iterator"],typeof e=="function"?e:null)}var JA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ZA=Object.assign,QA={};function yc(e,t,r){this.props=e,this.context=t,this.refs=QA,this.updater=r||JA}yc.prototype.isReactComponent={};yc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function eE(){}eE.prototype=yc.prototype;function _b(e,t,r){this.props=e,this.context=t,this.refs=QA,this.updater=r||JA}var Ab=_b.prototype=new eE;Ab.constructor=_b;ZA(Ab,yc.prototype);Ab.isPureReactComponent=!0;var fw=Array.isArray,tE=Object.prototype.hasOwnProperty,Eb={current:null},rE={key:!0,ref:!0,__self:!0,__source:!0};function nE(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)tE.call(t,n)&&!rE.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Tu,type:e,key:i,ref:s,props:a,_owner:Eb.current}}function a4(e,t){return{$$typeof:Tu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Nb(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tu}function i4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hw=/\/+/g;function Eg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?i4(""+e.key):t.toString(36)}function oh(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Tu:case HI:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Eg(s,0):n,fw(a)?(r="",e!=null&&(r=e.replace(hw,"$&/")+"/"),oh(a,t,r,"",function(u){return u})):a!=null&&(Nb(a)&&(a=a4(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(hw,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",fw(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+Eg(i,l);s+=oh(i,t,r,c,a)}else if(c=o4(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+Eg(i,l++),s+=oh(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function lf(e,t,r){if(e==null)return e;var n=[],a=0;return oh(e,n,"","",function(i){return t.call(r,i,a++)}),n}function s4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Yr={current:null},ah={transition:null},l4={ReactCurrentDispatcher:Yr,ReactCurrentBatchConfig:ah,ReactCurrentOwner:Eb};function oE(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:lf,forEach:function(e,t,r){lf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return lf(e,function(){t++}),t},toArray:function(e){return lf(e,function(t){return t})||[]},only:function(e){if(!Nb(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=yc;Qe.Fragment=XI;Qe.Profiler=JI;Qe.PureComponent=_b;Qe.StrictMode=YI;Qe.Suspense=t4;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l4;Qe.act=oE;Qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ZA({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Eb.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)tE.call(t,c)&&!rE.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Tu,type:e.type,key:a,ref:i,props:n,_owner:s}};Qe.createContext=function(e){return e={$$typeof:QI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ZI,_context:e},e.Consumer=e};Qe.createElement=nE;Qe.createFactory=function(e){var t=nE.bind(null,e);return t.type=e,t};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:e4,render:e}};Qe.isValidElement=Nb;Qe.lazy=function(e){return{$$typeof:n4,_payload:{_status:-1,_result:e},_init:s4}};Qe.memo=function(e,t){return{$$typeof:r4,type:e,compare:t===void 0?null:t}};Qe.startTransition=function(e){var t=ah.transition;ah.transition={};try{e()}finally{ah.transition=t}};Qe.unstable_act=oE;Qe.useCallback=function(e,t){return Yr.current.useCallback(e,t)};Qe.useContext=function(e){return Yr.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return Yr.current.useDeferredValue(e)};Qe.useEffect=function(e,t){return Yr.current.useEffect(e,t)};Qe.useId=function(){return Yr.current.useId()};Qe.useImperativeHandle=function(e,t,r){return Yr.current.useImperativeHandle(e,t,r)};Qe.useInsertionEffect=function(e,t){return Yr.current.useInsertionEffect(e,t)};Qe.useLayoutEffect=function(e,t){return Yr.current.useLayoutEffect(e,t)};Qe.useMemo=function(e,t){return Yr.current.useMemo(e,t)};Qe.useReducer=function(e,t,r){return Yr.current.useReducer(e,t,r)};Qe.useRef=function(e){return Yr.current.useRef(e)};Qe.useState=function(e){return Yr.current.useState(e)};Qe.useSyncExternalStore=function(e,t,r){return Yr.current.useSyncExternalStore(e,t,r)};Qe.useTransition=function(){return Yr.current.useTransition()};Qe.version="18.3.1";YA.exports=Qe;var h=YA.exports;const zn=no(h),Pb=GI({__proto__:null,default:zn},[h]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c4=h,d4=Symbol.for("react.element"),u4=Symbol.for("react.fragment"),f4=Object.prototype.hasOwnProperty,h4=c4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p4={key:!0,ref:!0,__self:!0,__source:!0};function aE(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)f4.call(t,n)&&!p4.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:d4,type:e,key:i,ref:s,props:a,_owner:h4.current}}Xp.Fragment=u4;Xp.jsx=aE;Xp.jsxs=aE;XA.exports=Xp;var o=XA.exports,iE={exports:{}},Mn={},sE={exports:{}},lE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,F){var q=O.length;O.push(F);e:for(;0<q;){var te=q-1>>>1,H=O[te];if(0<a(H,F))O[te]=F,O[q]=H,q=te;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var F=O[0],q=O.pop();if(q!==F){O[0]=q;e:for(var te=0,H=O.length,B=H>>>1;te<B;){var K=2*(te+1)-1,Z=O[K],he=K+1,re=O[he];if(0>a(Z,q))he<H&&0>a(re,Z)?(O[te]=re,O[he]=q,te=he):(O[te]=Z,O[K]=q,te=K);else if(he<H&&0>a(re,q))O[te]=re,O[he]=q,te=he;else break e}}return F}function a(O,F){var q=O.sortIndex-F.sortIndex;return q!==0?q:O.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,f=null,p=3,x=!1,m=!1,y=!1,j=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(O){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=O)n(u),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(u)}}function w(O){if(y=!1,v(O),!m)if(r(c)!==null)m=!0,L(C);else{var F=r(u);F!==null&&D(w,F.startTime-O)}}function C(O,F){m=!1,y&&(y=!1,b(_),_=-1),x=!0;var q=p;try{for(v(F),f=r(c);f!==null&&(!(f.expirationTime>F)||O&&!N());){var te=f.callback;if(typeof te=="function"){f.callback=null,p=f.priorityLevel;var H=te(f.expirationTime<=F);F=e.unstable_now(),typeof H=="function"?f.callback=H:f===r(c)&&n(c),v(F)}else n(c);f=r(c)}if(f!==null)var B=!0;else{var K=r(u);K!==null&&D(w,K.startTime-F),B=!1}return B}finally{f=null,p=q,x=!1}}var k=!1,S=null,_=-1,A=5,E=-1;function N(){return!(e.unstable_now()-E<A)}function $(){if(S!==null){var O=e.unstable_now();E=O;var F=!0;try{F=S(!0,O)}finally{F?z():(k=!1,S=null)}}else k=!1}var z;if(typeof g=="function")z=function(){g($)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,I=T.port2;T.port1.onmessage=$,z=function(){I.postMessage(null)}}else z=function(){j($,0)};function L(O){S=O,k||(k=!0,z())}function D(O,F){_=j(function(){O(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){m||x||(m=!0,L(C))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var q=p;p=F;try{return O()}finally{p=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var q=p;p=O;try{return F()}finally{p=q}},e.unstable_scheduleCallback=function(O,F,q){var te=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?te+q:te):q=te,O){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=q+H,O={id:d++,callback:F,priorityLevel:O,startTime:q,expirationTime:H,sortIndex:-1},q>te?(O.sortIndex=q,t(u,O),r(c)===null&&O===r(u)&&(y?(b(_),_=-1):y=!0,D(w,q-te))):(O.sortIndex=H,t(c,O),m||x||(m=!0,L(C))),O},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(O){var F=p;return function(){var q=p;p=F;try{return O.apply(this,arguments)}finally{p=q}}}})(lE);sE.exports=lE;var m4=sE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g4=h,_n=m4;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cE=new Set,qd={};function Gs(e,t){Zl(e,t),Zl(e+"Capture",t)}function Zl(e,t){for(qd[e]=t,e=0;e<t.length;e++)cE.add(t[e])}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nv=Object.prototype.hasOwnProperty,x4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pw={},mw={};function v4(e){return nv.call(mw,e)?!0:nv.call(pw,e)?!1:x4.test(e)?mw[e]=!0:(pw[e]=!0,!1)}function y4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b4(e,t,r,n){if(t===null||typeof t>"u"||y4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Jr(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var _r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){_r[e]=new Jr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];_r[t]=new Jr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){_r[e]=new Jr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){_r[e]=new Jr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){_r[e]=new Jr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){_r[e]=new Jr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){_r[e]=new Jr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){_r[e]=new Jr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){_r[e]=new Jr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mb=/[\-:]([a-z])/g;function Ob(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mb,Ob);_r[t]=new Jr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mb,Ob);_r[t]=new Jr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mb,Ob);_r[t]=new Jr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){_r[e]=new Jr(e,1,!1,e.toLowerCase(),null,!1,!1)});_r.xlinkHref=new Jr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){_r[e]=new Jr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Tb(e,t,r,n){var a=_r.hasOwnProperty(t)?_r[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b4(t,r,a,n)&&(r=null),n||a===null?v4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Na=g4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cf=Symbol.for("react.element"),vl=Symbol.for("react.portal"),yl=Symbol.for("react.fragment"),Lb=Symbol.for("react.strict_mode"),ov=Symbol.for("react.profiler"),dE=Symbol.for("react.provider"),uE=Symbol.for("react.context"),Db=Symbol.for("react.forward_ref"),av=Symbol.for("react.suspense"),iv=Symbol.for("react.suspense_list"),Ib=Symbol.for("react.memo"),Ya=Symbol.for("react.lazy"),fE=Symbol.for("react.offscreen"),gw=Symbol.iterator;function Wc(e){return e===null||typeof e!="object"?null:(e=gw&&e[gw]||e["@@iterator"],typeof e=="function"?e:null)}var Dt=Object.assign,Ng;function pd(e){if(Ng===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ng=t&&t[1]||""}return`
`+Ng+e}var Pg=!1;function Mg(e,t){if(!e||Pg)return"";Pg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,l=i.length-1;1<=s&&0<=l&&a[s]!==i[l];)l--;for(;1<=s&&0<=l;s--,l--)if(a[s]!==i[l]){if(s!==1||l!==1)do if(s--,l--,0>l||a[s]!==i[l]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=l);break}}}finally{Pg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?pd(e):""}function j4(e){switch(e.tag){case 5:return pd(e.type);case 16:return pd("Lazy");case 13:return pd("Suspense");case 19:return pd("SuspenseList");case 0:case 2:case 15:return e=Mg(e.type,!1),e;case 11:return e=Mg(e.type.render,!1),e;case 1:return e=Mg(e.type,!0),e;default:return""}}function sv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yl:return"Fragment";case vl:return"Portal";case ov:return"Profiler";case Lb:return"StrictMode";case av:return"Suspense";case iv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case uE:return(e.displayName||"Context")+".Consumer";case dE:return(e._context.displayName||"Context")+".Provider";case Db:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ib:return t=e.displayName||null,t!==null?t:sv(e.type)||"Memo";case Ya:t=e._payload,e=e._init;try{return sv(e(t))}catch{}}return null}function w4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sv(t);case 8:return t===Lb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ni(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function hE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function S4(e){var t=hE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function df(e){e._valueTracker||(e._valueTracker=S4(e))}function pE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=hE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function jh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function lv(e,t){var r=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function xw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ni(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mE(e,t){t=t.checked,t!=null&&Tb(e,"checked",t,!1)}function cv(e,t){mE(e,t);var r=Ni(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?dv(e,t.type,r):t.hasOwnProperty("defaultValue")&&dv(e,t.type,Ni(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function vw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function dv(e,t,r){(t!=="number"||jh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var md=Array.isArray;function Ol(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ni(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function uv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function yw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(md(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ni(r)}}function gE(e,t){var r=Ni(t.value),n=Ni(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function bw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function xE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?xE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var uf,vE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(uf=uf||document.createElement("div"),uf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=uf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Kd(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _d={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k4=["Webkit","ms","Moz","O"];Object.keys(_d).forEach(function(e){k4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_d[t]=_d[e]})});function yE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_d.hasOwnProperty(e)&&_d[e]?(""+t).trim():t+"px"}function bE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=yE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var C4=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hv(e,t){if(t){if(C4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function pv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mv=null;function $b(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gv=null,Tl=null,Ll=null;function jw(e){if(e=Iu(e)){if(typeof gv!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=em(t),gv(e.stateNode,e.type,t))}}function jE(e){Tl?Ll?Ll.push(e):Ll=[e]:Tl=e}function wE(){if(Tl){var e=Tl,t=Ll;if(Ll=Tl=null,jw(e),t)for(e=0;e<t.length;e++)jw(t[e])}}function SE(e,t){return e(t)}function kE(){}var Og=!1;function CE(e,t,r){if(Og)return e(t,r);Og=!0;try{return SE(e,t,r)}finally{Og=!1,(Tl!==null||Ll!==null)&&(kE(),wE())}}function Gd(e,t){var r=e.stateNode;if(r===null)return null;var n=em(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var xv=!1;if(ya)try{var qc={};Object.defineProperty(qc,"passive",{get:function(){xv=!0}}),window.addEventListener("test",qc,qc),window.removeEventListener("test",qc,qc)}catch{xv=!1}function _4(e,t,r,n,a,i,s,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ad=!1,wh=null,Sh=!1,vv=null,A4={onError:function(e){Ad=!0,wh=e}};function E4(e,t,r,n,a,i,s,l,c){Ad=!1,wh=null,_4.apply(A4,arguments)}function N4(e,t,r,n,a,i,s,l,c){if(E4.apply(this,arguments),Ad){if(Ad){var u=wh;Ad=!1,wh=null}else throw Error(ke(198));Sh||(Sh=!0,vv=u)}}function Vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function _E(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ww(e){if(Vs(e)!==e)throw Error(ke(188))}function P4(e){var t=e.alternate;if(!t){if(t=Vs(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return ww(a),e;if(i===n)return ww(a),t;i=i.sibling}throw Error(ke(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,l=a.child;l;){if(l===r){s=!0,r=a,n=i;break}if(l===n){s=!0,n=a,r=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===r){s=!0,r=i,n=a;break}if(l===n){s=!0,n=i,r=a;break}l=l.sibling}if(!s)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function AE(e){return e=P4(e),e!==null?EE(e):null}function EE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=EE(e);if(t!==null)return t;e=e.sibling}return null}var NE=_n.unstable_scheduleCallback,Sw=_n.unstable_cancelCallback,M4=_n.unstable_shouldYield,O4=_n.unstable_requestPaint,Kt=_n.unstable_now,T4=_n.unstable_getCurrentPriorityLevel,Rb=_n.unstable_ImmediatePriority,PE=_n.unstable_UserBlockingPriority,kh=_n.unstable_NormalPriority,L4=_n.unstable_LowPriority,ME=_n.unstable_IdlePriority,Yp=null,Ro=null;function D4(e){if(Ro&&typeof Ro.onCommitFiberRoot=="function")try{Ro.onCommitFiberRoot(Yp,e,void 0,(e.current.flags&128)===128)}catch{}}var wo=Math.clz32?Math.clz32:R4,I4=Math.log,$4=Math.LN2;function R4(e){return e>>>=0,e===0?32:31-(I4(e)/$4|0)|0}var ff=64,hf=4194304;function gd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ch(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var l=s&~a;l!==0?n=gd(l):(i&=s,i!==0&&(n=gd(i)))}else s=r&~a,s!==0?n=gd(s):i!==0&&(n=gd(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-wo(t),a=1<<r,n|=e[r],t&=~a;return n}function F4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-wo(i),l=1<<s,c=a[s];c===-1?(!(l&r)||l&n)&&(a[s]=F4(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function yv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function OE(){var e=ff;return ff<<=1,!(ff&4194240)&&(ff=64),e}function Tg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Lu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wo(t),e[t]=r}function B4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-wo(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Fb(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-wo(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var pt=0;function TE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var LE,zb,DE,IE,$E,bv=!1,pf=[],mi=null,gi=null,xi=null,Vd=new Map,Hd=new Map,ti=[],U4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kw(e,t){switch(e){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":xi=null;break;case"pointerover":case"pointerout":Vd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hd.delete(t.pointerId)}}function Kc(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Iu(t),t!==null&&zb(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function W4(e,t,r,n,a){switch(t){case"focusin":return mi=Kc(mi,e,t,r,n,a),!0;case"dragenter":return gi=Kc(gi,e,t,r,n,a),!0;case"mouseover":return xi=Kc(xi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Vd.set(i,Kc(Vd.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Hd.set(i,Kc(Hd.get(i)||null,e,t,r,n,a)),!0}return!1}function RE(e){var t=us(e.target);if(t!==null){var r=Vs(t);if(r!==null){if(t=r.tag,t===13){if(t=_E(r),t!==null){e.blockedOn=t,$E(e.priority,function(){DE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ih(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=jv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);mv=n,r.target.dispatchEvent(n),mv=null}else return t=Iu(r),t!==null&&zb(t),e.blockedOn=r,!1;t.shift()}return!0}function Cw(e,t,r){ih(e)&&r.delete(t)}function q4(){bv=!1,mi!==null&&ih(mi)&&(mi=null),gi!==null&&ih(gi)&&(gi=null),xi!==null&&ih(xi)&&(xi=null),Vd.forEach(Cw),Hd.forEach(Cw)}function Gc(e,t){e.blockedOn===t&&(e.blockedOn=null,bv||(bv=!0,_n.unstable_scheduleCallback(_n.unstable_NormalPriority,q4)))}function Xd(e){function t(a){return Gc(a,e)}if(0<pf.length){Gc(pf[0],e);for(var r=1;r<pf.length;r++){var n=pf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mi!==null&&Gc(mi,e),gi!==null&&Gc(gi,e),xi!==null&&Gc(xi,e),Vd.forEach(t),Hd.forEach(t),r=0;r<ti.length;r++)n=ti[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ti.length&&(r=ti[0],r.blockedOn===null);)RE(r),r.blockedOn===null&&ti.shift()}var Dl=Na.ReactCurrentBatchConfig,_h=!0;function K4(e,t,r,n){var a=pt,i=Dl.transition;Dl.transition=null;try{pt=1,Bb(e,t,r,n)}finally{pt=a,Dl.transition=i}}function G4(e,t,r,n){var a=pt,i=Dl.transition;Dl.transition=null;try{pt=4,Bb(e,t,r,n)}finally{pt=a,Dl.transition=i}}function Bb(e,t,r,n){if(_h){var a=jv(e,t,r,n);if(a===null)Wg(e,t,n,Ah,r),kw(e,n);else if(W4(a,e,t,r,n))n.stopPropagation();else if(kw(e,n),t&4&&-1<U4.indexOf(e)){for(;a!==null;){var i=Iu(a);if(i!==null&&LE(i),i=jv(e,t,r,n),i===null&&Wg(e,t,n,Ah,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Wg(e,t,n,null,r)}}var Ah=null;function jv(e,t,r,n){if(Ah=null,e=$b(n),e=us(e),e!==null)if(t=Vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=_E(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ah=e,null}function FE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T4()){case Rb:return 1;case PE:return 4;case kh:case L4:return 16;case ME:return 536870912;default:return 16}default:return 16}}var fi=null,Ub=null,sh=null;function zE(){if(sh)return sh;var e,t=Ub,r=t.length,n,a="value"in fi?fi.value:fi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return sh=a.slice(e,1<n?1-n:void 0)}function lh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mf(){return!0}function _w(){return!1}function On(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?mf:_w,this.isPropagationStopped=_w,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),t}var bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wb=On(bc),Du=Dt({},bc,{view:0,detail:0}),V4=On(Du),Lg,Dg,Vc,Jp=Dt({},Du,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vc&&(Vc&&e.type==="mousemove"?(Lg=e.screenX-Vc.screenX,Dg=e.screenY-Vc.screenY):Dg=Lg=0,Vc=e),Lg)},movementY:function(e){return"movementY"in e?e.movementY:Dg}}),Aw=On(Jp),H4=Dt({},Jp,{dataTransfer:0}),X4=On(H4),Y4=Dt({},Du,{relatedTarget:0}),Ig=On(Y4),J4=Dt({},bc,{animationName:0,elapsedTime:0,pseudoElement:0}),Z4=On(J4),Q4=Dt({},bc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),e5=On(Q4),t5=Dt({},bc,{data:0}),Ew=On(t5),r5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=o5[e])?!!t[e]:!1}function qb(){return a5}var i5=Dt({},Du,{key:function(e){if(e.key){var t=r5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=lh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?n5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qb,charCode:function(e){return e.type==="keypress"?lh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?lh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),s5=On(i5),l5=Dt({},Jp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nw=On(l5),c5=Dt({},Du,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qb}),d5=On(c5),u5=Dt({},bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),f5=On(u5),h5=Dt({},Jp,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),p5=On(h5),m5=[9,13,27,32],Kb=ya&&"CompositionEvent"in window,Ed=null;ya&&"documentMode"in document&&(Ed=document.documentMode);var g5=ya&&"TextEvent"in window&&!Ed,BE=ya&&(!Kb||Ed&&8<Ed&&11>=Ed),Pw=" ",Mw=!1;function UE(e,t){switch(e){case"keyup":return m5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bl=!1;function x5(e,t){switch(e){case"compositionend":return WE(t);case"keypress":return t.which!==32?null:(Mw=!0,Pw);case"textInput":return e=t.data,e===Pw&&Mw?null:e;default:return null}}function v5(e,t){if(bl)return e==="compositionend"||!Kb&&UE(e,t)?(e=zE(),sh=Ub=fi=null,bl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return BE&&t.locale!=="ko"?null:t.data;default:return null}}var y5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ow(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!y5[e.type]:t==="textarea"}function qE(e,t,r,n){jE(n),t=Eh(t,"onChange"),0<t.length&&(r=new Wb("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Nd=null,Yd=null;function b5(e){tN(e,0)}function Zp(e){var t=Sl(e);if(pE(t))return e}function j5(e,t){if(e==="change")return t}var KE=!1;if(ya){var $g;if(ya){var Rg="oninput"in document;if(!Rg){var Tw=document.createElement("div");Tw.setAttribute("oninput","return;"),Rg=typeof Tw.oninput=="function"}$g=Rg}else $g=!1;KE=$g&&(!document.documentMode||9<document.documentMode)}function Lw(){Nd&&(Nd.detachEvent("onpropertychange",GE),Yd=Nd=null)}function GE(e){if(e.propertyName==="value"&&Zp(Yd)){var t=[];qE(t,Yd,e,$b(e)),CE(b5,t)}}function w5(e,t,r){e==="focusin"?(Lw(),Nd=t,Yd=r,Nd.attachEvent("onpropertychange",GE)):e==="focusout"&&Lw()}function S5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zp(Yd)}function k5(e,t){if(e==="click")return Zp(t)}function C5(e,t){if(e==="input"||e==="change")return Zp(t)}function _5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _o=typeof Object.is=="function"?Object.is:_5;function Jd(e,t){if(_o(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!nv.call(t,a)||!_o(e[a],t[a]))return!1}return!0}function Dw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Iw(e,t){var r=Dw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Dw(r)}}function VE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?VE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function HE(){for(var e=window,t=jh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=jh(e.document)}return t}function Gb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function A5(e){var t=HE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&VE(r.ownerDocument.documentElement,r)){if(n!==null&&Gb(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Iw(r,i);var s=Iw(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var E5=ya&&"documentMode"in document&&11>=document.documentMode,jl=null,wv=null,Pd=null,Sv=!1;function $w(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sv||jl==null||jl!==jh(n)||(n=jl,"selectionStart"in n&&Gb(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Pd&&Jd(Pd,n)||(Pd=n,n=Eh(wv,"onSelect"),0<n.length&&(t=new Wb("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=jl)))}function gf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wl={animationend:gf("Animation","AnimationEnd"),animationiteration:gf("Animation","AnimationIteration"),animationstart:gf("Animation","AnimationStart"),transitionend:gf("Transition","TransitionEnd")},Fg={},XE={};ya&&(XE=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function Qp(e){if(Fg[e])return Fg[e];if(!wl[e])return e;var t=wl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in XE)return Fg[e]=t[r];return e}var YE=Qp("animationend"),JE=Qp("animationiteration"),ZE=Qp("animationstart"),QE=Qp("transitionend"),eN=new Map,Rw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){eN.set(e,t),Gs(t,[e])}for(var zg=0;zg<Rw.length;zg++){var Bg=Rw[zg],N5=Bg.toLowerCase(),P5=Bg[0].toUpperCase()+Bg.slice(1);Ii(N5,"on"+P5)}Ii(YE,"onAnimationEnd");Ii(JE,"onAnimationIteration");Ii(ZE,"onAnimationStart");Ii("dblclick","onDoubleClick");Ii("focusin","onFocus");Ii("focusout","onBlur");Ii(QE,"onTransitionEnd");Zl("onMouseEnter",["mouseout","mouseover"]);Zl("onMouseLeave",["mouseout","mouseover"]);Zl("onPointerEnter",["pointerout","pointerover"]);Zl("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M5=new Set("cancel close invalid load scroll toggle".split(" ").concat(xd));function Fw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,N4(n,t,void 0,e),e.currentTarget=null}function tN(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var l=n[s],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;Fw(a,l,u),i=c}else for(s=0;s<n.length;s++){if(l=n[s],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;Fw(a,l,u),i=c}}}if(Sh)throw e=vv,Sh=!1,vv=null,e}function wt(e,t){var r=t[Ev];r===void 0&&(r=t[Ev]=new Set);var n=e+"__bubble";r.has(n)||(rN(t,e,2,!1),r.add(n))}function Ug(e,t,r){var n=0;t&&(n|=4),rN(r,e,n,t)}var xf="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[xf]){e[xf]=!0,cE.forEach(function(r){r!=="selectionchange"&&(M5.has(r)||Ug(r,!1,e),Ug(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xf]||(t[xf]=!0,Ug("selectionchange",!1,t))}}function rN(e,t,r,n){switch(FE(t)){case 1:var a=K4;break;case 4:a=G4;break;default:a=Bb}r=a.bind(null,t,r,e),a=void 0,!xv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Wg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;l!==null;){if(s=us(l),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}l=l.parentNode}}n=n.return}CE(function(){var u=i,d=$b(r),f=[];e:{var p=eN.get(e);if(p!==void 0){var x=Wb,m=e;switch(e){case"keypress":if(lh(r)===0)break e;case"keydown":case"keyup":x=s5;break;case"focusin":m="focus",x=Ig;break;case"focusout":m="blur",x=Ig;break;case"beforeblur":case"afterblur":x=Ig;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Aw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=X4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=d5;break;case YE:case JE:case ZE:x=Z4;break;case QE:x=f5;break;case"scroll":x=V4;break;case"wheel":x=p5;break;case"copy":case"cut":case"paste":x=e5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Nw}var y=(t&4)!==0,j=!y&&e==="scroll",b=y?p!==null?p+"Capture":null:p;y=[];for(var g=u,v;g!==null;){v=g;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,b!==null&&(w=Gd(g,b),w!=null&&y.push(Qd(g,w,v)))),j)break;g=g.return}0<y.length&&(p=new x(p,m,null,r,d),f.push({event:p,listeners:y}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",p&&r!==mv&&(m=r.relatedTarget||r.fromElement)&&(us(m)||m[ba]))break e;if((x||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,x?(m=r.relatedTarget||r.toElement,x=u,m=m?us(m):null,m!==null&&(j=Vs(m),m!==j||m.tag!==5&&m.tag!==6)&&(m=null)):(x=null,m=u),x!==m)){if(y=Aw,w="onMouseLeave",b="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(y=Nw,w="onPointerLeave",b="onPointerEnter",g="pointer"),j=x==null?p:Sl(x),v=m==null?p:Sl(m),p=new y(w,g+"leave",x,r,d),p.target=j,p.relatedTarget=v,w=null,us(d)===u&&(y=new y(b,g+"enter",m,r,d),y.target=v,y.relatedTarget=j,w=y),j=w,x&&m)t:{for(y=x,b=m,g=0,v=y;v;v=ol(v))g++;for(v=0,w=b;w;w=ol(w))v++;for(;0<g-v;)y=ol(y),g--;for(;0<v-g;)b=ol(b),v--;for(;g--;){if(y===b||b!==null&&y===b.alternate)break t;y=ol(y),b=ol(b)}y=null}else y=null;x!==null&&zw(f,p,x,y,!1),m!==null&&j!==null&&zw(f,j,m,y,!0)}}e:{if(p=u?Sl(u):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var C=j5;else if(Ow(p))if(KE)C=C5;else{C=S5;var k=w5}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=k5);if(C&&(C=C(e,u))){qE(f,C,r,d);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&dv(p,"number",p.value)}switch(k=u?Sl(u):window,e){case"focusin":(Ow(k)||k.contentEditable==="true")&&(jl=k,wv=u,Pd=null);break;case"focusout":Pd=wv=jl=null;break;case"mousedown":Sv=!0;break;case"contextmenu":case"mouseup":case"dragend":Sv=!1,$w(f,r,d);break;case"selectionchange":if(E5)break;case"keydown":case"keyup":$w(f,r,d)}var S;if(Kb)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else bl?UE(e,r)&&(_="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(BE&&r.locale!=="ko"&&(bl||_!=="onCompositionStart"?_==="onCompositionEnd"&&bl&&(S=zE()):(fi=d,Ub="value"in fi?fi.value:fi.textContent,bl=!0)),k=Eh(u,_),0<k.length&&(_=new Ew(_,e,null,r,d),f.push({event:_,listeners:k}),S?_.data=S:(S=WE(r),S!==null&&(_.data=S)))),(S=g5?x5(e,r):v5(e,r))&&(u=Eh(u,"onBeforeInput"),0<u.length&&(d=new Ew("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=S))}tN(f,t)})}function Qd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Eh(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Gd(e,r),i!=null&&n.unshift(Qd(e,i,a)),i=Gd(e,t),i!=null&&n.push(Qd(e,i,a))),e=e.return}return n}function ol(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zw(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Gd(r,i),c!=null&&s.unshift(Qd(r,c,l))):a||(c=Gd(r,i),c!=null&&s.push(Qd(r,c,l)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var O5=/\r\n?/g,T5=/\u0000|\uFFFD/g;function Bw(e){return(typeof e=="string"?e:""+e).replace(O5,`
`).replace(T5,"")}function vf(e,t,r){if(t=Bw(t),Bw(e)!==t&&r)throw Error(ke(425))}function Nh(){}var kv=null,Cv=null;function _v(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Av=typeof setTimeout=="function"?setTimeout:void 0,L5=typeof clearTimeout=="function"?clearTimeout:void 0,Uw=typeof Promise=="function"?Promise:void 0,D5=typeof queueMicrotask=="function"?queueMicrotask:typeof Uw<"u"?function(e){return Uw.resolve(null).then(e).catch(I5)}:Av;function I5(e){setTimeout(function(){throw e})}function qg(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Xd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Xd(t)}function vi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ww(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var jc=Math.random().toString(36).slice(2),Do="__reactFiber$"+jc,eu="__reactProps$"+jc,ba="__reactContainer$"+jc,Ev="__reactEvents$"+jc,$5="__reactListeners$"+jc,R5="__reactHandles$"+jc;function us(e){var t=e[Do];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ba]||r[Do]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Ww(e);e!==null;){if(r=e[Do])return r;e=Ww(e)}return t}e=r,r=e.parentNode}return null}function Iu(e){return e=e[Do]||e[ba],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function em(e){return e[eu]||null}var Nv=[],kl=-1;function $i(e){return{current:e}}function Ct(e){0>kl||(e.current=Nv[kl],Nv[kl]=null,kl--)}function jt(e,t){kl++,Nv[kl]=e.current,e.current=t}var Pi={},zr=$i(Pi),ln=$i(!1),Ds=Pi;function Ql(e,t){var r=e.type.contextTypes;if(!r)return Pi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function cn(e){return e=e.childContextTypes,e!=null}function Ph(){Ct(ln),Ct(zr)}function qw(e,t,r){if(zr.current!==Pi)throw Error(ke(168));jt(zr,t),jt(ln,r)}function nN(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ke(108,w4(e)||"Unknown",a));return Dt({},r,n)}function Mh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pi,Ds=zr.current,jt(zr,e),jt(ln,ln.current),!0}function Kw(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=nN(e,t,Ds),n.__reactInternalMemoizedMergedChildContext=e,Ct(ln),Ct(zr),jt(zr,e)):Ct(ln),jt(ln,r)}var ra=null,tm=!1,Kg=!1;function oN(e){ra===null?ra=[e]:ra.push(e)}function F5(e){tm=!0,oN(e)}function Ri(){if(!Kg&&ra!==null){Kg=!0;var e=0,t=pt;try{var r=ra;for(pt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ra=null,tm=!1}catch(a){throw ra!==null&&(ra=ra.slice(e+1)),NE(Rb,Ri),a}finally{pt=t,Kg=!1}}return null}var Cl=[],_l=0,Oh=null,Th=0,Bn=[],Un=0,Is=null,la=1,ca="";function ts(e,t){Cl[_l++]=Th,Cl[_l++]=Oh,Oh=e,Th=t}function aN(e,t,r){Bn[Un++]=la,Bn[Un++]=ca,Bn[Un++]=Is,Is=e;var n=la;e=ca;var a=32-wo(n)-1;n&=~(1<<a),r+=1;var i=32-wo(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,la=1<<32-wo(t)+a|r<<a|n,ca=i+e}else la=1<<i|r<<a|n,ca=e}function Vb(e){e.return!==null&&(ts(e,1),aN(e,1,0))}function Hb(e){for(;e===Oh;)Oh=Cl[--_l],Cl[_l]=null,Th=Cl[--_l],Cl[_l]=null;for(;e===Is;)Is=Bn[--Un],Bn[Un]=null,ca=Bn[--Un],Bn[Un]=null,la=Bn[--Un],Bn[Un]=null}var wn=null,jn=null,_t=!1,vo=null;function iN(e,t){var r=qn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Gw(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,wn=e,jn=vi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,wn=e,jn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Is!==null?{id:la,overflow:ca}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=qn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,wn=e,jn=null,!0):!1;default:return!1}}function Pv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mv(e){if(_t){var t=jn;if(t){var r=t;if(!Gw(e,t)){if(Pv(e))throw Error(ke(418));t=vi(r.nextSibling);var n=wn;t&&Gw(e,t)?iN(n,r):(e.flags=e.flags&-4097|2,_t=!1,wn=e)}}else{if(Pv(e))throw Error(ke(418));e.flags=e.flags&-4097|2,_t=!1,wn=e}}}function Vw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wn=e}function yf(e){if(e!==wn)return!1;if(!_t)return Vw(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_v(e.type,e.memoizedProps)),t&&(t=jn)){if(Pv(e))throw sN(),Error(ke(418));for(;t;)iN(e,t),t=vi(t.nextSibling)}if(Vw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){jn=vi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}jn=null}}else jn=wn?vi(e.stateNode.nextSibling):null;return!0}function sN(){for(var e=jn;e;)e=vi(e.nextSibling)}function ec(){jn=wn=null,_t=!1}function Xb(e){vo===null?vo=[e]:vo.push(e)}var z5=Na.ReactCurrentBatchConfig;function Hc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var l=a.refs;s===null?delete l[i]:l[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function bf(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Hw(e){var t=e._init;return t(e._payload)}function lN(e){function t(b,g){if(e){var v=b.deletions;v===null?(b.deletions=[g],b.flags|=16):v.push(g)}}function r(b,g){if(!e)return null;for(;g!==null;)t(b,g),g=g.sibling;return null}function n(b,g){for(b=new Map;g!==null;)g.key!==null?b.set(g.key,g):b.set(g.index,g),g=g.sibling;return b}function a(b,g){return b=wi(b,g),b.index=0,b.sibling=null,b}function i(b,g,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<g?(b.flags|=2,g):v):(b.flags|=2,g)):(b.flags|=1048576,g)}function s(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,g,v,w){return g===null||g.tag!==6?(g=Zg(v,b.mode,w),g.return=b,g):(g=a(g,v),g.return=b,g)}function c(b,g,v,w){var C=v.type;return C===yl?d(b,g,v.props.children,w,v.key):g!==null&&(g.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ya&&Hw(C)===g.type)?(w=a(g,v.props),w.ref=Hc(b,g,v),w.return=b,w):(w=mh(v.type,v.key,v.props,null,b.mode,w),w.ref=Hc(b,g,v),w.return=b,w)}function u(b,g,v,w){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=Qg(v,b.mode,w),g.return=b,g):(g=a(g,v.children||[]),g.return=b,g)}function d(b,g,v,w,C){return g===null||g.tag!==7?(g=Es(v,b.mode,w,C),g.return=b,g):(g=a(g,v),g.return=b,g)}function f(b,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Zg(""+g,b.mode,v),g.return=b,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case cf:return v=mh(g.type,g.key,g.props,null,b.mode,v),v.ref=Hc(b,null,g),v.return=b,v;case vl:return g=Qg(g,b.mode,v),g.return=b,g;case Ya:var w=g._init;return f(b,w(g._payload),v)}if(md(g)||Wc(g))return g=Es(g,b.mode,v,null),g.return=b,g;bf(b,g)}return null}function p(b,g,v,w){var C=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:l(b,g,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case cf:return v.key===C?c(b,g,v,w):null;case vl:return v.key===C?u(b,g,v,w):null;case Ya:return C=v._init,p(b,g,C(v._payload),w)}if(md(v)||Wc(v))return C!==null?null:d(b,g,v,w,null);bf(b,v)}return null}function x(b,g,v,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return b=b.get(v)||null,l(g,b,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case cf:return b=b.get(w.key===null?v:w.key)||null,c(g,b,w,C);case vl:return b=b.get(w.key===null?v:w.key)||null,u(g,b,w,C);case Ya:var k=w._init;return x(b,g,v,k(w._payload),C)}if(md(w)||Wc(w))return b=b.get(v)||null,d(g,b,w,C,null);bf(g,w)}return null}function m(b,g,v,w){for(var C=null,k=null,S=g,_=g=0,A=null;S!==null&&_<v.length;_++){S.index>_?(A=S,S=null):A=S.sibling;var E=p(b,S,v[_],w);if(E===null){S===null&&(S=A);break}e&&S&&E.alternate===null&&t(b,S),g=i(E,g,_),k===null?C=E:k.sibling=E,k=E,S=A}if(_===v.length)return r(b,S),_t&&ts(b,_),C;if(S===null){for(;_<v.length;_++)S=f(b,v[_],w),S!==null&&(g=i(S,g,_),k===null?C=S:k.sibling=S,k=S);return _t&&ts(b,_),C}for(S=n(b,S);_<v.length;_++)A=x(S,b,_,v[_],w),A!==null&&(e&&A.alternate!==null&&S.delete(A.key===null?_:A.key),g=i(A,g,_),k===null?C=A:k.sibling=A,k=A);return e&&S.forEach(function(N){return t(b,N)}),_t&&ts(b,_),C}function y(b,g,v,w){var C=Wc(v);if(typeof C!="function")throw Error(ke(150));if(v=C.call(v),v==null)throw Error(ke(151));for(var k=C=null,S=g,_=g=0,A=null,E=v.next();S!==null&&!E.done;_++,E=v.next()){S.index>_?(A=S,S=null):A=S.sibling;var N=p(b,S,E.value,w);if(N===null){S===null&&(S=A);break}e&&S&&N.alternate===null&&t(b,S),g=i(N,g,_),k===null?C=N:k.sibling=N,k=N,S=A}if(E.done)return r(b,S),_t&&ts(b,_),C;if(S===null){for(;!E.done;_++,E=v.next())E=f(b,E.value,w),E!==null&&(g=i(E,g,_),k===null?C=E:k.sibling=E,k=E);return _t&&ts(b,_),C}for(S=n(b,S);!E.done;_++,E=v.next())E=x(S,b,_,E.value,w),E!==null&&(e&&E.alternate!==null&&S.delete(E.key===null?_:E.key),g=i(E,g,_),k===null?C=E:k.sibling=E,k=E);return e&&S.forEach(function($){return t(b,$)}),_t&&ts(b,_),C}function j(b,g,v,w){if(typeof v=="object"&&v!==null&&v.type===yl&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case cf:e:{for(var C=v.key,k=g;k!==null;){if(k.key===C){if(C=v.type,C===yl){if(k.tag===7){r(b,k.sibling),g=a(k,v.props.children),g.return=b,b=g;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ya&&Hw(C)===k.type){r(b,k.sibling),g=a(k,v.props),g.ref=Hc(b,k,v),g.return=b,b=g;break e}r(b,k);break}else t(b,k);k=k.sibling}v.type===yl?(g=Es(v.props.children,b.mode,w,v.key),g.return=b,b=g):(w=mh(v.type,v.key,v.props,null,b.mode,w),w.ref=Hc(b,g,v),w.return=b,b=w)}return s(b);case vl:e:{for(k=v.key;g!==null;){if(g.key===k)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){r(b,g.sibling),g=a(g,v.children||[]),g.return=b,b=g;break e}else{r(b,g);break}else t(b,g);g=g.sibling}g=Qg(v,b.mode,w),g.return=b,b=g}return s(b);case Ya:return k=v._init,j(b,g,k(v._payload),w)}if(md(v))return m(b,g,v,w);if(Wc(v))return y(b,g,v,w);bf(b,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(r(b,g.sibling),g=a(g,v),g.return=b,b=g):(r(b,g),g=Zg(v,b.mode,w),g.return=b,b=g),s(b)):r(b,g)}return j}var tc=lN(!0),cN=lN(!1),Lh=$i(null),Dh=null,Al=null,Yb=null;function Jb(){Yb=Al=Dh=null}function Zb(e){var t=Lh.current;Ct(Lh),e._currentValue=t}function Ov(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Il(e,t){Dh=e,Yb=Al=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(an=!0),e.firstContext=null)}function Qn(e){var t=e._currentValue;if(Yb!==e)if(e={context:e,memoizedValue:t,next:null},Al===null){if(Dh===null)throw Error(ke(308));Al=e,Dh.dependencies={lanes:0,firstContext:e}}else Al=Al.next=e;return t}var fs=null;function Qb(e){fs===null?fs=[e]:fs.push(e)}function dN(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Qb(t)):(r.next=a.next,a.next=r),t.interleaved=r,ja(e,n)}function ja(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ja=!1;function e0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ja(e,r)}return a=n.interleaved,a===null?(t.next=t,Qb(n)):(t.next=a.next,a.next=t),n.interleaved=t,ja(e,r)}function ch(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Fb(e,r)}}function Xw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ih(e,t,r,n){var a=e.updateQueue;Ja=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,s===null?i=u:s.next=u,s=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==s&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;s=0,d=u=c=null,l=i;do{var p=l.lane,x=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,y=l;switch(p=t,x=r,y.tag){case 1:if(m=y.payload,typeof m=="function"){f=m.call(x,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,p=typeof m=="function"?m.call(x,f,p):m,p==null)break e;f=Dt({},f,p);break e;case 2:Ja=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[l]:p.push(l))}else x={eventTime:x,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=x,c=f):d=d.next=x,s|=p;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;p=l,l=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Rs|=s,e.lanes=s,e.memoizedState=f}}function Yw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ke(191,a));a.call(n)}}}var $u={},Fo=$i($u),tu=$i($u),ru=$i($u);function hs(e){if(e===$u)throw Error(ke(174));return e}function t0(e,t){switch(jt(ru,t),jt(tu,e),jt(Fo,$u),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fv(t,e)}Ct(Fo),jt(Fo,t)}function rc(){Ct(Fo),Ct(tu),Ct(ru)}function fN(e){hs(ru.current);var t=hs(Fo.current),r=fv(t,e.type);t!==r&&(jt(tu,e),jt(Fo,r))}function r0(e){tu.current===e&&(Ct(Fo),Ct(tu))}var Mt=$i(0);function $h(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gg=[];function n0(){for(var e=0;e<Gg.length;e++)Gg[e]._workInProgressVersionPrimary=null;Gg.length=0}var dh=Na.ReactCurrentDispatcher,Vg=Na.ReactCurrentBatchConfig,$s=0,Tt=null,nr=null,hr=null,Rh=!1,Md=!1,nu=0,B5=0;function Pr(){throw Error(ke(321))}function o0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_o(e[r],t[r]))return!1;return!0}function a0(e,t,r,n,a,i){if($s=i,Tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dh.current=e===null||e.memoizedState===null?K5:G5,e=r(n,a),Md){i=0;do{if(Md=!1,nu=0,25<=i)throw Error(ke(301));i+=1,hr=nr=null,t.updateQueue=null,dh.current=V5,e=r(n,a)}while(Md)}if(dh.current=Fh,t=nr!==null&&nr.next!==null,$s=0,hr=nr=Tt=null,Rh=!1,t)throw Error(ke(300));return e}function i0(){var e=nu!==0;return nu=0,e}function Mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Tt.memoizedState=hr=e:hr=hr.next=e,hr}function eo(){if(nr===null){var e=Tt.alternate;e=e!==null?e.memoizedState:null}else e=nr.next;var t=hr===null?Tt.memoizedState:hr.next;if(t!==null)hr=t,nr=e;else{if(e===null)throw Error(ke(310));nr=e,e={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},hr===null?Tt.memoizedState=hr=e:hr=hr.next=e}return hr}function ou(e,t){return typeof t=="function"?t(e):t}function Hg(e){var t=eo(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=nr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=s=null,c=null,u=i;do{var d=u.lane;if(($s&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,s=n):c=c.next=f,Tt.lanes|=d,Rs|=d}u=u.next}while(u!==null&&u!==i);c===null?s=n:c.next=l,_o(n,t.memoizedState)||(an=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Tt.lanes|=i,Rs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Xg(e){var t=eo(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);_o(i,t.memoizedState)||(an=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function hN(){}function pN(e,t){var r=Tt,n=eo(),a=t(),i=!_o(n.memoizedState,a);if(i&&(n.memoizedState=a,an=!0),n=n.queue,s0(xN.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||hr!==null&&hr.memoizedState.tag&1){if(r.flags|=2048,au(9,gN.bind(null,r,n,a,t),void 0,null),gr===null)throw Error(ke(349));$s&30||mN(r,t,a)}return a}function mN(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gN(e,t,r,n){t.value=r,t.getSnapshot=n,vN(t)&&yN(e)}function xN(e,t,r){return r(function(){vN(t)&&yN(e)})}function vN(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_o(e,r)}catch{return!0}}function yN(e){var t=ja(e,1);t!==null&&So(t,e,1,-1)}function Jw(e){var t=Mo();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ou,lastRenderedState:e},t.queue=e,e=e.dispatch=q5.bind(null,Tt,e),[t.memoizedState,e]}function au(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function bN(){return eo().memoizedState}function uh(e,t,r,n){var a=Mo();Tt.flags|=e,a.memoizedState=au(1|t,r,void 0,n===void 0?null:n)}function rm(e,t,r,n){var a=eo();n=n===void 0?null:n;var i=void 0;if(nr!==null){var s=nr.memoizedState;if(i=s.destroy,n!==null&&o0(n,s.deps)){a.memoizedState=au(t,r,i,n);return}}Tt.flags|=e,a.memoizedState=au(1|t,r,i,n)}function Zw(e,t){return uh(8390656,8,e,t)}function s0(e,t){return rm(2048,8,e,t)}function jN(e,t){return rm(4,2,e,t)}function wN(e,t){return rm(4,4,e,t)}function SN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kN(e,t,r){return r=r!=null?r.concat([e]):null,rm(4,4,SN.bind(null,t,e),r)}function l0(){}function CN(e,t){var r=eo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&o0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function _N(e,t){var r=eo();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&o0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function AN(e,t,r){return $s&21?(_o(r,t)||(r=OE(),Tt.lanes|=r,Rs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,an=!0),e.memoizedState=r)}function U5(e,t){var r=pt;pt=r!==0&&4>r?r:4,e(!0);var n=Vg.transition;Vg.transition={};try{e(!1),t()}finally{pt=r,Vg.transition=n}}function EN(){return eo().memoizedState}function W5(e,t,r){var n=ji(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},NN(e))PN(t,r);else if(r=dN(e,t,r,n),r!==null){var a=Vr();So(r,e,n,a),MN(r,t,n)}}function q5(e,t,r){var n=ji(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(NN(e))PN(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,l=i(s,r);if(a.hasEagerState=!0,a.eagerState=l,_o(l,s)){var c=t.interleaved;c===null?(a.next=a,Qb(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=dN(e,t,a,n),r!==null&&(a=Vr(),So(r,e,n,a),MN(r,t,n))}}function NN(e){var t=e.alternate;return e===Tt||t!==null&&t===Tt}function PN(e,t){Md=Rh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function MN(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Fb(e,r)}}var Fh={readContext:Qn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},K5={readContext:Qn,useCallback:function(e,t){return Mo().memoizedState=[e,t===void 0?null:t],e},useContext:Qn,useEffect:Zw,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,uh(4194308,4,SN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return uh(4194308,4,e,t)},useInsertionEffect:function(e,t){return uh(4,2,e,t)},useMemo:function(e,t){var r=Mo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Mo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=W5.bind(null,Tt,e),[n.memoizedState,e]},useRef:function(e){var t=Mo();return e={current:e},t.memoizedState=e},useState:Jw,useDebugValue:l0,useDeferredValue:function(e){return Mo().memoizedState=e},useTransition:function(){var e=Jw(!1),t=e[0];return e=U5.bind(null,e[1]),Mo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Tt,a=Mo();if(_t){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),gr===null)throw Error(ke(349));$s&30||mN(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,Zw(xN.bind(null,n,i,e),[e]),n.flags|=2048,au(9,gN.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Mo(),t=gr.identifierPrefix;if(_t){var r=ca,n=la;r=(n&~(1<<32-wo(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=nu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=B5++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},G5={readContext:Qn,useCallback:CN,useContext:Qn,useEffect:s0,useImperativeHandle:kN,useInsertionEffect:jN,useLayoutEffect:wN,useMemo:_N,useReducer:Hg,useRef:bN,useState:function(){return Hg(ou)},useDebugValue:l0,useDeferredValue:function(e){var t=eo();return AN(t,nr.memoizedState,e)},useTransition:function(){var e=Hg(ou)[0],t=eo().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:pN,useId:EN,unstable_isNewReconciler:!1},V5={readContext:Qn,useCallback:CN,useContext:Qn,useEffect:s0,useImperativeHandle:kN,useInsertionEffect:jN,useLayoutEffect:wN,useMemo:_N,useReducer:Xg,useRef:bN,useState:function(){return Xg(ou)},useDebugValue:l0,useDeferredValue:function(e){var t=eo();return nr===null?t.memoizedState=e:AN(t,nr.memoizedState,e)},useTransition:function(){var e=Xg(ou)[0],t=eo().memoizedState;return[e,t]},useMutableSource:hN,useSyncExternalStore:pN,useId:EN,unstable_isNewReconciler:!1};function uo(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Tv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Dt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nm={isMounted:function(e){return(e=e._reactInternals)?Vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Vr(),a=ji(e),i=fa(n,a);i.payload=t,r!=null&&(i.callback=r),t=yi(e,i,a),t!==null&&(So(t,e,a,n),ch(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Vr(),a=ji(e),i=fa(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=yi(e,i,a),t!==null&&(So(t,e,a,n),ch(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Vr(),n=ji(e),a=fa(r,n);a.tag=2,t!=null&&(a.callback=t),t=yi(e,a,n),t!==null&&(So(t,e,n,r),ch(t,e,n))}};function Qw(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Jd(r,n)||!Jd(a,i):!0}function ON(e,t,r){var n=!1,a=Pi,i=t.contextType;return typeof i=="object"&&i!==null?i=Qn(i):(a=cn(t)?Ds:zr.current,n=t.contextTypes,i=(n=n!=null)?Ql(e,a):Pi),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nm,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function eS(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nm.enqueueReplaceState(t,t.state,null)}function Lv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},e0(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Qn(i):(i=cn(t)?Ds:zr.current,a.context=Ql(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Tv(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&nm.enqueueReplaceState(a,a.state,null),Ih(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function nc(e,t){try{var r="",n=t;do r+=j4(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Yg(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Dv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var H5=typeof WeakMap=="function"?WeakMap:Map;function TN(e,t,r){r=fa(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Bh||(Bh=!0,Kv=n),Dv(e,t)},r}function LN(e,t,r){r=fa(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Dv(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Dv(e,t),typeof n!="function"&&(bi===null?bi=new Set([this]):bi.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function tS(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new H5;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=l$.bind(null,e,t,r),t.then(e,e))}function rS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function nS(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fa(-1,1),t.tag=2,yi(r,t,1))),r.lanes|=1),e)}var X5=Na.ReactCurrentOwner,an=!1;function Wr(e,t,r,n){t.child=e===null?cN(t,null,r,n):tc(t,e.child,r,n)}function oS(e,t,r,n,a){r=r.render;var i=t.ref;return Il(t,a),n=a0(e,t,r,n,i,a),r=i0(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wa(e,t,a)):(_t&&r&&Vb(t),t.flags|=1,Wr(e,t,n,a),t.child)}function aS(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!g0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,DN(e,t,i,n,a)):(e=mh(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Jd,r(s,n)&&e.ref===t.ref)return wa(e,t,a)}return t.flags|=1,e=wi(i,n),e.ref=t.ref,e.return=t,t.child=e}function DN(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Jd(i,n)&&e.ref===t.ref)if(an=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(an=!0);else return t.lanes=e.lanes,wa(e,t,a)}return Iv(e,t,r,n,a)}function IN(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(Nl,pn),pn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jt(Nl,pn),pn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,jt(Nl,pn),pn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,jt(Nl,pn),pn|=n;return Wr(e,t,a,r),t.child}function $N(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Iv(e,t,r,n,a){var i=cn(r)?Ds:zr.current;return i=Ql(t,i),Il(t,a),r=a0(e,t,r,n,i,a),n=i0(),e!==null&&!an?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wa(e,t,a)):(_t&&n&&Vb(t),t.flags|=1,Wr(e,t,r,a),t.child)}function iS(e,t,r,n,a){if(cn(r)){var i=!0;Mh(t)}else i=!1;if(Il(t,a),t.stateNode===null)fh(e,t),ON(t,r,n),Lv(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,l=t.memoizedProps;s.props=l;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=Qn(u):(u=cn(r)?Ds:zr.current,u=Ql(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==n||c!==u)&&eS(t,s,n,u),Ja=!1;var p=t.memoizedState;s.state=p,Ih(t,n,s,a),c=t.memoizedState,l!==n||p!==c||ln.current||Ja?(typeof d=="function"&&(Tv(t,r,d,n),c=t.memoizedState),(l=Ja||Qw(t,r,l,n,p,c,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,uN(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:uo(t.type,l),s.props=u,f=t.pendingProps,p=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=Qn(c):(c=cn(r)?Ds:zr.current,c=Ql(t,c));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||p!==c)&&eS(t,s,n,c),Ja=!1,p=t.memoizedState,s.state=p,Ih(t,n,s,a);var m=t.memoizedState;l!==f||p!==m||ln.current||Ja?(typeof x=="function"&&(Tv(t,r,x,n),m=t.memoizedState),(u=Ja||Qw(t,r,u,n,p,m,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return $v(e,t,r,n,i,a)}function $v(e,t,r,n,a,i){$N(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&Kw(t,r,!1),wa(e,t,i);n=t.stateNode,X5.current=t;var l=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=tc(t,e.child,null,i),t.child=tc(t,null,l,i)):Wr(e,t,l,i),t.memoizedState=n.state,a&&Kw(t,r,!0),t.child}function RN(e){var t=e.stateNode;t.pendingContext?qw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qw(e,t.context,!1),t0(e,t.containerInfo)}function sS(e,t,r,n,a){return ec(),Xb(a),t.flags|=256,Wr(e,t,r,n),t.child}var Rv={dehydrated:null,treeContext:null,retryLane:0};function Fv(e){return{baseLanes:e,cachePool:null,transitions:null}}function FN(e,t,r){var n=t.pendingProps,a=Mt.current,i=!1,s=(t.flags&128)!==0,l;if((l=s)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),jt(Mt,a&1),e===null)return Mv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=im(s,n,0,null),e=Es(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fv(r),t.memoizedState=Rv,e):c0(t,s));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Y5(e,t,s,n,l,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=wi(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=wi(l,i):(i=Es(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Fv(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Rv,n}return i=e.child,e=i.sibling,n=wi(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function c0(e,t){return t=im({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function jf(e,t,r,n){return n!==null&&Xb(n),tc(t,e.child,null,r),e=c0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Y5(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Yg(Error(ke(422))),jf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=im({mode:"visible",children:n.children},a,0,null),i=Es(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&tc(t,e.child,null,s),t.child.memoizedState=Fv(s),t.memoizedState=Rv,i);if(!(t.mode&1))return jf(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(ke(419)),n=Yg(i,n,void 0),jf(e,t,s,n)}if(l=(s&e.childLanes)!==0,an||l){if(n=gr,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ja(e,a),So(n,e,a,-1))}return m0(),n=Yg(Error(ke(421))),jf(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=c$.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,jn=vi(a.nextSibling),wn=t,_t=!0,vo=null,e!==null&&(Bn[Un++]=la,Bn[Un++]=ca,Bn[Un++]=Is,la=e.id,ca=e.overflow,Is=t),t=c0(t,n.children),t.flags|=4096,t)}function lS(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ov(e.return,t,r)}function Jg(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function zN(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Wr(e,t,n.children,r),n=Mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lS(e,r,t);else if(e.tag===19)lS(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(jt(Mt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&$h(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Jg(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&$h(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Jg(t,!0,r,null,i);break;case"together":Jg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Rs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=wi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=wi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function J5(e,t,r){switch(t.tag){case 3:RN(t),ec();break;case 5:fN(t);break;case 1:cn(t.type)&&Mh(t);break;case 4:t0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;jt(Lh,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(jt(Mt,Mt.current&1),t.flags|=128,null):r&t.child.childLanes?FN(e,t,r):(jt(Mt,Mt.current&1),e=wa(e,t,r),e!==null?e.sibling:null);jt(Mt,Mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return zN(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),jt(Mt,Mt.current),n)break;return null;case 22:case 23:return t.lanes=0,IN(e,t,r)}return wa(e,t,r)}var BN,zv,UN,WN;BN=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zv=function(){};UN=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,hs(Fo.current);var i=null;switch(r){case"input":a=lv(e,a),n=lv(e,n),i=[];break;case"select":a=Dt({},a,{value:void 0}),n=Dt({},n,{value:void 0}),i=[];break;case"textarea":a=uv(e,a),n=uv(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Nh)}hv(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qd.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&wt("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};WN=function(e,t,r,n){r!==n&&(t.flags|=4)};function Xc(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Mr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Z5(e,t,r){var n=t.pendingProps;switch(Hb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mr(t),null;case 1:return cn(t.type)&&Ph(),Mr(t),null;case 3:return n=t.stateNode,rc(),Ct(ln),Ct(zr),n0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,vo!==null&&(Hv(vo),vo=null))),zv(e,t),Mr(t),null;case 5:r0(t);var a=hs(ru.current);if(r=t.type,e!==null&&t.stateNode!=null)UN(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return Mr(t),null}if(e=hs(Fo.current),yf(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Do]=t,n[eu]=i,e=(t.mode&1)!==0,r){case"dialog":wt("cancel",n),wt("close",n);break;case"iframe":case"object":case"embed":wt("load",n);break;case"video":case"audio":for(a=0;a<xd.length;a++)wt(xd[a],n);break;case"source":wt("error",n);break;case"img":case"image":case"link":wt("error",n),wt("load",n);break;case"details":wt("toggle",n);break;case"input":xw(n,i),wt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},wt("invalid",n);break;case"textarea":yw(n,i),wt("invalid",n)}hv(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&vf(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&vf(n.textContent,l,e),a=["children",""+l]):qd.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&wt("scroll",n)}switch(r){case"input":df(n),vw(n,i,!0);break;case"textarea":df(n),bw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Nh)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=xE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Do]=t,e[eu]=n,BN(e,t,!1,!1),t.stateNode=e;e:{switch(s=pv(r,n),r){case"dialog":wt("cancel",e),wt("close",e),a=n;break;case"iframe":case"object":case"embed":wt("load",e),a=n;break;case"video":case"audio":for(a=0;a<xd.length;a++)wt(xd[a],e);a=n;break;case"source":wt("error",e),a=n;break;case"img":case"image":case"link":wt("error",e),wt("load",e),a=n;break;case"details":wt("toggle",e),a=n;break;case"input":xw(e,n),a=lv(e,n),wt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Dt({},n,{value:void 0}),wt("invalid",e);break;case"textarea":yw(e,n),a=uv(e,n),wt("invalid",e);break;default:a=n}hv(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?bE(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vE(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Kd(e,c):typeof c=="number"&&Kd(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&wt("scroll",e):c!=null&&Tb(e,i,c,s))}switch(r){case"input":df(e),vw(e,n,!1);break;case"textarea":df(e),bw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ni(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ol(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ol(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Nh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mr(t),null;case 6:if(e&&t.stateNode!=null)WN(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=hs(ru.current),hs(Fo.current),yf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Do]=t,(i=n.nodeValue!==r)&&(e=wn,e!==null))switch(e.tag){case 3:vf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vf(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Do]=t,t.stateNode=n}return Mr(t),null;case 13:if(Ct(Mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&jn!==null&&t.mode&1&&!(t.flags&128))sN(),ec(),t.flags|=98560,i=!1;else if(i=yf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ke(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ke(317));i[Do]=t}else ec(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mr(t),i=!1}else vo!==null&&(Hv(vo),vo=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Mt.current&1?ar===0&&(ar=3):m0())),t.updateQueue!==null&&(t.flags|=4),Mr(t),null);case 4:return rc(),zv(e,t),e===null&&Zd(t.stateNode.containerInfo),Mr(t),null;case 10:return Zb(t.type._context),Mr(t),null;case 17:return cn(t.type)&&Ph(),Mr(t),null;case 19:if(Ct(Mt),i=t.memoizedState,i===null)return Mr(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Xc(i,!1);else{if(ar!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=$h(e),s!==null){for(t.flags|=128,Xc(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return jt(Mt,Mt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Kt()>oc&&(t.flags|=128,n=!0,Xc(i,!1),t.lanes=4194304)}else{if(!n)if(e=$h(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Xc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!_t)return Mr(t),null}else 2*Kt()-i.renderingStartTime>oc&&r!==1073741824&&(t.flags|=128,n=!0,Xc(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Kt(),t.sibling=null,r=Mt.current,jt(Mt,n?r&1|2:r&1),t):(Mr(t),null);case 22:case 23:return p0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?pn&1073741824&&(Mr(t),t.subtreeFlags&6&&(t.flags|=8192)):Mr(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function Q5(e,t){switch(Hb(t),t.tag){case 1:return cn(t.type)&&Ph(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return rc(),Ct(ln),Ct(zr),n0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return r0(t),null;case 13:if(Ct(Mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));ec()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ct(Mt),null;case 4:return rc(),null;case 10:return Zb(t.type._context),null;case 22:case 23:return p0(),null;case 24:return null;default:return null}}var wf=!1,Ir=!1,e$=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function El(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(e,t,n)}else r.current=null}function Bv(e,t,r){try{r()}catch(n){Bt(e,t,n)}}var cS=!1;function t$(e,t){if(kv=_h,e=HE(),Gb(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var x;f!==r||a!==0&&f.nodeType!==3||(l=s+a),f!==i||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(x=f.firstChild)!==null;)p=f,f=x;for(;;){if(f===e)break t;if(p===r&&++u===a&&(l=s),p===i&&++d===n&&(c=s),(x=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=x}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cv={focusedElem:e,selectionRange:r},_h=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,j=m.memoizedState,b=t.stateNode,g=b.getSnapshotBeforeUpdate(t.elementType===t.type?y:uo(t.type,y),j);b.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(w){Bt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return m=cS,cS=!1,m}function Od(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Bv(t,r,i)}a=a.next}while(a!==n)}}function om(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Uv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function qN(e){var t=e.alternate;t!==null&&(e.alternate=null,qN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Do],delete t[eu],delete t[Ev],delete t[$5],delete t[R5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function KN(e){return e.tag===5||e.tag===3||e.tag===4}function dS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||KN(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Nh));else if(n!==4&&(e=e.child,e!==null))for(Wv(e,t,r),e=e.sibling;e!==null;)Wv(e,t,r),e=e.sibling}function qv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(qv(e,t,r),e=e.sibling;e!==null;)qv(e,t,r),e=e.sibling}var Sr=null,go=!1;function za(e,t,r){for(r=r.child;r!==null;)GN(e,t,r),r=r.sibling}function GN(e,t,r){if(Ro&&typeof Ro.onCommitFiberUnmount=="function")try{Ro.onCommitFiberUnmount(Yp,r)}catch{}switch(r.tag){case 5:Ir||El(r,t);case 6:var n=Sr,a=go;Sr=null,za(e,t,r),Sr=n,go=a,Sr!==null&&(go?(e=Sr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Sr.removeChild(r.stateNode));break;case 18:Sr!==null&&(go?(e=Sr,r=r.stateNode,e.nodeType===8?qg(e.parentNode,r):e.nodeType===1&&qg(e,r),Xd(e)):qg(Sr,r.stateNode));break;case 4:n=Sr,a=go,Sr=r.stateNode.containerInfo,go=!0,za(e,t,r),Sr=n,go=a;break;case 0:case 11:case 14:case 15:if(!Ir&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Bv(r,t,s),a=a.next}while(a!==n)}za(e,t,r);break;case 1:if(!Ir&&(El(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Bt(r,t,l)}za(e,t,r);break;case 21:za(e,t,r);break;case 22:r.mode&1?(Ir=(n=Ir)||r.memoizedState!==null,za(e,t,r),Ir=n):za(e,t,r);break;default:za(e,t,r)}}function uS(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new e$),t.forEach(function(n){var a=d$.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function lo(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,l=s;e:for(;l!==null;){switch(l.tag){case 5:Sr=l.stateNode,go=!1;break e;case 3:Sr=l.stateNode.containerInfo,go=!0;break e;case 4:Sr=l.stateNode.containerInfo,go=!0;break e}l=l.return}if(Sr===null)throw Error(ke(160));GN(i,s,a),Sr=null,go=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Bt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)VN(t,e),t=t.sibling}function VN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(lo(t,e),Eo(e),n&4){try{Od(3,e,e.return),om(3,e)}catch(y){Bt(e,e.return,y)}try{Od(5,e,e.return)}catch(y){Bt(e,e.return,y)}}break;case 1:lo(t,e),Eo(e),n&512&&r!==null&&El(r,r.return);break;case 5:if(lo(t,e),Eo(e),n&512&&r!==null&&El(r,r.return),e.flags&32){var a=e.stateNode;try{Kd(a,"")}catch(y){Bt(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&mE(a,i),pv(l,s);var u=pv(l,i);for(s=0;s<c.length;s+=2){var d=c[s],f=c[s+1];d==="style"?bE(a,f):d==="dangerouslySetInnerHTML"?vE(a,f):d==="children"?Kd(a,f):Tb(a,d,f,u)}switch(l){case"input":cv(a,i);break;case"textarea":gE(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Ol(a,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ol(a,!!i.multiple,i.defaultValue,!0):Ol(a,!!i.multiple,i.multiple?[]:"",!1))}a[eu]=i}catch(y){Bt(e,e.return,y)}}break;case 6:if(lo(t,e),Eo(e),n&4){if(e.stateNode===null)throw Error(ke(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(y){Bt(e,e.return,y)}}break;case 3:if(lo(t,e),Eo(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Xd(t.containerInfo)}catch(y){Bt(e,e.return,y)}break;case 4:lo(t,e),Eo(e);break;case 13:lo(t,e),Eo(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(f0=Kt())),n&4&&uS(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ir=(u=Ir)||d,lo(t,e),Ir=u):lo(t,e),Eo(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Ne=e,d=e.child;d!==null;){for(f=Ne=d;Ne!==null;){switch(p=Ne,x=p.child,p.tag){case 0:case 11:case 14:case 15:Od(4,p,p.return);break;case 1:El(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(y){Bt(n,r,y)}}break;case 5:El(p,p.return);break;case 22:if(p.memoizedState!==null){hS(f);continue}}x!==null?(x.return=p,Ne=x):hS(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=yE("display",s))}catch(y){Bt(e,e.return,y)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(y){Bt(e,e.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:lo(t,e),Eo(e),n&4&&uS(e);break;case 21:break;default:lo(t,e),Eo(e)}}function Eo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(KN(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Kd(a,""),n.flags&=-33);var i=dS(e);qv(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,l=dS(e);Wv(e,l,s);break;default:throw Error(ke(161))}}catch(c){Bt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function r$(e,t,r){Ne=e,HN(e)}function HN(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var a=Ne,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||wf;if(!s){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ir;l=wf;var u=Ir;if(wf=s,(Ir=c)&&!u)for(Ne=a;Ne!==null;)s=Ne,c=s.child,s.tag===22&&s.memoizedState!==null?pS(a):c!==null?(c.return=s,Ne=c):pS(a);for(;i!==null;)Ne=i,HN(i),i=i.sibling;Ne=a,wf=l,Ir=u}fS(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ne=i):fS(e)}}function fS(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ir||om(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ir)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:uo(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Yw(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Yw(t,s,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Xd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}Ir||t.flags&512&&Uv(t)}catch(p){Bt(t,t.return,p)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function hS(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function pS(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{om(4,t)}catch(c){Bt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Bt(t,a,c)}}var i=t.return;try{Uv(t)}catch(c){Bt(t,i,c)}break;case 5:var s=t.return;try{Uv(t)}catch(c){Bt(t,s,c)}}}catch(c){Bt(t,t.return,c)}if(t===e){Ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ne=l;break}Ne=t.return}}var n$=Math.ceil,zh=Na.ReactCurrentDispatcher,d0=Na.ReactCurrentOwner,Xn=Na.ReactCurrentBatchConfig,ot=0,gr=null,Jt=null,Cr=0,pn=0,Nl=$i(0),ar=0,iu=null,Rs=0,am=0,u0=0,Td=null,nn=null,f0=0,oc=1/0,Qo=null,Bh=!1,Kv=null,bi=null,Sf=!1,hi=null,Uh=0,Ld=0,Gv=null,hh=-1,ph=0;function Vr(){return ot&6?Kt():hh!==-1?hh:hh=Kt()}function ji(e){return e.mode&1?ot&2&&Cr!==0?Cr&-Cr:z5.transition!==null?(ph===0&&(ph=OE()),ph):(e=pt,e!==0||(e=window.event,e=e===void 0?16:FE(e.type)),e):1}function So(e,t,r,n){if(50<Ld)throw Ld=0,Gv=null,Error(ke(185));Lu(e,r,n),(!(ot&2)||e!==gr)&&(e===gr&&(!(ot&2)&&(am|=r),ar===4&&ri(e,Cr)),dn(e,n),r===1&&ot===0&&!(t.mode&1)&&(oc=Kt()+500,tm&&Ri()))}function dn(e,t){var r=e.callbackNode;z4(e,t);var n=Ch(e,e===gr?Cr:0);if(n===0)r!==null&&Sw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Sw(r),t===1)e.tag===0?F5(mS.bind(null,e)):oN(mS.bind(null,e)),D5(function(){!(ot&6)&&Ri()}),r=null;else{switch(TE(n)){case 1:r=Rb;break;case 4:r=PE;break;case 16:r=kh;break;case 536870912:r=ME;break;default:r=kh}r=rP(r,XN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function XN(e,t){if(hh=-1,ph=0,ot&6)throw Error(ke(327));var r=e.callbackNode;if($l()&&e.callbackNode!==r)return null;var n=Ch(e,e===gr?Cr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Wh(e,n);else{t=n;var a=ot;ot|=2;var i=JN();(gr!==e||Cr!==t)&&(Qo=null,oc=Kt()+500,As(e,t));do try{i$();break}catch(l){YN(e,l)}while(!0);Jb(),zh.current=i,ot=a,Jt!==null?t=0:(gr=null,Cr=0,t=ar)}if(t!==0){if(t===2&&(a=yv(e),a!==0&&(n=a,t=Vv(e,a))),t===1)throw r=iu,As(e,0),ri(e,n),dn(e,Kt()),r;if(t===6)ri(e,n);else{if(a=e.current.alternate,!(n&30)&&!o$(a)&&(t=Wh(e,n),t===2&&(i=yv(e),i!==0&&(n=i,t=Vv(e,i))),t===1))throw r=iu,As(e,0),ri(e,n),dn(e,Kt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:rs(e,nn,Qo);break;case 3:if(ri(e,n),(n&130023424)===n&&(t=f0+500-Kt(),10<t)){if(Ch(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Vr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Av(rs.bind(null,e,nn,Qo),t);break}rs(e,nn,Qo);break;case 4:if(ri(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-wo(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Kt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*n$(n/1960))-n,10<n){e.timeoutHandle=Av(rs.bind(null,e,nn,Qo),n);break}rs(e,nn,Qo);break;case 5:rs(e,nn,Qo);break;default:throw Error(ke(329))}}}return dn(e,Kt()),e.callbackNode===r?XN.bind(null,e):null}function Vv(e,t){var r=Td;return e.current.memoizedState.isDehydrated&&(As(e,t).flags|=256),e=Wh(e,t),e!==2&&(t=nn,nn=r,t!==null&&Hv(t)),e}function Hv(e){nn===null?nn=e:nn.push.apply(nn,e)}function o$(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!_o(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ri(e,t){for(t&=~u0,t&=~am,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-wo(t),n=1<<r;e[r]=-1,t&=~n}}function mS(e){if(ot&6)throw Error(ke(327));$l();var t=Ch(e,0);if(!(t&1))return dn(e,Kt()),null;var r=Wh(e,t);if(e.tag!==0&&r===2){var n=yv(e);n!==0&&(t=n,r=Vv(e,n))}if(r===1)throw r=iu,As(e,0),ri(e,t),dn(e,Kt()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rs(e,nn,Qo),dn(e,Kt()),null}function h0(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(oc=Kt()+500,tm&&Ri())}}function Fs(e){hi!==null&&hi.tag===0&&!(ot&6)&&$l();var t=ot;ot|=1;var r=Xn.transition,n=pt;try{if(Xn.transition=null,pt=1,e)return e()}finally{pt=n,Xn.transition=r,ot=t,!(ot&6)&&Ri()}}function p0(){pn=Nl.current,Ct(Nl)}function As(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,L5(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(Hb(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ph();break;case 3:rc(),Ct(ln),Ct(zr),n0();break;case 5:r0(n);break;case 4:rc();break;case 13:Ct(Mt);break;case 19:Ct(Mt);break;case 10:Zb(n.type._context);break;case 22:case 23:p0()}r=r.return}if(gr=e,Jt=e=wi(e.current,null),Cr=pn=t,ar=0,iu=null,u0=am=Rs=0,nn=Td=null,fs!==null){for(t=0;t<fs.length;t++)if(r=fs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}fs=null}return e}function YN(e,t){do{var r=Jt;try{if(Jb(),dh.current=Fh,Rh){for(var n=Tt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Rh=!1}if($s=0,hr=nr=Tt=null,Md=!1,nu=0,d0.current=null,r===null||r.return===null){ar=1,iu=t,Jt=null;break}e:{var i=e,s=r.return,l=r,c=t;if(t=Cr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=rS(s);if(x!==null){x.flags&=-257,nS(x,s,l,i,t),x.mode&1&&tS(i,u,t),t=x,c=u;var m=t.updateQueue;if(m===null){var y=new Set;y.add(c),t.updateQueue=y}else m.add(c);break e}else{if(!(t&1)){tS(i,u,t),m0();break e}c=Error(ke(426))}}else if(_t&&l.mode&1){var j=rS(s);if(j!==null){!(j.flags&65536)&&(j.flags|=256),nS(j,s,l,i,t),Xb(nc(c,l));break e}}i=c=nc(c,l),ar!==4&&(ar=2),Td===null?Td=[i]:Td.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=TN(i,c,t);Xw(i,b);break e;case 1:l=c;var g=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(bi===null||!bi.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=LN(i,l,t);Xw(i,w);break e}}i=i.return}while(i!==null)}QN(r)}catch(C){t=C,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function JN(){var e=zh.current;return zh.current=Fh,e===null?Fh:e}function m0(){(ar===0||ar===3||ar===2)&&(ar=4),gr===null||!(Rs&268435455)&&!(am&268435455)||ri(gr,Cr)}function Wh(e,t){var r=ot;ot|=2;var n=JN();(gr!==e||Cr!==t)&&(Qo=null,As(e,t));do try{a$();break}catch(a){YN(e,a)}while(!0);if(Jb(),ot=r,zh.current=n,Jt!==null)throw Error(ke(261));return gr=null,Cr=0,ar}function a$(){for(;Jt!==null;)ZN(Jt)}function i$(){for(;Jt!==null&&!M4();)ZN(Jt)}function ZN(e){var t=tP(e.alternate,e,pn);e.memoizedProps=e.pendingProps,t===null?QN(e):Jt=t,d0.current=null}function QN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Q5(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ar=6,Jt=null;return}}else if(r=Z5(r,t,pn),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);ar===0&&(ar=5)}function rs(e,t,r){var n=pt,a=Xn.transition;try{Xn.transition=null,pt=1,s$(e,t,r,n)}finally{Xn.transition=a,pt=n}return null}function s$(e,t,r,n){do $l();while(hi!==null);if(ot&6)throw Error(ke(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(B4(e,i),e===gr&&(Jt=gr=null,Cr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sf||(Sf=!0,rP(kh,function(){return $l(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Xn.transition,Xn.transition=null;var s=pt;pt=1;var l=ot;ot|=4,d0.current=null,t$(e,r),VN(r,e),A5(Cv),_h=!!kv,Cv=kv=null,e.current=r,r$(r),O4(),ot=l,pt=s,Xn.transition=i}else e.current=r;if(Sf&&(Sf=!1,hi=e,Uh=a),i=e.pendingLanes,i===0&&(bi=null),D4(r.stateNode),dn(e,Kt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Bh)throw Bh=!1,e=Kv,Kv=null,e;return Uh&1&&e.tag!==0&&$l(),i=e.pendingLanes,i&1?e===Gv?Ld++:(Ld=0,Gv=e):Ld=0,Ri(),null}function $l(){if(hi!==null){var e=TE(Uh),t=Xn.transition,r=pt;try{if(Xn.transition=null,pt=16>e?16:e,hi===null)var n=!1;else{if(e=hi,hi=null,Uh=0,ot&6)throw Error(ke(331));var a=ot;for(ot|=4,Ne=e.current;Ne!==null;){var i=Ne,s=i.child;if(Ne.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ne=u;Ne!==null;){var d=Ne;switch(d.tag){case 0:case 11:case 15:Od(8,d,i)}var f=d.child;if(f!==null)f.return=d,Ne=f;else for(;Ne!==null;){d=Ne;var p=d.sibling,x=d.return;if(qN(d),d===u){Ne=null;break}if(p!==null){p.return=x,Ne=p;break}Ne=x}}}var m=i.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var j=y.sibling;y.sibling=null,y=j}while(y!==null)}}Ne=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ne=s;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Od(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Ne=b;break e}Ne=i.return}}var g=e.current;for(Ne=g;Ne!==null;){s=Ne;var v=s.child;if(s.subtreeFlags&2064&&v!==null)v.return=s,Ne=v;else e:for(s=g;Ne!==null;){if(l=Ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:om(9,l)}}catch(C){Bt(l,l.return,C)}if(l===s){Ne=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,Ne=w;break e}Ne=l.return}}if(ot=a,Ri(),Ro&&typeof Ro.onPostCommitFiberRoot=="function")try{Ro.onPostCommitFiberRoot(Yp,e)}catch{}n=!0}return n}finally{pt=r,Xn.transition=t}}return!1}function gS(e,t,r){t=nc(r,t),t=TN(e,t,1),e=yi(e,t,1),t=Vr(),e!==null&&(Lu(e,1,t),dn(e,t))}function Bt(e,t,r){if(e.tag===3)gS(e,e,r);else for(;t!==null;){if(t.tag===3){gS(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(bi===null||!bi.has(n))){e=nc(r,e),e=LN(t,e,1),t=yi(t,e,1),e=Vr(),t!==null&&(Lu(t,1,e),dn(t,e));break}}t=t.return}}function l$(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Vr(),e.pingedLanes|=e.suspendedLanes&r,gr===e&&(Cr&r)===r&&(ar===4||ar===3&&(Cr&130023424)===Cr&&500>Kt()-f0?As(e,0):u0|=r),dn(e,t)}function eP(e,t){t===0&&(e.mode&1?(t=hf,hf<<=1,!(hf&130023424)&&(hf=4194304)):t=1);var r=Vr();e=ja(e,t),e!==null&&(Lu(e,t,r),dn(e,r))}function c$(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),eP(e,r)}function d$(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),eP(e,r)}var tP;tP=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ln.current)an=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return an=!1,J5(e,t,r);an=!!(e.flags&131072)}else an=!1,_t&&t.flags&1048576&&aN(t,Th,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;fh(e,t),e=t.pendingProps;var a=Ql(t,zr.current);Il(t,r),a=a0(null,t,n,e,a,r);var i=i0();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,cn(n)?(i=!0,Mh(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,e0(t),a.updater=nm,t.stateNode=a,a._reactInternals=t,Lv(t,n,e,r),t=$v(null,t,n,!0,i,r)):(t.tag=0,_t&&i&&Vb(t),Wr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(fh(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=f$(n),e=uo(n,e),a){case 0:t=Iv(null,t,n,e,r);break e;case 1:t=iS(null,t,n,e,r);break e;case 11:t=oS(null,t,n,e,r);break e;case 14:t=aS(null,t,n,uo(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:uo(n,a),Iv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:uo(n,a),iS(e,t,n,a,r);case 3:e:{if(RN(t),e===null)throw Error(ke(387));n=t.pendingProps,i=t.memoizedState,a=i.element,uN(e,t),Ih(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=nc(Error(ke(423)),t),t=sS(e,t,n,r,a);break e}else if(n!==a){a=nc(Error(ke(424)),t),t=sS(e,t,n,r,a);break e}else for(jn=vi(t.stateNode.containerInfo.firstChild),wn=t,_t=!0,vo=null,r=cN(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ec(),n===a){t=wa(e,t,r);break e}Wr(e,t,n,r)}t=t.child}return t;case 5:return fN(t),e===null&&Mv(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,_v(n,a)?s=null:i!==null&&_v(n,i)&&(t.flags|=32),$N(e,t),Wr(e,t,s,r),t.child;case 6:return e===null&&Mv(t),null;case 13:return FN(e,t,r);case 4:return t0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=tc(t,null,n,r):Wr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:uo(n,a),oS(e,t,n,a,r);case 7:return Wr(e,t,t.pendingProps,r),t.child;case 8:return Wr(e,t,t.pendingProps.children,r),t.child;case 12:return Wr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,jt(Lh,n._currentValue),n._currentValue=s,i!==null)if(_o(i.value,s)){if(i.children===a.children&&!ln.current){t=wa(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){s=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=fa(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ov(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ke(341));s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ov(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Wr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Il(t,r),a=Qn(a),n=n(a),t.flags|=1,Wr(e,t,n,r),t.child;case 14:return n=t.type,a=uo(n,t.pendingProps),a=uo(n.type,a),aS(e,t,n,a,r);case 15:return DN(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:uo(n,a),fh(e,t),t.tag=1,cn(n)?(e=!0,Mh(t)):e=!1,Il(t,r),ON(t,n,a),Lv(t,n,a,r),$v(null,t,n,!0,e,r);case 19:return zN(e,t,r);case 22:return IN(e,t,r)}throw Error(ke(156,t.tag))};function rP(e,t){return NE(e,t)}function u$(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(e,t,r,n){return new u$(e,t,r,n)}function g0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function f$(e){if(typeof e=="function")return g0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Db)return 11;if(e===Ib)return 14}return 2}function wi(e,t){var r=e.alternate;return r===null?(r=qn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function mh(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")g0(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case yl:return Es(r.children,a,i,t);case Lb:s=8,a|=8;break;case ov:return e=qn(12,r,t,a|2),e.elementType=ov,e.lanes=i,e;case av:return e=qn(13,r,t,a),e.elementType=av,e.lanes=i,e;case iv:return e=qn(19,r,t,a),e.elementType=iv,e.lanes=i,e;case fE:return im(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case dE:s=10;break e;case uE:s=9;break e;case Db:s=11;break e;case Ib:s=14;break e;case Ya:s=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=qn(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Es(e,t,r,n){return e=qn(7,e,n,t),e.lanes=r,e}function im(e,t,r,n){return e=qn(22,e,n,t),e.elementType=fE,e.lanes=r,e.stateNode={isHidden:!1},e}function Zg(e,t,r){return e=qn(6,e,null,t),e.lanes=r,e}function Qg(e,t,r){return t=qn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function h$(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tg(0),this.expirationTimes=Tg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tg(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function x0(e,t,r,n,a,i,s,l,c){return e=new h$(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=qn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},e0(i),e}function p$(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function nP(e){if(!e)return Pi;e=e._reactInternals;e:{if(Vs(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(cn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(cn(r))return nN(e,r,t)}return t}function oP(e,t,r,n,a,i,s,l,c){return e=x0(r,n,!0,e,a,i,s,l,c),e.context=nP(null),r=e.current,n=Vr(),a=ji(r),i=fa(n,a),i.callback=t??null,yi(r,i,a),e.current.lanes=a,Lu(e,a,n),dn(e,n),e}function sm(e,t,r,n){var a=t.current,i=Vr(),s=ji(a);return r=nP(r),t.context===null?t.context=r:t.pendingContext=r,t=fa(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=yi(a,t,s),e!==null&&(So(e,a,s,i),ch(e,a,s)),s}function qh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function xS(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function v0(e,t){xS(e,t),(e=e.alternate)&&xS(e,t)}function m$(){return null}var aP=typeof reportError=="function"?reportError:function(e){console.error(e)};function y0(e){this._internalRoot=e}lm.prototype.render=y0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));sm(e,t,null,null)};lm.prototype.unmount=y0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fs(function(){sm(null,e,null,null)}),t[ba]=null}};function lm(e){this._internalRoot=e}lm.prototype.unstable_scheduleHydration=function(e){if(e){var t=IE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ti.length&&t!==0&&t<ti[r].priority;r++);ti.splice(r,0,e),r===0&&RE(e)}};function b0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function vS(){}function g$(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=qh(s);i.call(u)}}var s=oP(t,n,e,0,null,!1,!1,"",vS);return e._reactRootContainer=s,e[ba]=s.current,Zd(e.nodeType===8?e.parentNode:e),Fs(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=qh(c);l.call(u)}}var c=x0(e,0,!1,null,null,!1,!1,"",vS);return e._reactRootContainer=c,e[ba]=c.current,Zd(e.nodeType===8?e.parentNode:e),Fs(function(){sm(t,c,r,n)}),c}function dm(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var l=a;a=function(){var c=qh(s);l.call(c)}}sm(t,s,e,a)}else s=g$(r,t,e,a,n);return qh(s)}LE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=gd(t.pendingLanes);r!==0&&(Fb(t,r|1),dn(t,Kt()),!(ot&6)&&(oc=Kt()+500,Ri()))}break;case 13:Fs(function(){var n=ja(e,1);if(n!==null){var a=Vr();So(n,e,1,a)}}),v0(e,1)}};zb=function(e){if(e.tag===13){var t=ja(e,134217728);if(t!==null){var r=Vr();So(t,e,134217728,r)}v0(e,134217728)}};DE=function(e){if(e.tag===13){var t=ji(e),r=ja(e,t);if(r!==null){var n=Vr();So(r,e,t,n)}v0(e,t)}};IE=function(){return pt};$E=function(e,t){var r=pt;try{return pt=e,t()}finally{pt=r}};gv=function(e,t,r){switch(t){case"input":if(cv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=em(n);if(!a)throw Error(ke(90));pE(n),cv(n,a)}}}break;case"textarea":gE(e,r);break;case"select":t=r.value,t!=null&&Ol(e,!!r.multiple,t,!1)}};SE=h0;kE=Fs;var x$={usingClientEntryPoint:!1,Events:[Iu,Sl,em,jE,wE,h0]},Yc={findFiberByHostInstance:us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v$={bundleType:Yc.bundleType,version:Yc.version,rendererPackageName:Yc.rendererPackageName,rendererConfig:Yc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Na.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=AE(e),e===null?null:e.stateNode},findFiberByHostInstance:Yc.findFiberByHostInstance||m$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kf.isDisabled&&kf.supportsFiber)try{Yp=kf.inject(v$),Ro=kf}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x$;Mn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!b0(t))throw Error(ke(200));return p$(e,t,null,r)};Mn.createRoot=function(e,t){if(!b0(e))throw Error(ke(299));var r=!1,n="",a=aP;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=x0(e,1,!1,null,null,r,!1,n,a),e[ba]=t.current,Zd(e.nodeType===8?e.parentNode:e),new y0(t)};Mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=AE(t),e=e===null?null:e.stateNode,e};Mn.flushSync=function(e){return Fs(e)};Mn.hydrate=function(e,t,r){if(!cm(t))throw Error(ke(200));return dm(null,e,t,!0,r)};Mn.hydrateRoot=function(e,t,r){if(!b0(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=aP;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=oP(t,null,e,1,r??null,a,!1,i,s),e[ba]=t.current,Zd(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new lm(t)};Mn.render=function(e,t,r){if(!cm(t))throw Error(ke(200));return dm(null,e,t,!1,r)};Mn.unmountComponentAtNode=function(e){if(!cm(e))throw Error(ke(40));return e._reactRootContainer?(Fs(function(){dm(null,null,e,!1,function(){e._reactRootContainer=null,e[ba]=null})}),!0):!1};Mn.unstable_batchedUpdates=h0;Mn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cm(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return dm(e,t,r,!1,n)};Mn.version="18.3.1-next-f1338f8080-20240426";function iP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iP)}catch(e){console.error(e)}}iP(),iE.exports=Mn;var Pa=iE.exports,sP,yS=Pa;sP=yS.createRoot,yS.hydrateRoot;var um=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},fm=typeof window>"u"||"Deno"in globalThis;function fo(){}function y$(e,t){return typeof e=="function"?e(t):e}function b$(e){return typeof e=="number"&&e>=0&&e!==1/0}function j$(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Xv(e,t){return typeof e=="function"?e(t):e}function w$(e,t){return typeof e=="function"?e(t):e}function bS(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:s,stale:l}=e;if(s){if(n){if(t.queryHash!==j0(s,t.options))return!1}else if(!lu(t.queryKey,s))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function jS(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(su(t.options.mutationKey)!==su(i))return!1}else if(!lu(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function j0(e,t){return((t==null?void 0:t.queryKeyHashFn)||su)(e)}function su(e){return JSON.stringify(e,(t,r)=>Yv(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function lu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>lu(e[r],t[r])):!1}function lP(e,t){if(e===t)return e;const r=wS(e)&&wS(t);if(r||Yv(e)&&Yv(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),s=i.length,l=r?[]:{},c=new Set(n);let u=0;for(let d=0;d<s;d++){const f=r?d:i[d];(!r&&c.has(f)||r)&&e[f]===void 0&&t[f]===void 0?(l[f]=void 0,u++):(l[f]=lP(e[f],t[f]),l[f]===e[f]&&e[f]!==void 0&&u++)}return a===s&&u===a?e:l}return t}function wS(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Yv(e){if(!SS(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!SS(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function SS(e){return Object.prototype.toString.call(e)==="[object Object]"}function S$(e){return new Promise(t=>{setTimeout(t,e)})}function k$(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?lP(e,t):t}function C$(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function _$(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var w0=Symbol();function cP(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===w0?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var js,si,ql,BA,A$=(BA=class extends um{constructor(){super();st(this,js);st(this,si);st(this,ql);We(this,ql,t=>{if(!fm&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){fe(this,si)||this.setEventListener(fe(this,ql))}onUnsubscribe(){var t;this.hasListeners()||((t=fe(this,si))==null||t.call(this),We(this,si,void 0))}setEventListener(t){var r;We(this,ql,t),(r=fe(this,si))==null||r.call(this),We(this,si,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){fe(this,js)!==t&&(We(this,js,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof fe(this,js)=="boolean"?fe(this,js):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},js=new WeakMap,si=new WeakMap,ql=new WeakMap,BA),dP=new A$,Kl,li,Gl,UA,E$=(UA=class extends um{constructor(){super();st(this,Kl,!0);st(this,li);st(this,Gl);We(this,Gl,t=>{if(!fm&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){fe(this,li)||this.setEventListener(fe(this,Gl))}onUnsubscribe(){var t;this.hasListeners()||((t=fe(this,li))==null||t.call(this),We(this,li,void 0))}setEventListener(t){var r;We(this,Gl,t),(r=fe(this,li))==null||r.call(this),We(this,li,t(this.setOnline.bind(this)))}setOnline(t){fe(this,Kl)!==t&&(We(this,Kl,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return fe(this,Kl)}},Kl=new WeakMap,li=new WeakMap,Gl=new WeakMap,UA),Kh=new E$;function N$(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function P$(e){return Math.min(1e3*2**e,3e4)}function uP(e){return(e??"online")==="online"?Kh.isOnline():!0}var fP=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ex(e){return e instanceof fP}function hP(e){let t=!1,r=0,n=!1,a;const i=N$(),s=y=>{var j;n||(p(new fP(y)),(j=e.abort)==null||j.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>dP.isFocused()&&(e.networkMode==="always"||Kh.isOnline())&&e.canRun(),d=()=>uP(e.networkMode)&&e.canRun(),f=y=>{var j;n||(n=!0,(j=e.onSuccess)==null||j.call(e,y),a==null||a(),i.resolve(y))},p=y=>{var j;n||(n=!0,(j=e.onError)==null||j.call(e,y),a==null||a(),i.reject(y))},x=()=>new Promise(y=>{var j;a=b=>{(n||u())&&y(b)},(j=e.onPause)==null||j.call(e)}).then(()=>{var y;a=void 0,n||(y=e.onContinue)==null||y.call(e)}),m=()=>{if(n)return;let y;const j=r===0?e.initialPromise:void 0;try{y=j??e.fn()}catch(b){y=Promise.reject(b)}Promise.resolve(y).then(f).catch(b=>{var k;if(n)return;const g=e.retry??(fm?0:3),v=e.retryDelay??P$,w=typeof v=="function"?v(r,b):v,C=g===!0||typeof g=="number"&&r<g||typeof g=="function"&&g(r,b);if(t||!C){p(b);return}r++,(k=e.onFail)==null||k.call(e,r,b),S$(w).then(()=>u()?void 0:x()).then(()=>{t?p(b):m()})})};return{promise:i,cancel:s,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?m():x().then(m),i)}}var M$=e=>setTimeout(e,0);function O$(){let e=[],t=0,r=l=>{l()},n=l=>{l()},a=M$;const i=l=>{t?e.push(l):a(()=>{r(l)})},s=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||s()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var qr=O$(),ws,WA,pP=(WA=class{constructor(){st(this,ws)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),b$(this.gcTime)&&We(this,ws,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(fm?1/0:5*60*1e3))}clearGcTimeout(){fe(this,ws)&&(clearTimeout(fe(this,ws)),We(this,ws,void 0))}},ws=new WeakMap,WA),Vl,Ss,Fn,ks,Tr,Mu,Cs,po,Jo,qA,T$=(qA=class extends pP{constructor(t){super();st(this,po);st(this,Vl);st(this,Ss);st(this,Fn);st(this,ks);st(this,Tr);st(this,Mu);st(this,Cs);We(this,Cs,!1),We(this,Mu,t.defaultOptions),this.setOptions(t.options),this.observers=[],We(this,ks,t.client),We(this,Fn,fe(this,ks).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,We(this,Vl,D$(this.options)),this.state=t.state??fe(this,Vl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=fe(this,Tr))==null?void 0:t.promise}setOptions(t){this.options={...fe(this,Mu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&fe(this,Fn).remove(this)}setData(t,r){const n=k$(this.state.data,t,this.options);return Nr(this,po,Jo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Nr(this,po,Jo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=fe(this,Tr))==null?void 0:n.promise;return(a=fe(this,Tr))==null||a.cancel(t),r?r.then(fo).catch(fo):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(fe(this,Vl))}isActive(){return this.observers.some(t=>w$(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===w0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Xv(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!j$(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=fe(this,Tr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=fe(this,Tr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),fe(this,Fn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(fe(this,Tr)&&(fe(this,Cs)?fe(this,Tr).cancel({revert:!0}):fe(this,Tr).cancelRetry()),this.scheduleGc()),fe(this,Fn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nr(this,po,Jo).call(this,{type:"invalidate"})}fetch(t,r){var u,d,f;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(fe(this,Tr))return fe(this,Tr).continueRetry(),fe(this,Tr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const p=this.observers.find(x=>x.options.queryFn);p&&this.setOptions(p.options)}const n=new AbortController,a=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(We(this,Cs,!0),n.signal)})},i=()=>{const p=cP(this.options,r),m=(()=>{const y={client:fe(this,ks),queryKey:this.queryKey,meta:this.meta};return a(y),y})();return We(this,Cs,!1),this.options.persister?this.options.persister(p,m,this):p(m)},l=(()=>{const p={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:fe(this,ks),state:this.state,fetchFn:i};return a(p),p})();(u=this.options.behavior)==null||u.onFetch(l,this),We(this,Ss,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&Nr(this,po,Jo).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta});const c=p=>{var x,m,y,j;ex(p)&&p.silent||Nr(this,po,Jo).call(this,{type:"error",error:p}),ex(p)||((m=(x=fe(this,Fn).config).onError)==null||m.call(x,p,this),(j=(y=fe(this,Fn).config).onSettled)==null||j.call(y,this.state.data,p,this)),this.scheduleGc()};return We(this,Tr,hP({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:p=>{var x,m,y,j;if(p===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(b){c(b);return}(m=(x=fe(this,Fn).config).onSuccess)==null||m.call(x,p,this),(j=(y=fe(this,Fn).config).onSettled)==null||j.call(y,p,this.state.error,this),this.scheduleGc()},onError:c,onFail:(p,x)=>{Nr(this,po,Jo).call(this,{type:"failed",failureCount:p,error:x})},onPause:()=>{Nr(this,po,Jo).call(this,{type:"pause"})},onContinue:()=>{Nr(this,po,Jo).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),fe(this,Tr).start()}},Vl=new WeakMap,Ss=new WeakMap,Fn=new WeakMap,ks=new WeakMap,Tr=new WeakMap,Mu=new WeakMap,Cs=new WeakMap,po=new WeakSet,Jo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...L$(n.data,this.options),fetchMeta:t.meta??null};case"success":return We(this,Ss,void 0),{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return ex(a)&&a.revert&&fe(this,Ss)?{...fe(this,Ss),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),qr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),fe(this,Fn).notify({query:this,type:"updated",action:t})})},qA);function L$(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uP(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function D$(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Oo,KA,I$=(KA=class extends um{constructor(t={}){super();st(this,Oo);this.config=t,We(this,Oo,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??j0(a,r);let s=this.get(i);return s||(s=new T$({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(s)),s}add(t){fe(this,Oo).has(t.queryHash)||(fe(this,Oo).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=fe(this,Oo).get(t.queryHash);r&&(t.destroy(),r===t&&fe(this,Oo).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){qr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return fe(this,Oo).get(t)}getAll(){return[...fe(this,Oo).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>bS(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>bS(t,n)):r}notify(t){qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){qr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){qr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Oo=new WeakMap,KA),To,Ur,_s,Lo,Va,GA,$$=(GA=class extends pP{constructor(t){super();st(this,Lo);st(this,To);st(this,Ur);st(this,_s);this.mutationId=t.mutationId,We(this,Ur,t.mutationCache),We(this,To,[]),this.state=t.state||R$(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){fe(this,To).includes(t)||(fe(this,To).push(t),this.clearGcTimeout(),fe(this,Ur).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){We(this,To,fe(this,To).filter(r=>r!==t)),this.scheduleGc(),fe(this,Ur).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){fe(this,To).length||(this.state.status==="pending"?this.scheduleGc():fe(this,Ur).remove(this))}continue(){var t;return((t=fe(this,_s))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,s,l,c,u,d,f,p,x,m,y,j,b,g,v,w,C,k,S,_;const r=()=>{Nr(this,Lo,Va).call(this,{type:"continue"})};We(this,_s,hP({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(A,E)=>{Nr(this,Lo,Va).call(this,{type:"failed",failureCount:A,error:E})},onPause:()=>{Nr(this,Lo,Va).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>fe(this,Ur).canRun(this)}));const n=this.state.status==="pending",a=!fe(this,_s).canStart();try{if(n)r();else{Nr(this,Lo,Va).call(this,{type:"pending",variables:t,isPaused:a}),await((s=(i=fe(this,Ur).config).onMutate)==null?void 0:s.call(i,t,this));const E=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));E!==this.state.context&&Nr(this,Lo,Va).call(this,{type:"pending",context:E,variables:t,isPaused:a})}const A=await fe(this,_s).start();return await((d=(u=fe(this,Ur).config).onSuccess)==null?void 0:d.call(u,A,t,this.state.context,this)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,A,t,this.state.context)),await((m=(x=fe(this,Ur).config).onSettled)==null?void 0:m.call(x,A,null,this.state.variables,this.state.context,this)),await((j=(y=this.options).onSettled)==null?void 0:j.call(y,A,null,t,this.state.context)),Nr(this,Lo,Va).call(this,{type:"success",data:A}),A}catch(A){try{throw await((g=(b=fe(this,Ur).config).onError)==null?void 0:g.call(b,A,t,this.state.context,this)),await((w=(v=this.options).onError)==null?void 0:w.call(v,A,t,this.state.context)),await((k=(C=fe(this,Ur).config).onSettled)==null?void 0:k.call(C,void 0,A,this.state.variables,this.state.context,this)),await((_=(S=this.options).onSettled)==null?void 0:_.call(S,void 0,A,t,this.state.context)),A}finally{Nr(this,Lo,Va).call(this,{type:"error",error:A})}}finally{fe(this,Ur).runNext(this)}}},To=new WeakMap,Ur=new WeakMap,_s=new WeakMap,Lo=new WeakSet,Va=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),qr.batch(()=>{fe(this,To).forEach(n=>{n.onMutationUpdate(t)}),fe(this,Ur).notify({mutation:this,type:"updated",action:t})})},GA);function R$(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var oa,mo,Ou,VA,F$=(VA=class extends um{constructor(t={}){super();st(this,oa);st(this,mo);st(this,Ou);this.config=t,We(this,oa,new Set),We(this,mo,new Map),We(this,Ou,0)}build(t,r,n){const a=new $$({mutationCache:this,mutationId:++sf(this,Ou)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){fe(this,oa).add(t);const r=Cf(t);if(typeof r=="string"){const n=fe(this,mo).get(r);n?n.push(t):fe(this,mo).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(fe(this,oa).delete(t)){const r=Cf(t);if(typeof r=="string"){const n=fe(this,mo).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&fe(this,mo).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Cf(t);if(typeof r=="string"){const n=fe(this,mo).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=Cf(t);if(typeof r=="string"){const a=(n=fe(this,mo).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){qr.batch(()=>{fe(this,oa).forEach(t=>{this.notify({type:"removed",mutation:t})}),fe(this,oa).clear(),fe(this,mo).clear()})}getAll(){return Array.from(fe(this,oa))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>jS(r,n))}findAll(t={}){return this.getAll().filter(r=>jS(t,r))}notify(t){qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return qr.batch(()=>Promise.all(t.map(r=>r.continue().catch(fo))))}},oa=new WeakMap,mo=new WeakMap,Ou=new WeakMap,VA);function Cf(e){var t;return(t=e.options.scope)==null?void 0:t.id}function kS(e){return{onFetch:(t,r)=>{var d,f,p,x,m;const n=t.options,a=(p=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,i=((x=t.state.data)==null?void 0:x.pages)||[],s=((m=t.state.data)==null?void 0:m.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let y=!1;const j=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},b=cP(t.options,t.fetchOptions),g=async(v,w,C)=>{if(y)return Promise.reject();if(w==null&&v.pages.length)return Promise.resolve(v);const S=(()=>{const N={client:t.client,queryKey:t.queryKey,pageParam:w,direction:C?"backward":"forward",meta:t.options.meta};return j(N),N})(),_=await b(S),{maxPages:A}=t.options,E=C?_$:C$;return{pages:E(v.pages,_,A),pageParams:E(v.pageParams,w,A)}};if(a&&i.length){const v=a==="backward",w=v?z$:CS,C={pages:i,pageParams:s},k=w(n,C);l=await g(C,k,v)}else{const v=e??i.length;do{const w=c===0?s[0]??n.initialPageParam:CS(n,l);if(c>0&&w==null)break;l=await g(l,w),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var y,j;return(j=(y=t.options).persister)==null?void 0:j.call(y,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function CS(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function z$(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var zt,ci,di,Hl,Xl,ui,Yl,Jl,HA,B$=(HA=class{constructor(e={}){st(this,zt);st(this,ci);st(this,di);st(this,Hl);st(this,Xl);st(this,ui);st(this,Yl);st(this,Jl);We(this,zt,e.queryCache||new I$),We(this,ci,e.mutationCache||new F$),We(this,di,e.defaultOptions||{}),We(this,Hl,new Map),We(this,Xl,new Map),We(this,ui,0)}mount(){sf(this,ui)._++,fe(this,ui)===1&&(We(this,Yl,dP.subscribe(async e=>{e&&(await this.resumePausedMutations(),fe(this,zt).onFocus())})),We(this,Jl,Kh.subscribe(async e=>{e&&(await this.resumePausedMutations(),fe(this,zt).onOnline())})))}unmount(){var e,t;sf(this,ui)._--,fe(this,ui)===0&&((e=fe(this,Yl))==null||e.call(this),We(this,Yl,void 0),(t=fe(this,Jl))==null||t.call(this),We(this,Jl,void 0))}isFetching(e){return fe(this,zt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return fe(this,ci).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=fe(this,zt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=fe(this,zt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Xv(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return fe(this,zt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=fe(this,zt).get(n.queryHash),i=a==null?void 0:a.state.data,s=y$(t,i);if(s!==void 0)return fe(this,zt).build(this,n).setData(s,{...r,manual:!0})}setQueriesData(e,t,r){return qr.batch(()=>fe(this,zt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=fe(this,zt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=fe(this,zt);qr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=fe(this,zt);return qr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=qr.batch(()=>fe(this,zt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(fo).catch(fo)}invalidateQueries(e,t={}){return qr.batch(()=>(fe(this,zt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=qr.batch(()=>fe(this,zt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(fo)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(fo)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=fe(this,zt).build(this,t);return r.isStaleByTime(Xv(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(fo).catch(fo)}fetchInfiniteQuery(e){return e.behavior=kS(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(fo).catch(fo)}ensureInfiniteQueryData(e){return e.behavior=kS(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Kh.isOnline()?fe(this,ci).resumePausedMutations():Promise.resolve()}getQueryCache(){return fe(this,zt)}getMutationCache(){return fe(this,ci)}getDefaultOptions(){return fe(this,di)}setDefaultOptions(e){We(this,di,e)}setQueryDefaults(e,t){fe(this,Hl).set(su(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...fe(this,Hl).values()],r={};return t.forEach(n=>{lu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){fe(this,Xl).set(su(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...fe(this,Xl).values()],r={};return t.forEach(n=>{lu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...fe(this,di).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=j0(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===w0&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...fe(this,di).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){fe(this,zt).clear(),fe(this,ci).clear()}},zt=new WeakMap,ci=new WeakMap,di=new WeakMap,Hl=new WeakMap,Xl=new WeakMap,ui=new WeakMap,Yl=new WeakMap,Jl=new WeakMap,HA),U$=h.createContext(void 0),W$=({client:e,children:t})=>(h.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),o.jsx(U$.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cu(){return cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cu.apply(this,arguments)}var pi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(pi||(pi={}));const _S="popstate";function q$(e){e===void 0&&(e={});function t(a,i){let{pathname:s="/",search:l="",hash:c=""}=Hs(a.location.hash.substr(1));return!s.startsWith("/")&&!s.startsWith(".")&&(s="/"+s),Jv("",{pathname:s,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let s=a.document.querySelector("base"),l="";if(s&&s.getAttribute("href")){let c=a.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof i=="string"?i:Gh(i))}function n(a,i){S0(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return G$(t,r,n,e)}function Lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function S0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function K$(){return Math.random().toString(36).substr(2,8)}function AS(e,t){return{usr:e.state,key:e.key,idx:t}}function Jv(e,t,r,n){return r===void 0&&(r=null),cu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Hs(t):t,{state:r,key:t&&t.key||n||K$()})}function Gh(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Hs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function G$(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l=pi.Pop,c=null,u=d();u==null&&(u=0,s.replaceState(cu({},s.state,{idx:u}),""));function d(){return(s.state||{idx:null}).idx}function f(){l=pi.Pop;let j=d(),b=j==null?null:j-u;u=j,c&&c({action:l,location:y.location,delta:b})}function p(j,b){l=pi.Push;let g=Jv(y.location,j,b);r&&r(g,j),u=d()+1;let v=AS(g,u),w=y.createHref(g);try{s.pushState(v,"",w)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(w)}i&&c&&c({action:l,location:y.location,delta:1})}function x(j,b){l=pi.Replace;let g=Jv(y.location,j,b);r&&r(g,j),u=d();let v=AS(g,u),w=y.createHref(g);s.replaceState(v,"",w),i&&c&&c({action:l,location:y.location,delta:0})}function m(j){let b=a.location.origin!=="null"?a.location.origin:a.location.href,g=typeof j=="string"?j:Gh(j);return g=g.replace(/ $/,"%20"),Lt(b,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,b)}let y={get action(){return l},get location(){return e(a,s)},listen(j){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(_S,f),c=j,()=>{a.removeEventListener(_S,f),c=null}},createHref(j){return t(a,j)},createURL:m,encodeLocation(j){let b=m(j);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:x,go(j){return s.go(j)}};return y}var ES;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ES||(ES={}));function V$(e,t,r){return r===void 0&&(r="/"),H$(e,t,r)}function H$(e,t,r,n){let a=typeof t=="string"?Hs(t):t,i=ac(a.pathname||"/",r);if(i==null)return null;let s=mP(e);X$(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let u=iR(i);l=oR(s[c],u)}return l}function mP(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Lt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Si([n,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Lt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mP(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:rR(u,i.index),routesMeta:d})};return e.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of gP(i.path))a(i,s,c)}),t}function gP(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=gP(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function X$(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Y$=/^:[\w-]+$/,J$=3,Z$=2,Q$=1,eR=10,tR=-2,NS=e=>e==="*";function rR(e,t){let r=e.split("/"),n=r.length;return r.some(NS)&&(n+=tR),t&&(n+=Z$),r.filter(a=>!NS(a)).reduce((a,i)=>a+(Y$.test(i)?J$:i===""?Q$:eR),n)}function nR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function oR(e,t,r){let{routesMeta:n}=e,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",f=Zv({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:Si([i,f.pathname]),pathnameBase:dR(Si([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=Si([i,f.pathnameBase]))}return s}function Zv(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=aR(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:p,isOptional:x}=d;if(p==="*"){let y=l[f]||"";s=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const m=l[f];return x&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:s,pattern:e}}function aR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),S0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function iR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return S0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ac(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function sR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Hs(e):e;return{pathname:r?r.startsWith("/")?r:lR(r,t):t,search:uR(n),hash:fR(a)}}function lR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function tx(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cR(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function k0(e,t){let r=cR(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function C0(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Hs(e):(a=cu({},e),Lt(!a.pathname||!a.pathname.includes("?"),tx("?","pathname","search",a)),Lt(!a.pathname||!a.pathname.includes("#"),tx("#","pathname","hash",a)),Lt(!a.search||!a.search.includes("#"),tx("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let p=s.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}l=f>=0?t[f]:"/"}let c=sR(a,l),u=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Si=e=>e.join("/").replace(/\/\/+/g,"/"),dR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),uR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,fR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function hR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const xP=["post","put","patch","delete"];new Set(xP);const pR=["get",...xP];new Set(pR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function du(){return du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},du.apply(this,arguments)}const hm=h.createContext(null),vP=h.createContext(null),Ma=h.createContext(null),pm=h.createContext(null),Oa=h.createContext({outlet:null,matches:[],isDataRoute:!1}),yP=h.createContext(null);function mR(e,t){let{relative:r}=t===void 0?{}:t;wc()||Lt(!1);let{basename:n,navigator:a}=h.useContext(Ma),{hash:i,pathname:s,search:l}=mm(e,{relative:r}),c=s;return n!=="/"&&(c=s==="/"?n:Si([n,s])),a.createHref({pathname:c,search:l,hash:i})}function wc(){return h.useContext(pm)!=null}function Go(){return wc()||Lt(!1),h.useContext(pm).location}function bP(e){h.useContext(Ma).static||h.useLayoutEffect(e)}function Sc(){let{isDataRoute:e}=h.useContext(Oa);return e?PR():gR()}function gR(){wc()||Lt(!1);let e=h.useContext(hm),{basename:t,future:r,navigator:n}=h.useContext(Ma),{matches:a}=h.useContext(Oa),{pathname:i}=Go(),s=JSON.stringify(k0(a,r.v7_relativeSplatPath)),l=h.useRef(!1);return bP(()=>{l.current=!0}),h.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=C0(u,JSON.parse(s),i,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Si([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,s,i,e])}const xR=h.createContext(null);function vR(e){let t=h.useContext(Oa).outlet;return t&&h.createElement(xR.Provider,{value:e},t)}function mm(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=h.useContext(Ma),{matches:a}=h.useContext(Oa),{pathname:i}=Go(),s=JSON.stringify(k0(a,n.v7_relativeSplatPath));return h.useMemo(()=>C0(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function yR(e,t){return bR(e,t)}function bR(e,t,r,n){wc()||Lt(!1);let{navigator:a}=h.useContext(Ma),{matches:i}=h.useContext(Oa),s=i[i.length-1],l=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let u=Go(),d;if(t){var f;let j=typeof t=="string"?Hs(t):t;c==="/"||(f=j.pathname)!=null&&f.startsWith(c)||Lt(!1),d=j}else d=u;let p=d.pathname||"/",x=p;if(c!=="/"){let j=c.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(j.length).join("/")}let m=V$(e,{pathname:x}),y=CR(m&&m.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:Si([c,a.encodeLocation?a.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:Si([c,a.encodeLocation?a.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),i,r,n);return t&&y?h.createElement(pm.Provider,{value:{location:du({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:pi.Pop}},y):y}function jR(){let e=NR(),t=hR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},t),r?h.createElement("pre",{style:a},r):null,null)}const wR=h.createElement(jR,null);class SR extends h.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?h.createElement(Oa.Provider,{value:this.props.routeContext},h.createElement(yP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kR(e){let{routeContext:t,match:r,children:n}=e,a=h.useContext(hm);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),h.createElement(Oa.Provider,{value:t},n)}function CR(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let d=s.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||Lt(!1),s=s.slice(0,Math.min(s.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<s.length;d++){let f=s[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:x}=r,m=f.route.loader&&p[f.route.id]===void 0&&(!x||x[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((d,f,p)=>{let x,m=!1,y=null,j=null;r&&(x=l&&f.route.id?l[f.route.id]:void 0,y=f.route.errorElement||wR,c&&(u<0&&p===0?(MR("route-fallback"),m=!0,j=null):u===p&&(m=!0,j=f.route.hydrateFallbackElement||null)));let b=t.concat(s.slice(0,p+1)),g=()=>{let v;return x?v=y:m?v=j:f.route.Component?v=h.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=d,h.createElement(kR,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?h.createElement(SR,{location:r.location,revalidation:r.revalidation,component:y,error:x,children:g(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):g()},null)}var jP=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(jP||{}),wP=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(wP||{});function _R(e){let t=h.useContext(hm);return t||Lt(!1),t}function AR(e){let t=h.useContext(vP);return t||Lt(!1),t}function ER(e){let t=h.useContext(Oa);return t||Lt(!1),t}function SP(e){let t=ER(),r=t.matches[t.matches.length-1];return r.route.id||Lt(!1),r.route.id}function NR(){var e;let t=h.useContext(yP),r=AR(),n=SP();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function PR(){let{router:e}=_R(jP.UseNavigateStable),t=SP(wP.UseNavigateStable),r=h.useRef(!1);return bP(()=>{r.current=!0}),h.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,du({fromRouteId:t},i)))},[e,t])}const PS={};function MR(e,t,r){PS[e]||(PS[e]=!0)}function OR(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function ho(e){let{to:t,replace:r,state:n,relative:a}=e;wc()||Lt(!1);let{future:i,static:s}=h.useContext(Ma),{matches:l}=h.useContext(Oa),{pathname:c}=Go(),u=Sc(),d=C0(t,k0(l,i.v7_relativeSplatPath),c,a==="path"),f=JSON.stringify(d);return h.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:a}),[u,f,a,r,n]),null}function _0(e){return vR(e.context)}function gt(e){Lt(!1)}function TR(e){let{basename:t="/",children:r=null,location:n,navigationType:a=pi.Pop,navigator:i,static:s=!1,future:l}=e;wc()&&Lt(!1);let c=t.replace(/^\/*/,"/"),u=h.useMemo(()=>({basename:c,navigator:i,static:s,future:du({v7_relativeSplatPath:!1},l)}),[c,l,i,s]);typeof n=="string"&&(n=Hs(n));let{pathname:d="/",search:f="",hash:p="",state:x=null,key:m="default"}=n,y=h.useMemo(()=>{let j=ac(d,c);return j==null?null:{location:{pathname:j,search:f,hash:p,state:x,key:m},navigationType:a}},[c,d,f,p,x,m,a]);return y==null?null:h.createElement(Ma.Provider,{value:u},h.createElement(pm.Provider,{children:r,value:y}))}function LR(e){let{children:t,location:r}=e;return yR(Qv(t),r)}new Promise(()=>{});function Qv(e,t){t===void 0&&(t=[]);let r=[];return h.Children.forEach(e,(n,a)=>{if(!h.isValidElement(n))return;let i=[...t,a];if(n.type===h.Fragment){r.push.apply(r,Qv(n.props.children,i));return}n.type!==gt&&Lt(!1),!n.props.index||!n.props.children||Lt(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Qv(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vh.apply(this,arguments)}function kP(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function DR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function IR(e,t){return e.button===0&&(!t||t==="_self")&&!DR(e)}function ey(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function $R(e,t){let r=ey(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const RR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],FR=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],zR="6";try{window.__reactRouterVersion=zR}catch{}const BR=h.createContext({isTransitioning:!1}),UR="startTransition",MS=Pb[UR];function WR(e){let{basename:t,children:r,future:n,window:a}=e,i=h.useRef();i.current==null&&(i.current=q$({window:a,v5Compat:!0}));let s=i.current,[l,c]=h.useState({action:s.action,location:s.location}),{v7_startTransition:u}=n||{},d=h.useCallback(f=>{u&&MS?MS(()=>c(f)):c(f)},[c,u]);return h.useLayoutEffect(()=>s.listen(d),[s,d]),h.useEffect(()=>OR(n),[n]),h.createElement(TR,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:s,future:n})}const qR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",KR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ni=h.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,p=kP(t,RR),{basename:x}=h.useContext(Ma),m,y=!1;if(typeof u=="string"&&KR.test(u)&&(m=u,qR))try{let v=new URL(window.location.href),w=u.startsWith("//")?new URL(v.protocol+u):new URL(u),C=ac(w.pathname,x);w.origin===v.origin&&C!=null?u=C+w.search+w.hash:y=!0}catch{}let j=mR(u,{relative:a}),b=VR(u,{replace:s,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function g(v){n&&n(v),v.defaultPrevented||b(v)}return h.createElement("a",Vh({},p,{href:m||j,onClick:y||i?n:g,ref:r,target:c}))}),CP=h.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:i="",end:s=!1,style:l,to:c,viewTransition:u,children:d}=t,f=kP(t,FR),p=mm(c,{relative:f.relative}),x=Go(),m=h.useContext(vP),{navigator:y,basename:j}=h.useContext(Ma),b=m!=null&&XR(p)&&u===!0,g=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,v=x.pathname,w=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;a||(v=v.toLowerCase(),w=w?w.toLowerCase():null,g=g.toLowerCase()),w&&j&&(w=ac(w,j)||w);const C=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let k=v===g||!s&&v.startsWith(g)&&v.charAt(C)==="/",S=w!=null&&(w===g||!s&&w.startsWith(g)&&w.charAt(g.length)==="/"),_={isActive:k,isPending:S,isTransitioning:b},A=k?n:void 0,E;typeof i=="function"?E=i(_):E=[i,k?"active":null,S?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(_):l;return h.createElement(ni,Vh({},f,{"aria-current":A,className:E,ref:r,style:N,to:c,viewTransition:u}),typeof d=="function"?d(_):d)});var ty;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ty||(ty={}));var OS;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(OS||(OS={}));function GR(e){let t=h.useContext(hm);return t||Lt(!1),t}function VR(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:l}=t===void 0?{}:t,c=Sc(),u=Go(),d=mm(e,{relative:s});return h.useCallback(f=>{if(IR(f,r)){f.preventDefault();let p=n!==void 0?n:Gh(u)===Gh(d);c(e,{replace:p,state:a,preventScrollReset:i,relative:s,viewTransition:l})}},[u,c,d,n,a,r,e,i,s,l])}function HR(e){let t=h.useRef(ey(e)),r=h.useRef(!1),n=Go(),a=h.useMemo(()=>$R(n.search,r.current?null:t.current),[n.search]),i=Sc(),s=h.useCallback((l,c)=>{const u=ey(typeof l=="function"?l(a):l);r.current=!0,i("?"+u,c)},[i,a]);return[a,s]}function XR(e,t){t===void 0&&(t={});let r=h.useContext(BR);r==null&&Lt(!1);let{basename:n}=GR(ty.useViewTransitionState),a=mm(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=ac(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=ac(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Zv(a.pathname,s)!=null||Zv(a.pathname,i)!=null}function uu(e){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(e)}function YR(e,t){if(uu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(uu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JR(e){var t=YR(e,"string");return uu(t)=="symbol"?t:t+""}function ce(e,t,r){return(t=JR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _P(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rx,TS;function ZR(){if(TS)return rx;TS=1;var e=function(r,n,a,i,s,l,c,u){if(!r){var d;if(n===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[a,i,s,l,c,u],p=0;d=new Error(n.replace(/%s/g,function(){return f[p++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return rx=e,rx}var QR=ZR(),sr=_P(QR),Ge=h.createContext(null);function e6(){sr(!!h.useContext,"useGoogleMap is React hook and requires React version 16.8+");var e=h.useContext(Ge);return sr(!!e,"useGoogleMap needs a GoogleMap available up in the tree"),e}function t6(e,t,r){return Object.keys(e).reduce(function(a,i){return t(a,e[i],i)},r)}function r6(e,t){Object.keys(e).forEach(r=>t(e[r],r))}function n6(e,t,r,n){var a={},i=(s,l)=>{var c=r[l];c!==t[l]&&(a[l]=c,s(n,c))};return r6(e,i),a}function o6(e,t,r){var n=t6(r,function(i,s,l){return typeof e[l]=="function"&&i.push(google.maps.event.addListener(t,s,e[l])),i},[]);return n}function a6(e){google.maps.event.removeListener(e)}function Ze(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.forEach(a6)}function Xe(e){var{updaterMap:t,eventMap:r,prevProps:n,nextProps:a,instance:i}=e,s=o6(a,i,r);return n6(t,n,a,i),s}var LS={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},DS={extraMapTypes(e,t){t.forEach(function(n,a){e.mapTypes.set(String(a),n)})},center(e,t){e.setCenter(t)},clickableIcons(e,t){e.setClickableIcons(t)},heading(e,t){e.setHeading(t)},mapTypeId(e,t){e.setMapTypeId(t)},options(e,t){e.setOptions(t)},streetView(e,t){e.setStreetView(t)},tilt(e,t){e.setTilt(t)},zoom(e,t){e.setZoom(t)}};function i6(e){var{children:t,options:r,id:n,mapContainerStyle:a,mapContainerClassName:i,center:s,onClick:l,onDblClick:c,onDrag:u,onDragEnd:d,onDragStart:f,onMouseMove:p,onMouseOut:x,onMouseOver:m,onMouseDown:y,onMouseUp:j,onRightClick:b,onCenterChanged:g,onLoad:v,onUnmount:w}=e,[C,k]=h.useState(null),S=h.useRef(null),[_,A]=h.useState(null),[E,N]=h.useState(null),[$,z]=h.useState(null),[T,I]=h.useState(null),[L,D]=h.useState(null),[O,F]=h.useState(null),[q,te]=h.useState(null),[H,B]=h.useState(null),[K,Z]=h.useState(null),[he,re]=h.useState(null),[X,V]=h.useState(null),[J,ne]=h.useState(null);return h.useEffect(()=>{r&&C!==null&&C.setOptions(r)},[C,r]),h.useEffect(()=>{C!==null&&typeof s<"u"&&C.setCenter(s)},[C,s]),h.useEffect(()=>{C&&c&&(E!==null&&google.maps.event.removeListener(E),N(google.maps.event.addListener(C,"dblclick",c)))},[c]),h.useEffect(()=>{C&&d&&($!==null&&google.maps.event.removeListener($),z(google.maps.event.addListener(C,"dragend",d)))},[d]),h.useEffect(()=>{C&&f&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(C,"dragstart",f)))},[f]),h.useEffect(()=>{C&&y&&(L!==null&&google.maps.event.removeListener(L),D(google.maps.event.addListener(C,"mousedown",y)))},[y]),h.useEffect(()=>{C&&p&&(O!==null&&google.maps.event.removeListener(O),F(google.maps.event.addListener(C,"mousemove",p)))},[p]),h.useEffect(()=>{C&&x&&(q!==null&&google.maps.event.removeListener(q),te(google.maps.event.addListener(C,"mouseout",x)))},[x]),h.useEffect(()=>{C&&m&&(H!==null&&google.maps.event.removeListener(H),B(google.maps.event.addListener(C,"mouseover",m)))},[m]),h.useEffect(()=>{C&&j&&(K!==null&&google.maps.event.removeListener(K),Z(google.maps.event.addListener(C,"mouseup",j)))},[j]),h.useEffect(()=>{C&&b&&(he!==null&&google.maps.event.removeListener(he),re(google.maps.event.addListener(C,"rightclick",b)))},[b]),h.useEffect(()=>{C&&l&&(X!==null&&google.maps.event.removeListener(X),V(google.maps.event.addListener(C,"click",l)))},[l]),h.useEffect(()=>{C&&u&&(J!==null&&google.maps.event.removeListener(J),ne(google.maps.event.addListener(C,"drag",u)))},[u]),h.useEffect(()=>{C&&g&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(C,"center_changed",g)))},[l]),h.useEffect(()=>{var Q=S.current===null?null:new google.maps.Map(S.current,r);return k(Q),Q!==null&&v&&v(Q),()=>{Q!==null&&w&&w(Q)}},[]),o.jsx("div",{id:n,ref:S,style:a,className:i,children:o.jsx(Ge.Provider,{value:C,children:C!==null?t:null})})}h.memo(i6);class A0 extends h.PureComponent{constructor(){super(...arguments),ce(this,"state",{map:null}),ce(this,"registeredEvents",[]),ce(this,"mapRef",null),ce(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),ce(this,"panTo",t=>{var r=this.getInstance();r&&r.panTo(t)}),ce(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),ce(this,"getRef",t=>{this.mapRef=t})}componentDidMount(){var t=this.getInstance();this.registeredEvents=Xe({updaterMap:DS,eventMap:LS,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{map:t}},this.setMapCallback)}componentDidUpdate(t){this.state.map!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:DS,eventMap:LS,prevProps:t,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),Ze(this.registeredEvents))}render(){return o.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:o.jsx(Ge.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function IS(e,t,r,n,a,i,s){try{var l=e[i](s),c=l.value}catch(u){return void r(u)}l.done?t(c):Promise.resolve(c).then(n,a)}function AP(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function s(c){IS(i,n,a,s,l,"next",c)}function l(c){IS(i,n,a,s,l,"throw",c)}s(void 0)})}}function EP(e){var{googleMapsApiKey:t,googleMapsClientId:r,version:n="weekly",language:a,region:i,libraries:s,channel:l,mapIds:c,authReferrerPolicy:u,apiUrl:d="https://maps.googleapis.com"}=e,f=[];return sr(t&&r||!(t&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),t?f.push("key=".concat(t)):r&&f.push("client=".concat(r)),n&&f.push("v=".concat(n)),a&&f.push("language=".concat(a)),i&&f.push("region=".concat(i)),s&&s.length&&f.push("libraries=".concat(s.sort().join(","))),l&&f.push("channel=".concat(l)),c&&c.length&&f.push("map_ids=".concat(c.join(","))),u&&f.push("auth_referrer_policy=".concat(u)),f.push("loading=async"),f.push("callback=initMap"),"".concat(d,"/maps/api/js?").concat(f.join("&"))}var ps=typeof document<"u";function NP(e){var{url:t,id:r,nonce:n}=e;return ps?new Promise(function(i,s){var l=document.getElementById(r),c=window;if(l){var u=l.getAttribute("data-state");if(l.src===t&&u!=="error"){if(u==="ready")return i(r);var d=c.initMap,f=l.onerror;c.initMap=function(){d&&d(),i(r)},l.onerror=function(x){f&&f(x),s(x)};return}else l.remove()}var p=document.createElement("script");p.type="text/javascript",p.src=t,p.id=r,p.async=!0,p.nonce=n||"",p.onerror=function(m){p.setAttribute("data-state","error"),s(m)},c.initMap=function(){p.setAttribute("data-state","ready"),i(r)},document.head.appendChild(p)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function $S(e){var t=e.href;return t&&(t.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||t.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:e.tagName.toLowerCase()==="style"&&e.styleSheet&&e.styleSheet.cssText&&e.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(e.styleSheet.cssText="",!0):e.tagName.toLowerCase()==="style"&&e.innerHTML&&e.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(e.innerHTML="",!0):e.tagName.toLowerCase()==="style"&&!e.styleSheet&&!e.innerHTML}function PP(){var e=document.getElementsByTagName("head")[0];if(e){var t=e.insertBefore.bind(e);e.insertBefore=function(a,i){return $S(a)||Reflect.apply(t,e,[a,i]),a};var r=e.appendChild.bind(e);e.appendChild=function(a){return $S(a)||Reflect.apply(r,e,[a]),a}}}var Jc=!1;function MP(){return o.jsx("div",{children:"Loading..."})}var ry={id:"script-loader",version:"weekly"};class OP extends h.PureComponent{constructor(){super(...arguments),ce(this,"check",null),ce(this,"state",{loaded:!1}),ce(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),ce(this,"isCleaningUp",AP(function*(){function t(r){if(!Jc)r();else if(ps)var n=window.setInterval(function(){Jc||(window.clearInterval(n),r())},1)}return new Promise(t)})),ce(this,"cleanup",()=>{Jc=!0;var t=document.getElementById(this.props.id);t&&t.parentNode&&t.parentNode.removeChild(t),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(n){return typeof n.src=="string"&&n.src.includes("maps.googleapis")}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(n){return n.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(n){return n.innerText!==void 0&&n.innerText.length>0&&n.innerText.includes(".gm-")}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)})}),ce(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&PP(),sr(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var t={id:this.props.id,nonce:this.props.nonce,url:EP(this.props)};NP(t).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),ce(this,"getRef",t=>{this.check=t})}componentDidMount(){if(ps){if(window.google&&window.google.maps&&!Jc){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(t){this.props.libraries!==t.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),ps&&t.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(ps){this.cleanup();var t=()=>{this.check||(delete window.google,Jc=!1)};window.setTimeout(t,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||o.jsx(MP,{})]})}}ce(OP,"defaultProps",ry);function s6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}function E0(e,t){if(e==null)return{};var r,n,a=s6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var RS;function l6(e){var{id:t=ry.id,version:r=ry.version,nonce:n,googleMapsApiKey:a,googleMapsClientId:i,language:s,region:l,libraries:c,preventGoogleFontsLoading:u,channel:d,mapIds:f,authReferrerPolicy:p,apiUrl:x="https://maps.googleapis.com"}=e,m=h.useRef(!1),[y,j]=h.useState(!1),[b,g]=h.useState(void 0);h.useEffect(function(){return m.current=!0,()=>{m.current=!1}},[]),h.useEffect(function(){ps&&u&&PP()},[u]),h.useEffect(function(){y&&sr(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[y]);var v=EP({version:r,googleMapsApiKey:a,googleMapsClientId:i,language:s,region:l,libraries:c,channel:d,mapIds:f,authReferrerPolicy:p,apiUrl:x});h.useEffect(function(){if(!ps)return;function k(){m.current&&(j(!0),RS=v)}if(window.google&&window.google.maps&&RS===v){k();return}NP({id:t,url:v,nonce:n}).then(k).catch(function(_){m.current&&g(_),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(i||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(_)})},[t,v,n]);var w=h.useRef(void 0);return h.useEffect(function(){w.current&&c!==w.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),w.current=c},[c]),{isLoaded:y,loadError:b,url:v}}var c6=["loadingElement","onLoad","onError","onUnmount","children"],d6=o.jsx(MP,{});function u6(e){var{loadingElement:t,onLoad:r,onError:n,onUnmount:a,children:i}=e,s=E0(e,c6),{isLoaded:l,loadError:c}=l6(s);return h.useEffect(function(){l&&typeof r=="function"&&r()},[l,r]),h.useEffect(function(){c&&typeof n=="function"&&n(c)},[c,n]),h.useEffect(function(){return()=>{a&&a()}},[a]),l?i:t||d6}h.memo(u6);var FS;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(FS||(FS={}));function zS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zS(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var BS={},US={options(e,t){e.setOptions(t)}};function f6(e){var{options:t,onLoad:r,onUnmount:n}=e,a=h.useContext(Ge),[i,s]=h.useState(null);return h.useEffect(()=>{i!==null&&i.setMap(a)},[a]),h.useEffect(()=>{t&&i!==null&&i.setOptions(t)},[i,t]),h.useEffect(()=>{var l=new google.maps.TrafficLayer(Hh(Hh({},t),{},{map:a}));return s(l),r&&r(l),()=>{i!==null&&(n&&n(i),i.setMap(null))}},[]),null}h.memo(f6);class h6 extends h.PureComponent{constructor(){super(...arguments),ce(this,"state",{trafficLayer:null}),ce(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),ce(this,"registeredEvents",[])}componentDidMount(){var t=new google.maps.TrafficLayer(Hh(Hh({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:US,eventMap:BS,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{trafficLayer:t}},this.setTrafficLayerCallback)}componentDidUpdate(t){this.state.trafficLayer!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:US,eventMap:BS,prevProps:t,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),Ze(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}ce(h6,"contextType",Ge);function p6(e){var{onLoad:t,onUnmount:r}=e,n=h.useContext(Ge),[a,i]=h.useState(null);return h.useEffect(()=>{a!==null&&a.setMap(n)},[n]),h.useEffect(()=>{var s=new google.maps.BicyclingLayer;return i(s),s.setMap(n),t&&t(s),()=>{s!==null&&(r&&r(s),s.setMap(null))}},[]),null}h.memo(p6);class m6 extends h.PureComponent{constructor(){super(...arguments),ce(this,"state",{bicyclingLayer:null}),ce(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var t=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:t}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}ce(m6,"contextType",Ge);function g6(e){var{onLoad:t,onUnmount:r}=e,n=h.useContext(Ge),[a,i]=h.useState(null);return h.useEffect(()=>{a!==null&&a.setMap(n)},[n]),h.useEffect(()=>{var s=new google.maps.TransitLayer;return i(s),s.setMap(n),t&&t(s),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}h.memo(g6);class x6 extends h.PureComponent{constructor(){super(...arguments),ce(this,"state",{transitLayer:null}),ce(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var t=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:t}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}ce(x6,"contextType",Ge);function WS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WS(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var qS={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},KS={drawingMode(e,t){e.setDrawingMode(t)},options(e,t){e.setOptions(t)}};function v6(e){var{options:t,drawingMode:r,onCircleComplete:n,onMarkerComplete:a,onOverlayComplete:i,onPolygonComplete:s,onPolylineComplete:l,onRectangleComplete:c,onLoad:u,onUnmount:d}=e,f=h.useContext(Ge),[p,x]=h.useState(null),[m,y]=h.useState(null),[j,b]=h.useState(null),[g,v]=h.useState(null),[w,C]=h.useState(null),[k,S]=h.useState(null),[_,A]=h.useState(null);return h.useEffect(()=>{p!==null&&p.setMap(f)},[f]),h.useEffect(()=>{t&&p!==null&&p.setOptions(t)},[p,t]),h.useEffect(()=>{p!==null&&p.setDrawingMode(r??null)},[p,r]),h.useEffect(()=>{p&&n&&(m!==null&&google.maps.event.removeListener(m),y(google.maps.event.addListener(p,"circlecomplete",n)))},[p,n]),h.useEffect(()=>{p&&a&&(j!==null&&google.maps.event.removeListener(j),b(google.maps.event.addListener(p,"markercomplete",a)))},[p,a]),h.useEffect(()=>{p&&i&&(g!==null&&google.maps.event.removeListener(g),v(google.maps.event.addListener(p,"overlaycomplete",i)))},[p,i]),h.useEffect(()=>{p&&s&&(w!==null&&google.maps.event.removeListener(w),C(google.maps.event.addListener(p,"polygoncomplete",s)))},[p,s]),h.useEffect(()=>{p&&l&&(k!==null&&google.maps.event.removeListener(k),S(google.maps.event.addListener(p,"polylinecomplete",l)))},[p,l]),h.useEffect(()=>{p&&c&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(p,"rectanglecomplete",c)))},[p,c]),h.useEffect(()=>{sr(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var E=new google.maps.drawing.DrawingManager(Xh(Xh({},t),{},{map:f}));return r&&E.setDrawingMode(r),n&&y(google.maps.event.addListener(E,"circlecomplete",n)),a&&b(google.maps.event.addListener(E,"markercomplete",a)),i&&v(google.maps.event.addListener(E,"overlaycomplete",i)),s&&C(google.maps.event.addListener(E,"polygoncomplete",s)),l&&S(google.maps.event.addListener(E,"polylinecomplete",l)),c&&A(google.maps.event.addListener(E,"rectanglecomplete",c)),x(E),u&&u(E),()=>{p!==null&&(m&&google.maps.event.removeListener(m),j&&google.maps.event.removeListener(j),g&&google.maps.event.removeListener(g),w&&google.maps.event.removeListener(w),k&&google.maps.event.removeListener(k),_&&google.maps.event.removeListener(_),d&&d(p),p.setMap(null))}},[]),null}h.memo(v6);class y6 extends h.PureComponent{constructor(t){super(t),ce(this,"registeredEvents",[]),ce(this,"state",{drawingManager:null}),ce(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),sr(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var t=new google.maps.drawing.DrawingManager(Xh(Xh({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:KS,eventMap:qS,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{drawingManager:t}},this.setDrawingManagerCallback)}componentDidUpdate(t){this.state.drawingManager!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:KS,eventMap:qS,prevProps:t,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),Ze(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}ce(y6,"contextType",Ge);function GS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GS(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var VS={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},HS={animation(e,t){e.setAnimation(t)},clickable(e,t){e.setClickable(t)},cursor(e,t){e.setCursor(t)},draggable(e,t){e.setDraggable(t)},icon(e,t){e.setIcon(t)},label(e,t){e.setLabel(t)},map(e,t){e.setMap(t)},opacity(e,t){e.setOpacity(t)},options(e,t){e.setOptions(t)},position(e,t){e.setPosition(t)},shape(e,t){e.setShape(t)},title(e,t){e.setTitle(t)},visible(e,t){e.setVisible(t)},zIndex(e,t){e.setZIndex(t)}},Yh={};function b6(e){var{position:t,options:r,clusterer:n,noClustererRedraw:a,children:i,draggable:s,visible:l,animation:c,clickable:u,cursor:d,icon:f,label:p,opacity:x,shape:m,title:y,zIndex:j,onClick:b,onDblClick:g,onDrag:v,onDragEnd:w,onDragStart:C,onMouseOut:k,onMouseOver:S,onMouseUp:_,onMouseDown:A,onRightClick:E,onClickableChanged:N,onCursorChanged:$,onAnimationChanged:z,onDraggableChanged:T,onFlatChanged:I,onIconChanged:L,onPositionChanged:D,onShapeChanged:O,onTitleChanged:F,onVisibleChanged:q,onZindexChanged:te,onLoad:H,onUnmount:B}=e,K=h.useContext(Ge),[Z,he]=h.useState(null),[re,X]=h.useState(null),[V,J]=h.useState(null),[ne,Q]=h.useState(null),[me,ue]=h.useState(null),[W,ae]=h.useState(null),[we,ve]=h.useState(null),[G,R]=h.useState(null),[Y,ge]=h.useState(null),[de,Oe]=h.useState(null),[be,Ue]=h.useState(null),[ie,pe]=h.useState(null),[Se,$e]=h.useState(null),[He,nt]=h.useState(null),[It,Ho]=h.useState(null),[Hi,Bc]=h.useState(null),[ee,xe]=h.useState(null),[Ce,_e]=h.useState(null),[je,Fe]=h.useState(null),[Be,et]=h.useState(null),[qt,$t]=h.useState(null),[Pt,dr]=h.useState(null);h.useEffect(()=>{Z!==null&&Z.setMap(K)},[K]),h.useEffect(()=>{typeof r<"u"&&Z!==null&&Z.setOptions(r)},[Z,r]),h.useEffect(()=>{typeof s<"u"&&Z!==null&&Z.setDraggable(s)},[Z,s]),h.useEffect(()=>{t&&Z!==null&&Z.setPosition(t)},[Z,t]),h.useEffect(()=>{typeof l<"u"&&Z!==null&&Z.setVisible(l)},[Z,l]),h.useEffect(()=>{Z==null||Z.setAnimation(c)},[Z,c]),h.useEffect(()=>{Z&&u!==void 0&&Z.setClickable(u)},[Z,u]),h.useEffect(()=>{Z&&d!==void 0&&Z.setCursor(d)},[Z,d]),h.useEffect(()=>{Z&&f!==void 0&&Z.setIcon(f)},[Z,f]),h.useEffect(()=>{Z&&p!==void 0&&Z.setLabel(p)},[Z,p]),h.useEffect(()=>{Z&&x!==void 0&&Z.setOpacity(x)},[Z,x]),h.useEffect(()=>{Z&&m!==void 0&&Z.setShape(m)},[Z,m]),h.useEffect(()=>{Z&&y!==void 0&&Z.setTitle(y)},[Z,y]),h.useEffect(()=>{Z&&j!==void 0&&Z.setZIndex(j)},[Z,j]),h.useEffect(()=>{Z&&g&&(re!==null&&google.maps.event.removeListener(re),X(google.maps.event.addListener(Z,"dblclick",g)))},[g]),h.useEffect(()=>{Z&&w&&(V!==null&&google.maps.event.removeListener(V),J(google.maps.event.addListener(Z,"dragend",w)))},[w]),h.useEffect(()=>{Z&&C&&(ne!==null&&google.maps.event.removeListener(ne),Q(google.maps.event.addListener(Z,"dragstart",C)))},[C]),h.useEffect(()=>{Z&&A&&(me!==null&&google.maps.event.removeListener(me),ue(google.maps.event.addListener(Z,"mousedown",A)))},[A]),h.useEffect(()=>{Z&&k&&(W!==null&&google.maps.event.removeListener(W),ae(google.maps.event.addListener(Z,"mouseout",k)))},[k]),h.useEffect(()=>{Z&&S&&(we!==null&&google.maps.event.removeListener(we),ve(google.maps.event.addListener(Z,"mouseover",S)))},[S]),h.useEffect(()=>{Z&&_&&(G!==null&&google.maps.event.removeListener(G),R(google.maps.event.addListener(Z,"mouseup",_)))},[_]),h.useEffect(()=>{Z&&E&&(Y!==null&&google.maps.event.removeListener(Y),ge(google.maps.event.addListener(Z,"rightclick",E)))},[E]),h.useEffect(()=>{Z&&b&&(de!==null&&google.maps.event.removeListener(de),Oe(google.maps.event.addListener(Z,"click",b)))},[b]),h.useEffect(()=>{Z&&v&&(be!==null&&google.maps.event.removeListener(be),Ue(google.maps.event.addListener(Z,"drag",v)))},[v]),h.useEffect(()=>{Z&&N&&(ie!==null&&google.maps.event.removeListener(ie),pe(google.maps.event.addListener(Z,"clickable_changed",N)))},[N]),h.useEffect(()=>{Z&&$&&(Se!==null&&google.maps.event.removeListener(Se),$e(google.maps.event.addListener(Z,"cursor_changed",$)))},[$]),h.useEffect(()=>{Z&&z&&(He!==null&&google.maps.event.removeListener(He),nt(google.maps.event.addListener(Z,"animation_changed",z)))},[z]),h.useEffect(()=>{Z&&T&&(It!==null&&google.maps.event.removeListener(It),Ho(google.maps.event.addListener(Z,"draggable_changed",T)))},[T]),h.useEffect(()=>{Z&&I&&(Hi!==null&&google.maps.event.removeListener(Hi),Bc(google.maps.event.addListener(Z,"flat_changed",I)))},[I]),h.useEffect(()=>{Z&&L&&(ee!==null&&google.maps.event.removeListener(ee),xe(google.maps.event.addListener(Z,"icon_changed",L)))},[L]),h.useEffect(()=>{Z&&D&&(Ce!==null&&google.maps.event.removeListener(Ce),_e(google.maps.event.addListener(Z,"position_changed",D)))},[D]),h.useEffect(()=>{Z&&O&&(je!==null&&google.maps.event.removeListener(je),Fe(google.maps.event.addListener(Z,"shape_changed",O)))},[O]),h.useEffect(()=>{Z&&F&&(Be!==null&&google.maps.event.removeListener(Be),et(google.maps.event.addListener(Z,"title_changed",F)))},[F]),h.useEffect(()=>{Z&&q&&(qt!==null&&google.maps.event.removeListener(qt),$t(google.maps.event.addListener(Z,"visible_changed",q)))},[q]),h.useEffect(()=>{Z&&te&&(Pt!==null&&google.maps.event.removeListener(Pt),dr(google.maps.event.addListener(Z,"zindex_changed",te)))},[te]),h.useEffect(()=>{var Fa=Rl(Rl(Rl({},r||Yh),n?Yh:{map:K}),{},{position:t}),qe=new google.maps.Marker(Fa);return n?n.addMarker(qe,!!a):qe.setMap(K),t&&qe.setPosition(t),typeof l<"u"&&qe.setVisible(l),typeof s<"u"&&qe.setDraggable(s),typeof u<"u"&&qe.setClickable(u),typeof d=="string"&&qe.setCursor(d),f&&qe.setIcon(f),typeof p<"u"&&qe.setLabel(p),typeof x<"u"&&qe.setOpacity(x),m&&qe.setShape(m),typeof y=="string"&&qe.setTitle(y),typeof j=="number"&&qe.setZIndex(j),g&&X(google.maps.event.addListener(qe,"dblclick",g)),w&&J(google.maps.event.addListener(qe,"dragend",w)),C&&Q(google.maps.event.addListener(qe,"dragstart",C)),A&&ue(google.maps.event.addListener(qe,"mousedown",A)),k&&ae(google.maps.event.addListener(qe,"mouseout",k)),S&&ve(google.maps.event.addListener(qe,"mouseover",S)),_&&R(google.maps.event.addListener(qe,"mouseup",_)),E&&ge(google.maps.event.addListener(qe,"rightclick",E)),b&&Oe(google.maps.event.addListener(qe,"click",b)),v&&Ue(google.maps.event.addListener(qe,"drag",v)),N&&pe(google.maps.event.addListener(qe,"clickable_changed",N)),$&&$e(google.maps.event.addListener(qe,"cursor_changed",$)),z&&nt(google.maps.event.addListener(qe,"animation_changed",z)),T&&Ho(google.maps.event.addListener(qe,"draggable_changed",T)),I&&Bc(google.maps.event.addListener(qe,"flat_changed",I)),L&&xe(google.maps.event.addListener(qe,"icon_changed",L)),D&&_e(google.maps.event.addListener(qe,"position_changed",D)),O&&Fe(google.maps.event.addListener(qe,"shape_changed",O)),F&&et(google.maps.event.addListener(qe,"title_changed",F)),q&&$t(google.maps.event.addListener(qe,"visible_changed",q)),te&&dr(google.maps.event.addListener(qe,"zindex_changed",te)),he(qe),H&&H(qe),()=>{re!==null&&google.maps.event.removeListener(re),V!==null&&google.maps.event.removeListener(V),ne!==null&&google.maps.event.removeListener(ne),me!==null&&google.maps.event.removeListener(me),W!==null&&google.maps.event.removeListener(W),we!==null&&google.maps.event.removeListener(we),G!==null&&google.maps.event.removeListener(G),Y!==null&&google.maps.event.removeListener(Y),de!==null&&google.maps.event.removeListener(de),ie!==null&&google.maps.event.removeListener(ie),Se!==null&&google.maps.event.removeListener(Se),He!==null&&google.maps.event.removeListener(He),It!==null&&google.maps.event.removeListener(It),Hi!==null&&google.maps.event.removeListener(Hi),ee!==null&&google.maps.event.removeListener(ee),Ce!==null&&google.maps.event.removeListener(Ce),Be!==null&&google.maps.event.removeListener(Be),qt!==null&&google.maps.event.removeListener(qt),Pt!==null&&google.maps.event.removeListener(Pt),B&&B(qe),n?n.removeMarker(qe,!!a):qe&&qe.setMap(null)}},[]);var Uc=h.useMemo(()=>i?h.Children.map(i,Fa=>{if(!h.isValidElement(Fa))return Fa;var qe=Fa;return h.cloneElement(qe,{anchor:Z})}):null,[i,Z]);return o.jsx(o.Fragment,{children:Uc})||null}h.memo(b6);class TP extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[])}componentDidMount(){var t=this;return AP(function*(){var r=Rl(Rl(Rl({},t.props.options||Yh),t.props.clusterer?Yh:{map:t.context}),{},{position:t.props.position});t.marker=new google.maps.Marker(r),t.props.clusterer?t.props.clusterer.addMarker(t.marker,!!t.props.noClustererRedraw):t.marker.setMap(t.context),t.registeredEvents=Xe({updaterMap:HS,eventMap:VS,prevProps:{},nextProps:t.props,instance:t.marker}),t.props.onLoad&&t.props.onLoad(t.marker)})()}componentDidUpdate(t){this.marker&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:HS,eventMap:VS,prevProps:t,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),Ze(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var t=this.props.children?h.Children.map(this.props.children,r=>{if(!h.isValidElement(r))return r;var n=r;return h.cloneElement(n,{anchor:this.marker})}):null;return t||null}}ce(TP,"contextType",Ge);var j6=function(){function e(t,r){t.getClusterer().extend(e,google.maps.OverlayView),this.cluster=t,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(t.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return e.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},e.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},e.prototype.onClick=function(t){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var n=r.getMaxZoom(),a=this.cluster.getBounds(),i=r.getMap();i!==null&&"fitBounds"in i&&i.fitBounds(a),this.timeOut=window.setTimeout(function(){var s=r.getMap();if(s!==null){"fitBounds"in s&&s.fitBounds(a);var l=s.getZoom()||0;n!==null&&l>n&&s.setZoom(n+1)}},100)}t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}},e.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},e.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},e.prototype.onAdd=function(){var t;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(t=this.getPanes())===null||t===void 0||t.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},e.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},e.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var t=this.getPosFromLatLng(this.center);this.div.style.top=t!==null?"".concat(t.y,"px"):"0",this.div.style.left=t!==null?"".concat(t.x,"px"):"0"}},e.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},e.prototype.show=function(){var t,r,n,a,i,s;if(this.div&&this.center){var l=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,c=this.backgroundPosition.split(" "),u=parseInt(((t=c[0])===null||t===void 0?void 0:t.replace(/^\s+|\s+$/g,""))||"0",10),d=parseInt(((r=c[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),f=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(f!==null?"".concat(f.y,"px"):"0","; left: ").concat(f!==null?"".concat(f.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var p=document.createElement("img");p.alt=l,p.src=this.url,p.width=this.width,p.height=this.height,p.setAttribute("style","position: absolute; top: ".concat(d,"px; left: ").concat(u,"px")),this.cluster.getClusterer().enableRetinaIcons||(p.style.clip="rect(-".concat(d,"px, -").concat(u+this.width,"px, -").concat(d+this.height,", -").concat(u,")"));var x=document.createElement("div");x.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((n=this.sums)===null||n===void 0)&&n.text&&(x.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((i=this.sums)===null||i===void 0)&&i.html&&(x.innerHTML="".concat((s=this.sums)===null||s===void 0?void 0:s.html)),this.div.innerHTML="",this.div.appendChild(p),this.div.appendChild(x),this.div.title=l,this.div.style.display=""}this.visible=!0},e.prototype.useStyle=function(t){this.sums=t;var r=this.cluster.getClusterer().getStyles(),n=r[Math.min(r.length-1,Math.max(0,t.index-1))];n&&(this.url=n.url,this.height=n.height,this.width=n.width,n.className&&(this.className="".concat(this.clusterClassName," ").concat(n.className)),this.anchorText=n.anchorText||[0,0],this.anchorIcon=n.anchorIcon||[this.height/2,this.width/2],this.textColor=n.textColor||"black",this.textSize=n.textSize||11,this.textDecoration=n.textDecoration||"none",this.fontWeight=n.fontWeight||"bold",this.fontStyle=n.fontStyle||"normal",this.fontFamily=n.fontFamily||"Arial,sans-serif",this.backgroundPosition=n.backgroundPosition||"0 0")},e.prototype.setCenter=function(t){this.center=t},e.prototype.getPosFromLatLng=function(t){var r=this.getProjection().fromLatLngToDivPixel(t);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},e}(),w6=function(){function e(t){this.markerClusterer=t,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new j6(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return e.prototype.getSize=function(){return this.markers.length},e.prototype.getMarkers=function(){return this.markers},e.prototype.getCenter=function(){return this.center},e.prototype.getMap=function(){return this.map},e.prototype.getClusterer=function(){return this.markerClusterer},e.prototype.getBounds=function(){for(var t=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),n=0,a=r;n<a.length;n++){var i=a[n],s=i.getPosition();s&&t.extend(s)}return t},e.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},e.prototype.addMarker=function(t){var r;if(this.isMarkerAlreadyAdded(t))return!1;if(this.center){if(this.averageCenter){var n=t.getPosition();if(n){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+n.lat())/a,(this.center.lng()*(a-1)+n.lng())/a),this.calculateBounds()}}}else{var n=t.getPosition();n&&(this.center=n,this.calculateBounds())}t.isAdded=!0,this.markers.push(t);var i=this.markers.length,s=this.markerClusterer.getMaxZoom(),l=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(s!==null&&typeof l<"u"&&l>s)t.getMap()!==this.map&&t.setMap(this.map);else if(i<this.minClusterSize)t.getMap()!==this.map&&t.setMap(this.map);else if(i===this.minClusterSize)for(var c=0,u=this.markers;c<u.length;c++){var d=u[c];d.setMap(null)}else t.setMap(null);return!0},e.prototype.isMarkerInClusterBounds=function(t){if(this.bounds!==null){var r=t.getPosition();if(r)return this.bounds.contains(r)}return!1},e.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},e.prototype.updateIcon=function(){var t,r=this.markers.length,n=this.markerClusterer.getMaxZoom(),a=(t=this.map)===null||t===void 0?void 0:t.getZoom();if(n!==null&&typeof a<"u"&&a>n){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},e.prototype.isMarkerAlreadyAdded=function(t){if(this.markers.includes)return this.markers.includes(t);for(var r=0;r<this.markers.length;r++)if(t===this.markers[r])return!0;return!1},e}();function S6(e,t){var r=e.length,n=r.toString().length,a=Math.min(n,t);return{text:r.toString(),index:a,title:""}}var k6=2e3,C6=500,_6="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",A6="png",E6=[53,56,66,78,90],N6="cluster",LP=function(){function e(t,r,n){r===void 0&&(r=[]),n===void 0&&(n={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(e,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=n.gridSize||60,this.minClusterSize=n.minimumClusterSize||2,this.maxZoom=n.maxZoom||null,this.styles=n.styles||[],this.title=n.title||"",this.zoomOnClick=!0,n.zoomOnClick!==void 0&&(this.zoomOnClick=n.zoomOnClick),this.averageCenter=!1,n.averageCenter!==void 0&&(this.averageCenter=n.averageCenter),this.ignoreHidden=!1,n.ignoreHidden!==void 0&&(this.ignoreHidden=n.ignoreHidden),this.enableRetinaIcons=!1,n.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=n.enableRetinaIcons),this.imagePath=n.imagePath||_6,this.imageExtension=n.imageExtension||A6,this.imageSizes=n.imageSizes||E6,this.calculator=n.calculator||S6,this.batchSize=n.batchSize||k6,this.batchSizeIE=n.batchSizeIE||C6,this.clusterClass=n.clusterClass||N6,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(t)}return e.prototype.onZoomChanged=function(){var t,r;this.resetViewport(!1),(((t=this.getMap())===null||t===void 0?void 0:t.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},e.prototype.onIdle=function(){this.redraw()},e.prototype.onAdd=function(){var t=this.getMap();this.activeMap=t,this.ready=!0,this.repaint(),t!==null&&(this.listeners=[google.maps.event.addListener(t,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(t,"idle",this.onIdle)])},e.prototype.onRemove=function(){for(var t=0,r=this.markers;t<r.length;t++){var n=r[t];n.getMap()!==this.activeMap&&n.setMap(this.activeMap)}for(var a=0,i=this.clusters;a<i.length;a++){var s=i[a];s.remove()}this.clusters=[];for(var l=0,c=this.listeners;l<c.length;l++){var u=c[l];google.maps.event.removeListener(u)}this.listeners=[],this.activeMap=null,this.ready=!1},e.prototype.draw=function(){},e.prototype.getMap=function(){return null},e.prototype.getPanes=function(){return null},e.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},e.prototype.setMap=function(){},e.prototype.addListener=function(){return{remove:function(){}}},e.prototype.bindTo=function(){},e.prototype.get=function(){},e.prototype.notify=function(){},e.prototype.set=function(){},e.prototype.setValues=function(){},e.prototype.unbind=function(){},e.prototype.unbindAll=function(){},e.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var t=0;t<this.imageSizes.length;t++)this.styles.push({url:"".concat(this.imagePath+(t+1),".").concat(this.imageExtension),height:this.imageSizes[t]||0,width:this.imageSizes[t]||0})},e.prototype.fitMapToMarkers=function(){for(var t=this.getMarkers(),r=new google.maps.LatLngBounds,n=0,a=t;n<a.length;n++){var i=a[n],s=i.getPosition();s&&r.extend(s)}var l=this.getMap();l!==null&&"fitBounds"in l&&l.fitBounds(r)},e.prototype.getGridSize=function(){return this.gridSize},e.prototype.setGridSize=function(t){this.gridSize=t},e.prototype.getMinimumClusterSize=function(){return this.minClusterSize},e.prototype.setMinimumClusterSize=function(t){this.minClusterSize=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getStyles=function(){return this.styles},e.prototype.setStyles=function(t){this.styles=t},e.prototype.getTitle=function(){return this.title},e.prototype.setTitle=function(t){this.title=t},e.prototype.getZoomOnClick=function(){return this.zoomOnClick},e.prototype.setZoomOnClick=function(t){this.zoomOnClick=t},e.prototype.getAverageCenter=function(){return this.averageCenter},e.prototype.setAverageCenter=function(t){this.averageCenter=t},e.prototype.getIgnoreHidden=function(){return this.ignoreHidden},e.prototype.setIgnoreHidden=function(t){this.ignoreHidden=t},e.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},e.prototype.setEnableRetinaIcons=function(t){this.enableRetinaIcons=t},e.prototype.getImageExtension=function(){return this.imageExtension},e.prototype.setImageExtension=function(t){this.imageExtension=t},e.prototype.getImagePath=function(){return this.imagePath},e.prototype.setImagePath=function(t){this.imagePath=t},e.prototype.getImageSizes=function(){return this.imageSizes},e.prototype.setImageSizes=function(t){this.imageSizes=t},e.prototype.getCalculator=function(){return this.calculator},e.prototype.setCalculator=function(t){this.calculator=t},e.prototype.getBatchSizeIE=function(){return this.batchSizeIE},e.prototype.setBatchSizeIE=function(t){this.batchSizeIE=t},e.prototype.getClusterClass=function(){return this.clusterClass},e.prototype.setClusterClass=function(t){this.clusterClass=t},e.prototype.getMarkers=function(){return this.markers},e.prototype.getTotalMarkers=function(){return this.markers.length},e.prototype.getClusters=function(){return this.clusters},e.prototype.getTotalClusters=function(){return this.clusters.length},e.prototype.addMarker=function(t,r){this.pushMarkerTo(t),r||this.redraw()},e.prototype.addMarkers=function(t,r){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=t[n];a&&this.pushMarkerTo(a)}r||this.redraw()},e.prototype.pushMarkerTo=function(t){var r=this;t.getDraggable()&&google.maps.event.addListener(t,"dragend",function(){r.ready&&(t.isAdded=!1,r.repaint())}),t.isAdded=!1,this.markers.push(t)},e.prototype.removeMarker_=function(t){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(t);else for(var n=0;n<this.markers.length;n++)if(t===this.markers[n]){r=n;break}return r===-1?!1:(t.setMap(null),this.markers.splice(r,1),!0)},e.prototype.removeMarker=function(t,r){var n=this.removeMarker_(t);return!r&&n&&this.repaint(),n},e.prototype.removeMarkers=function(t,r){for(var n=!1,a=0,i=t;a<i.length;a++){var s=i[a];n=n||this.removeMarker_(s)}return!r&&n&&this.repaint(),n},e.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},e.prototype.repaint=function(){var t=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var n=0,a=t;n<a.length;n++){var i=a[n];i.remove()}},0)},e.prototype.getExtendedBounds=function(t){var r=this.getProjection(),n=r.fromLatLngToDivPixel(new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()));n!==null&&(n.x+=this.gridSize,n.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),n!==null){var i=r.fromDivPixelToLatLng(n);i!==null&&t.extend(i)}if(a!==null){var s=r.fromDivPixelToLatLng(a);s!==null&&t.extend(s)}return t},e.prototype.redraw=function(){this.createClusters(0)},e.prototype.resetViewport=function(t){for(var r=0,n=this.clusters;r<n.length;r++){var a=n[r];a.remove()}this.clusters=[];for(var i=0,s=this.markers;i<s.length;i++){var l=s[i];l.isAdded=!1,t&&l.setMap(null)}},e.prototype.distanceBetweenPoints=function(t,r){var n=6371,a=(r.lat()-t.lat())*Math.PI/180,i=(r.lng()-t.lng())*Math.PI/180,s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return n*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))},e.prototype.isMarkerInBounds=function(t,r){var n=t.getPosition();return n?r.contains(n):!1},e.prototype.addToClosestCluster=function(t){for(var r,n=4e4,a=null,i=0,s=this.clusters;i<s.length;i++){var l=s[i];r=l;var c=r.getCenter(),u=t.getPosition();if(c&&u){var d=this.distanceBetweenPoints(c,u);d<n&&(n=d,a=r)}}a&&a.isMarkerInClusterBounds(t)?a.addMarker(t):(r=new w6(this),r.addMarker(t),this.clusters.push(r))},e.prototype.createClusters=function(t){var r=this;if(this.ready){t===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var n=this.getMap(),a=n!==null&&("getBounds"in n)?n.getBounds():null,i=(n==null?void 0:n.getZoom())||0,s=i>3?new google.maps.LatLngBounds(a==null?void 0:a.getSouthWest(),a==null?void 0:a.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),l=this.getExtendedBounds(s),c=Math.min(t+this.batchSize,this.markers.length),u=t;u<c;u++){var d=this.markers[u];d&&!d.isAdded&&this.isMarkerInBounds(d,l)&&(!this.ignoreHidden||this.ignoreHidden&&d.getVisible())&&this.addToClosestCluster(d)}if(c<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(c)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var f=0,p=this.clusters;f<p.length;f++){var x=p[f];x.updateIcon()}}}},e.prototype.extend=function(t,r){return(function(a){for(var i in a.prototype){var s=i;this.prototype[s]=a.prototype[s]}return this}).apply(t,[r])},e}();function XS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XS(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Rn={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},lt={averageCenter(e,t){e.setAverageCenter(t)},batchSizeIE(e,t){e.setBatchSizeIE(t)},calculator(e,t){e.setCalculator(t)},clusterClass(e,t){e.setClusterClass(t)},enableRetinaIcons(e,t){e.setEnableRetinaIcons(t)},gridSize(e,t){e.setGridSize(t)},ignoreHidden(e,t){e.setIgnoreHidden(t)},imageExtension(e,t){e.setImageExtension(t)},imagePath(e,t){e.setImagePath(t)},imageSizes(e,t){e.setImageSizes(t)},maxZoom(e,t){e.setMaxZoom(t)},minimumClusterSize(e,t){e.setMinimumClusterSize(t)},styles(e,t){e.setStyles(t)},title(e,t){e.setTitle(t)},zoomOnClick(e,t){e.setZoomOnClick(t)}},M6={};function O6(e){var{children:t,options:r,averageCenter:n,batchSizeIE:a,calculator:i,clusterClass:s,enableRetinaIcons:l,gridSize:c,ignoreHidden:u,imageExtension:d,imagePath:f,imageSizes:p,maxZoom:x,minimumClusterSize:m,styles:y,title:j,zoomOnClick:b,onClick:g,onClusteringBegin:v,onClusteringEnd:w,onMouseOver:C,onMouseOut:k,onLoad:S,onUnmount:_}=e,[A,E]=h.useState(null),N=h.useContext(Ge),[$,z]=h.useState(null),[T,I]=h.useState(null),[L,D]=h.useState(null),[O,F]=h.useState(null),[q,te]=h.useState(null);return h.useEffect(()=>{A&&k&&(O!==null&&google.maps.event.removeListener(O),F(google.maps.event.addListener(A,Rn.onMouseOut,k)))},[k]),h.useEffect(()=>{A&&C&&(q!==null&&google.maps.event.removeListener(q),te(google.maps.event.addListener(A,Rn.onMouseOver,C)))},[C]),h.useEffect(()=>{A&&g&&($!==null&&google.maps.event.removeListener($),z(google.maps.event.addListener(A,Rn.onClick,g)))},[g]),h.useEffect(()=>{A&&v&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(A,Rn.onClusteringBegin,v)))},[v]),h.useEffect(()=>{A&&w&&(L!==null&&google.maps.event.removeListener(L),I(google.maps.event.addListener(A,Rn.onClusteringEnd,w)))},[w]),h.useEffect(()=>{typeof n<"u"&&A!==null&&lt.averageCenter(A,n)},[A,n]),h.useEffect(()=>{typeof a<"u"&&A!==null&&lt.batchSizeIE(A,a)},[A,a]),h.useEffect(()=>{typeof i<"u"&&A!==null&&lt.calculator(A,i)},[A,i]),h.useEffect(()=>{typeof s<"u"&&A!==null&&lt.clusterClass(A,s)},[A,s]),h.useEffect(()=>{typeof l<"u"&&A!==null&&lt.enableRetinaIcons(A,l)},[A,l]),h.useEffect(()=>{typeof c<"u"&&A!==null&&lt.gridSize(A,c)},[A,c]),h.useEffect(()=>{typeof u<"u"&&A!==null&&lt.ignoreHidden(A,u)},[A,u]),h.useEffect(()=>{typeof d<"u"&&A!==null&&lt.imageExtension(A,d)},[A,d]),h.useEffect(()=>{typeof f<"u"&&A!==null&&lt.imagePath(A,f)},[A,f]),h.useEffect(()=>{typeof p<"u"&&A!==null&&lt.imageSizes(A,p)},[A,p]),h.useEffect(()=>{typeof x<"u"&&A!==null&&lt.maxZoom(A,x)},[A,x]),h.useEffect(()=>{typeof m<"u"&&A!==null&&lt.minimumClusterSize(A,m)},[A,m]),h.useEffect(()=>{typeof y<"u"&&A!==null&&lt.styles(A,y)},[A,y]),h.useEffect(()=>{typeof j<"u"&&A!==null&&lt.title(A,j)},[A,j]),h.useEffect(()=>{typeof b<"u"&&A!==null&&lt.zoomOnClick(A,b)},[A,b]),h.useEffect(()=>{if(N){var H=P6({},r||M6),B=new LP(N,[],H);return n&&lt.averageCenter(B,n),a&&lt.batchSizeIE(B,a),i&&lt.calculator(B,i),s&&lt.clusterClass(B,s),l&&lt.enableRetinaIcons(B,l),c&&lt.gridSize(B,c),u&&lt.ignoreHidden(B,u),d&&lt.imageExtension(B,d),f&&lt.imagePath(B,f),p&&lt.imageSizes(B,p),x&&lt.maxZoom(B,x),m&&lt.minimumClusterSize(B,m),y&&lt.styles(B,y),j&&lt.title(B,j),b&&lt.zoomOnClick(B,b),k&&F(google.maps.event.addListener(B,Rn.onMouseOut,k)),C&&te(google.maps.event.addListener(B,Rn.onMouseOver,C)),g&&z(google.maps.event.addListener(B,Rn.onClick,g)),v&&I(google.maps.event.addListener(B,Rn.onClusteringBegin,v)),w&&D(google.maps.event.addListener(B,Rn.onClusteringEnd,w)),E(B),S&&S(B),()=>{O!==null&&google.maps.event.removeListener(O),q!==null&&google.maps.event.removeListener(q),$!==null&&google.maps.event.removeListener($),T!==null&&google.maps.event.removeListener(T),L!==null&&google.maps.event.removeListener(L),_&&_(B)}}},[]),A!==null&&t(A)||null}h.memo(O6);class T6 extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{markerClusterer:null}),ce(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var t=new LP(this.context,[],this.props.options);this.registeredEvents=Xe({updaterMap:lt,eventMap:Rn,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({markerClusterer:t}),this.setClustererCallback)}}componentDidUpdate(t){this.state.markerClusterer&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:lt,eventMap:Rn,prevProps:t,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),Ze(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}ce(T6,"contextType",Ge);function YS(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}var DP=function(){function e(t){t===void 0&&(t={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(e,google.maps.OverlayView),this.content=t.content||"",this.disableAutoPan=t.disableAutoPan||!1,this.maxWidth=t.maxWidth||0,this.pixelOffset=t.pixelOffset||new google.maps.Size(0,0),this.position=t.position||new google.maps.LatLng(0,0),this.zIndex=t.zIndex||null,this.boxClass=t.boxClass||"infoBox",this.boxStyle=t.boxStyle||{},this.closeBoxMargin=t.closeBoxMargin||"2px",this.closeBoxURL=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",t.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=t.infoBoxClearance||new google.maps.Size(1,1),typeof t.visible>"u"&&(typeof t.isHidden>"u"?t.visible=!0:t.visible=!t.isHidden),this.isHidden=!t.visible,this.alignBottom=t.alignBottom||!1,this.pane=t.pane||"floatPane",this.enableEventPropagation=t.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return e.prototype.createInfoBoxDiv=function(){var t=this,r=function(d){d.returnValue=!1,d.preventDefault&&d.preventDefault(),t.enableEventPropagation||YS(d)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var n=this.getPanes();if(n!==null&&n[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var i=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],s=0,l=i;s<l.length;s++){var c=l[s];this.eventListeners.push(google.maps.event.addListener(this.div,c,YS))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){t.div&&(t.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},e.prototype.getCloseBoxImg=function(){var t="";return this.closeBoxURL!==""&&(t='<img alt=""',t+=' aria-hidden="true"',t+=" src='"+this.closeBoxURL+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin+";",t+="'>"),t},e.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},e.prototype.closeClickHandler=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},e.prototype.getCloseClickHandler=function(){return this.closeClickHandler},e.prototype.panBox=function(t){if(this.div&&!t){var r=this.getMap();if(r instanceof google.maps.Map){var n=0,a=0,i=r.getBounds();i&&!i.contains(this.position)&&r.setCenter(this.position);var s=r.getDiv(),l=s.offsetWidth,c=s.offsetHeight,u=this.pixelOffset.width,d=this.pixelOffset.height,f=this.div.offsetWidth,p=this.div.offsetHeight,x=this.infoBoxClearance.width,m=this.infoBoxClearance.height,y=this.getProjection(),j=y.fromLatLngToContainerPixel(this.position);j!==null&&(j.x<-u+x?n=j.x+u-x:j.x+f+u+x>l&&(n=j.x+f+u+x-l),this.alignBottom?j.y<-d+m+p?a=j.y+d-m-p:j.y+d+m>c&&(a=j.y+d+m-c):j.y<-d+m?a=j.y+d-m:j.y+p+d+m>c&&(a=j.y+p+d+m-c)),n===0&&a===0||r.panBy(n,a)}}},e.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var t=this.boxStyle;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(this.div.style[r]=t[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var n=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+n*100+')"',this.div.style.filter="alpha(opacity="+n*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},e.prototype.getBoxWidths=function(){var t={top:0,bottom:0,left:0,right:0};if(!this.div)return t;if(document.defaultView){var r=this.div.ownerDocument,n=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;n&&(t.top=parseInt(n.borderTopWidth||"",10)||0,t.bottom=parseInt(n.borderBottomWidth||"",10)||0,t.left=parseInt(n.borderLeftWidth||"",10)||0,t.right=parseInt(n.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(t.top=parseInt(a.borderTopWidth||"",10)||0,t.bottom=parseInt(a.borderBottomWidth||"",10)||0,t.left=parseInt(a.borderLeftWidth||"",10)||0,t.right=parseInt(a.borderRightWidth||"",10)||0)}return t},e.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},e.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var t=this.getProjection(),r=t.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},e.prototype.setOptions=function(t){t===void 0&&(t={}),typeof t.boxClass<"u"&&(this.boxClass=t.boxClass,this.setBoxStyle()),typeof t.boxStyle<"u"&&(this.boxStyle=t.boxStyle,this.setBoxStyle()),typeof t.content<"u"&&this.setContent(t.content),typeof t.disableAutoPan<"u"&&(this.disableAutoPan=t.disableAutoPan),typeof t.maxWidth<"u"&&(this.maxWidth=t.maxWidth),typeof t.pixelOffset<"u"&&(this.pixelOffset=t.pixelOffset),typeof t.alignBottom<"u"&&(this.alignBottom=t.alignBottom),typeof t.position<"u"&&this.setPosition(t.position),typeof t.zIndex<"u"&&this.setZIndex(t.zIndex),typeof t.closeBoxMargin<"u"&&(this.closeBoxMargin=t.closeBoxMargin),typeof t.closeBoxURL<"u"&&(this.closeBoxURL=t.closeBoxURL),typeof t.infoBoxClearance<"u"&&(this.infoBoxClearance=t.infoBoxClearance),typeof t.isHidden<"u"&&(this.isHidden=t.isHidden),typeof t.visible<"u"&&(this.isHidden=!t.visible),typeof t.enableEventPropagation<"u"&&(this.enableEventPropagation=t.enableEventPropagation),this.div&&this.draw()},e.prototype.setContent=function(t){this.content=t,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},e.prototype.setPosition=function(t){this.position=t,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},e.prototype.setVisible=function(t){this.isHidden=!t,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},e.prototype.setZIndex=function(t){this.zIndex=t,this.div&&(this.div.style.zIndex=t+""),google.maps.event.trigger(this,"zindex_changed")},e.prototype.getContent=function(){return this.content},e.prototype.getPosition=function(){return this.position},e.prototype.getZIndex=function(){return this.zIndex},e.prototype.getVisible=function(){var t=this.getMap();return typeof t>"u"||t===null?!1:!this.isHidden},e.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},e.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},e.prototype.open=function(t,r){var n=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();n.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){n.setMap(r.map)})),this.setMap(t),this.div&&this.panBox()},e.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var t=0,r=this.eventListeners;t<r.length;t++){var n=r[t];google.maps.event.removeListener(n)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},e.prototype.extend=function(t,r){return(function(a){for(var i in a.prototype)Object.prototype.hasOwnProperty.call(this,i)||(this.prototype[i]=a.prototype[i]);return this}).apply(t,[r])},e}(),L6=["position"],D6=["position"];function JS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JS(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ZS={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},QS={options(e,t){e.setOptions(t)},position(e,t){t instanceof google.maps.LatLng?e.setPosition(t):e.setPosition(new google.maps.LatLng(t.lat,t.lng))},visible(e,t){e.setVisible(t)},zIndex(e,t){e.setZIndex(t)}},I6={};function $6(e){var{children:t,anchor:r,options:n,position:a,zIndex:i,onCloseClick:s,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:f,onUnmount:p}=e,x=h.useContext(Ge),[m,y]=h.useState(null),[j,b]=h.useState(null),[g,v]=h.useState(null),[w,C]=h.useState(null),[k,S]=h.useState(null),[_,A]=h.useState(null),E=h.useRef(null);return h.useEffect(()=>{x&&m!==null&&(m.close(),r?m.open(x,r):m.getPosition()&&m.open(x))},[x,m,r]),h.useEffect(()=>{n&&m!==null&&m.setOptions(n)},[m,n]),h.useEffect(()=>{if(a&&m!==null){var N=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);m.setPosition(N)}},[a]),h.useEffect(()=>{typeof i=="number"&&m!==null&&m.setZIndex(i)},[i]),h.useEffect(()=>{m&&s&&(j!==null&&google.maps.event.removeListener(j),b(google.maps.event.addListener(m,"closeclick",s)))},[s]),h.useEffect(()=>{m&&l&&(g!==null&&google.maps.event.removeListener(g),v(google.maps.event.addListener(m,"domready",l)))},[l]),h.useEffect(()=>{m&&c&&(w!==null&&google.maps.event.removeListener(w),C(google.maps.event.addListener(m,"content_changed",c)))},[c]),h.useEffect(()=>{m&&u&&(k!==null&&google.maps.event.removeListener(k),S(google.maps.event.addListener(m,"position_changed",u)))},[u]),h.useEffect(()=>{m&&d&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(m,"zindex_changed",d)))},[d]),h.useEffect(()=>{if(x){var N=n||I6,{position:$}=N,z=E0(N,L6),T;$&&!($ instanceof google.maps.LatLng)&&(T=new google.maps.LatLng($.lat,$.lng));var I=new DP(Jh(Jh({},z),T?{position:T}:{}));E.current=document.createElement("div"),y(I),s&&b(google.maps.event.addListener(I,"closeclick",s)),l&&v(google.maps.event.addListener(I,"domready",l)),c&&C(google.maps.event.addListener(I,"content_changed",c)),u&&S(google.maps.event.addListener(I,"position_changed",u)),d&&A(google.maps.event.addListener(I,"zindex_changed",d)),I.setContent(E.current),r?I.open(x,r):I.getPosition()?I.open(x):sr(!1,"You must provide either an anchor or a position prop for <InfoBox>."),f&&f(I)}return()=>{m!==null&&(j&&google.maps.event.removeListener(j),w&&google.maps.event.removeListener(w),g&&google.maps.event.removeListener(g),k&&google.maps.event.removeListener(k),_&&google.maps.event.removeListener(_),p&&p(m),m.close())}},[]),E.current?Pa.createPortal(h.Children.only(t),E.current):null}h.memo($6);class R6 extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"containerElement",null),ce(this,"state",{infoBox:null}),ce(this,"open",(t,r)=>{r?this.context!==null&&t.open(this.context,r):t.getPosition()?this.context!==null&&t.open(this.context):sr(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),ce(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var t=this.props.options||{},{position:r}=t,n=E0(t,D6),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var i=new DP(Jh(Jh({},n),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=Xe({updaterMap:QS,eventMap:ZS,prevProps:{},nextProps:this.props,instance:i}),this.setState({infoBox:i},this.setInfoBoxCallback)}componentDidUpdate(t){var{infoBox:r}=this.state;r!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:QS,eventMap:ZS,prevProps:t,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:t}=this.props,{infoBox:r}=this.state;r!==null&&(t&&t(r),Ze(this.registeredEvents),r.close())}render(){return this.containerElement?Pa.createPortal(h.Children.only(this.props.children),this.containerElement):null}}ce(R6,"contextType",Ge);var nx,e2;function F6(){return e2||(e2=1,nx=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,i;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(i=Object.keys(t),n=i.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[a]))return!1;for(a=n;a--!==0;){var s=i[a];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}),nx}var z6=F6(),t2=_P(z6),r2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ox=1,Zc=8;class N0{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,n]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=n>>4;if(a!==ox)throw new Error("Got v".concat(a," data when expected v").concat(ox,"."));var i=r2[n&15];if(!i)throw new Error("Unrecognized array type.");var[s]=new Uint16Array(t,2,1),[l]=new Uint32Array(t,4,1);return new N0(l,s,i,t)}constructor(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;var i=r2.indexOf(this.ArrayType),s=t*2*this.ArrayType.BYTES_PER_ELEMENT,l=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-l%8)%8;if(i<0)throw new Error("Unexpected typed array class: ".concat(n,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,Zc,t),this.coords=new this.ArrayType(this.data,Zc+l+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Zc+s+l+c),this.ids=new this.IndexArrayType(this.data,Zc,t),this.coords=new this.ArrayType(this.data,Zc+l+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ox<<4)+i]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){var n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=r,n}finish(){var t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return ny(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:i,coords:s,nodeSize:l}=this,c=[0,i.length-1,0],u=[];c.length;){var d=c.pop()||0,f=c.pop()||0,p=c.pop()||0;if(f-p<=l){for(var x=p;x<=f;x++){var m=s[2*x],y=s[2*x+1];m>=t&&m<=n&&y>=r&&y<=a&&u.push(i[x])}continue}var j=p+f>>1,b=s[2*j],g=s[2*j+1];b>=t&&b<=n&&g>=r&&g<=a&&u.push(i[j]),(d===0?t<=b:r<=g)&&(c.push(p),c.push(j-1),c.push(1-d)),(d===0?n>=b:a>=g)&&(c.push(j+1),c.push(f),c.push(1-d))}return u}within(t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:i,nodeSize:s}=this,l=[0,a.length-1,0],c=[],u=n*n;l.length;){var d=l.pop()||0,f=l.pop()||0,p=l.pop()||0;if(f-p<=s){for(var x=p;x<=f;x++)n2(i[2*x],i[2*x+1],t,r)<=u&&c.push(a[x]);continue}var m=p+f>>1,y=i[2*m],j=i[2*m+1];n2(y,j,t,r)<=u&&c.push(a[m]),(d===0?t-n<=y:r-n<=j)&&(l.push(p),l.push(m-1),l.push(1-d)),(d===0?t+n>=y:r+n>=j)&&(l.push(m+1),l.push(f),l.push(1-d))}return c}}function ny(e,t,r,n,a,i){if(!(a-n<=r)){var s=n+a>>1;IP(e,t,s,n,a,i),ny(e,t,r,n,s-1,1-i),ny(e,t,r,s+1,a,1-i)}}function IP(e,t,r,n,a,i){for(;a>n;){if(a-n>600){var s=a-n+1,l=r-n+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1),f=Math.max(n,Math.floor(r-l*u/s+d)),p=Math.min(a,Math.floor(r+(s-l)*u/s+d));IP(e,t,r,f,p,i)}var x=t[2*r+i],m=n,y=a;for(Qc(e,t,n,r),t[2*a+i]>x&&Qc(e,t,n,a);m<y;){for(Qc(e,t,m,y),m++,y--;t[2*m+i]<x;)m++;for(;t[2*y+i]>x;)y--}t[2*n+i]===x?Qc(e,t,n,y):(y++,Qc(e,t,y,a)),y<=r&&(n=y+1),r<=y&&(a=y-1)}}function Qc(e,t,r,n){ax(e,r,n),ax(t,2*r,2*n),ax(t,2*r+1,2*n+1)}function ax(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function n2(e,t,r,n){var a=e-r,i=t-n;return a*a+i*i}var B6={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},o2=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),Xi=2,Za=3,ix=4,Ha=5,$P=6;class U6{constructor(t){this.options=Object.assign(Object.create(B6),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){var{log:r,minZoom:n,maxZoom:a}=this.options;r&&console.time("total time");var i="prepare ".concat(t.length," points");r&&console.time(i),this.points=t;for(var s=[],l=0;l<t.length;l++){var c=t[l];if(c.geometry){var[u,d]=c.geometry.coordinates,f=o2(_f(u)),p=o2(Af(d));s.push(f,p,1/0,l,-1,1),this.options.reduce&&s.push(0)}}var x=this.trees[a+1]=this._createTree(s);r&&console.timeEnd(i);for(var m=a;m>=n;m--){var y=+Date.now();x=this.trees[m]=this._createTree(this._cluster(x,m)),r&&console.log("z%d: %d clusters in %dms",m,x.numItems,+Date.now()-y)}return r&&console.timeEnd("total time"),this}getClusters(t,r){var n=((t[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[1])),i=t[2]===180?180:((t[2]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var l=this.getClusters([n,a,180,s],r),c=this.getClusters([-180,a,i,s],r);return l.concat(c)}var u=this.trees[this._limitZoom(r)],d=u.range(_f(n),Af(s),_f(i),Af(a)),f=u.data,p=[];for(var x of d){var m=this.stride*x;p.push(f[m+Ha]>1?a2(f,m,this.clusterProps):this.points[f[m+Za]])}return p}getChildren(t){var r=this._getOriginId(t),n=this._getOriginZoom(t),a="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(a);var s=i.data;if(r*this.stride>=s.length)throw new Error(a);var l=this.options.radius/(this.options.extent*Math.pow(2,n-1)),c=s[r*this.stride],u=s[r*this.stride+1],d=i.within(c,u,l),f=[];for(var p of d){var x=p*this.stride;s[x+ix]===t&&f.push(s[x+Ha]>1?a2(s,x,this.clusterProps):this.points[s[x+Za]])}if(f.length===0)throw new Error(a);return f}getLeaves(t,r,n){r=r||10,n=n||0;var a=[];return this._appendLeaves(a,t,r,n,0),a}getTile(t,r,n){var a=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:s,radius:l}=this.options,c=l/s,u=(n-c)/i,d=(n+1+c)/i,f={features:[]};return this._addTileFeatures(a.range((r-c)/i,u,(r+1+c)/i,d),a.data,r,n,i,f),r===0&&this._addTileFeatures(a.range(1-c/i,u,1,d),a.data,i,n,i,f),r===i-1&&this._addTileFeatures(a.range(0,u,c/i,d),a.data,-1,n,i,f),f.features.length?f:null}getClusterExpansionZoom(t){for(var r=this._getOriginZoom(t)-1;r<=this.options.maxZoom;){var n=this.getChildren(t);if(r++,n.length!==1)break;t=n[0].properties.cluster_id}return r}_appendLeaves(t,r,n,a,i){var s=this.getChildren(r);for(var l of s){var c=l.properties;if(c&&c.cluster?i+c.point_count<=a?i+=c.point_count:i=this._appendLeaves(t,c.cluster_id,n,a,i):i<a?i++:t.push(l),t.length===n)break}return i}_createTree(t){for(var r=new N0(t.length/this.stride|0,this.options.nodeSize,Float32Array),n=0;n<t.length;n+=this.stride)r.add(t[n],t[n+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,n,a,i,s){for(var l of t){var c=l*this.stride,u=r[c+Ha]>1,d=void 0,f=void 0,p=void 0;if(u)d=RP(r,c,this.clusterProps),f=r[c],p=r[c+1];else{var x=this.points[r[c+Za]];d=x.properties;var[m,y]=x.geometry.coordinates;f=_f(m),p=Af(y)}var j={type:1,geometry:[[Math.round(this.options.extent*(f*i-n)),Math.round(this.options.extent*(p*i-a))]],tags:d},b=void 0;u||this.options.generateId?b=r[c+Za]:b=this.points[r[c+Za]].id,b!==void 0&&(j.id=b),s.features.push(j)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){for(var{radius:n,extent:a,reduce:i,minPoints:s}=this.options,l=n/(a*Math.pow(2,r)),c=t.data,u=[],d=this.stride,f=0;f<c.length;f+=d)if(!(c[f+Xi]<=r)){c[f+Xi]=r;var p=c[f],x=c[f+1],m=t.within(c[f],c[f+1],l),y=c[f+Ha],j=y;for(var b of m){var g=b*d;c[g+Xi]>r&&(j+=c[g+Ha])}if(j>y&&j>=s){var v=p*y,w=x*y,C=void 0,k=-1,S=((f/d|0)<<5)+(r+1)+this.points.length;for(var _ of m){var A=_*d;if(!(c[A+Xi]<=r)){c[A+Xi]=r;var E=c[A+Ha];v+=c[A]*E,w+=c[A+1]*E,c[A+ix]=S,i&&(C||(C=this._map(c,f,!0),k=this.clusterProps.length,this.clusterProps.push(C)),i(C,this._map(c,A)))}}c[f+ix]=S,u.push(v/j,w/j,1/0,S,-1,j),i&&u.push(k)}else{for(var N=0;N<d;N++)u.push(c[f+N]);if(j>1)for(var $ of m){var z=$*d;if(!(c[z+Xi]<=r)){c[z+Xi]=r;for(var T=0;T<d;T++)u.push(c[z+T])}}}}return u}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,n){if(t[r+Ha]>1){var a=this.clusterProps[t[r+$P]];return n?Object.assign({},a):a}var i=this.points[t[r+Za]].properties,s=this.options.map(i);return n&&s===i?Object.assign({},s):s}}function a2(e,t,r){return{type:"Feature",id:e[t+Za],properties:RP(e,t,r),geometry:{type:"Point",coordinates:[W6(e[t]),q6(e[t+1])]}}}function RP(e,t,r){var n=e[t+Ha],a=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,i=e[t+$P],s=i===-1?{}:Object.assign({},r[i]);return Object.assign(s,{cluster:!0,cluster_id:e[t+Za],point_count:n,point_count_abbreviated:a})}function _f(e){return e/360+.5}function Af(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function W6(e){return(e-.5)*360}function q6(e){var t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function K6(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}class gn{static isAdvancedMarkerAvailable(t){return google.maps.marker&&t.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,r){this.isAdvancedMarker(t)?t.map=r:t.setMap(r)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(t.position.lat&&t.position.lng)return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return this.isAdvancedMarker(t)?!0:t.getVisible()}}class oy{constructor(t){var{markers:r,position:n}=t;this.markers=r,n&&(n instanceof google.maps.LatLng?this._position=n:this._position=new google.maps.LatLng(n))}get bounds(){if(!(this.markers.length===0&&!this._position)){var t=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)t.extend(gn.getPosition(r));return t}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>gn.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(gn.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class G6{constructor(t){var{maxZoom:r=16}=t;this.maxZoom=r}noop(t){var{markers:r}=t;return V6(r)}}var V6=e=>{var t=e.map(r=>new oy({position:gn.getPosition(r),markers:[r]}));return t};class H6 extends G6{constructor(t){var{maxZoom:r,radius:n=60}=t,a=K6(t,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new U6(Object.assign({maxZoom:this.maxZoom,radius:n},a))}calculate(t){var r=!1,n={zoom:t.map.getZoom()};if(!t2(t.markers,this.markers)){r=!0,this.markers=[...t.markers];var a=this.markers.map(i=>{var s=gn.getPosition(i),l=[s.lng(),s.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:l},properties:{marker:i}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(r=!t2(this.state,n)),this.state=n,r&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:r}}cluster(t){var{map:r}=t;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(n=>this.transformCluster(n))}transformCluster(t){var{geometry:{coordinates:[r,n]},properties:a}=t;if(a.cluster)return new oy({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(s=>s.properties.marker),position:{lat:n,lng:r}});var i=a.marker;return new oy({markers:[i],position:gn.getPosition(i)})}}class X6{constructor(t,r){this.markers={sum:t.length};var n=r.map(i=>i.count),a=n.reduce((i,s)=>i+s,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...n),max:Math.max(...n)}}}}class Y6{render(t,r,n){var{count:a,position:i}=t,s=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",l='<svg fill="'.concat(s,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),c="Cluster of ".concat(a," markers"),u=Number(google.maps.Marker.MAX_ZINDEX)+a;if(gn.isAdvancedMarkerAvailable(n)){var d=new DOMParser,f=d.parseFromString(l,"image/svg+xml").documentElement;f.setAttribute("transform","translate(0 25)");var p={map:n,position:i,zIndex:u,title:c,content:f};return new google.maps.marker.AdvancedMarkerElement(p)}var x={position:i,zIndex:u,title:c,icon:{url:"data:image/svg+xml;base64,".concat(btoa(l)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(x)}}function J6(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]}class P0{constructor(){J6(P0,google.maps.OverlayView)}}var Dd;(function(e){e.CLUSTERING_BEGIN="clusteringbegin",e.CLUSTERING_END="clusteringend",e.CLUSTER_CLICK="click"})(Dd||(Dd={}));var Z6=(e,t,r)=>{r.fitBounds(t.bounds)};class Q6 extends P0{constructor(t){var{map:r,markers:n=[],algorithmOptions:a={},algorithm:i=new H6(a),renderer:s=new Y6,onClusterClick:l=Z6}=t;super(),this.markers=[...n],this.clusters=[],this.algorithm=i,this.renderer=s,this.onClusterClick=l,r&&this.setMap(r)}addMarker(t,r){this.markers.includes(t)||(this.markers.push(t),r||this.render())}addMarkers(t,r){t.forEach(n=>{this.addMarker(n,!0)}),r||this.render()}removeMarker(t,r){var n=this.markers.indexOf(t);return n===-1?!1:(gn.setMap(t,null),this.markers.splice(n,1),r||this.render(),!0)}removeMarkers(t,r){var n=!1;return t.forEach(a=>{n=this.removeMarker(a,!0)||n}),n&&!r&&this.render(),n}clearMarkers(t){this.markers.length=0,t||this.render()}render(){var t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,Dd.CLUSTERING_BEGIN,this);var{clusters:r,changed:n}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(n||n==null){var a=new Set;for(var i of r)i.markers.length==1&&a.add(i.markers[0]);var s=[];for(var l of this.clusters)l.marker!=null&&(l.markers.length==1?a.has(l.marker)||gn.setMap(l.marker,null):s.push(l.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>s.forEach(c=>gn.setMap(c,null)))}google.maps.event.trigger(this,Dd.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>gn.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){var t=new X6(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(n=>{n.markers.length===1?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,t,r),n.markers.forEach(a=>gn.setMap(a,null)),this.onClusterClick&&n.marker.addListener("click",a=>{google.maps.event.trigger(this,Dd.CLUSTER_CLICK,n),this.onClusterClick(a,n,r)})),gn.setMap(n.marker,r)})}}function i2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eF(e){var t=e6(),[r,n]=h.useState(null);return h.useEffect(()=>{if(t&&r===null){var a=new Q6(s2(s2({},e),{},{map:t}));n(a)}},[t]),r}function tF(e){var{children:t,options:r}=e,n=eF(r);return n!==null?t(n):null}h.memo(tF);var l2={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},c2={options(e,t){e.setOptions(t)},position(e,t){e.setPosition(t)},zIndex(e,t){e.setZIndex(t)}};function rF(e){var{children:t,anchor:r,options:n,position:a,zIndex:i,onCloseClick:s,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:f,onUnmount:p}=e,x=h.useContext(Ge),[m,y]=h.useState(null),[j,b]=h.useState(null),[g,v]=h.useState(null),[w,C]=h.useState(null),[k,S]=h.useState(null),[_,A]=h.useState(null),E=h.useRef(null);return h.useEffect(()=>{m!==null&&(m.close(),r?m.open(x,r):m.getPosition()&&m.open(x))},[x,m,r]),h.useEffect(()=>{n&&m!==null&&m.setOptions(n)},[m,n]),h.useEffect(()=>{a&&m!==null&&m.setPosition(a)},[a]),h.useEffect(()=>{typeof i=="number"&&m!==null&&m.setZIndex(i)},[i]),h.useEffect(()=>{m&&s&&(j!==null&&google.maps.event.removeListener(j),b(google.maps.event.addListener(m,"closeclick",s)))},[s]),h.useEffect(()=>{m&&l&&(g!==null&&google.maps.event.removeListener(g),v(google.maps.event.addListener(m,"domready",l)))},[l]),h.useEffect(()=>{m&&c&&(w!==null&&google.maps.event.removeListener(w),C(google.maps.event.addListener(m,"content_changed",c)))},[c]),h.useEffect(()=>{m&&u&&(k!==null&&google.maps.event.removeListener(k),S(google.maps.event.addListener(m,"position_changed",u)))},[u]),h.useEffect(()=>{m&&d&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(m,"zindex_changed",d)))},[d]),h.useEffect(()=>{var N=new google.maps.InfoWindow(n);return y(N),E.current=document.createElement("div"),s&&b(google.maps.event.addListener(N,"closeclick",s)),l&&v(google.maps.event.addListener(N,"domready",l)),c&&C(google.maps.event.addListener(N,"content_changed",c)),u&&S(google.maps.event.addListener(N,"position_changed",u)),d&&A(google.maps.event.addListener(N,"zindex_changed",d)),N.setContent(E.current),a&&N.setPosition(a),i&&N.setZIndex(i),r?N.open(x,r):N.getPosition()?N.open(x):sr(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),f&&f(N),()=>{j&&google.maps.event.removeListener(j),w&&google.maps.event.removeListener(w),g&&google.maps.event.removeListener(g),k&&google.maps.event.removeListener(k),_&&google.maps.event.removeListener(_),p&&p(N),N.close()}},[]),E.current?Pa.createPortal(h.Children.only(t),E.current):null}h.memo(rF);class fu extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"containerElement",null),ce(this,"state",{infoWindow:null}),ce(this,"open",(t,r)=>{r?t.open(this.context,r):t.getPosition()?t.open(this.context):sr(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),ce(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var t=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=Xe({updaterMap:c2,eventMap:l2,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({infoWindow:t}),this.setInfoWindowCallback)}componentDidUpdate(t){this.state.infoWindow!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:c2,eventMap:l2,prevProps:t,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(Ze(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Pa.createPortal(h.Children.only(this.props.children),this.containerElement):null}}ce(fu,"contextType",Ge);function d2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var u2={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},f2={draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},path(e,t){e.setPath(t)},visible(e,t){e.setVisible(t)}},nF={};function oF(e){var{options:t,draggable:r,editable:n,visible:a,path:i,onDblClick:s,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:f,onMouseOver:p,onMouseUp:x,onRightClick:m,onClick:y,onDrag:j,onLoad:b,onUnmount:g}=e,v=h.useContext(Ge),[w,C]=h.useState(null),[k,S]=h.useState(null),[_,A]=h.useState(null),[E,N]=h.useState(null),[$,z]=h.useState(null),[T,I]=h.useState(null),[L,D]=h.useState(null),[O,F]=h.useState(null),[q,te]=h.useState(null),[H,B]=h.useState(null),[K,Z]=h.useState(null),[he,re]=h.useState(null);return h.useEffect(()=>{w!==null&&w.setMap(v)},[v]),h.useEffect(()=>{typeof t<"u"&&w!==null&&w.setOptions(t)},[w,t]),h.useEffect(()=>{typeof r<"u"&&w!==null&&w.setDraggable(r)},[w,r]),h.useEffect(()=>{typeof n<"u"&&w!==null&&w.setEditable(n)},[w,n]),h.useEffect(()=>{typeof a<"u"&&w!==null&&w.setVisible(a)},[w,a]),h.useEffect(()=>{typeof i<"u"&&w!==null&&w.setPath(i)},[w,i]),h.useEffect(()=>{w&&s&&(k!==null&&google.maps.event.removeListener(k),S(google.maps.event.addListener(w,"dblclick",s)))},[s]),h.useEffect(()=>{w&&l&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(w,"dragend",l)))},[l]),h.useEffect(()=>{w&&c&&(E!==null&&google.maps.event.removeListener(E),N(google.maps.event.addListener(w,"dragstart",c)))},[c]),h.useEffect(()=>{w&&u&&($!==null&&google.maps.event.removeListener($),z(google.maps.event.addListener(w,"mousedown",u)))},[u]),h.useEffect(()=>{w&&d&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(w,"mousemove",d)))},[d]),h.useEffect(()=>{w&&f&&(L!==null&&google.maps.event.removeListener(L),D(google.maps.event.addListener(w,"mouseout",f)))},[f]),h.useEffect(()=>{w&&p&&(O!==null&&google.maps.event.removeListener(O),F(google.maps.event.addListener(w,"mouseover",p)))},[p]),h.useEffect(()=>{w&&x&&(q!==null&&google.maps.event.removeListener(q),te(google.maps.event.addListener(w,"mouseup",x)))},[x]),h.useEffect(()=>{w&&m&&(H!==null&&google.maps.event.removeListener(H),B(google.maps.event.addListener(w,"rightclick",m)))},[m]),h.useEffect(()=>{w&&y&&(K!==null&&google.maps.event.removeListener(K),Z(google.maps.event.addListener(w,"click",y)))},[y]),h.useEffect(()=>{w&&j&&(he!==null&&google.maps.event.removeListener(he),re(google.maps.event.addListener(w,"drag",j)))},[j]),h.useEffect(()=>{var X=new google.maps.Polyline(Zh(Zh({},t||nF),{},{map:v}));return i&&X.setPath(i),typeof a<"u"&&X.setVisible(a),typeof n<"u"&&X.setEditable(n),typeof r<"u"&&X.setDraggable(r),s&&S(google.maps.event.addListener(X,"dblclick",s)),l&&A(google.maps.event.addListener(X,"dragend",l)),c&&N(google.maps.event.addListener(X,"dragstart",c)),u&&z(google.maps.event.addListener(X,"mousedown",u)),d&&I(google.maps.event.addListener(X,"mousemove",d)),f&&D(google.maps.event.addListener(X,"mouseout",f)),p&&F(google.maps.event.addListener(X,"mouseover",p)),x&&te(google.maps.event.addListener(X,"mouseup",x)),m&&B(google.maps.event.addListener(X,"rightclick",m)),y&&Z(google.maps.event.addListener(X,"click",y)),j&&re(google.maps.event.addListener(X,"drag",j)),C(X),b&&b(X),()=>{k!==null&&google.maps.event.removeListener(k),_!==null&&google.maps.event.removeListener(_),E!==null&&google.maps.event.removeListener(E),$!==null&&google.maps.event.removeListener($),T!==null&&google.maps.event.removeListener(T),L!==null&&google.maps.event.removeListener(L),O!==null&&google.maps.event.removeListener(O),q!==null&&google.maps.event.removeListener(q),H!==null&&google.maps.event.removeListener(H),K!==null&&google.maps.event.removeListener(K),g&&g(X),X.setMap(null)}},[]),null}h.memo(oF);class aF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{polyline:null}),ce(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var t=new google.maps.Polyline(Zh(Zh({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:f2,eventMap:u2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{polyline:t}},this.setPolylineCallback)}componentDidUpdate(t){this.state.polyline!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:f2,eventMap:u2,prevProps:t,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),Ze(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}ce(aF,"contextType",Ge);function h2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var m2={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},g2={draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},path(e,t){e.setPath(t)},paths(e,t){e.setPaths(t)},visible(e,t){e.setVisible(t)}};function iF(e){var{options:t,draggable:r,editable:n,visible:a,path:i,paths:s,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:f,onMouseOut:p,onMouseOver:x,onMouseUp:m,onRightClick:y,onClick:j,onDrag:b,onLoad:g,onUnmount:v,onEdit:w}=e,C=h.useContext(Ge),[k,S]=h.useState(null),[_,A]=h.useState(null),[E,N]=h.useState(null),[$,z]=h.useState(null),[T,I]=h.useState(null),[L,D]=h.useState(null),[O,F]=h.useState(null),[q,te]=h.useState(null),[H,B]=h.useState(null),[K,Z]=h.useState(null),[he,re]=h.useState(null),[X,V]=h.useState(null);return h.useEffect(()=>{k!==null&&k.setMap(C)},[C]),h.useEffect(()=>{typeof t<"u"&&k!==null&&k.setOptions(t)},[k,t]),h.useEffect(()=>{typeof r<"u"&&k!==null&&k.setDraggable(r)},[k,r]),h.useEffect(()=>{typeof n<"u"&&k!==null&&k.setEditable(n)},[k,n]),h.useEffect(()=>{typeof a<"u"&&k!==null&&k.setVisible(a)},[k,a]),h.useEffect(()=>{typeof i<"u"&&k!==null&&k.setPath(i)},[k,i]),h.useEffect(()=>{typeof s<"u"&&k!==null&&k.setPaths(s)},[k,s]),h.useEffect(()=>{k&&typeof l=="function"&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(k,"dblclick",l)))},[l]),h.useEffect(()=>{k&&(google.maps.event.addListener(k.getPath(),"insert_at",()=>{w==null||w(k)}),google.maps.event.addListener(k.getPath(),"set_at",()=>{w==null||w(k)}),google.maps.event.addListener(k.getPath(),"remove_at",()=>{w==null||w(k)}))},[k,w]),h.useEffect(()=>{k&&typeof c=="function"&&(E!==null&&google.maps.event.removeListener(E),N(google.maps.event.addListener(k,"dragend",c)))},[c]),h.useEffect(()=>{k&&typeof u=="function"&&($!==null&&google.maps.event.removeListener($),z(google.maps.event.addListener(k,"dragstart",u)))},[u]),h.useEffect(()=>{k&&typeof d=="function"&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(k,"mousedown",d)))},[d]),h.useEffect(()=>{k&&typeof f=="function"&&(L!==null&&google.maps.event.removeListener(L),D(google.maps.event.addListener(k,"mousemove",f)))},[f]),h.useEffect(()=>{k&&typeof p=="function"&&(O!==null&&google.maps.event.removeListener(O),F(google.maps.event.addListener(k,"mouseout",p)))},[p]),h.useEffect(()=>{k&&typeof x=="function"&&(q!==null&&google.maps.event.removeListener(q),te(google.maps.event.addListener(k,"mouseover",x)))},[x]),h.useEffect(()=>{k&&typeof m=="function"&&(H!==null&&google.maps.event.removeListener(H),B(google.maps.event.addListener(k,"mouseup",m)))},[m]),h.useEffect(()=>{k&&typeof y=="function"&&(K!==null&&google.maps.event.removeListener(K),Z(google.maps.event.addListener(k,"rightclick",y)))},[y]),h.useEffect(()=>{k&&typeof j=="function"&&(he!==null&&google.maps.event.removeListener(he),re(google.maps.event.addListener(k,"click",j)))},[j]),h.useEffect(()=>{k&&typeof b=="function"&&(X!==null&&google.maps.event.removeListener(X),V(google.maps.event.addListener(k,"drag",b)))},[b]),h.useEffect(()=>{var J=new google.maps.Polygon(p2(p2({},t),{},{map:C}));return i&&J.setPath(i),s&&J.setPaths(s),typeof a<"u"&&J.setVisible(a),typeof n<"u"&&J.setEditable(n),typeof r<"u"&&J.setDraggable(r),l&&A(google.maps.event.addListener(J,"dblclick",l)),c&&N(google.maps.event.addListener(J,"dragend",c)),u&&z(google.maps.event.addListener(J,"dragstart",u)),d&&I(google.maps.event.addListener(J,"mousedown",d)),f&&D(google.maps.event.addListener(J,"mousemove",f)),p&&F(google.maps.event.addListener(J,"mouseout",p)),x&&te(google.maps.event.addListener(J,"mouseover",x)),m&&B(google.maps.event.addListener(J,"mouseup",m)),y&&Z(google.maps.event.addListener(J,"rightclick",y)),j&&re(google.maps.event.addListener(J,"click",j)),b&&V(google.maps.event.addListener(J,"drag",b)),S(J),g&&g(J),()=>{_!==null&&google.maps.event.removeListener(_),E!==null&&google.maps.event.removeListener(E),$!==null&&google.maps.event.removeListener($),T!==null&&google.maps.event.removeListener(T),L!==null&&google.maps.event.removeListener(L),O!==null&&google.maps.event.removeListener(O),q!==null&&google.maps.event.removeListener(q),H!==null&&google.maps.event.removeListener(H),K!==null&&google.maps.event.removeListener(K),he!==null&&google.maps.event.removeListener(he),v&&v(J),J.setMap(null)}},[]),null}h.memo(iF);class gm extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[])}componentDidMount(){var t=this.props.options||{};this.polygon=new google.maps.Polygon(t),this.polygon.setMap(this.context),this.registeredEvents=Xe({updaterMap:g2,eventMap:m2,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(t){this.polygon&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:g2,eventMap:m2,prevProps:t,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),Ze(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}ce(gm,"contextType",Ge);function x2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var v2={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},y2={bounds(e,t){e.setBounds(t)},draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},visible(e,t){e.setVisible(t)}};function sF(e){var{options:t,bounds:r,draggable:n,editable:a,visible:i,onDblClick:s,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:f,onMouseOver:p,onMouseUp:x,onRightClick:m,onClick:y,onDrag:j,onBoundsChanged:b,onLoad:g,onUnmount:v}=e,w=h.useContext(Ge),[C,k]=h.useState(null),[S,_]=h.useState(null),[A,E]=h.useState(null),[N,$]=h.useState(null),[z,T]=h.useState(null),[I,L]=h.useState(null),[D,O]=h.useState(null),[F,q]=h.useState(null),[te,H]=h.useState(null),[B,K]=h.useState(null),[Z,he]=h.useState(null),[re,X]=h.useState(null),[V,J]=h.useState(null);return h.useEffect(()=>{C!==null&&C.setMap(w)},[w]),h.useEffect(()=>{typeof t<"u"&&C!==null&&C.setOptions(t)},[C,t]),h.useEffect(()=>{typeof n<"u"&&C!==null&&C.setDraggable(n)},[C,n]),h.useEffect(()=>{typeof a<"u"&&C!==null&&C.setEditable(a)},[C,a]),h.useEffect(()=>{typeof i<"u"&&C!==null&&C.setVisible(i)},[C,i]),h.useEffect(()=>{typeof r<"u"&&C!==null&&C.setBounds(r)},[C,r]),h.useEffect(()=>{C&&s&&(S!==null&&google.maps.event.removeListener(S),_(google.maps.event.addListener(C,"dblclick",s)))},[s]),h.useEffect(()=>{C&&l&&(A!==null&&google.maps.event.removeListener(A),E(google.maps.event.addListener(C,"dragend",l)))},[l]),h.useEffect(()=>{C&&c&&(N!==null&&google.maps.event.removeListener(N),$(google.maps.event.addListener(C,"dragstart",c)))},[c]),h.useEffect(()=>{C&&u&&(z!==null&&google.maps.event.removeListener(z),T(google.maps.event.addListener(C,"mousedown",u)))},[u]),h.useEffect(()=>{C&&d&&(I!==null&&google.maps.event.removeListener(I),L(google.maps.event.addListener(C,"mousemove",d)))},[d]),h.useEffect(()=>{C&&f&&(D!==null&&google.maps.event.removeListener(D),O(google.maps.event.addListener(C,"mouseout",f)))},[f]),h.useEffect(()=>{C&&p&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(C,"mouseover",p)))},[p]),h.useEffect(()=>{C&&x&&(te!==null&&google.maps.event.removeListener(te),H(google.maps.event.addListener(C,"mouseup",x)))},[x]),h.useEffect(()=>{C&&m&&(B!==null&&google.maps.event.removeListener(B),K(google.maps.event.addListener(C,"rightclick",m)))},[m]),h.useEffect(()=>{C&&y&&(Z!==null&&google.maps.event.removeListener(Z),he(google.maps.event.addListener(C,"click",y)))},[y]),h.useEffect(()=>{C&&j&&(re!==null&&google.maps.event.removeListener(re),X(google.maps.event.addListener(C,"drag",j)))},[j]),h.useEffect(()=>{C&&b&&(V!==null&&google.maps.event.removeListener(V),J(google.maps.event.addListener(C,"bounds_changed",b)))},[b]),h.useEffect(()=>{var ne=new google.maps.Rectangle(Qh(Qh({},t),{},{map:w}));return typeof i<"u"&&ne.setVisible(i),typeof a<"u"&&ne.setEditable(a),typeof n<"u"&&ne.setDraggable(n),typeof r<"u"&&ne.setBounds(r),s&&_(google.maps.event.addListener(ne,"dblclick",s)),l&&E(google.maps.event.addListener(ne,"dragend",l)),c&&$(google.maps.event.addListener(ne,"dragstart",c)),u&&T(google.maps.event.addListener(ne,"mousedown",u)),d&&L(google.maps.event.addListener(ne,"mousemove",d)),f&&O(google.maps.event.addListener(ne,"mouseout",f)),p&&q(google.maps.event.addListener(ne,"mouseover",p)),x&&H(google.maps.event.addListener(ne,"mouseup",x)),m&&K(google.maps.event.addListener(ne,"rightclick",m)),y&&he(google.maps.event.addListener(ne,"click",y)),j&&X(google.maps.event.addListener(ne,"drag",j)),b&&J(google.maps.event.addListener(ne,"bounds_changed",b)),k(ne),g&&g(ne),()=>{S!==null&&google.maps.event.removeListener(S),A!==null&&google.maps.event.removeListener(A),N!==null&&google.maps.event.removeListener(N),z!==null&&google.maps.event.removeListener(z),I!==null&&google.maps.event.removeListener(I),D!==null&&google.maps.event.removeListener(D),F!==null&&google.maps.event.removeListener(F),te!==null&&google.maps.event.removeListener(te),B!==null&&google.maps.event.removeListener(B),Z!==null&&google.maps.event.removeListener(Z),re!==null&&google.maps.event.removeListener(re),V!==null&&google.maps.event.removeListener(V),v&&v(ne),ne.setMap(null)}},[]),null}h.memo(sF);let lF=class extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{rectangle:null}),ce(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var t=new google.maps.Rectangle(Qh(Qh({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:y2,eventMap:v2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{rectangle:t}},this.setRectangleCallback)}componentDidUpdate(t){this.state.rectangle!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:y2,eventMap:v2,prevProps:t,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),Ze(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}};ce(lF,"contextType",Ge);function b2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var j2={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},w2={center(e,t){e.setCenter(t)},draggable(e,t){e.setDraggable(t)},editable(e,t){e.setEditable(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},radius(e,t){e.setRadius(t)},visible(e,t){e.setVisible(t)}},cF={};function dF(e){var{options:t,center:r,radius:n,draggable:a,editable:i,visible:s,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:f,onMouseOut:p,onMouseOver:x,onMouseUp:m,onRightClick:y,onClick:j,onDrag:b,onCenterChanged:g,onRadiusChanged:v,onLoad:w,onUnmount:C}=e,k=h.useContext(Ge),[S,_]=h.useState(null),[A,E]=h.useState(null),[N,$]=h.useState(null),[z,T]=h.useState(null),[I,L]=h.useState(null),[D,O]=h.useState(null),[F,q]=h.useState(null),[te,H]=h.useState(null),[B,K]=h.useState(null),[Z,he]=h.useState(null),[re,X]=h.useState(null),[V,J]=h.useState(null),[ne,Q]=h.useState(null),[me,ue]=h.useState(null);return h.useEffect(()=>{S!==null&&S.setMap(k)},[k]),h.useEffect(()=>{typeof t<"u"&&S!==null&&S.setOptions(t)},[S,t]),h.useEffect(()=>{typeof a<"u"&&S!==null&&S.setDraggable(a)},[S,a]),h.useEffect(()=>{typeof i<"u"&&S!==null&&S.setEditable(i)},[S,i]),h.useEffect(()=>{typeof s<"u"&&S!==null&&S.setVisible(s)},[S,s]),h.useEffect(()=>{typeof n=="number"&&S!==null&&S.setRadius(n)},[S,n]),h.useEffect(()=>{typeof r<"u"&&S!==null&&S.setCenter(r)},[S,r]),h.useEffect(()=>{S&&l&&(A!==null&&google.maps.event.removeListener(A),E(google.maps.event.addListener(S,"dblclick",l)))},[l]),h.useEffect(()=>{S&&c&&(N!==null&&google.maps.event.removeListener(N),$(google.maps.event.addListener(S,"dragend",c)))},[c]),h.useEffect(()=>{S&&u&&(z!==null&&google.maps.event.removeListener(z),T(google.maps.event.addListener(S,"dragstart",u)))},[u]),h.useEffect(()=>{S&&d&&(I!==null&&google.maps.event.removeListener(I),L(google.maps.event.addListener(S,"mousedown",d)))},[d]),h.useEffect(()=>{S&&f&&(D!==null&&google.maps.event.removeListener(D),O(google.maps.event.addListener(S,"mousemove",f)))},[f]),h.useEffect(()=>{S&&p&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(S,"mouseout",p)))},[p]),h.useEffect(()=>{S&&x&&(te!==null&&google.maps.event.removeListener(te),H(google.maps.event.addListener(S,"mouseover",x)))},[x]),h.useEffect(()=>{S&&m&&(B!==null&&google.maps.event.removeListener(B),K(google.maps.event.addListener(S,"mouseup",m)))},[m]),h.useEffect(()=>{S&&y&&(Z!==null&&google.maps.event.removeListener(Z),he(google.maps.event.addListener(S,"rightclick",y)))},[y]),h.useEffect(()=>{S&&j&&(re!==null&&google.maps.event.removeListener(re),X(google.maps.event.addListener(S,"click",j)))},[j]),h.useEffect(()=>{S&&b&&(V!==null&&google.maps.event.removeListener(V),J(google.maps.event.addListener(S,"drag",b)))},[b]),h.useEffect(()=>{S&&g&&(ne!==null&&google.maps.event.removeListener(ne),Q(google.maps.event.addListener(S,"center_changed",g)))},[j]),h.useEffect(()=>{S&&v&&(me!==null&&google.maps.event.removeListener(me),ue(google.maps.event.addListener(S,"radius_changed",v)))},[v]),h.useEffect(()=>{var W=new google.maps.Circle(ep(ep({},t||cF),{},{map:k}));return typeof n=="number"&&W.setRadius(n),typeof r<"u"&&W.setCenter(r),typeof n=="number"&&W.setRadius(n),typeof s<"u"&&W.setVisible(s),typeof i<"u"&&W.setEditable(i),typeof a<"u"&&W.setDraggable(a),l&&E(google.maps.event.addListener(W,"dblclick",l)),c&&$(google.maps.event.addListener(W,"dragend",c)),u&&T(google.maps.event.addListener(W,"dragstart",u)),d&&L(google.maps.event.addListener(W,"mousedown",d)),f&&O(google.maps.event.addListener(W,"mousemove",f)),p&&q(google.maps.event.addListener(W,"mouseout",p)),x&&H(google.maps.event.addListener(W,"mouseover",x)),m&&K(google.maps.event.addListener(W,"mouseup",m)),y&&he(google.maps.event.addListener(W,"rightclick",y)),j&&X(google.maps.event.addListener(W,"click",j)),b&&J(google.maps.event.addListener(W,"drag",b)),g&&Q(google.maps.event.addListener(W,"center_changed",g)),v&&ue(google.maps.event.addListener(W,"radius_changed",v)),_(W),w&&w(W),()=>{A!==null&&google.maps.event.removeListener(A),N!==null&&google.maps.event.removeListener(N),z!==null&&google.maps.event.removeListener(z),I!==null&&google.maps.event.removeListener(I),D!==null&&google.maps.event.removeListener(D),F!==null&&google.maps.event.removeListener(F),te!==null&&google.maps.event.removeListener(te),B!==null&&google.maps.event.removeListener(B),Z!==null&&google.maps.event.removeListener(Z),re!==null&&google.maps.event.removeListener(re),ne!==null&&google.maps.event.removeListener(ne),me!==null&&google.maps.event.removeListener(me),C&&C(W),W.setMap(null)}},[]),null}h.memo(dF);class uF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{circle:null}),ce(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var t=new google.maps.Circle(ep(ep({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:w2,eventMap:j2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{circle:t}},this.setCircleCallback)}componentDidUpdate(t){this.state.circle!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:w2,eventMap:j2,prevProps:t,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var t;this.props.onUnmount&&this.props.onUnmount(this.state.circle),Ze(this.registeredEvents),(t=this.state.circle)===null||t===void 0||t.setMap(null)}}render(){return null}}ce(uF,"contextType",Ge);function S2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var k2={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},C2={add(e,t){e.add(t)},addgeojson(e,t,r){e.addGeoJson(t,r)},contains(e,t){e.contains(t)},foreach(e,t){e.forEach(t)},loadgeojson(e,t,r,n){e.loadGeoJson(t,r,n)},overridestyle(e,t,r){e.overrideStyle(t,r)},remove(e,t){e.remove(t)},revertstyle(e,t){e.revertStyle(t)},controlposition(e,t){e.setControlPosition(t)},controls(e,t){e.setControls(t)},drawingmode(e,t){e.setDrawingMode(t)},map(e,t){e.setMap(t)},style(e,t){e.setStyle(t)},togeojson(e,t){e.toGeoJson(t)}};function fF(e){var{options:t,onClick:r,onDblClick:n,onMouseDown:a,onMouseMove:i,onMouseOut:s,onMouseOver:l,onMouseUp:c,onRightClick:u,onAddFeature:d,onRemoveFeature:f,onRemoveProperty:p,onSetGeometry:x,onSetProperty:m,onLoad:y,onUnmount:j}=e,b=h.useContext(Ge),[g,v]=h.useState(null),[w,C]=h.useState(null),[k,S]=h.useState(null),[_,A]=h.useState(null),[E,N]=h.useState(null),[$,z]=h.useState(null),[T,I]=h.useState(null),[L,D]=h.useState(null),[O,F]=h.useState(null),[q,te]=h.useState(null),[H,B]=h.useState(null),[K,Z]=h.useState(null),[he,re]=h.useState(null),[X,V]=h.useState(null);return h.useEffect(()=>{g!==null&&g.setMap(b)},[b]),h.useEffect(()=>{g&&n&&(w!==null&&google.maps.event.removeListener(w),C(google.maps.event.addListener(g,"dblclick",n)))},[n]),h.useEffect(()=>{g&&a&&(k!==null&&google.maps.event.removeListener(k),S(google.maps.event.addListener(g,"mousedown",a)))},[a]),h.useEffect(()=>{g&&i&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(g,"mousemove",i)))},[i]),h.useEffect(()=>{g&&s&&(E!==null&&google.maps.event.removeListener(E),N(google.maps.event.addListener(g,"mouseout",s)))},[s]),h.useEffect(()=>{g&&l&&($!==null&&google.maps.event.removeListener($),z(google.maps.event.addListener(g,"mouseover",l)))},[l]),h.useEffect(()=>{g&&c&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(g,"mouseup",c)))},[c]),h.useEffect(()=>{g&&u&&(L!==null&&google.maps.event.removeListener(L),D(google.maps.event.addListener(g,"rightclick",u)))},[u]),h.useEffect(()=>{g&&r&&(O!==null&&google.maps.event.removeListener(O),F(google.maps.event.addListener(g,"click",r)))},[r]),h.useEffect(()=>{g&&d&&(q!==null&&google.maps.event.removeListener(q),te(google.maps.event.addListener(g,"addfeature",d)))},[d]),h.useEffect(()=>{g&&f&&(H!==null&&google.maps.event.removeListener(H),B(google.maps.event.addListener(g,"removefeature",f)))},[f]),h.useEffect(()=>{g&&p&&(K!==null&&google.maps.event.removeListener(K),Z(google.maps.event.addListener(g,"removeproperty",p)))},[p]),h.useEffect(()=>{g&&x&&(he!==null&&google.maps.event.removeListener(he),re(google.maps.event.addListener(g,"setgeometry",x)))},[x]),h.useEffect(()=>{g&&m&&(X!==null&&google.maps.event.removeListener(X),V(google.maps.event.addListener(g,"setproperty",m)))},[m]),h.useEffect(()=>{if(b!==null){var J=new google.maps.Data(tp(tp({},t),{},{map:b}));n&&C(google.maps.event.addListener(J,"dblclick",n)),a&&S(google.maps.event.addListener(J,"mousedown",a)),i&&A(google.maps.event.addListener(J,"mousemove",i)),s&&N(google.maps.event.addListener(J,"mouseout",s)),l&&z(google.maps.event.addListener(J,"mouseover",l)),c&&I(google.maps.event.addListener(J,"mouseup",c)),u&&D(google.maps.event.addListener(J,"rightclick",u)),r&&F(google.maps.event.addListener(J,"click",r)),d&&te(google.maps.event.addListener(J,"addfeature",d)),f&&B(google.maps.event.addListener(J,"removefeature",f)),p&&Z(google.maps.event.addListener(J,"removeproperty",p)),x&&re(google.maps.event.addListener(J,"setgeometry",x)),m&&V(google.maps.event.addListener(J,"setproperty",m)),v(J),y&&y(J)}return()=>{g&&(w!==null&&google.maps.event.removeListener(w),k!==null&&google.maps.event.removeListener(k),_!==null&&google.maps.event.removeListener(_),E!==null&&google.maps.event.removeListener(E),$!==null&&google.maps.event.removeListener($),T!==null&&google.maps.event.removeListener(T),L!==null&&google.maps.event.removeListener(L),O!==null&&google.maps.event.removeListener(O),q!==null&&google.maps.event.removeListener(q),H!==null&&google.maps.event.removeListener(H),K!==null&&google.maps.event.removeListener(K),he!==null&&google.maps.event.removeListener(he),X!==null&&google.maps.event.removeListener(X),j&&j(g),g.setMap(null))}},[]),null}h.memo(fF);class hF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{data:null}),ce(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var t=new google.maps.Data(tp(tp({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:C2,eventMap:k2,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({data:t}),this.setDataCallback)}}componentDidUpdate(t){this.state.data!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:C2,eventMap:k2,prevProps:t,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),Ze(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}ce(hF,"contextType",Ge);function _2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var E2={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},N2={options(e,t){e.setOptions(t)},url(e,t){e.setUrl(t)},zIndex(e,t){e.setZIndex(t)}};class pF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{kmlLayer:null}),ce(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var t=new google.maps.KmlLayer(A2(A2({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:N2,eventMap:E2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{kmlLayer:t}},this.setKmlLayerCallback)}componentDidUpdate(t){this.state.kmlLayer!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:N2,eventMap:E2,prevProps:t,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),Ze(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}ce(pF,"contextType",Ge);function FP(e,t){return typeof t=="function"?t(e.offsetWidth,e.offsetHeight):{x:0,y:0}}function mF(e,t){return new t(e.lat,e.lng)}function gF(e,t){return new t(new google.maps.LatLng(e.ne.lat,e.ne.lng),new google.maps.LatLng(e.sw.lat,e.sw.lng))}function xF(e,t,r){return e instanceof t?e:r(e,t)}function vF(e,t,r){return e instanceof t?e:r(e,t)}function yF(e,t,r){var n=e&&e.fromLatLngToDivPixel(r.getNorthEast()),a=e&&e.fromLatLngToDivPixel(r.getSouthWest());return n&&a?{left:"".concat(a.x+t.x,"px"),top:"".concat(n.y+t.y,"px"),width:"".concat(n.x-a.x-t.x,"px"),height:"".concat(a.y-n.y-t.y,"px")}:{left:"-9999px",top:"-9999px"}}function bF(e,t,r){var n=e&&e.fromLatLngToDivPixel(r);if(n){var{x:a,y:i}=n;return{left:"".concat(a+t.x,"px"),top:"".concat(i+t.y,"px")}}return{left:"-9999px",top:"-9999px"}}function zP(e,t,r,n){return r!==void 0?yF(e,t,vF(r,google.maps.LatLngBounds,gF)):bF(e,t,xF(n,google.maps.LatLng,mF))}function jF(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.height&&e.height===t.height}function P2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SF(e,t,r,n,a){class i extends google.maps.OverlayView{constructor(l,c,u,d){super(),this.container=l,this.pane=c,this.position=u,this.bounds=d}onAdd(){var l,c=(l=this.getPanes())===null||l===void 0?void 0:l[this.pane];c==null||c.appendChild(this.container)}draw(){var l=this.getProjection(),c=wF({},this.container?FP(this.container,a):{x:0,y:0}),u=zP(l,c,this.bounds,this.position);for(var[d,f]of Object.entries(u))this.container.style[d]=f}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new i(e,t,r,n)}function M2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O2(e){if(!e)return"";var t=e instanceof google.maps.LatLng?e:new google.maps.LatLng(e.lat,e.lng);return t+""}function T2(e){if(!e)return"";var t=e instanceof google.maps.LatLngBounds?e:new google.maps.LatLngBounds(new google.maps.LatLng(e.south,e.east),new google.maps.LatLng(e.north,e.west));return t+""}function CF(e){var{position:t,bounds:r,mapPaneName:n,zIndex:a,onLoad:i,onUnmount:s,getPixelPositionOffset:l,children:c}=e,u=h.useContext(Ge),d=h.useMemo(()=>{var p=document.createElement("div");return p.style.position="absolute",p},[]),f=h.useMemo(()=>SF(d,n,t,r,l),[d,n,t,r]);return h.useEffect(()=>(i==null||i(f),f==null||f.setMap(u),()=>{s==null||s(f),f==null||f.setMap(null)}),[u,f]),h.useEffect(()=>{d.style.zIndex="".concat(a)},[a,d]),Pa.createPortal(c,d)}h.memo(CF);class Mi extends h.PureComponent{constructor(t){super(t),ce(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),ce(this,"updatePane",()=>{var n=this.props.mapPaneName,a=this.overlayView.getPanes();sr(!!n,"OverlayView requires props.mapPaneName but got %s",n),a?this.setState({paneEl:a[n]}):this.setState({paneEl:null})}),ce(this,"onAdd",()=>{var n,a;this.updatePane(),(n=(a=this.props).onLoad)===null||n===void 0||n.call(a,this.overlayView)}),ce(this,"onPositionElement",()=>{var n=this.overlayView.getProjection(),a=kF({x:0,y:0},this.containerRef.current?FP(this.containerRef.current,this.props.getPixelPositionOffset):{}),i=zP(n,a,this.props.bounds,this.props.position);if(!jF(i,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var s,l,c,u;this.setState({containerStyle:{top:(s=i.top)!==null&&s!==void 0?s:0,left:(l=i.left)!==null&&l!==void 0?l:0,width:(c=i.width)!==null&&c!==void 0?c:0,height:(u=i.height)!==null&&u!==void 0?u:0,position:"absolute"}})}}),ce(this,"draw",()=>{this.onPositionElement()}),ce(this,"onRemove",()=>{var n,a;this.setState(()=>({paneEl:null})),(n=(a=this.props).onUnmount)===null||n===void 0||n.call(a,this.overlayView)}),this.containerRef=h.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(t){var r=O2(t.position),n=O2(this.props.position),a=T2(t.bounds),i=T2(this.props.bounds);(r!==n||a!==i)&&this.overlayView.draw(),t.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var t=this.state.paneEl;return t?Pa.createPortal(o.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:h.Children.only(this.props.children)}),t):null}}ce(Mi,"FLOAT_PANE","floatPane");ce(Mi,"MAP_PANE","mapPane");ce(Mi,"MARKER_LAYER","markerLayer");ce(Mi,"OVERLAY_LAYER","overlayLayer");ce(Mi,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");ce(Mi,"contextType",Ge);function _F(){}function L2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var I2={onDblClick:"dblclick",onClick:"click"},$2={opacity(e,t){e.setOpacity(t)}};function AF(e){var{url:t,bounds:r,options:n,visible:a}=e,i=h.useContext(Ge),s=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),l=h.useMemo(()=>new google.maps.GroundOverlay(t,s,n),[]);return h.useEffect(()=>{l!==null&&l.setMap(i)},[i]),h.useEffect(()=>{typeof t<"u"&&l!==null&&(l.set("url",t),l.setMap(i))},[l,t]),h.useEffect(()=>{typeof a<"u"&&l!==null&&l.setOpacity(a?1:0)},[l,a]),h.useEffect(()=>{var c=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&l!==null&&(l.set("bounds",c),l.setMap(i))},[l,r]),null}h.memo(AF);class BP extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{groundOverlay:null}),ce(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){sr(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var t=new google.maps.GroundOverlay(this.props.url,this.props.bounds,D2(D2({},this.props.options),{},{map:this.context}));this.registeredEvents=Xe({updaterMap:$2,eventMap:I2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{groundOverlay:t}},this.setGroundOverlayCallback)}componentDidUpdate(t){this.state.groundOverlay!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:$2,eventMap:I2,prevProps:t,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}ce(BP,"defaultProps",{onLoad:_F});ce(BP,"contextType",Ge);function R2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R2(Object(r),!0).forEach(function(n){ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var F2={},z2={data(e,t){e.setData(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)}};function EF(e){var{data:t,onLoad:r,onUnmount:n,options:a}=e,i=h.useContext(Ge),[s,l]=h.useState(null);return h.useEffect(()=>{google.maps.visualization||sr(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),h.useEffect(()=>{sr(!!t,"data property is required in HeatmapLayer %s",t)},[t]),h.useEffect(()=>{s!==null&&s.setMap(i)},[i]),h.useEffect(()=>{a&&s!==null&&s.setOptions(a)},[s,a]),h.useEffect(()=>{var c=new google.maps.visualization.HeatmapLayer(rp(rp({},a),{},{data:t,map:i}));return l(c),r&&r(c),()=>{s!==null&&(n&&n(s),s.setMap(null))}},[]),null}h.memo(EF);class NF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{heatmapLayer:null}),ce(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){sr(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),sr(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var t=new google.maps.visualization.HeatmapLayer(rp(rp({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=Xe({updaterMap:z2,eventMap:F2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{heatmapLayer:t}},this.setHeatmapLayerCallback)}componentDidUpdate(t){Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:z2,eventMap:F2,prevProps:t,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),Ze(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}ce(NF,"contextType",Ge);var B2={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},U2={register(e,t,r){e.registerPanoProvider(t,r)},links(e,t){e.setLinks(t)},motionTracking(e,t){e.setMotionTracking(t)},options(e,t){e.setOptions(t)},pano(e,t){e.setPano(t)},position(e,t){e.setPosition(t)},pov(e,t){e.setPov(t)},visible(e,t){e.setVisible(t)},zoom(e,t){e.setZoom(t)}};class PF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{streetViewPanorama:null}),ce(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var t,r,n=(t=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&t!==void 0?t:null;this.registeredEvents=Xe({updaterMap:U2,eventMap:B2,prevProps:{},nextProps:this.props,instance:n}),this.setState(()=>({streetViewPanorama:n}),this.setStreetViewPanoramaCallback)}componentDidUpdate(t){this.state.streetViewPanorama!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:U2,eventMap:B2,prevProps:t,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),Ze(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}ce(PF,"contextType",Ge);class MF extends h.PureComponent{constructor(){super(...arguments),ce(this,"state",{streetViewService:null}),ce(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var t=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:t}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}ce(MF,"contextType",Ge);var W2={onDirectionsChanged:"directions_changed"},q2={directions(e,t){e.setDirections(t)},map(e,t){e.setMap(t)},options(e,t){e.setOptions(t)},panel(e,t){e.setPanel(t)},routeIndex(e,t){e.setRouteIndex(t)}};class OF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"state",{directionsRenderer:null}),ce(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var t=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=Xe({updaterMap:q2,eventMap:W2,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{directionsRenderer:t}},this.setDirectionsRendererCallback)}componentDidUpdate(t){this.state.directionsRenderer!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:q2,eventMap:W2,prevProps:t,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),Ze(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}ce(OF,"contextType",Ge);var K2={onPlacesChanged:"places_changed"},G2={bounds(e,t){e.setBounds(t)}};class TF extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"containerElement",h.createRef()),ce(this,"state",{searchBox:null}),ce(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(sr(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var t=this.containerElement.current.querySelector("input");if(t!==null){var r=new google.maps.places.SearchBox(t,this.props.options);this.registeredEvents=Xe({updaterMap:G2,eventMap:K2,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(t){this.state.searchBox!==null&&(Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:G2,eventMap:K2,prevProps:t,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),Ze(this.registeredEvents))}render(){return o.jsx("div",{ref:this.containerElement,children:h.Children.only(this.props.children)})}}ce(TF,"contextType",Ge);var V2={onPlaceChanged:"place_changed"},H2={bounds(e,t){e.setBounds(t)},restrictions(e,t){e.setComponentRestrictions(t)},fields(e,t){e.setFields(t)},options(e,t){e.setOptions(t)},types(e,t){e.setTypes(t)}};class UP extends h.PureComponent{constructor(){super(...arguments),ce(this,"registeredEvents",[]),ce(this,"containerElement",h.createRef()),ce(this,"state",{autocomplete:null}),ce(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var t;sr(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(t=this.containerElement.current)===null||t===void 0?void 0:t.querySelector("input");if(r){var n=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=Xe({updaterMap:H2,eventMap:V2,prevProps:{},nextProps:this.props,instance:n}),this.setState(()=>({autocomplete:n}),this.setAutocompleteCallback)}}componentDidUpdate(t){Ze(this.registeredEvents),this.registeredEvents=Xe({updaterMap:H2,eventMap:V2,prevProps:t,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&Ze(this.registeredEvents)}render(){return o.jsx("div",{ref:this.containerElement,className:this.props.className,children:h.Children.only(this.props.children)})}}ce(UP,"defaultProps",{className:""});ce(UP,"contextType",Ge);let LF={data:""},DF=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||LF,IF=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,$F=/\/\*[^]*?\*\/|  +/g,X2=/\n+/g,oi=(e,t)=>{let r="",n="",a="";for(let i in e){let s=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+s+";":n+=i[1]=="f"?oi(s,i):i+"{"+oi(s,i[1]=="k"?"":t)+"}":typeof s=="object"?n+=oi(s,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=oi.p?oi.p(i,s):i+":"+s+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Xo={},WP=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+WP(e[r]);return t}return e},RF=(e,t,r,n,a)=>{let i=WP(e),s=Xo[i]||(Xo[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Xo[s]){let c=i!==e?e:(u=>{let d,f,p=[{}];for(;d=IF.exec(u.replace($F,""));)d[4]?p.shift():d[3]?(f=d[3].replace(X2," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][d[1]]=d[2].replace(X2," ").trim();return p[0]})(e);Xo[s]=oi(a?{["@keyframes "+s]:c}:c,r?"":"."+s)}let l=r&&Xo.g?Xo.g:null;return r&&(Xo.g=Xo[s]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(Xo[s],t,n,l),s},FF=(e,t,r)=>e.reduce((n,a,i)=>{let s=t[i];if(s&&s.call){let l=s(r),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;s=c?"."+c:l&&typeof l=="object"?l.props?"":oi(l,""):l===!1?"":l}return n+a+(s??"")},"");function xm(e){let t=this||{},r=e.call?e(t.p):e;return RF(r.unshift?r.raw?FF(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,DF(t.target),t.g,t.o,t.k)}let qP,ay,iy;xm.bind({g:1});let Sa=xm.bind({k:1});function zF(e,t,r,n){oi.p=t,qP=e,ay=r,iy=n}function Fi(e,t){let r=this||{};return function(){let n=arguments;function a(i,s){let l=Object.assign({},i),c=l.className||a.className;r.p=Object.assign({theme:ay&&ay()},l),r.o=/ *go\d+/.test(c),l.className=xm.apply(r,n)+(c?" "+c:"");let u=e;return e[0]&&(u=l.as||e,delete l.as),iy&&u[0]&&iy(l),qP(u,l)}return a}}var BF=e=>typeof e=="function",np=(e,t)=>BF(e)?e(t):e,UF=(()=>{let e=0;return()=>(++e).toString()})(),KP=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),WF=20,GP=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,WF)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return GP(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},gh=[],ms={toasts:[],pausedAt:void 0},Xs=e=>{ms=GP(ms,e),gh.forEach(t=>{t(ms)})},qF={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},KF=(e={})=>{let[t,r]=h.useState(ms),n=h.useRef(ms);h.useEffect(()=>(n.current!==ms&&r(ms),gh.push(r),()=>{let i=gh.indexOf(r);i>-1&&gh.splice(i,1)}),[]);let a=t.toasts.map(i=>{var s,l,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((s=e[i.type])==null?void 0:s.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((l=e[i.type])==null?void 0:l.duration)||(e==null?void 0:e.duration)||qF[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...t,toasts:a}},GF=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||UF()}),Ru=e=>(t,r)=>{let n=GF(t,e,r);return Xs({type:2,toast:n}),n.id},or=(e,t)=>Ru("blank")(e,t);or.error=Ru("error");or.success=Ru("success");or.loading=Ru("loading");or.custom=Ru("custom");or.dismiss=e=>{Xs({type:3,toastId:e})};or.remove=e=>Xs({type:4,toastId:e});or.promise=(e,t,r)=>{let n=or.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?np(t.success,a):void 0;return i?or.success(i,{id:n,...r,...r==null?void 0:r.success}):or.dismiss(n),a}).catch(a=>{let i=t.error?np(t.error,a):void 0;i?or.error(i,{id:n,...r,...r==null?void 0:r.error}):or.dismiss(n)}),e};var VF=(e,t)=>{Xs({type:1,toast:{id:e,height:t}})},HF=()=>{Xs({type:5,time:Date.now()})},Id=new Map,XF=1e3,YF=(e,t=XF)=>{if(Id.has(e))return;let r=setTimeout(()=>{Id.delete(e),Xs({type:4,toastId:e})},t);Id.set(e,r)},JF=e=>{let{toasts:t,pausedAt:r}=KF(e);h.useEffect(()=>{if(r)return;let i=Date.now(),s=t.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(c<0){l.visible&&or.dismiss(l.id);return}return setTimeout(()=>or.dismiss(l.id),c)});return()=>{s.forEach(l=>l&&clearTimeout(l))}},[t,r]);let n=h.useCallback(()=>{r&&Xs({type:6,time:Date.now()})},[r]),a=h.useCallback((i,s)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:u}=s||{},d=t.filter(x=>(x.position||u)===(i.position||u)&&x.height),f=d.findIndex(x=>x.id===i.id),p=d.filter((x,m)=>m<f&&x.visible).length;return d.filter(x=>x.visible).slice(...l?[p+1]:[0,p]).reduce((x,m)=>x+(m.height||0)+c,0)},[t]);return h.useEffect(()=>{t.forEach(i=>{if(i.dismissed)YF(i.id,i.removeDelay);else{let s=Id.get(i.id);s&&(clearTimeout(s),Id.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:VF,startPause:HF,endPause:n,calculateOffset:a}}},ZF=Sa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,QF=Sa`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ez=Sa`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,tz=Fi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ZF} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${QF} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ez} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,rz=Sa`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,nz=Fi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${rz} 1s linear infinite;
`,oz=Sa`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,az=Sa`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,iz=Fi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oz} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${az} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,sz=Fi("div")`
  position: absolute;
`,lz=Fi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,cz=Sa`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dz=Fi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${cz} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,uz=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?h.createElement(dz,null,t):t:r==="blank"?null:h.createElement(lz,null,h.createElement(nz,{...n}),r!=="loading"&&h.createElement(sz,null,r==="error"?h.createElement(tz,{...n}):h.createElement(iz,{...n})))},fz=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,hz=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,pz="0%{opacity:0;} 100%{opacity:1;}",mz="0%{opacity:1;} 100%{opacity:0;}",gz=Fi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xz=Fi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,vz=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=KP()?[pz,mz]:[fz(r),hz(r)];return{animation:t?`${Sa(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Sa(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},yz=h.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?vz(e.position||t||"top-center",e.visible):{opacity:0},i=h.createElement(uz,{toast:e}),s=h.createElement(xz,{...e.ariaProps},np(e.message,e));return h.createElement(gz,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:s}):h.createElement(h.Fragment,null,i,s))});zF(h.createElement);var bz=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=h.useCallback(s=>{if(s){let l=()=>{let c=s.getBoundingClientRect().height;n(e,c)};l(),new MutationObserver(l).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return h.createElement("div",{ref:i,className:t,style:r},a)},jz=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:KP()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},wz=xm`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ef=16,M0=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:s})=>{let{toasts:l,handlers:c}=JF(r);return h.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Ef,left:Ef,right:Ef,bottom:Ef,pointerEvents:"none",...i},className:s,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let d=u.position||t,f=c.calculateOffset(u,{reverseOrder:e,gutter:n,defaultPosition:t}),p=jz(d,f);return h.createElement(bz,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?wz:"",style:p},u.type==="custom"?np(u.message,u):a?a(u):h.createElement(yz,{toast:u,position:d}))}))},oe=or;const Sz="modulepreload",kz=function(e){return"/"+e},Y2={},Fu=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=kz(c),c in Y2)return;Y2[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Sz,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((p,x)=>{f.addEventListener("load",p),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return a.then(s=>{for(const l of s||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Cz=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Fu(async()=>{const{default:n}=await Promise.resolve().then(()=>kc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class O0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class _z extends O0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class J2 extends O0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Z2 extends O0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var sy;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(sy||(sy={}));var Az=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class Ez{constructor(t,{headers:r={},customFetch:n,region:a=sy.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Cz(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Az(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=s):typeof s=="string"?(l["Content-Type"]="text/plain",d=s):typeof FormData<"u"&&s instanceof FormData?d=s:(l["Content-Type"]="application/json",d=JSON.stringify(s)));const f=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:d}).catch(y=>{throw new _z(y)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new J2(f);if(!f.ok)throw new Z2(f);let x=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return x==="application/json"?m=yield f.json():x==="application/octet-stream"?m=yield f.blob():x==="text/event-stream"?m=f:x==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Z2||a instanceof J2?a.context:void 0}}})}}var on={},T0={},vm={},zu={},ym={},bm={},Nz=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ic=Nz();const Pz=ic.fetch,VP=ic.fetch.bind(ic),HP=ic.Headers,Mz=ic.Request,Oz=ic.Response,kc=Object.freeze(Object.defineProperty({__proto__:null,Headers:HP,Request:Mz,Response:Oz,default:VP,fetch:Pz},Symbol.toStringTag,{value:"Module"})),Tz=VI(kc);var jm={};Object.defineProperty(jm,"__esModule",{value:!0});let Lz=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};jm.default=Lz;var XP=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bm,"__esModule",{value:!0});const Dz=XP(Tz),Iz=XP(jm);let $z=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Dz.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,l,c;let u=null,d=null,f=null,p=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=b:d=JSON.parse(b))}const y=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),j=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");y&&j&&j.length>1&&(f=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,p=406,x="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const y=await i.text();try{u=JSON.parse(y),Array.isArray(u)&&i.status===404&&(d=[],u=null,p=200,x="OK")}catch{i.status===404&&y===""?(p=204,x="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,p=200,x="OK"),u&&this.shouldThrowOnError)throw new Iz.default(u)}return{error:u,data:d,count:f,status:p,statusText:x}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,l,c;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};bm.default=$z;var Rz=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ym,"__esModule",{value:!0});const Fz=Rz(bm);let zz=class extends Fz.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${u}"; options=${c};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ym.default=zz;var Bz=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zu,"__esModule",{value:!0});const Uz=Bz(ym);let Wz=class extends Uz.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};zu.default=Wz;var qz=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vm,"__esModule",{value:!0});const ed=qz(zu);let Kz=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new ed.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const s=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(s.length>0){const l=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ed.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const s="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ed.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new ed.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ed.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};vm.default=Kz;var wm={},Sm={};Object.defineProperty(Sm,"__esModule",{value:!0});Sm.version=void 0;Sm.version="0.0.0-automated";Object.defineProperty(wm,"__esModule",{value:!0});wm.DEFAULT_HEADERS=void 0;const Gz=Sm;wm.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Gz.version}`};var YP=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T0,"__esModule",{value:!0});const Vz=YP(vm),Hz=YP(zu),Xz=wm;let Yz=class JP{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},Xz.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Vz.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new JP(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let s;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{l.searchParams.append(d,f)})):(s="POST",c=r);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new Hz.default({method:s,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};T0.default=Yz;var Cc=un&&un.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(on,"__esModule",{value:!0});on.PostgrestError=on.PostgrestBuilder=on.PostgrestTransformBuilder=on.PostgrestFilterBuilder=on.PostgrestQueryBuilder=on.PostgrestClient=void 0;const ZP=Cc(T0);on.PostgrestClient=ZP.default;const QP=Cc(vm);on.PostgrestQueryBuilder=QP.default;const eM=Cc(zu);on.PostgrestFilterBuilder=eM.default;const tM=Cc(ym);on.PostgrestTransformBuilder=tM.default;const rM=Cc(bm);on.PostgrestBuilder=rM.default;const nM=Cc(jm);on.PostgrestError=nM.default;var Jz=on.default={PostgrestClient:ZP.default,PostgrestQueryBuilder:QP.default,PostgrestFilterBuilder:eM.default,PostgrestTransformBuilder:tM.default,PostgrestBuilder:rM.default,PostgrestError:nM.default};const{PostgrestClient:Zz,PostgrestQueryBuilder:Gse,PostgrestFilterBuilder:Vse,PostgrestTransformBuilder:Hse,PostgrestBuilder:Xse,PostgrestError:Yse}=Jz;function Qz(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const eB=Qz(),tB="2.11.15",rB=`realtime-js/${tB}`,nB="1.0.0",oM=1e4,oB=1e3;var $d;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})($d||($d={}));var Or;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Or||(Or={}));var xo;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(xo||(xo={}));var ly;(function(e){e.websocket="websocket"})(ly||(ly={}));var ls;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ls||(ls={}));class aB{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const l=n.decode(t.slice(s,s+a));s=s+a;const c=n.decode(t.slice(s,s+i));s=s+i;const u=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class aM{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var yt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(yt||(yt={}));const Q2=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=iB(s,e,t,a),i),{})},iB=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?iM(i,s):cy(s)},iM=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return dB(t,r)}switch(e){case yt.bool:return sB(t);case yt.float4:case yt.float8:case yt.int2:case yt.int4:case yt.int8:case yt.numeric:case yt.oid:return lB(t);case yt.json:case yt.jsonb:return cB(t);case yt.timestamp:return uB(t);case yt.abstime:case yt.date:case yt.daterange:case yt.int4range:case yt.int8range:case yt.money:case yt.reltime:case yt.text:case yt.time:case yt.timestamptz:case yt.timetz:case yt.tsrange:case yt.tstzrange:return cy(t);default:return cy(t)}},cy=e=>e,sB=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},lB=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},cB=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},dB=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(l=>iM(t,l))}return e},uB=e=>typeof e=="string"?e.replace(" ","T"):e,sM=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class sx{constructor(t,r,n={},a=oM){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ek;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ek||(ek={}));class Rd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rd.syncState(this.state,a,i,s),this.pendingDiffs.forEach(c=>{this.state=Rd.syncDiff(this.state,c,i,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Rd.syncDiff(this.state,a,i,s),l())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),l={},c={};return this.map(i,(u,d)=>{s[u]||(c[u]=d)}),this.map(s,(u,d)=>{const f=i[u];if(f){const p=d.map(j=>j.presence_ref),x=f.map(j=>j.presence_ref),m=d.filter(j=>x.indexOf(j.presence_ref)<0),y=f.filter(j=>p.indexOf(j.presence_ref)<0);m.length>0&&(l[u]=m),y.length>0&&(c[u]=y)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(x=>x.presence_ref),p=d.filter(x=>f.indexOf(x.presence_ref)<0);t[l].unshift(...p)}n(l,d,c)}),this.map(s,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,a(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tk;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(tk||(tk={}));var rk;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(rk||(rk={}));var ea;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ea||(ea={}));class L0{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Or.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new sx(this,xo.join,this.params,this.timeout),this.rejoinTimer=new aM(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Or.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Or.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this._on(xo.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Rd(this),this.broadcastEndpointURL=sM(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Or.closed){const{config:{broadcast:i,presence:s,private:l}}=this.params;this._onError(d=>t==null?void 0:t(ea.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(ea.CLOSED));const c={},u={broadcast:i,presence:s,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var f;if(this.socket.setAuth(),d===void 0){t==null||t(ea.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,x=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,m=[];for(let y=0;y<x;y++){const j=p[y],{filter:{event:b,schema:g,table:v,filter:w}}=j,C=d&&d[y];if(C&&C.event===b&&C.schema===g&&C.table===v&&C.filter===w)m.push(Object.assign(Object.assign({},j),{id:C.id}));else{this.unsubscribe(),this.state=Or.errored,t==null||t(ea.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(ea.SUBSCRIBED);return}}).receive("error",d=>{this.state=Or.errored,t==null||t(ea.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ea.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Or.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(xo.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new sx(this,xo.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new sx(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=xo;if(n&&[l,c,u,d].indexOf(s)>=0&&n!==this._joinRef())return;let p=this._onMessage(s,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var m,y,j;return((m=x.filter)===null||m===void 0?void 0:m.event)==="*"||((j=(y=x.filter)===null||y===void 0?void 0:y.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===s}).map(x=>x.callback(p,n)):(i=this.bindings[s])===null||i===void 0||i.filter(x=>{var m,y,j,b,g,v;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in x){const w=x.id,C=(m=x.filter)===null||m===void 0?void 0:m.event;return w&&((y=r.ids)===null||y===void 0?void 0:y.includes(w))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((j=r.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const w=(g=(b=x==null?void 0:x.filter)===null||b===void 0?void 0:b.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return w==="*"||w===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===s}).map(x=>{if(typeof p=="object"&&"ids"in p){const m=p.data,{schema:y,table:j,commit_timestamp:b,type:g,errors:v}=m;p=Object.assign(Object.assign({},{schema:y,table:j,commit_timestamp:b,eventType:g,new:{},old:{},errors:v}),this._getPayloadRecords(m))}x.callback(p,n)})}_isClosed(){return this.state===Or.closed}_isJoined(){return this.state===Or.joined}_isJoining(){return this.state===Or.joining}_isLeaving(){return this.state===Or.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&L0.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(xo.close,{},t)}_onError(t){this._on(xo.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Or.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Q2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Q2(t.columns,t.old_record)),r}}const nk=()=>{},fB=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hB{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=oM,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nk,this.ref=0,this.logger=nk,this.conn=null,this.sendBuffer=[],this.serializer=new aB,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...l)=>Fu(async()=>{const{default:c}=await Promise.resolve().then(()=>kc);return{default:c}},void 0).then(({default:c})=>c(...l)):s=fetch,(...l)=>s(...l)},this.endPoint=`${t}/${ly.websocket}`,this.httpEndpoint=sM(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,s)=>s(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new aM(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=eB),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:nB}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case $d.connecting:return ls.Connecting;case $d.open:return ls.Open;case $d.closing:return ls.Closing;default:return ls.Closed}}isConnected(){return this.connectionState()===ls.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new L0(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:rB};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(xo.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(oB,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:s}=r;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${s&&"("+s+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(n)).forEach(l=>l._trigger(a,i,s)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(xo.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([fB],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class D0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ur(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class pB extends D0{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class dy extends D0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var mB=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const lM=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Fu(async()=>{const{default:n}=await Promise.resolve().then(()=>kc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},gB=()=>mB(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Fu(()=>Promise.resolve().then(()=>kc),void 0)).Response:Response}),uy=e=>{if(Array.isArray(e))return e.map(r=>uy(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=uy(n)}),t};var Ys=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const lx=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),xB=(e,t,r)=>Ys(void 0,void 0,void 0,function*(){const n=yield gB();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new pB(lx(a),e.status||500))}).catch(a=>{t(new dy(lx(a),a))}):t(new dy(lx(e),e))}),vB=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function Bu(e,t,r,n,a,i){return Ys(this,void 0,void 0,function*(){return new Promise((s,l)=>{e(r,vB(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>xB(c,l,n))})})}function op(e,t,r,n){return Ys(this,void 0,void 0,function*(){return Bu(e,"GET",t,r,n)})}function Qa(e,t,r,n,a){return Ys(this,void 0,void 0,function*(){return Bu(e,"POST",t,n,a,r)})}function yB(e,t,r,n,a){return Ys(this,void 0,void 0,function*(){return Bu(e,"PUT",t,n,a,r)})}function bB(e,t,r,n){return Ys(this,void 0,void 0,function*(){return Bu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function cM(e,t,r,n,a){return Ys(this,void 0,void 0,function*(){return Bu(e,"DELETE",t,n,a,r)})}var Qr=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const jB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ok={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wB{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=lM(a)}uploadOrUpdate(t,r,n,a){return Qr(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},ok),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:l},s!=null&&s.duplex?{duplex:s.duplex}:{})),p=yield f.json();return f.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Qr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:ok.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(c){if(ur(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Qr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Qa(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),l=s.searchParams.get("token");if(!l)throw new D0("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}update(t,r,n){return Qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Qr(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Qr(this,void 0,void 0,function*(){try{return{data:{path:(yield Qa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Qr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Qa(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Qr(this,void 0,void 0,function*(){try{const a=yield Qa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}download(t,r){return Qr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield op(this.fetch,`${this.url}/${a}/${l}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ur(l))return{data:null,error:l};throw l}})}info(t){return Qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield op(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:uy(n),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}exists(t){return Qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield bB(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ur(n)&&n instanceof dy){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return Qr(this,void 0,void 0,function*(){try{return{data:yield cM(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ur(r))return{data:null,error:r};throw r}})}list(t,r,n){return Qr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},jB),r),{prefix:t||""});return{data:yield Qa(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const SB="2.7.1",kB={"X-Client-Info":`storage-js/${SB}`};var al=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class CB{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},kB),r),this.fetch=lM(n)}listBuckets(){return al(this,void 0,void 0,function*(){try{return{data:yield op(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ur(t))return{data:null,error:t};throw t}})}getBucket(t){return al(this,void 0,void 0,function*(){try{return{data:yield op(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ur(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return al(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return al(this,void 0,void 0,function*(){try{return{data:yield yB(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}emptyBucket(t){return al(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ur(r))return{data:null,error:r};throw r}})}deleteBucket(t){return al(this,void 0,void 0,function*(){try{return{data:yield cM(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ur(r))return{data:null,error:r};throw r}})}}class _B extends CB{constructor(t,r={},n){super(t,r,n)}from(t){return new wB(this.url,this.headers,t,this.fetch)}}const AB="2.52.0";let vd="";typeof Deno<"u"?vd="deno":typeof document<"u"?vd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vd="react-native":vd="node";const EB={"X-Client-Info":`supabase-js-${vd}/${AB}`},NB={headers:EB},PB={schema:"public"},MB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},OB={};var TB=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const LB=e=>{let t;return e?t=e:typeof fetch>"u"?t=VP:t=fetch,(...r)=>t(...r)},DB=()=>typeof Headers>"u"?HP:Headers,IB=(e,t,r)=>{const n=LB(r),a=DB();return(i,s)=>TB(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new a(s==null?void 0:s.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},s),{headers:u}))})};var $B=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};function RB(e){return e.endsWith("/")?e:e+"/"}function FB(e,t){var r,n;const{db:a,auth:i,realtime:s,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,p={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),s),global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>$B(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const dM="2.71.1",ml=30*1e3,fy=3,cx=fy*ml,zB="http://localhost:9999",BB="supabase.auth.token",UB={"X-Client-Info":`gotrue-js/${dM}`},hy="X-Supabase-Api-Version",uM={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},WB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,qB=10*60*1e3;class I0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class KB extends I0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function GB(e){return Ke(e)&&e.name==="AuthApiError"}class fM extends I0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class zi extends I0{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Xa extends zi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VB(e){return Ke(e)&&e.name==="AuthSessionMissingError"}class Nf extends zi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pf extends zi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Mf extends zi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function HB(e){return Ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class ak extends zi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class py extends zi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function dx(e){return Ke(e)&&e.name==="AuthRetryableFetchError"}class ik extends zi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class my extends zi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sk=` 	
\r=`.split(""),XB=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<sk.length;t+=1)e[sk[t].charCodeAt(0)]=-2;for(let t=0;t<ap.length;t+=1)e[ap[t].charCodeAt(0)]=t;return e})();function lk(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ap[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ap[n]),t.queuedBits-=6}}function hM(e,t,r){const n=XB[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ck(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{ZB(s,n,r)};for(let s=0;s<e.length;s+=1)hM(e.charCodeAt(s),a,i);return t.join("")}function YB(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function JB(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}YB(n,t)}}function ZB(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function QB(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)hM(e.charCodeAt(a),r,n);return new Uint8Array(t)}function e8(e){const t=[];return JB(e,r=>t.push(r)),new Uint8Array(t)}function t8(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>lk(a,r,n)),lk(null,r,n),t.join("")}function r8(e){return Math.round(Date.now()/1e3)+e}function n8(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const co=()=>typeof window<"u"&&typeof document<"u",Yi={tested:!1,writable:!1},pM=()=>{if(!co())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Yi.tested)return Yi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Yi.tested=!0,Yi.writable=!0}catch{Yi.tested=!0,Yi.writable=!1}return Yi.writable};function o8(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const mM=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Fu(async()=>{const{default:n}=await Promise.resolve().then(()=>kc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},a8=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",gl=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ji=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ba=async(e,t)=>{await e.removeItem(t)};class km{constructor(){this.promise=new km.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}km.promiseConstructor=Promise;function ux(e){const t=e.split(".");if(t.length!==3)throw new my("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!WB.test(t[n]))throw new my("JWT not in base64url format");return{header:JSON.parse(ck(t[0])),payload:JSON.parse(ck(t[1])),signature:QB(t[2]),raw:{header:t[0],payload:t[1]}}}async function i8(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function s8(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function l8(e){return("0"+e.toString(16)).substr(-2)}function c8(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,l8).join("")}async function d8(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function u8(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await d8(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function il(e,t,r=!1){const n=c8();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await gl(e,`${t}-code-verifier`,a);const i=await u8(n);return[i,n===i?"plain":"s256"]}const f8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function h8(e){const t=e.headers.get(hy);if(!t||!t.match(f8))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function p8(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function m8(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const g8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function sl(e){if(!g8.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fx(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dk(e){return JSON.parse(JSON.stringify(e))}var x8=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const ns=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),v8=[502,503,504];async function uk(e){var t;if(!a8(e))throw new py(ns(e),0);if(v8.includes(e.status))throw new py(ns(e),e.status);let r;try{r=await e.json()}catch(i){throw new fM(ns(i),i)}let n;const a=h8(e);if(a&&a.getTime()>=uM["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new ik(ns(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Xa}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new ik(ns(r),e.status,r.weak_password.reasons);throw new KB(ns(r),e.status||500,n)}const y8=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ye(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[hy]||(i[hy]=uM["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await b8(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function b8(e,t,r,n,a,i){const s=y8(t,n,a,i);let l;try{l=await e(r,Object.assign({},s))}catch(c){throw console.error(c),new py(ns(c),0)}if(l.ok||await uk(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await uk(c)}}function Zo(e){var t;let r=null;k8(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=r8(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function fk(e){const t=Zo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ai(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function j8(e){return{data:e,error:null}}function w8(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=x8(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function S8(e){return e}function k8(e){return e.access_token&&e.refresh_token&&e.expires_in}const hx=["global","local","others"];var C8=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class _8{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=mM(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=hx[0]){if(hx.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hx.join(", ")}`);try{return await Ye(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ai})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=C8(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:w8,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ke(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ye(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ai})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:S8});if(d.error)throw d.error;const f=await d.json(),p=(s=d.headers.get("x-total-count"))!==null&&s!==void 0?s:0,x=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return x.length>0&&(x.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(m.split(";")[1].split("=")[1]);u[`${j}Page`]=y}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Ke(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){sl(t);try{return await Ye(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ai})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){sl(t);try{return await Ye(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ai})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){sl(t);try{return await Ye(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ai})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){sl(t.userId);try{const{data:r,error:n}=await Ye(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _deleteFactor(t){sl(t.userId),sl(t.id);try{return{data:await Ye(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}}function hk(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function A8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ll={debug:!!(globalThis&&pM()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gM extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class E8 extends gM{}async function N8(e,t,r){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ll.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new E8(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ll.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}A8();const P8={url:zB,storageKey:BB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function pk(e,t,r){return await r()}const cl={};class hu{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=hu.nextInstanceID,hu.nextInstanceID+=1,this.instanceID>0&&co()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},P8),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new _8({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=mM(a.fetch),this.lock=a.lock||pk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:co()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=N8:this.lock=pk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:pM()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hk(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=hk(this.memoryStorage)),co()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=cl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){cl[this.storageKey]=Object.assign(Object.assign({},cl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=cl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){cl[this.storageKey]=Object.assign(Object.assign({},cl[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dM}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=o8(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),co()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),HB(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ke(r)?{error:r}:{error:new fM("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Zo}),{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ke(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:d,password:f,options:p}=t;let x=null,m=null;this.flowType==="pkce"&&([x,m]=await il(this.storage,this.storageKey)),i=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:x,code_challenge_method:m},xform:Zo})}else if("phone"in t){const{phone:d,password:f,options:p}=t;i=await Ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Zo})}else throw new Pf("You must provide either an email or phone number and a password");const{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ke(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:l}=t;r=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fk})}else if("phone"in t){const{phone:i,password:s,options:l}=t;r=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fk})}else throw new Pf("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Nf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,s,l,c,u,d,f,p,x;let m,y;if("message"in t)m=t.message,y=t.signature;else{const{chain:j,wallet:b,statement:g,options:v}=t;let w;if(co())if(typeof b=="object")w=b;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))w=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=b}const C=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const k=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),g?{statement:g}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)m=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),y=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${C.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(a=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((s=v==null?void 0:v.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(d=v==null?void 0:v.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await w.signMessage(new TextEncoder().encode(m),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=k}}try{const{data:j,error:b}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:t8(y)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Zo});if(b)throw b;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new Nf}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:b})}catch(j){if(Ke(j))return{data:{user:null,session:null},error:j};throw j}}async _exchangeCodeForSession(t){const r=await Ji(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Zo});if(await Ba(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Nf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Ke(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,l=await Ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Zo}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Nf}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await il(this.storage,this.storageKey));const{error:f}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Pf("You must provide either an email or phone number.")}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await Ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Zo});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,u=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await il(this.storage,this.storageKey)),await Ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:j8})}catch(i){if(Ke(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Xa;const{error:a}=await Ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:l}=await Ye(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:l}}throw new Pf("You must provide either an email or phone number and a type")}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ji(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<cx:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await Ji(this.userStorage,this.storageKey+"-user");s!=null&&s.user?t.user=s.user:t.user=fx()}if(this.storage.isServer&&t.user){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!s&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ai}):await this._useSession(async r=>{var n,a,i;const{data:s,error:l}=r;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xa}:await Ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ai})})}catch(r){if(Ke(r))return VB(r)&&(await this._removeSession(),await Ba(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Xa;const s=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await il(this.storage,this.storageKey));const{data:u,error:d}=await Ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:ai});if(d)throw d;return s.user=u.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Ke(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Xa;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=ux(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ke(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:l}=r;if(l)throw l;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Xa;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ke(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!co())throw new Mf("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Mf(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ak("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ak("No code detected.");const{data:g,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!s||!u)throw new Mf("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let p=d+f;c&&(p=parseInt(c));const x=p-d;x*1e3<=ml&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${f}s`);const m=p-f;d-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,p,d):d-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,p,d);const{data:y,error:j}=await this._getUser(i);if(j)throw j;const b={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:s,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(n){if(Ke(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ji(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,t);if(l&&!(GB(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Ba(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=n8(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await il(this.storage,this.storageKey,!0));try{return await Ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Ke(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,l,c,u,d;const{data:f,error:p}=i;if(p)throw p;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ye(this.fetch,"GET",x,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return co()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ke(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Ye(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await s8(async a=>(a>0&&await i8(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Zo})),(a,i)=>{const s=200*Math.pow(2,a);return i&&dx(i)&&Date.now()+s-n<ml})}catch(n){if(this._debug(r,"error",n),Ke(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),co()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ji(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Ji(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await gl(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s==null?void 0:s.user)!==null&&t!==void 0?t:fx()}else if(a&&!a.user&&!a.user){const s=await Ji(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await Ba(this.storage,this.storageKey+"-user"),await gl(this.storage,this.storageKey,a)):a.user=fx()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cx;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${cx}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),dx(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(a.access_token);!l&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Xa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new km;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Xa;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Ke(i)){const s={session:null,error:i};return dx(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(s),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await gl(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=dk(a);await gl(this.storage,this.storageKey,i)}else{const a=dk(r);await gl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ba(this.storage,this.storageKey),await Ba(this.storage,this.storageKey+"-code-verifier"),await Ba(this.storage,this.storageKey+"-user"),this.userStorage&&await Ba(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&co()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ml);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/ml);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ml}ms, refresh threshold is ${fy} ticks`),a<=fy&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof gM)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!co()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await il(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Ye(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Ye(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:l}=await Ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:l})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Ye(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ke(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=ux(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+qB>a)return n;const{data:i,error:s}=await Ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:x,error:m}=await this.getSession();if(m||!x.session)return{data:null,error:m};n=x.session.access_token}const{header:a,payload:i,signature:s,raw:{header:l,payload:c}}=ux(n);r!=null&&r.allowExpired||p8(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:i,header:a,signature:s},error:null}}const d=m8(a.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,s,e8(`${l}.${c}`)))throw new my("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Ke(n))return{data:null,error:n};throw n}}}hu.nextInstanceID=0;const M8=hu;class O8 extends M8{constructor(t){super(t)}}var T8=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(d){try{u(n.next(d))}catch(f){s(f)}}function c(d){try{u(n.throw(d))}catch(f){s(f)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};class L8{constructor(t,r,n){var a,i,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=RB(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:PB,realtime:OB,auth:Object.assign(Object.assign({},MB),{storageKey:u}),global:NB},f=FB(n??{},d);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=f.auth)!==null&&s!==void 0?s:{},this.headers,f.global.fetch),this.fetch=IB(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Zz(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new Ez(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new _B(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return T8(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:s,lock:l,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new O8({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:s,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new hB(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Br=(e,t,r)=>new L8(e,t,r),se=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});function xM(){const[e,t]=h.useState(null),[r,n]=h.useState(!0);return h.useEffect(()=>{const a=localStorage.getItem("user");a&&t({user:JSON.parse(a),expires_at:0}),se.auth.getSession().then(({data:{session:s}})=>{s!=null&&s.user&&s.user.app_metadata.provider==="google"&&(t(s),se.from("Users").upsert({email:s.user.email},{onConflict:"email"}).then(({error:l})=>{l&&console.error("Error storing OAuth user:",l)})),n(!1)});const{data:{subscription:i}}=se.auth.onAuthStateChange((s,l)=>{l!=null&&l.user&&l.user.app_metadata.provider==="google"&&(t(l),se.from("Users").upsert({email:l.user.email},{onConflict:"email"}).then(({error:c})=>{c&&console.error("Error storing OAuth user:",c)}))});return()=>i.unsubscribe()},[]),{session:e,loading:r}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var D8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),it=(e,t)=>{const r=h.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:l="",children:c,...u},d)=>h.createElement("svg",{ref:d,...D8,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${I8(e)}`,l].join(" "),...u},[...t.map(([f,p])=>h.createElement(f,p)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=it("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=it("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=it("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=it("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=it("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=it("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=it("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=it("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=it("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=it("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=it("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=it("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=it("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=it("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=it("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=it("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=it("MinusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=it("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=it("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=it("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=it("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=it("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=it("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=it("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=it("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=it("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=it("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=it("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=it("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=it("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=it("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=it("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function e7(){return o.jsxs("div",{className:"min-h-screen flex flex-col",children:[o.jsx("header",{className:"py-6 px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("img",{src:"/moray-logo.png",alt:"Agrcola Moray",className:"h-10 w-auto"}),o.jsx("h1",{className:"ml-3 text-xl font-bold",children:"Agrcola Moray"})]}),o.jsx(ni,{to:"/login",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors",children:"Iniciar Sesin"})]})}),o.jsx("main",{className:"flex-grow",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Sistema de Gestin Agrcola"}),o.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Monitoreo en tiempo real, gestin de cultivos y anlisis de datos para optimizar su produccin agrcola."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg text-center",children:[o.jsx(H8,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Mapeo Interactivo"}),o.jsx("p",{className:"text-gray-400",children:"Visualice sus cultivos y monitoree el estado de cada tnel en tiempo real."})]}),o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg text-center",children:[o.jsx(W8,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Registro de Muestreos"}),o.jsx("p",{className:"text-gray-400",children:"Gestione los datos de plagas, nutricin, riego y cosecha de manera eficiente."})]}),o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg text-center",children:[o.jsx(R8,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Reportes y Anlisis"}),o.jsx("p",{className:"text-gray-400",children:"Obtenga insights valiosos a travs de reportes detallados y anlisis de datos."})]})]})]})}),o.jsx("footer",{className:"bg-[#1A1A1A] py-8",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-400",children:o.jsxs("p",{children:[" ",new Date().getFullYear()," Agrcola Moray. Todos los derechos reservados."]})})})]})}function t7(){return o.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-white text-xl font-medium",children:"Cargando aplicacin..."})]})})}const r7={},Sk=e=>{let t;const r=new Set,n=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const x=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(m=>m(t,x))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(r7?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,a,c);return c},n7=e=>e?Sk(e):Sk;var yM={exports:{}},bM={},jM={exports:{}},wM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sc=h;function o7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var a7=typeof Object.is=="function"?Object.is:o7,i7=sc.useState,s7=sc.useEffect,l7=sc.useLayoutEffect,c7=sc.useDebugValue;function d7(e,t){var r=t(),n=i7({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return l7(function(){a.value=r,a.getSnapshot=t,px(a)&&i({inst:a})},[e,r,t]),s7(function(){return px(a)&&i({inst:a}),e(function(){px(a)&&i({inst:a})})},[e]),c7(r),r}function px(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!a7(e,r)}catch{return!0}}function u7(e,t){return t()}var f7=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u7:d7;wM.useSyncExternalStore=sc.useSyncExternalStore!==void 0?sc.useSyncExternalStore:f7;jM.exports=wM;var h7=jM.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _m=h,p7=h7;function m7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var g7=typeof Object.is=="function"?Object.is:m7,x7=p7.useSyncExternalStore,v7=_m.useRef,y7=_m.useEffect,b7=_m.useMemo,j7=_m.useDebugValue;bM.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=v7(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=b7(function(){function c(x){if(!u){if(u=!0,d=x,x=n(x),a!==void 0&&s.hasValue){var m=s.value;if(a(m,x))return f=m}return f=x}if(m=f,g7(d,x))return m;var y=n(x);return a!==void 0&&a(m,y)?(d=x,m):(d=x,f=y)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var l=x7(e,i[0],i[1]);return y7(function(){s.hasValue=!0,s.value=l},[l]),j7(l),l};yM.exports=bM;var SM=yM.exports;const w7=no(SM),kM={},{useDebugValue:S7}=zn,{useSyncExternalStoreWithSelector:k7}=w7;let kk=!1;const C7=e=>e;function _7(e,t=C7,r){(kM?"production":void 0)!=="production"&&r&&!kk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),kk=!0);const n=k7(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return S7(n),n}const Ck=e=>{(kM?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?n7(e):e,r=(n,a)=>_7(t,n,a);return Object.assign(r,t),r},A7=e=>e?Ck(e):Ck;function E7(){try{const e=localStorage.getItem("user");return e?{is_admin:!1,is_active:!0,role_id:null,name:null,...JSON.parse(e)}:null}catch{return null}}function N7(){try{const e=localStorage.getItem("permissions");return e?JSON.parse(e):null}catch{return null}}async function _k(e){if(e.is_admin)return{roleKeys:[],overrides:[],roleActionPerms:[]};if(!e.role_id)return{roleKeys:[],overrides:[],roleActionPerms:[]};const[{data:t,error:r},{data:n,error:a},{data:i,error:s}]=await Promise.all([se.from("role_nav_permissions").select("nav_key").eq("role_id",e.role_id).eq("can_view",!0),se.from("user_nav_overrides").select("id, user_id, nav_key, can_view").eq("user_id",e.id),se.from("role_action_permissions").select("action_key, can_execute").eq("role_id",e.role_id)]);return r&&console.error("[useAuthStore] role_nav_permissions:",r),a&&console.error("[useAuthStore] user_nav_overrides:",a),s&&console.error("[useAuthStore] role_action_permissions:",s),{roleKeys:(t??[]).map(l=>l.nav_key),overrides:n??[],roleActionPerms:i??[]}}const Of=E7(),Vo=A7((e,t)=>{var r;return{user:Of,allowedTabs:((r=Of==null?void 0:Of.tabs)==null?void 0:r.split(",").map(n=>n.trim()))??[],permissions:N7(),setUser:n=>{var a;n?localStorage.setItem("user",JSON.stringify(n)):localStorage.removeItem("user"),e({user:n,allowedTabs:((a=n==null?void 0:n.tabs)==null?void 0:a.split(",").map(i=>i.trim()))??[]})},login:async(n,a)=>{var d;const{data:i,error:s}=await se.from("Users").select("*").eq("email",n).eq("password",a).single();if(s||!i)throw new Error("Credenciales incorrectas");const l=i,c={id:l.ID,email:l.email,password:l.password,name:l.name??null,tabs:l.tabs??"",role_id:l.role_id??null,is_active:l.is_active!==!1,is_admin:l.is_admin===!0,created_at:l.created_at};if(c.is_active===!1)throw new Error("Esta cuenta est desactivada. Contacta al administrador.");const u=await _k(c);localStorage.setItem("user",JSON.stringify(c)),localStorage.setItem("permissions",JSON.stringify(u)),e({user:c,allowedTabs:((d=c.tabs)==null?void 0:d.split(",").map(f=>f.trim()))??[],permissions:u})},logout:async()=>{localStorage.removeItem("user"),localStorage.removeItem("permissions"),e({user:null,allowedTabs:[],permissions:null}),window.location.reload()},refreshPermissions:async()=>{const{user:n}=t();if(!n)return;const a=await _k(n);localStorage.setItem("permissions",JSON.stringify(a)),e({permissions:a})}}});function P7(){const[e,t]=h.useState(""),[r,n]=h.useState(""),[a,i]=h.useState(!1),[s,l]=h.useState(!1),[c,u]=h.useState(!1);Sc();const d=Vo(p=>p.login),f=async p=>{p.preventDefault(),l(!0);try{await d(e,r),u(!0),setTimeout(()=>{window.location.href="/#/app/mapa",window.location.reload()},700)}catch(x){console.error(x),oe.error("Correo o contrasea incorrectos")}finally{l(!1)}};return o.jsxs(o.Fragment,{children:[c&&o.jsx(t7,{}),o.jsxs("div",{className:"login-page min-h-screen flex items-center justify-center px-4 relative overflow-hidden",children:[o.jsx("div",{className:"login-waves absolute inset-0 z-0"}),o.jsxs("div",{className:"w-full max-w-md z-10",children:[o.jsx("h1",{className:"text-center text-4xl font-bold text-white mb-8",children:"Agrcola Moray"}),o.jsx("div",{className:"bg-[#1A1A1A] p-8 rounded-lg",children:o.jsxs("form",{onSubmit:f,className:"space-y-6",autoComplete:"on",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm text-white mb-1",children:"Correo electrnico"}),o.jsx("input",{id:"email",type:"email",autoComplete:"email",value:e,onChange:p=>t(p.target.value),className:"w-full bg-[#262626] border border-[#404040] rounded-md p-2 text-white",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm text-white mb-1",children:"Contrasea"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"password",type:a?"text":"password",autoComplete:"current-password",value:r,onChange:p=>n(p.target.value),className:"w-full bg-[#262626] border border-[#404040] rounded-md p-2 pr-10 text-white",required:!0}),o.jsx("button",{type:"button",onClick:()=>i(p=>!p),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:a?"":""})]})]}),o.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 transition",children:s?"Iniciando sesin":"Iniciar sesin"})]})})]})]})]})}const M7={"exportacion.kanban.advance_without_docs":!0,"exportacion.embarque.edit":!0,"exportacion.embarque.delete":!0,"exportacion.catalogos.edit":!0,"cosecha.corte.delete":!0,"cosecha.merma.delete":!0,"inventario.ajuste.negativo":!0,"inventario.item.delete":!0,"personal.baja":!0,"plagas.aplicacion.delete":!0,"usuarios.delete":!0};function _c(){const{user:e,permissions:t}=Vo(),r=h.useCallback(l=>{if(!e)return!1;if(e.is_admin)return!0;if(!t)return!1;const c=t.overrides.find(u=>u.nav_key===l);return c!==void 0?c.can_view:t.roleKeys.includes(l)},[e,t]),n=h.useCallback(l=>l.some(c=>r(c)),[r]),a=h.useCallback(l=>{if(!e)return"denied";if(e.is_admin)return"allowed";const c=M7[l];if(c===void 0)return console.warn(`[usePermissions] action_key desconocido: "${l}". Denegando.`),"denied";if(t!=null&&t.roleActionPerms){const u=t.roleActionPerms.find(d=>d.action_key===l);if(u!==void 0)return u.can_execute?"allowed":"needs_approval"}return c?"needs_approval":"allowed"},[e,t]),i=(e==null?void 0:e.is_admin)??!1,s=(e==null?void 0:e.is_admin)===!0||t!==null;return{canView:r,canViewAny:n,canExecute:a,isAdmin:i,isLoaded:s,user:e}}const ip=[{key:"mapa",label:"Mapa",path:"/app/mapa",level:"direct",legacyTab:"Mapa",icon:""},{key:"muestreos",label:"Muestreos",path:"/app/muestreos",level:"direct",legacyTab:"Muestreos",icon:""},{key:"reportes",label:"Reportes",path:"/app/reportes",level:"direct",legacyTab:"Reportes",icon:""},{key:"finanzas",label:"Finanzas",path:"/app/finanzas",level:"direct",icon:"",children:[{key:"finanzas.cuadre",label:"Cuadre Diario",level:"tab"},{key:"finanzas.ventas",label:"Ventas",level:"tab"},{key:"finanzas.costos",label:"Costos",level:"tab"},{key:"finanzas.resultados",label:"Resultados",level:"tab"}]},{key:"configuracion",label:"Configuracin",path:"/app/configuracion",level:"direct",legacyTab:"Configuracin",icon:""},{key:"operacion",label:"Operacin",level:"group",icon:"",children:[{key:"personal",label:"Gestin de Personal",level:"subgroup",icon:"",children:[{key:"personal.programa",label:"Programa de Trabajo",path:"/app/estrategia/personal",level:"section",legacyTab:"Personal"},{key:"personal.planeacion",label:"Planeacin de Labores",path:"/app/estrategia/personal/planeacion",level:"section",legacyTab:"Personal"}]},{key:"fumigacion",label:"Fumigacin",path:"/app/operacion/fumigacion",level:"section",legacyTab:"Personal",icon:"",children:[{key:"fumigacion.programa",label:"Programa",level:"tab"},{key:"fumigacion.aplicaciones",label:"Aplicaciones",level:"tab"},{key:"fumigacion.jornada",label:"Jornada",level:"tab"},{key:"fumigacion.catalogo",label:"Catlogo",level:"tab"}]},{key:"nutricion",label:"Nutricin",level:"subgroup",icon:"",children:[{key:"nutricion.tanques",label:"Tanques de Nutricin",path:"/app/operacion/nutricion/tanques",level:"section",legacyTab:"Personal"}]},{key:"cosecha",label:"Cosecha",path:"/app/operacion/cosecha",level:"section",icon:"",legacyTab:"Personal",children:[{key:"cosecha.registro",label:"Registro de Cosecha",path:"/app/operacion/cosecha/registro",level:"tab",legacyTab:"Personal"},{key:"cosecha.reportes",label:"Reportes de Cosecha",path:"/app/operacion/cosecha/reportes",level:"tab",legacyTab:"Personal"}]},{key:"administracion",label:"Administracin",path:"/app/administracion",level:"section",legacyTab:"Personal",icon:""},{key:"empaque",label:"Empaque",path:"/app/operacion/empaque",level:"section",legacyTab:"Personal",icon:""},{key:"inventario",label:"Inventario General",path:"/app/operacion/inventario",level:"section",legacyTab:"Personal",icon:"",children:[{key:"inventario.stock",label:"Stock",level:"tab"},{key:"inventario.historial",label:"Historial",level:"tab"},{key:"inventario.configuracion",label:"Configuracin",level:"tab"},{key:"inventario.cat.empaque",label:"Materiales de Empaque",level:"tab",icon:""},{key:"inventario.cat.agroquimicos",label:"Agroqumicos",level:"tab",icon:""},{key:"inventario.cat.fertilizantes",label:"Fertilizantes",level:"tab",icon:""},{key:"inventario.cat.riego",label:"Riego",level:"tab",icon:""},{key:"inventario.cat.fumigacion",label:"Fumigacin",level:"tab",icon:""},{key:"inventario.cat.herramientas",label:"Herramientas y Equipo",level:"tab",icon:""},{key:"inventario.cat.combustibles",label:"Combustibles",level:"tab",icon:""},{key:"inventario.rancho.moray",label:"Rancho Moray",level:"tab",icon:""},{key:"inventario.rancho.mojave",label:"Rancho Mojave",level:"tab",icon:""},{key:"inventario.rancho.lapena",label:"Rancho La Pea",level:"tab",icon:""}]},{key:"exportacion",label:"Exportacin",path:"/app/operacion/exportacion",level:"section",legacyTab:"Personal",icon:"",children:[{key:"exportacion.dashboard",label:"Dashboard",level:"tab"},{key:"exportacion.pipeline",label:"Pipeline",level:"tab"},{key:"exportacion.catalogos",label:"Catlogos",level:"tab"}]}]}];function CM(e,t={}){var r;for(const n of e)t[n.key]=n,(r=n.children)!=null&&r.length&&CM(n.children,t);return t}const _M=CM(ip),Ak=Object.values(_M).filter(e=>e.level!=="group"&&e.level!=="subgroup").map(e=>e.key);function AM(e){var n;const t=_M[e];if(!((n=t==null?void 0:t.children)!=null&&n.length))return[];const r=[];for(const a of t.children)a.level!=="group"&&a.level!=="subgroup"&&r.push(a.key),r.push(...AM(a.key));return r}const O7="/assets/Moray-logo-blanco-BDySKkI3.jpg";function T7(){const{pathname:e}=Go(),{logout:t}=Vo(),{canView:r,canViewAny:n,isAdmin:a}=_c(),[i,s]=h.useState(!1),[l,c]=h.useState({}),u=h.useRef(null);h.useEffect(()=>{const b=g=>{u.current&&!u.current.contains(g.target)&&(s(!1),c({}))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]);const d=b=>{c(g=>{const v=g[b],w={};return v||(w[b]=!0),w})},f=()=>{s(!1),c({})},p=b=>b==="/app/mapa"?e==="/app/mapa"||e==="/app":b==="/app/configuracion"?e.startsWith("/app/configuracion"):e===b||e.startsWith(b+"/"),x=b=>!b.path||!r(b.key)?null:o.jsx(ni,{to:b.path,className:`text-lg transition-colors ${p(b.path)?"text-white font-medium":"text-[#A3A3A3] hover:text-white"}`,children:b.label},b.key),m=b=>{if(!b.path||!r(b.key))return null;const g=p(b.path);return b.key==="exportacion"?o.jsx("div",{className:"border-t border-[#333] mt-2 pt-2",children:o.jsxs(ni,{to:b.path,onClick:f,className:`flex items-center gap-2 px-4 py-2 hover:bg-[#2A2A2A] rounded-md font-medium ${g?"bg-[#00c9a715] text-[#00c9a7]":"text-[#00c9a7]"}`,children:[b.icon," ",b.label]})},b.key):o.jsx(ni,{to:b.path,onClick:f,className:`block px-4 py-2 hover:bg-[#2A2A2A] rounded-md mt-1 ${g?"bg-[#2A2A2A] text-white":""}`,children:b.label},b.key)},y=b=>{var w;if(!((w=b.children)!=null&&w.length))return null;const g=b.children.filter(C=>C.path&&r(C.key));if(!g.length)return null;const v=l[b.key]??!1;return o.jsxs("div",{className:"relative group mb-1",children:[o.jsxs("button",{onClick:()=>d(b.key),className:"w-full flex justify-between items-center px-4 py-2 hover:bg-[#2A2A2A] rounded-md",children:[b.label,o.jsx("span",{className:"ml-2",children:v?"":""})]}),v&&o.jsx("div",{className:"absolute right-full top-0 mr-2 w-64 bg-[#1A1A1A] border border-[#333] rounded-xl shadow-lg z-50 p-2 animate-fadeInLeft",children:g.map(C=>o.jsx(ni,{to:C.path,onClick:f,className:"block px-4 py-2 hover:bg-[#2A2A2A] rounded-md",children:C.label},C.key))})]},b.key)},j=b=>{var w;if(!((w=b.children)!=null&&w.length))return null;const g=AM(b.key);if(!n(g))return null;const v=i||e.startsWith("/app/operacion")||e.startsWith("/app/estrategia")||e.startsWith("/app/administracion");return o.jsxs("div",{className:"relative",ref:u,children:[o.jsx("button",{onClick:()=>s(C=>!C),className:`text-lg transition-colors ${v?"text-white font-medium":"text-[#A3A3A3] hover:text-white"}`,children:b.label}),i&&o.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-[#1A1A1A] border border-[#333] rounded-xl shadow-lg z-50 p-2",children:b.children.map(C=>C.level==="subgroup"?y(C):C.level==="section"?m(C):null)})]},b.key)};return o.jsxs("header",{className:"bg-[#0D0D0D] text-white",children:[o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsx("div",{className:"flex items-center",children:o.jsx(ni,{to:"/",className:"flex items-center",children:o.jsx("img",{src:O7,alt:"Agrcola Moray",className:"h-10 w-auto object-contain",loading:"lazy"})})}),o.jsxs("nav",{className:"flex items-center space-x-8",children:[ip.map(b=>b.level==="direct"?x(b):b.level==="group"?j(b):null),a&&o.jsx(L7,{}),o.jsx("button",{onClick:t,className:"ml-6 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors",children:"Cerrar sesin"})]})]})}),o.jsx("style",{children:`
        @keyframes fadeInLeft {
          from { opacity: 0; transform: translateX(-10px); }
          to   { opacity: 1; transform: translateX(0); }
        }
        .animate-fadeInLeft { animation: fadeInLeft 0.2s ease-out; }
      `})]})}function L7(){const[e,t]=zn.useState(0),{user:r}=Vo();return zn.useEffect(()=>{if(!(r!=null&&r.is_admin))return;const n=async()=>{const{count:i}=await se.from("approval_requests").select("id",{count:"exact",head:!0}).eq("status","pending");t(i??0)};n();const a=setInterval(n,3e4);return()=>clearInterval(a)},[r==null?void 0:r.is_admin]),e===0?null:o.jsxs(ni,{to:"/app/configuracion/solicitudes",className:"relative flex items-center justify-center w-8 h-8 rounded-full hover:bg-[#2A2A2A] transition-colors",title:`${e} solicitud${e!==1?"es":""} pendiente${e!==1?"s":""}`,children:[o.jsx("span",{className:"text-[#A3A3A3] text-lg",children:""}),o.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center",children:e>9?"9+":e})]})}function D7(){return o.jsxs("div",{className:"min-h-screen bg-pattern",children:[o.jsx(T7,{}),o.jsx("main",{children:o.jsx(_0,{})})]})}var EM={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(un,function(){var r=1e3,n=6e4,a=36e5,i="millisecond",s="second",l="minute",c="hour",u="day",d="week",f="month",p="quarter",x="year",m="date",y="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var I=["th","st","nd","rd"],L=T%100;return"["+T+(I[(L-20)%10]||I[L]||I[0])+"]"}},v=function(T,I,L){var D=String(T);return!D||D.length>=I?T:""+Array(I+1-D.length).join(L)+T},w={s:v,z:function(T){var I=-T.utcOffset(),L=Math.abs(I),D=Math.floor(L/60),O=L%60;return(I<=0?"+":"-")+v(D,2,"0")+":"+v(O,2,"0")},m:function T(I,L){if(I.date()<L.date())return-T(L,I);var D=12*(L.year()-I.year())+(L.month()-I.month()),O=I.clone().add(D,f),F=L-O<0,q=I.clone().add(D+(F?-1:1),f);return+(-(D+(L-O)/(F?O-q:q-O))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:f,y:x,w:d,d:u,D:m,h:c,m:l,s,ms:i,Q:p}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},C="en",k={};k[C]=g;var S="$isDayjsObject",_=function(T){return T instanceof $||!(!T||!T[S])},A=function T(I,L,D){var O;if(!I)return C;if(typeof I=="string"){var F=I.toLowerCase();k[F]&&(O=F),L&&(k[F]=L,O=F);var q=I.split("-");if(!O&&q.length>1)return T(q[0])}else{var te=I.name;k[te]=I,O=te}return!D&&O&&(C=O),O||!D&&C},E=function(T,I){if(_(T))return T.clone();var L=typeof I=="object"?I:{};return L.date=T,L.args=arguments,new $(L)},N=w;N.l=A,N.i=_,N.w=function(T,I){return E(T,{locale:I.$L,utc:I.$u,x:I.$x,$offset:I.$offset})};var $=function(){function T(L){this.$L=A(L.locale,null,!0),this.parse(L),this.$x=this.$x||L.x||{},this[S]=!0}var I=T.prototype;return I.parse=function(L){this.$d=function(D){var O=D.date,F=D.utc;if(O===null)return new Date(NaN);if(N.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var q=O.match(j);if(q){var te=q[2]-1||0,H=(q[7]||"0").substring(0,3);return F?new Date(Date.UTC(q[1],te,q[3]||1,q[4]||0,q[5]||0,q[6]||0,H)):new Date(q[1],te,q[3]||1,q[4]||0,q[5]||0,q[6]||0,H)}}return new Date(O)}(L),this.init()},I.init=function(){var L=this.$d;this.$y=L.getFullYear(),this.$M=L.getMonth(),this.$D=L.getDate(),this.$W=L.getDay(),this.$H=L.getHours(),this.$m=L.getMinutes(),this.$s=L.getSeconds(),this.$ms=L.getMilliseconds()},I.$utils=function(){return N},I.isValid=function(){return this.$d.toString()!==y},I.isSame=function(L,D){var O=E(L);return this.startOf(D)<=O&&O<=this.endOf(D)},I.isAfter=function(L,D){return E(L)<this.startOf(D)},I.isBefore=function(L,D){return this.endOf(D)<E(L)},I.$g=function(L,D,O){return N.u(L)?this[D]:this.set(O,L)},I.unix=function(){return Math.floor(this.valueOf()/1e3)},I.valueOf=function(){return this.$d.getTime()},I.startOf=function(L,D){var O=this,F=!!N.u(D)||D,q=N.p(L),te=function(V,J){var ne=N.w(O.$u?Date.UTC(O.$y,J,V):new Date(O.$y,J,V),O);return F?ne:ne.endOf(u)},H=function(V,J){return N.w(O.toDate()[V].apply(O.toDate("s"),(F?[0,0,0,0]:[23,59,59,999]).slice(J)),O)},B=this.$W,K=this.$M,Z=this.$D,he="set"+(this.$u?"UTC":"");switch(q){case x:return F?te(1,0):te(31,11);case f:return F?te(1,K):te(0,K+1);case d:var re=this.$locale().weekStart||0,X=(B<re?B+7:B)-re;return te(F?Z-X:Z+(6-X),K);case u:case m:return H(he+"Hours",0);case c:return H(he+"Minutes",1);case l:return H(he+"Seconds",2);case s:return H(he+"Milliseconds",3);default:return this.clone()}},I.endOf=function(L){return this.startOf(L,!1)},I.$set=function(L,D){var O,F=N.p(L),q="set"+(this.$u?"UTC":""),te=(O={},O[u]=q+"Date",O[m]=q+"Date",O[f]=q+"Month",O[x]=q+"FullYear",O[c]=q+"Hours",O[l]=q+"Minutes",O[s]=q+"Seconds",O[i]=q+"Milliseconds",O)[F],H=F===u?this.$D+(D-this.$W):D;if(F===f||F===x){var B=this.clone().set(m,1);B.$d[te](H),B.init(),this.$d=B.set(m,Math.min(this.$D,B.daysInMonth())).$d}else te&&this.$d[te](H);return this.init(),this},I.set=function(L,D){return this.clone().$set(L,D)},I.get=function(L){return this[N.p(L)]()},I.add=function(L,D){var O,F=this;L=Number(L);var q=N.p(D),te=function(K){var Z=E(F);return N.w(Z.date(Z.date()+Math.round(K*L)),F)};if(q===f)return this.set(f,this.$M+L);if(q===x)return this.set(x,this.$y+L);if(q===u)return te(1);if(q===d)return te(7);var H=(O={},O[l]=n,O[c]=a,O[s]=r,O)[q]||1,B=this.$d.getTime()+L*H;return N.w(B,this)},I.subtract=function(L,D){return this.add(-1*L,D)},I.format=function(L){var D=this,O=this.$locale();if(!this.isValid())return O.invalidDate||y;var F=L||"YYYY-MM-DDTHH:mm:ssZ",q=N.z(this),te=this.$H,H=this.$m,B=this.$M,K=O.weekdays,Z=O.months,he=O.meridiem,re=function(J,ne,Q,me){return J&&(J[ne]||J(D,F))||Q[ne].slice(0,me)},X=function(J){return N.s(te%12||12,J,"0")},V=he||function(J,ne,Q){var me=J<12?"AM":"PM";return Q?me.toLowerCase():me};return F.replace(b,function(J,ne){return ne||function(Q){switch(Q){case"YY":return String(D.$y).slice(-2);case"YYYY":return N.s(D.$y,4,"0");case"M":return B+1;case"MM":return N.s(B+1,2,"0");case"MMM":return re(O.monthsShort,B,Z,3);case"MMMM":return re(Z,B);case"D":return D.$D;case"DD":return N.s(D.$D,2,"0");case"d":return String(D.$W);case"dd":return re(O.weekdaysMin,D.$W,K,2);case"ddd":return re(O.weekdaysShort,D.$W,K,3);case"dddd":return K[D.$W];case"H":return String(te);case"HH":return N.s(te,2,"0");case"h":return X(1);case"hh":return X(2);case"a":return V(te,H,!0);case"A":return V(te,H,!1);case"m":return String(H);case"mm":return N.s(H,2,"0");case"s":return String(D.$s);case"ss":return N.s(D.$s,2,"0");case"SSS":return N.s(D.$ms,3,"0");case"Z":return q}return null}(J)||q.replace(":","")})},I.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},I.diff=function(L,D,O){var F,q=this,te=N.p(D),H=E(L),B=(H.utcOffset()-this.utcOffset())*n,K=this-H,Z=function(){return N.m(q,H)};switch(te){case x:F=Z()/12;break;case f:F=Z();break;case p:F=Z()/3;break;case d:F=(K-B)/6048e5;break;case u:F=(K-B)/864e5;break;case c:F=K/a;break;case l:F=K/n;break;case s:F=K/r;break;default:F=K}return O?F:N.a(F)},I.daysInMonth=function(){return this.endOf(f).$D},I.$locale=function(){return k[this.$L]},I.locale=function(L,D){if(!L)return this.$L;var O=this.clone(),F=A(L,D,!0);return F&&(O.$L=F),O},I.clone=function(){return N.w(this.$d,this)},I.toDate=function(){return new Date(this.valueOf())},I.toJSON=function(){return this.isValid()?this.toISOString():null},I.toISOString=function(){return this.$d.toISOString()},I.toString=function(){return this.$d.toUTCString()},T}(),z=$.prototype;return E.prototype=z,[["$ms",i],["$s",s],["$m",l],["$H",c],["$W",u],["$M",f],["$y",x],["$D",m]].forEach(function(T){z[T[1]]=function(I){return this.$g(I,T[0],T[1])}}),E.extend=function(T,I){return T.$i||(T(I,$,E),T.$i=!0),E},E.locale=A,E.isDayjs=_,E.unix=function(T){return E(1e3*T)},E.en=k[C],E.Ls=k,E.p={},E})})(EM);var NM=EM.exports;const td=no(NM);var I7={exports:{}};(function(e,t){(function(r,n){e.exports=n(NM)})(un,function(r){function n(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var a=n(r),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:function(s){return s+""}};return a.default.locale(i,null,!0),i})})(I7);const Ek=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),$7="PlanAsignaciones",R7="Personal Moray",mx=["Administracion","FUMIGACION","RIEGO","SUPERVISOR","LABORES"];function F7(){return["#FFB6C1","#FFD700","#90EE90","#87CEFA","#DDA0DD","#FFA07A","#20B2AA","#FF69B4","#A0522D","#00CED1","#F4A460","#00FA9A","#8A2BE2","#7FFFD4","#DC143C","#FF7F50","#9ACD32","#40E0D0","#BA55D3","#FF6347"]}function z7(){const[e,t]=h.useState([]),[r,n]=h.useState([]),[a,i]=h.useState({}),[s,l]=h.useState(!0),[c,u]=h.useState(td().subtract(2,"day")),[d,f]=h.useState(td().add(4,"day")),p=async()=>{l(!0);try{const{data:g}=await Ek.from(R7).select("ID,Nombre,Area,Estado").eq("Estado",!0).range(0,9999),{data:v}=await Ek.from($7).select("*").gte("Fecha",c.format("YYYY-MM-DD")).lte("Fecha",d.format("YYYY-MM-DD")).range(0,9999);n(g||[]),t(v||[]);const w=new Set,C=(v==null?void 0:v.flatMap(_=>(_.Labor?_.Labor.split(",").map(E=>E.trim()).filter(E=>E.length>0):["Sin labor"]).filter(E=>w.has(E)?!1:(w.add(E),!0))))||[],k=F7(),S={};C.forEach((_,A)=>{S[_]=k[A%k.length]}),i(S)}catch(g){console.error("Error al cargar datos:",g)}finally{l(!1)}};h.useEffect(()=>{p()},[c,d]);const x=[...Array(d.diff(c,"day")+1)].map((g,v)=>c.add(v,"day").format("YYYY-MM-DD")),m={};r.forEach(g=>{m[g.Nombre]={},x.forEach(v=>{m[g.Nombre][v]=[]})}),e.forEach(g=>{const v=td(g.Fecha).format("YYYY-MM-DD");(g.Labor?[...new Set(g.Labor.split(",").map(C=>C.trim()).filter(C=>C.length>0))]:["Sin labor"]).forEach(C=>{m[g.Nombre]||(m[g.Nombre]={}),m[g.Nombre][v]||(m[g.Nombre][v]=[]),m[g.Nombre][v].push(C)})});const y={};mx.forEach(g=>y[g]=[]),r.forEach(g=>{var C;const v=((C=g.Area)==null?void 0:C.toUpperCase())||"OTRO",w=mx.includes(v)?v:"OTRO";y[w]||(y[w]=[]),y[w].push(g)});const j=(g,v)=>{const w=[...v].sort((C,k)=>C.Nombre.localeCompare(k.Nombre,"es",{sensitivity:"base"}));return o.jsxs("div",{className:"mb-8",children:[o.jsx("h3",{className:"text-xl font-semibold text-white mb-2 mt-4",children:g.charAt(0).toUpperCase()+g.slice(1).toLowerCase()}),o.jsx("div",{className:"overflow-x-auto border border-gray-700 rounded-lg",children:o.jsxs("table",{className:"min-w-full table-auto border-collapse text-sm",children:[o.jsx("thead",{className:"bg-[#1A1A1A] text-white sticky top-0 z-10",children:o.jsxs("tr",{children:[o.jsx("th",{className:"border border-gray-700 px-4 py-2 text-left sticky left-0 bg-[#1A1A1A] z-20",children:"Personal"}),x.map(C=>o.jsx("th",{className:"border border-gray-700 px-4 py-2 text-center",children:td(C).format("DD/MM")},C))]})}),o.jsx("tbody",{children:w.map(({Nombre:C})=>o.jsxs("tr",{children:[o.jsx("td",{className:"border border-gray-700 px-4 py-2 font-medium text-white sticky left-0 bg-[#0D0D0D] z-10 whitespace-nowrap",children:C}),x.map(k=>{var _;const S=[...new Set(((_=m[C])==null?void 0:_[k])||[])].sort((A,E)=>A.localeCompare(E,"es",{sensitivity:"base"}));return o.jsx("td",{className:"border border-gray-700 px-1 py-1 text-center text-white max-w-[200px]",children:S.length>0?o.jsx("div",{className:"flex flex-col gap-1 items-center",children:S.map((A,E)=>o.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold text-black",style:{backgroundColor:a[A]||"#ccc"},children:A},E))}):o.jsx("span",{className:"text-gray-500",children:""})},`${C}-${k}`)})]},C))})]})})]},g)},b=(g,v)=>{const w=td(g.target.value);v==="start"?(d.diff(w,"day")>7&&f(w.add(7,"day")),u(w)):(w.diff(c,"day")>7&&u(w.subtract(7,"day")),f(w))};return o.jsxs("div",{className:"p-6",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[o.jsx(z8,{className:"w-5 h-5 text-blue-500"})," Vista de Asignaciones por Da"]}),o.jsxs("div",{className:"flex gap-4 items-center mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-white text-sm mb-1",children:"Fecha de inicio:"}),o.jsx("input",{type:"date",className:"px-2 py-1 rounded bg-gray-800 text-white border border-gray-600",value:c.format("YYYY-MM-DD"),onChange:g=>b(g,"start")})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-white text-sm mb-1",children:"Fecha de fin:"}),o.jsx("input",{type:"date",className:"px-2 py-1 rounded bg-gray-800 text-white border border-gray-600",value:d.format("YYYY-MM-DD"),onChange:g=>b(g,"end")})]})]}),s?o.jsxs("div",{className:"text-center text-gray-400 flex items-center justify-center gap-2",children:[o.jsx(V8,{className:"animate-spin w-5 h-5"})," Cargando asignaciones..."]}):o.jsx("div",{children:mx.map(g=>{var v;return((v=y[g])==null?void 0:v.length)>0?j(g,y[g]):null})})]})}const No=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),dl="Personal Moray";function B7(){const[e,t]=h.useState([]),[r,n]=h.useState([]),[a,i]=h.useState([]),[s,l]=h.useState(""),[c,u]=h.useState(!0),[d,f]=h.useState(!1),[p,x]=h.useState(!1),[m,y]=h.useState(!1),[j,b]=h.useState(null),[g,v]=h.useState(""),[w,C]=h.useState(""),[k,S]=h.useState(""),[_,A]=h.useState({}),[E,N]=h.useState({}),[$,z]=h.useState([]),[T,I]=h.useState(!1),[L,D]=h.useState(""),[O,F]=h.useState(""),[q,te]=h.useState(!1),[H,B]=h.useState(""),[K,Z]=h.useState(""),[he,re]=h.useState([]),[X,V]=h.useState(!1);h.useEffect(()=>{(async()=>{const{data:pe,error:Se}=await No.from("Personal Moray").select("Nombre").eq("Estado",!0).range(0,9999);Se?console.error("Error al obtener trabajadores activos:",Se):re(pe.map($e=>$e.Nombre))})()},[]),h.useEffect(()=>{J();const ie=No.channel("personal-changes").on("postgres_changes",{event:"*",schema:"public",table:dl},J).subscribe();return()=>{No.removeChannel(ie)}},[]),h.useEffect(()=>{(async()=>{try{const{data:pe,error:Se}=await No.from("Labores Personal").select('"Nombre Labor"').eq("Activo",!0).range(0,9999);if(Se)throw Se;const $e=[...new Set(pe.map(He=>He["Nombre Labor"]))].sort((He,nt)=>He.localeCompare(nt,"es",{sensitivity:"base"}));z($e)}catch(pe){console.error("Error al cargar las labores activas:",pe),oe.error("No se pudieron cargar las labores activas")}})()},[]);async function J(){u(!0);try{const{data:ie,error:pe}=await No.from(dl).select("ID,Nombre,Area,Estado,Labores,Asignado").eq("Estado",!0).order("Labores",{ascending:!0}).order("Nombre",{ascending:!0}).range(0,9999);if(pe)throw pe;t(ie)}catch(ie){console.error(ie),oe.error("No se pudo cargar el personal")}finally{u(!1)}}function ne(){if(!s||!r.length){oe.error("Seleccione una labor y al menos un trabajador");return}t(ie=>ie.map(pe=>r.includes(pe.ID)?{...pe,Labores:s,Asignado:!0,PendienteGuardar:!0}:pe)),n([]),l("")}async function Q(){const ie=e.filter(pe=>pe.PendienteGuardar);if(!ie.length){oe.error("No hay asignaciones nuevas");return}f(!0);try{for(const pe of ie){const{error:Se}=await No.from(dl).update({Labores:pe.Labores,Asignado:!0}).eq("ID",pe.ID);if(Se)throw Se}oe.success("Asignaciones guardadas correctamente"),t(pe=>pe.map(Se=>({...Se,PendienteGuardar:!1}))),J()}catch(pe){console.error(pe),oe.error("Error al guardar en la base de datos")}finally{f(!1)}}const me=ie=>{b(ie),y(!0)},ue=async()=>{if(!j)return;const ie=e.filter(pe=>pe.Labores===j);try{const pe=ie.map(Se=>No.from(dl).update({Asignado:!1}).eq("ID",Se.ID));await Promise.all(pe),oe.success("Asignaciones removidas correctamente"),t(Se=>Se.map($e=>$e.Labores===j?{...$e,Asignado:!1}:$e))}catch(pe){console.error("Error al remover asignaciones:",pe),oe.error("Error al actualizar Supabase")}finally{b(null),y(!1)}},W=async ie=>{t(Se=>Se.map($e=>$e.ID===ie?{...$e,Labores:null,Asignado:!1}:$e));const{error:pe}=await No.from(dl).update({Asignado:!1}).eq("ID",ie);pe?(console.error("Error al actualizar Supabase:",pe),oe.error("Error al desasignar en la base de datos")):oe.success("Asignacin removida correctamente")},ae=(ie,pe)=>{n(Se=>{const $e=pe.map(It=>It.ID),He=Se.filter(It=>!$e.includes(It));return pe.every(It=>Se.includes(It.ID))?He:[...He,...$e]})},we=(ie,pe)=>{i(Se=>{const $e=pe.map(It=>It.ID),He=Se.filter(It=>!$e.includes(It));return pe.every(It=>Se.includes(It.ID))?He:[...He,...$e]})},ve=ie=>ie.every(pe=>r.includes(pe.ID)),G=ie=>ie.every(pe=>a.includes(pe.ID)),R=ie=>{const pe=ie.filter(Se=>r.includes(Se.ID)).length;return pe>0&&pe<ie.length},Y=ie=>{const pe=ie.filter(Se=>a.includes(Se.ID)).length;return pe>0&&pe<ie.length},ge=e.filter(ie=>ie.Asignado===!1).filter(ie=>ie.Nombre.toLowerCase().includes(g.toLowerCase())),de=e.filter(ie=>ie.Asignado===!0).filter(ie=>ie.Nombre.toLowerCase().includes(w.toLowerCase())),Oe=(ie,pe)=>ie.reduce((Se,$e)=>{const He=pe($e);return Se[He]||(Se[He]=[]),Se[He].push($e),Se},{}),be=Oe(ge,ie=>ie.Labores||"Sin Labor"),Ue=Oe(de,ie=>ie.Labores);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"min-h-screen bg-[#0D0D0D] p-8",children:[o.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center mb-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-bold text-white",children:"Programa de Trabajo"}),o.jsx("p",{className:"text-[#A3A3A3]",children:"Asigne labores al personal activo"})]}),o.jsxs("button",{onClick:()=>x(!0),className:"bg-[#3B82F6] text-white px-6 py-3 rounded-lg flex items-center gap-2",children:[o.jsx(G8,{className:"w-5 h-5"}),"Ver Programa de Trabajo"]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(jk,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h3",{className:"text-xl font-semibold text-white",children:"Personal sin Asignar"})]}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx("input",{type:"text",placeholder:"Buscar personal...",className:"w-full bg-[#262626] text-white pl-10 pr-4 py-2 rounded-lg",value:g,onChange:ie=>v(ie.target.value)}),o.jsx(Fl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A3A3A3]"})]}),c?o.jsx("p",{className:"text-center text-[#A3A3A3]",children:"Cargando"}):Object.keys(be).length?Object.entries(be).map(([ie,pe])=>o.jsxs("div",{className:"mb-4",children:[o.jsxs("button",{className:"flex items-center justify-between w-full",onClick:()=>A(Se=>({...Se,[ie]:!Se[ie]})),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:Se=>{Se.stopPropagation(),ae(ie,pe)},className:"text-[#3B82F6] hover:text-[#2563EB]",children:ve(pe)?o.jsx(mk,{className:"w-5 h-5"}):R(pe)?o.jsx(vk,{className:"w-5 h-5"}):o.jsx(yk,{className:"w-5 h-5"})}),o.jsxs("h4",{className:"text-[#3B82F6] font-medium",children:[ie," (",pe.length,")"]})]}),_[ie]?o.jsx(xk,{className:"text-[#3B82F6]"}):o.jsx(gk,{className:"text-[#3B82F6]"})]}),_[ie]&&pe.map(Se=>o.jsxs("div",{className:"flex items-center bg-[#262626] rounded-lg p-4 mt-2 gap-3",children:[o.jsx("input",{type:"checkbox",checked:r.includes(Se.ID),onChange:$e=>{n(He=>$e.target.checked?[...He,Se.ID]:He.filter(nt=>nt!==Se.ID))},className:"h-4 w-4 text-blue-600"}),o.jsx("span",{className:"text-white",children:Se.Nombre})]},Se.ID))]},ie)):o.jsx("p",{className:"text-center text-[#A3A3A3]",children:"No hay personal sin asignar"})]}),o.jsxs("div",{className:"bg-[#262626] rounded-xl p-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(F8,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h3",{className:"text-xl font-semibold text-white",children:"Asignar Labor"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar labor...",className:"w-full bg-[#1A1A1A] text-white pl-10 pr-4 py-2 rounded-lg",value:k,onChange:ie=>S(ie.target.value)}),o.jsx(Fl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A3A3A3]"})]}),o.jsxs("select",{className:"w-full bg-[#1A1A1A] text-white px-4 py-2 rounded-lg",value:s,onChange:ie=>l(ie.target.value),children:[o.jsx("option",{value:"",children:"Seleccionar Labor"}),$.filter(ie=>ie.toLowerCase().includes(k.toLowerCase())).map(ie=>o.jsx("option",{value:ie,children:ie},ie))]}),o.jsxs("button",{onClick:ne,disabled:!s||!r.length,className:"w-full bg-[#3B82F6] text-white py-3 rounded-lg flex items-center justify-center gap-2 disabled:opacity-50",children:[o.jsx(U8,{className:"w-5 h-5"}),"Asignar Labor"]}),o.jsx("button",{onClick:()=>te(!0),className:"w-full bg-green-600 text-white py-3 rounded-lg flex items-center justify-center gap-2 mt-2",children:" Aadir Segunda Labor"})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(jk,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h3",{className:"text-xl font-semibold text-white",children:"Personal Asignado"})]}),o.jsxs("button",{onClick:Q,disabled:d,className:"bg-[#3B82F6] text-white px-4 py-2 rounded-lg flex items-center gap-2 disabled:opacity-50",children:[o.jsx(Bi,{className:"w-4 h-4"}),d?"Guardando":"Guardar Asignaciones"]})]}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx("input",{type:"text",placeholder:"Buscar personal asignado...",className:"w-full bg-[#262626] text-white pl-10 pr-4 py-2 rounded-lg",value:w,onChange:ie=>C(ie.target.value)}),o.jsx(Fl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A3A3A3]"})]}),Object.keys(Ue).length?Object.entries(Ue).map(([ie,pe])=>o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>we(ie,pe),className:"text-[#3B82F6] hover:text-[#2563EB]",children:G(pe)?o.jsx(mk,{className:"w-5 h-5"}):Y(pe)?o.jsx(vk,{className:"w-5 h-5"}):o.jsx(yk,{className:"w-5 h-5"})}),o.jsxs("h4",{className:"text-[#3B82F6] font-medium",children:[ie," (",pe.length,")"]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("button",{onClick:()=>me(ie),className:"text-[#3B82F6] text-sm hover:underline",children:"Remover Asignacin"}),E[ie]?o.jsx(xk,{className:"text-[#3B82F6] cursor-pointer",onClick:()=>N(Se=>({...Se,[ie]:!1}))}):o.jsx(gk,{className:"text-[#3B82F6] cursor-pointer",onClick:()=>N(Se=>({...Se,[ie]:!0}))})]})]}),E[ie]&&pe.map(Se=>o.jsxs("div",{className:"bg-[#262626] rounded-lg p-4 mt-2 flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"checkbox",checked:a.includes(Se.ID),onChange:$e=>{i(He=>$e.target.checked?[...He,Se.ID]:He.filter(nt=>nt!==Se.ID))},className:"h-4 w-4 text-blue-600"}),o.jsx("span",{className:"text-white",children:Se.Nombre})]}),o.jsx("button",{onClick:()=>W(Se.ID),className:"text-[#A3A3A3] hover:text-white transition-colors",children:o.jsx(vM,{className:"w-5 h-5"})})]},Se.ID))]},ie)):o.jsx("p",{className:"text-center text-[#A3A3A3]",children:"No hay personal asignado"})]})]})]}),p&&o.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-[#1A1A1A] w-full max-w-6xl h-[90vh] rounded-xl overflow-hidden shadow-xl relative",children:[o.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-red-400",onClick:()=>x(!1),children:o.jsx(wk,{className:"w-6 h-6"})}),o.jsx("div",{className:"p-6 h-full overflow-y-auto",children:o.jsx(z7,{})})]})}),q&&o.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-[#1A1A1A] w-full max-w-md rounded-xl shadow-xl p-6 relative",children:[o.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-red-400",onClick:()=>{te(!1),Z(""),B("")},children:o.jsx(wk,{className:"w-6 h-6"})}),o.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Aadir Labor Secundaria"}),o.jsxs("div",{className:"mb-4 relative",children:[o.jsx("label",{className:"block text-white mb-1",children:"Nombre del trabajador:"}),o.jsx("input",{type:"text",placeholder:"Buscar trabajador...",className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg",value:H,onChange:ie=>{B(ie.target.value),V(!0)},onFocus:()=>V(!0)}),X&&H&&o.jsx("div",{className:"absolute z-10 w-full max-h-48 overflow-y-auto bg-[#1A1A1A] mt-1 rounded-lg shadow-lg border border-[#333]",children:he.filter(ie=>ie.toLowerCase().includes(H.toLowerCase())).map(ie=>o.jsx("div",{className:"px-4 py-2 text-white hover:bg-[#333] cursor-pointer",onClick:()=>{B(ie),V(!1)},children:ie},ie))})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-white mb-1",children:"Labor adicional:"}),o.jsxs("select",{className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg",value:K,onChange:ie=>Z(ie.target.value),children:[o.jsx("option",{value:"",children:"Seleccionar Labor"}),$.map(ie=>o.jsx("option",{value:ie,children:ie},ie))]})]}),o.jsx("button",{onClick:async()=>{const ie=e.find(nt=>nt.Nombre.toLowerCase()===H.toLowerCase());if(!ie){oe.error("Trabajador no encontrado");return}const pe=ie.Labores?`${ie.Labores}, ${K}`:K,{error:Se}=await No.from(dl).update({Labores:pe}).eq("ID",ie.ID);if(Se){console.error(Se),oe.error("Error al guardar la segunda labor");return}const $e=new Date().toISOString().split("T")[0],{error:He}=await No.from("PlanAsignaciones").insert([{Fecha:$e,Nombre:ie.Nombre,Labor:K}]);if(He){console.error(He),oe.error("Error al guardar en el plan de asignaciones");return}oe.success("Segunda labor guardada en ambas tablas"),J(),te(!1),B(""),Z("")},className:"bg-green-600 text-white px-4 py-2 rounded-lg w-full",children:"Guardar"})]})}),m&&o.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg shadow-lg max-w-md w-full",children:[o.jsx("h2",{className:"text-white text-xl font-semibold mb-4",children:"Confirmar Remocin?"}),o.jsxs("p",{className:"text-[#A3A3A3] mb-6",children:["Esto desasignar a todo el personal de la labor ",o.jsx("strong",{children:j}),". Deseas continuar?"]}),o.jsxs("div",{className:"flex justify-end gap-4",children:[o.jsx("button",{onClick:()=>{y(!1),b(null)},className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-500",children:"Cancelar"}),o.jsx("button",{onClick:ue,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-500",children:"Confirmar"})]})]})})]})}const ul=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg");function U7(){const[e,t]=h.useState(""),[r,n]=h.useState(""),[a,i]=h.useState(!1),[s,l]=h.useState([]),[c,u]=h.useState([]),[d,f]=h.useState(""),[p,x]=h.useState(!0),[m,y]=h.useState(!1),[j,b]=h.useState(null),[g,v]=h.useState(""),[w,C]=h.useState(!1);h.useEffect(()=>{k();const N=ul.channel("personal-changes").on("postgres_changes",{event:"*",schema:"public",table:"Personal Moray"},()=>k()).subscribe();return()=>{ul.removeChannel(N)}},[]);const k=async()=>{x(!0);try{const{data:N,error:$}=await ul.from("Personal Moray").select("ID, Nombre, Area, Estado").eq("Estado",!0).order("Nombre",{ascending:!0}).range(0,9999);if($)throw $;l(N||[])}catch(N){console.error(N),oe.error("Error al cargar el personal activo")}finally{x(!1)}},S=async N=>{if(N.preventDefault(),!e.trim()||!r){oe.error("Por favor complete todos los campos");return}i(!0);try{const{error:$}=await ul.from("Personal Moray").insert({Nombre:e.trim(),Area:r,Estado:!0,Labores:null});if($)throw $;oe.success("Personal registrado exitosamente"),t(""),n("")}catch($){console.error($),oe.error("Error al registrar el personal")}finally{i(!1)}},_=async()=>{if(c.length===0){oe.error("Seleccione al menos un trabajador");return}y(!0);try{const{error:N}=await ul.from("Personal Moray").update({Estado:!1}).in("ID",c);if(N)throw N;oe.success("Personal dado de baja exitosamente"),u([])}catch(N){console.error(N),oe.error("Error al dar de baja el personal")}finally{y(!1)}},A=async()=>{if(!j||!g){oe.error("Seleccione un trabajador y un rea nueva");return}C(!0);try{const{error:N}=await ul.from("Personal Moray").update({Area:g}).eq("ID",j);if(N)throw N;oe.success("rea actualizada correctamente"),b(null),v("")}catch(N){console.error(N),oe.error("Error al actualizar rea")}finally{C(!1)}},E=s.filter(N=>N.Nombre.toLowerCase().includes(d.toLowerCase()));return o.jsx("div",{className:"min-h-screen bg-[#0D0D0D] p-8",children:o.jsxs("div",{className:"max-w-2xl mx-auto space-y-12",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(yd,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h2",{className:"text-xl font-semibold text-white",children:"Alta de Personal"})]}),o.jsxs("form",{onSubmit:S,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Nombre del trabajador"}),o.jsx("input",{type:"text",value:e,onChange:N=>t(N.target.value),placeholder:"Ingrese el nombre completo",className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg border border-[#404040] focus:outline-none focus:border-[#3B82F6]",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"rea"}),o.jsxs("select",{value:r,onChange:N=>n(N.target.value),className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg border border-[#404040] focus:outline-none focus:border-[#3B82F6]",required:!0,children:[o.jsx("option",{value:"",children:"Seleccione un rea"}),o.jsx("option",{value:"Labores",children:"Labores"}),o.jsx("option",{value:"Fumigacin",children:"Fumigacin"}),o.jsx("option",{value:"Supervisor",children:"Supervisor"}),o.jsx("option",{value:"Riego",children:"Riego"})]})]}),o.jsxs("button",{type:"submit",disabled:a,className:"w-full bg-[#3B82F6] text-white py-3 rounded-lg flex items-center justify-center gap-2 hover:bg-[#2563EB] disabled:opacity-50",children:[a?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(yd,{className:"w-5 h-5"}),a?"Registrando...":"Dar de Alta"]})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(bk,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h2",{className:"text-xl font-semibold text-white",children:"Dar de Baja Personal"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Buscar personal...",value:d,onChange:N=>f(N.target.value),className:"w-full bg-[#262626] text-white pl-10 pr-4 py-2 rounded-lg border border-[#404040] focus:outline-none focus:border-[#3B82F6]"}),o.jsx(Fl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A3A3A3]"})]}),o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:p?o.jsxs("div",{className:"text-center text-[#A3A3A3] py-4",children:[o.jsx(ir,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Cargando personal..."]}):E.length===0?o.jsx("p",{className:"text-center text-[#A3A3A3] py-4",children:"No se encontr personal activo"}):E.map(N=>o.jsxs("div",{className:"flex items-center bg-[#262626] rounded-lg p-4 gap-3",children:[o.jsx("input",{type:"checkbox",checked:c.includes(N.ID),onChange:$=>{u(z=>$.target.checked?[...z,N.ID]:z.filter(T=>T!==N.ID))},className:"h-4 w-4 text-blue-600"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-white",children:N.Nombre}),o.jsxs("span",{className:"ml-2 text-sm text-[#A3A3A3]",children:["[",N.Area,"]"]})]})]},N.ID))}),o.jsxs("button",{onClick:_,disabled:m||c.length===0,className:"w-full bg-[#3B82F6] text-white py-3 rounded-lg flex items-center justify-center gap-2 hover:bg-[#2563EB] disabled:opacity-50",children:[m?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(bk,{className:"w-5 h-5"}),m?"Procesando...":"Dar de Baja"]})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[o.jsx(yd,{className:"w-5 h-5 text-[#3B82F6]"}),o.jsx("h2",{className:"text-xl font-semibold text-white",children:"Actualizar rea"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Trabajador"}),o.jsxs("select",{value:j??"",onChange:N=>b(Number(N.target.value)||null),className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg border border-[#404040] focus:outline-none focus:border-[#3B82F6]",children:[o.jsx("option",{value:"",children:"Seleccione un trabajador"}),s.map(N=>o.jsxs("option",{value:N.ID,children:[N.Nombre," [",N.Area,"]"]},N.ID))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Nueva rea"}),o.jsxs("select",{value:g,onChange:N=>v(N.target.value),className:"w-full bg-[#262626] text-white px-4 py-2 rounded-lg border border-[#404040] focus:outline-none focus:border-[#3B82F6]",children:[o.jsx("option",{value:"",children:"Seleccione un rea"}),o.jsx("option",{value:"Labores",children:"Labores"}),o.jsx("option",{value:"Fumigacin",children:"Fumigacin"}),o.jsx("option",{value:"Supervisor",children:"Supervisor"}),o.jsx("option",{value:"Riego",children:"Riego"})]})]}),o.jsxs("button",{onClick:A,disabled:w,className:"w-full bg-[#3B82F6] text-white py-3 rounded-lg flex items-center justify-center gap-2 hover:bg-[#2563EB] disabled:opacity-50",children:[w?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(yd,{className:"w-5 h-5"}),w?"Actualizando...":"Actualizar rea"]})]})]})]})})}const er=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),W7={mapTypeId:"satellite",mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0},Nk=["Trips","Gusano Soldado","Chinche Lygus","Corynespora","Botritis","Roya"],Pk={Trips:{low:{max:.99,color:"#22c55e",label:"Bajo"},moderate:{max:1.99,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}},"Gusano Soldado":{low:{max:.49,color:"#22c55e",label:"Bajo"},moderate:{max:1.49,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}},"Chinche Lygus":{low:{max:0,color:"#22c55e",label:"Bajo"},moderate:{max:1,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}},Corynespora:{low:{max:2,color:"#22c55e",label:"Bajo"},moderate:{max:4,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}},Roya:{low:{max:2,color:"#22c55e",label:"Bajo"},moderate:{max:4,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}},Botritis:{low:{max:2,color:"#22c55e",label:"Bajo"},moderate:{max:5,color:"#eab308",label:"Moderado"},high:{max:1/0,color:"#ef4444",label:"Alto"}}},Po={normal:{min:1.4,max:2,color:"#22c55e"},warning:{min:1.2,max:2.2,color:"#eab308"},critical:{color:"#ef4444"}},gx={Pressures:"Presiones/Nxt Agro",labor:"Labores",pests:"Plagas y Enfermedades",nutrients:"Nutricin",irrigation:"Aforos",harvest:"Cosecha",probetas:"Probetas"},Mk={"Plagas y Enfermedades":"Muestreo Plagas y Enfermedades",Labores:"Muestreos Labores",Nutricin:"Muestreos Nutricion",Riego:"Muestreos Riego",Cosecha:"Muestreos Cosecha",Probetas:"Muestreos Probetas",Aforos:"Muestreos Aforos Riego"},Ok=e=>{const t=[];let r="green";const n=e.ce;n<1.1||n>2.5?(r="red",t.push(`C.E.: ${n.toFixed(2)} (Crtico)`)):n>=1.1&&n<1.5||n>2&&n<=2.5?(r!=="red"&&(r="yellow"),t.push(`C.E.: ${n.toFixed(2)} (Precaucin)`)):t.push(`C.E.: ${n.toFixed(2)} (Normal)`);const a=e.ph;a<4.5||a>6.7?(r="red",t.push(`pH: ${a.toFixed(2)} (Crtico)`)):a>=4.5&&a<5||a>6.3&&a<=6.7?(r!=="red"&&(r="yellow"),t.push(`pH: ${a.toFixed(2)} (Precaucin)`)):t.push(`pH: ${a.toFixed(2)} (Normal)`);const i=e.na;return i>120?(r="red",t.push(`Na: ${i.toFixed(2)} (Crtico)`)):i>=100&&i<=120?(r!=="red"&&(r="yellow"),t.push(`Na: ${i.toFixed(2)} (Precaucin)`)):t.push(`Na: ${i.toFixed(2)} (Normal)`),t.push(`NO3: ${e.no3.toFixed(2)}`),t.push(`Ca: ${e.ca.toFixed(2)}`),t.push(`K: ${e.k.toFixed(2)}`),{color:{green:"#22c55e",yellow:"#eab308",red:"#ef4444",gray:"#6B7280"}[r],details:t}},q7=(e,t)=>{if(typeof e!="number")return"#6B7280";const r=/^[12][A-F]$/i.test(t),n=new Date().getMonth();let a;n===10||n===11||n===0?a=r?{green:[0,11],yellow:[12,13],red:14}:{green:[0,9],yellow:[10,11],red:12}:a=r?{green:[0,9],yellow:[10,11],red:12}:{green:[0,6],yellow:[7,7],red:8};const i={green:["#14532d","#166534","#22c55e"],yellow:["#a16207","#eab308"],red:["#dc2626","#b91c1c","#7f1d1d"]};if(e>=a.green[0]&&e<=a.green[1]){const s=e-a.green[0];return i.green[Math.min(s,i.green.length-1)]}if(e>=a.yellow[0]&&e<=a.yellow[1]){const s=e-a.yellow[0];return i.yellow[Math.min(s,i.yellow.length-1)]}if(e>=a.red){const s=e-a.red;return i.red[Math.min(s,i.red.length-1)]}return"#6B7280"};function K7(){var Bc;const[e,t]=h.useState(null),[r,n]=h.useState(null),[a,i]=h.useState(null),[s,l]=h.useState("Pressures"),[c,u]=h.useState(Nk[0]),[d,f]=h.useState(""),[p,x]=h.useState([]),[m,y]=h.useState({}),[j,b]=h.useState(null),[g,v]=h.useState(null),[w,C]=h.useState(null),[k,S]=h.useState({}),[_,A]=h.useState([]),[E,N]=h.useState(""),[$,z]=h.useState([]),[T,I]=h.useState(""),[L,D]=h.useState(!0),[O,F]=h.useState([]),[q,te]=h.useState(""),[H,B]=h.useState("Goteros"),[K,Z]=h.useState(new Set),[he,re]=h.useState([]),[X,V]=h.useState(""),[J,ne]=h.useState([]),[Q,me]=h.useState([]),[ue,W]=h.useState(!1),[ae]=HR();parseFloat(ae.get("lat")||"20.7066066"),parseFloat(ae.get("lng")||"-103.9314381");function we(ee,xe){return xe.startsWith("1")||xe.startsWith("2")?ee>=14&&ee<=16?"#22c55e":ee>=12&&ee<14||ee>16&&ee<=18?"#eab308":"#ef4444":ee>=19&&ee<=21?"#22c55e":ee>=17&&ee<19||ee>21&&ee<=23?"#eab308":"#ef4444"}h.useEffect(()=>{G(),Y()},[s]),h.useEffect(()=>{if(!(g!=null&&g.type)||g.type!=="sensor"||!g.sector)return;const ee=er.channel("nxtagro-updates").on("postgres_changes",{event:"*",schema:"public",table:"Nxt Agro API",filter:`Sector=eq.${g.sector}`},()=>{ie(g.sector)}).subscribe();return()=>{er.removeChannel(ee)}},[g]),h.useEffect(()=>{if(!d||s==="pests"&&(!T||T.trim()===""))return;let ee=Mk[gx[s]],xe=`Semana=eq.${d}`;s==="pests"&&(ee="Muestreo Plagas y Enfermedades",xe=`and(Semana.eq.${d},Plaga.eq.${c},Fecha.eq.${T})`);const Ce=er.channel("tunnel-updates").on("postgres_changes",{event:"*",schema:"public",table:ee,filter:xe},()=>{Ue()}).subscribe();return()=>{er.removeChannel(Ce)}},[s,c,d,T]),h.useEffect(()=>{s==="labor"&&R()},[s]),h.useEffect(()=>{s==="labor"&&X&&de()},[s,X]),h.useEffect(()=>{if(d)switch(Ue(),s){case"pests":Oe(d);break;case"Pressures":ge(d);break;case"nutrients":be(d);break;case"labor":Ue();break}},[s,c,d,T,H]),h.useEffect(()=>{(g==null?void 0:g.type)==="sensor"&&g.sector&&ie(g.sector)},[g]),h.useEffect(()=>{const ee=setInterval(()=>{d&&Ue(),(g==null?void 0:g.type)==="sensor"&&g.sector&&ie(g.sector)},6e4);return()=>clearInterval(ee)},[d,g]);const ve=async()=>{try{const{data:ee,error:xe}=await er.from("Labores Personal").select('"Nombre Labor", "Fecha Inicio", "Fecha Fin", "Seccion"').eq("Activo",!0);if(xe)throw xe;const Ce=ee.map(_e=>({nombre:_e["Nombre Labor"],fechaInicio:_e["Fecha Inicio"],fechaFin:_e["Fecha Fin"],secciones:_e.Seccion?_e.Seccion.split(",").map(je=>je.trim().toUpperCase()):[]}));ne(Ce)}catch(ee){console.error("Error al cargar labores planeadas:",ee),ne([])}};h.useEffect(()=>{(async()=>{try{const{data:xe,error:Ce}=await er.from("Labores Personal").select('"Nombre Labor"').eq("Activo",!0);if(Ce)throw Ce;const _e=[...new Set(xe.map(je=>je["Nombre Labor"]))].sort((je,Fe)=>je.localeCompare(Fe));me(_e),(!X||!_e.includes(X))&&V(_e[0]??"")}catch(xe){console.error("Error fetching active labors:",xe),toast.error("No se pudieron cargar las labores activas")}})(),ve()},[]),h.useEffect(()=>{(async()=>{if(s==="labor"){f("");return}await Y()})()},[s]),h.useEffect(()=>{d&&s==="Pressures"&&ge(d)},[d,s]),h.useEffect(()=>{d&&E&&s==="Pressures"&&pe()},[E,d,s]);const G=async()=>{try{const xe=await(await fetch("/tunnels.json")).json();b(xe)}catch(ee){console.error("Error loading GeoJSON data:",ee)}},R=async()=>{try{const{data:ee,error:xe}=await er.from("Labores Personal").select('"Nombre Labor", Tipo').eq("Activo",!0);if(xe)throw xe;const Ce=ee.filter(je=>je.Tipo&&je.Tipo.toUpperCase()!=="N/A").map(je=>je["Nombre Labor"]),_e=[...new Set(Ce)].sort((je,Fe)=>je.localeCompare(Fe,"es",{sensitivity:"base"}));re(_e),(!X||!_e.includes(X))&&V(_e[0]??"")}catch(ee){console.error("Error fetching labor options:",ee),re([])}},Y=async()=>{try{let ee;if(s==="Pressures"?ee="Muestreos Presiones":ee=Mk[gx[s]],!ee)return;const{data:xe,error:Ce}=await er.from(ee).select("Semana").not("Semana","is",null);if(Ce)throw Ce;if(xe&&xe.length>0){const _e=[...new Set(xe.map(je=>je.Semana.toString()))].sort((je,Fe)=>parseInt(Fe)-parseInt(je));x(_e),(!d||!_e.includes(d))&&f(_e[0]??"")}else x([]),f("")}catch(ee){console.error("Error fetching weeks:",ee),x([]),f("")}},ge=async ee=>{try{const{data:xe,error:Ce}=await er.from("Muestreos Presiones").select("Fecha").eq("Semana",parseInt(ee)).order("Fecha",{ascending:!0});if(Ce)throw Ce;if(xe&&xe.length>0){const _e=[...new Set(xe.map(je=>je.Fecha))];A(_e),N(_e[0])}else A([]),N("")}catch(xe){console.error("Error fetching available dates:",xe),A([]),N("")}},de=async()=>{try{const{data:ee,error:xe}=await er.from("Muestreos Labores").select('Seccion, "Nombre Labor"');if(xe)throw xe;const Ce=new Set;ee==null||ee.forEach(_e=>{!(!X||_e["Nombre Labor"]===X)||!_e.Seccion||_e.Seccion.split(",").forEach(Fe=>Ce.add(Fe.trim()))}),Z(Ce)}catch(ee){console.error("Error fetching completed tunnels:",ee),Z(new Set)}},Oe=async ee=>{const xe=parseInt(ee);if(!isNaN(xe))try{const{data:Ce,error:_e}=await er.from("Muestreo Plagas y Enfermedades").select("Fecha").eq("Semana",xe).order("Fecha",{ascending:!0});if(_e)throw _e;const je=[...new Set(Ce.map(Fe=>Fe.Fecha))];z(je),je.includes(T)||I(je[0]||"")}catch(Ce){console.error("Error fetching pest dates:",Ce),z([]),I("")}},be=async ee=>{const xe=parseInt(ee);if(!isNaN(xe))try{const{data:Ce,error:_e}=await er.from("Muestreos Nutricion").select("Fecha").eq("Semana",xe).eq("Tipo",H);if(_e)throw _e;const je=Ce?[...new Set(Ce.map(Fe=>Fe.Fecha))]:[];F(je),je.includes(q)||te(je[0]??"")}catch(Ce){console.error("Error fetching nutrient dates:",Ce),F([]),te("")}},Ue=async()=>{if(d){if(s==="labor"){y({});return}try{const ee={};if(s==="probetas"){const{data:xe,error:Ce}=await er.from("Muestreos Probetas").select("Sector, Mililitros").eq("Semana",parseInt(d));if(Ce)throw Ce;xe==null||xe.forEach(_e=>{const je=`Sector ${_e.Sector}`;ee[je]={value:_e.Mililitros,details:`Mililitros: ${_e.Mililitros}`}})}else if(s==="pests"){if(!T||T.trim()==="")return;const{data:xe,error:Ce}=await er.from("Muestreo Plagas y Enfermedades").select("Sector, Tunel, Cantidad").eq("Semana",parseInt(d)).eq("Plaga",c).eq("Fecha",T);if(Ce)throw Ce;const _e={};xe==null||xe.forEach(je=>{const Fe=`${je.Sector} Tunel ${je.Tunel}`;_e[Fe]||(_e[Fe]=[]),_e[Fe].push(je.Cantidad)});for(const je in _e){const Fe=_e[je],Be=Fe.reduce((et,qt)=>et+qt,0)/Fe.length;ee[je]={value:Be,details:`Cantidad promedio: ${Be.toFixed(2)}`}}}else if(s==="harvest"){const{data:xe,error:Ce}=await er.rpc("get_harvest_days_per_tunnel");if(Ce)throw Ce;xe==null||xe.forEach(_e=>{const je=`${_e.sector} Tunel ${_e.tunel}`;ee[je]={harvestDays:_e.dias_desde_corte,details:`Das desde ltima cosecha: ${_e.dias_desde_corte}
ltimo corte: ${_e.ultima_fecha}
Variedad: ${_e.variedad}`}})}else if(s==="nutrients"){const{data:xe,error:Ce}=await er.from("Muestreos Nutricion").select('Sector, Tunel, "C.E.", pH, NO3, Ca, K, Na').eq("Semana",parseInt(d)).eq("Tipo",H);if(Ce)throw Ce;const _e=xe==null?void 0:xe.reduce((je,Fe)=>{const Be=`${Fe.Sector} Tunel ${Fe.Tunel}`;return je[Be]||(je[Be]={ce:[],ph:[],no3:[],ca:[],k:[],na:[]}),je[Be].ce.push(Fe["C.E."]),je[Be].ph.push(Fe.pH),je[Be].no3.push(Fe.NO3),je[Be].ca.push(Fe.Ca),je[Be].k.push(Fe.K),je[Be].na.push(Fe.Na),je},{});for(const[je,Fe]of Object.entries(_e)){const Be=Pt=>Pt.reduce((dr,Uc)=>dr+Uc,0)/Pt.length,et={ce:Be(Fe.ce),ph:Be(Fe.ph),no3:Be(Fe.no3),ca:Be(Fe.ca),k:Be(Fe.k),na:Be(Fe.na)},{color:qt,details:$t}=Ok(et);ee[je]={value:et.ce,details:$t.join(`
`),nutrientData:et}}}else if(s==="irrigation"){const{data:xe,error:Ce}=await er.from("Muestreos Aforos Riego").select("Sector, Tunel, CaudalGotero").eq("Semana",parseInt(d));if(Ce)throw Ce;xe==null||xe.forEach(_e=>{const je=`${_e.Sector} Tunel ${_e.Tunel}`;ee[je]={value:_e.CaudalGotero,details:`Caudal por gotero: ${_e.CaudalGotero} ml/s`}})}y(ee)}catch(ee){console.error("Error fetching tunnel metrics:",ee)}}},ie=async ee=>{try{const{data:xe,error:Ce}=await er.from("Nxt Agro API").select("*").eq("Sector",ee).order("Timestamp",{ascending:!1}).limit(1);if(Ce)throw Ce;C((xe==null?void 0:xe[0])??null)}catch(xe){console.error("Error fetching NxtAgro data:",xe)}},pe=async()=>{if(d)try{const{data:ee,error:xe}=await er.from("Muestreos Presiones").select("Sector, Presion").eq("Semana",parseInt(d)).eq("Fecha",E).order("Fecha",{ascending:!1});if(xe)throw xe;const Ce={};ee==null||ee.forEach(_e=>{var Fe;const je=(Fe=_e.Sector)==null?void 0:Fe.toUpperCase().trim();je&&!Ce[je]&&(Ce[je]={sector:je,pressure:_e.Presion})}),S(Ce)}catch(ee){console.error("Error fetching valve pressures:",ee)}},Se=ee=>{if(ee.properties.type!=="valve"||s!=="Pressures")return"#388e3c";const xe=ee.properties.name.match(/Vlvula\s+(\w+)/);if(!xe)return"#6B7280";const Ce=xe[1],_e=k[Ce];if(!_e||_e.pressure===null)return"#6B7280";const je=_e.pressure;return je<1.2||je>2.2?"#ef4444":je<1.4||je>2?"#eab308":"#22c55e"},$e=ee=>{var Fe,Be;const xe=ee.id,Ce=ee.properties.name;if(s==="labor"){if(K.has(Ce))return"#22c55e";const[et,,qt]=Ce.split(" "),$t=J.find(Pt=>{var dr;return((dr=Pt.nombre)==null?void 0:dr.toUpperCase())===(X==null?void 0:X.toUpperCase())});if($t){const Pt=(Fe=$t.secciones)==null?void 0:Fe.includes(Ce.toUpperCase()),dr=new Date,Uc=new Date($t.fechaInicio),Fa=new Date($t.fechaFin);if(Pt&&dr>=Uc&&dr<=Fa)return"#eab308";if(Pt&&dr>Fa)return"#ef4444"}return"#6B7280"}if(s==="probetas"&&((Be=xe==null?void 0:xe.startsWith)!=null&&Be.call(xe,"sector_"))){const et=`Sector ${xe.split("_")[1].toUpperCase()}`;return m[et]?"#388e3c":"#6B7280"}if(s==="irrigation"){const et=Ce,[qt,,$t]=et.split(" "),Pt=`${qt} Tunel ${$t}`,dr=m[Pt];return!dr||dr.value===void 0?"#6B7280":we(dr.value,qt)}const _e=m[Ce];if(!_e)return"#6B7280";if(s==="Pressures"&&_e.value!==void 0){const et=_e.value;return et>=Po.normal.min&&et<=Po.normal.max?Po.normal.color:et>=Po.warning.min&&et<=Po.warning.max?Po.warning.color:Po.critical.color}if(s==="harvest"){const et=Ce.split(" ")[0];return q7(_e.harvestDays,et)}if(s==="nutrients"&&_e.nutrientData)return Ok(_e.nutrientData).color;if(_e.value===void 0)return"#6B7280";const je=Pk[c];return _e.value<=je.low.max?je.low.color:_e.value<=je.moderate.max?je.moderate.color:je.high.color},He=h.useCallback(ee=>{t(ee);const xe=new google.maps.LatLngBounds;ee.coordinates.forEach(Ce=>xe.extend(Ce)),i(xe.getCenter().toJSON())},[]),nt=()=>{if(s==="nutrients")return[];if(s==="irrigation")return[{color:"#6B7280",label:"Sin datos"},{color:"#22c55e",label:"Normal (14-16 ml/s Biloxi  19-21 ml/s Otros)"},{color:"#eab308",label:"Precaucin (12-14 / 16-18 Biloxi  17-19 / 21-23 Otros)"},{color:"#ef4444",label:"Crtico (<12 / >18 Biloxi  <17 / >23 Otros)"}];if(s==="Pressures")return[{color:"#6B7280",label:"Sin datos"},{color:Po.normal.color,label:"Normal (1.4 - 2.0)"},{color:Po.warning.color,label:"Precaucin (1.2 - 1.4 o 2.0 - 2.2)"},{color:Po.critical.color,label:"Crtico (< 1.2 o > 2.2)"}];if(s==="irrigation")return[{color:"#6B7280",label:"Sin datos"},{color:"#22c55e",label:"Biloxi: 1416 ml/s  Otros: 1921 ml/s"},{color:"#eab308",label:"Biloxi: 1214 o 1618 ml/s  Otros: 1719 o 2123 ml/s"},{color:"#ef4444",label:"Biloxi: <12 o >18 ml/s  Otros: <17 o >23 ml/s"}];if(s==="harvest")return[{color:"#6B7280",label:"No cosechado"},{color:"#22c55e",label:"Cosecha menor a 7 das"},{color:"#eab308",label:"Cosecha entre 8 y 9 das"},{color:"#ef4444",label:"Cosecha entre 10 y 11 das"},{color:"#991b1b",label:"Cosecha mayor a 11 das"}];if(s==="probetas")return[{color:"#6B7280",label:"Sin datos"},{color:"#388e3c",label:"Con datos"}];if(s==="labor")return[{color:"#6B7280",label:"Sin datos"},{color:"#22c55e",label:"Seccin Completada"}];const ee=Pk[c];return[{color:"#6B7280",label:"Sin datos"},{color:ee.low.color,label:`${ee.low.label} ( ${ee.low.max})`},{color:ee.moderate.color,label:`${ee.moderate.label} (${ee.low.max} - ${ee.moderate.max})`},{color:ee.high.color,label:`${ee.high.label} (> ${ee.moderate.max})`}]},It=ee=>{var Ce;const xe=((Ce=ee.name.split(" ").pop())==null?void 0:Ce.toUpperCase())??"";v({...ee,sector:(ee.type==="sensor",xe)})},Ho=ee=>ee[0].map(([xe,Ce])=>({lat:Ce,lng:xe})),Hi=ee=>{var je,Fe,Be,et;const xe=ee.geometry.type==="Point",Ce=ee.geometry.type==="Polygon",_e=typeof ee.id=="string"&&ee.id.startsWith("sector_");if(s==="probetas")return _e;if(s==="labor"){if(!Ce||_e)return!1;const qt=((je=ee.properties.name)==null?void 0:je.toUpperCase())||"";if(qt.startsWith("Camino")||qt.startsWith("Periferia"))return!0;const $t=J.find(Pt=>{var dr;return((dr=Pt.nombre)==null?void 0:dr.toUpperCase())===(X==null?void 0:X.toUpperCase())});return!$t||!((Fe=$t.secciones)!=null&&Fe.length)?!1:$t.secciones.some(Pt=>qt.startsWith(Pt))}switch(s){case"pests":if(!Ce||_e)return!1;const qt=((Be=ee.properties.name)==null?void 0:Be.toUpperCase())||"";return/^[1-8][A-F]\s+TUNEL\s+\d+$/i.test(qt);case"nutrients":case"harvest":case"harvest":{if(!Ce||_e)return!1;const $t=((et=ee.properties.name)==null?void 0:et.toUpperCase())||"";return/^[1-8][A-F]\s+TUNEL\s+\d+$/i.test($t)}case"Pressures":return xe;default:return!0}};return o.jsxs("div",{className:"relative w-full h-[calc(100vh-4rem)]",children:[o.jsxs("div",{className:"absolute top-4 left-4 z-20 text-white",children:[o.jsx("button",{onClick:()=>D(!L),className:"mb-2 bg-[#1A1A1A] px-4 py-2 rounded-lg text-sm hover:bg-[#2A2A2A] transition",children:L?"Ocultar filtros":"Mostrar filtros"}),L&&o.jsxs("div",{className:"bg-[#1A1A1A] bg-opacity-90 rounded-lg p-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Filtros de Visualizacin"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Muestreo"}),o.jsx("select",{value:s,onChange:ee=>l(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",children:Object.entries(gx).map(([ee,xe])=>o.jsx("option",{value:ee,children:xe},ee))})]}),s==="labor"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Labor"}),o.jsx("select",{value:X,onChange:ee=>V(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",children:he.map(ee=>o.jsx("option",{value:ee,children:ee},ee))})]}),s==="pests"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Plaga"}),o.jsx("select",{value:c,onChange:ee=>u(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",children:Nk.map(ee=>o.jsx("option",{value:ee,children:ee},ee))})]}),s!=="labor"&&s!=="harvest"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Semana"}),o.jsx("select",{value:d,onChange:ee=>f(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",disabled:p.length===0,children:p.length===0?o.jsx("option",{value:"",children:"No hay datos disponibles"}):p.map(ee=>o.jsxs("option",{value:ee,children:["Semana ",ee]},ee))})]}),s==="pests"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fecha"}),o.jsx("select",{value:T,onChange:ee=>I(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",disabled:$.length===0,children:$.length===0?o.jsx("option",{value:"",children:"No hay fechas disponibles"}):$.map(ee=>o.jsx("option",{value:ee,children:new Date(`${ee}T06:00:00Z`).toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long",timeZone:"America/Mexico_City"})},ee))})]}),s==="nutrients"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Muestreo"}),o.jsxs("select",{value:H,onChange:ee=>B(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",children:[o.jsx("option",{value:"Goteros",children:"Goteros"}),o.jsx("option",{value:"Exprimidos",children:"Exprimidos"})]})]}),o.jsxs("div",{className:"mt-6 border-t border-[#404040] pt-4 text-xs text-white space-y-1",children:[o.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Referencias"}),o.jsxs("p",{children:[o.jsx("strong",{children:"C.E.:"})," Verde 1.52.0  Amarillo 1.11.5 / 2.02.5  Rojo <1.1 / >2.5"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"pH:"})," Verde 5.06.3  Amarillo 4.55.0 / 6.36.7  Rojo <4.5 / >6.7"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Na:"})," Verde <100  Amarillo 100120  Rojo >120"]})]})]}),s==="Pressures"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fecha"}),o.jsx("select",{value:E,onChange:ee=>N(ee.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-lg px-4 py-2 text-white",disabled:_.length===0,children:_.length===0?o.jsx("option",{value:"",children:"No hay fechas disponibles"}):_.map(ee=>o.jsx("option",{value:ee,children:new Date(ee+"T06:00:00Z").toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"short",timeZone:"America/Mexico_City"})},ee))})]}),nt().length>0&&o.jsxs("div",{className:"pt-4 border-t border-[#404040]",children:[s!=="nutrients"&&o.jsx("h3",{className:"text-lg font-medium mb-3",children:"Leyenda"}),o.jsx("div",{className:"space-y-2",children:nt().map((ee,xe)=>o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:ee.color}}),o.jsx("span",{children:ee.label})]},xe))})]})]})]})]}),s==="pests"&&o.jsx("div",{className:"absolute top-4 right-4 z-20",children:o.jsx("button",{onClick:()=>W(ee=>!ee),className:"bg-black bg-opacity-80 text-white px-3 py-2 rounded-md text-xs hover:bg-opacity-100 transition",children:ue?"Ocultar valores":"Mostrar valores"})}),o.jsxs(A0,{mapContainerClassName:"w-full h-full",options:{...W7,gestureHandling:"greedy",zoomControl:!1,streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1},onClick:()=>{t(null),i(null)},onLoad:ee=>{ee.setCenter({lat:20.7066066,lng:-103.9314381}),ee.setZoom(17)},children:[j==null?void 0:j.features.filter(Hi).map(ee=>{if(ee.geometry.type==="Point"){const[xe,Ce]=ee.geometry.coordinates,_e={lat:Ce,lng:xe},Fe=ee.properties.type==="valve"?Se(ee):"#B6CCA1";return o.jsx(TP,{position:_e,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:Fe,fillOpacity:.9,strokeColor:Fe,strokeWeight:2,scale:8},onClick:()=>It({position:_e,name:ee.properties.name,type:ee.properties.type||"valve",sector:ee.properties.name.split(" ").pop()})},ee.id)}return null}),j==null?void 0:j.features.filter(Hi).map(ee=>{if(ee.geometry.type==="Polygon"){const xe=Ho(ee.geometry.coordinates),Ce=$e(ee);return o.jsx(gm,{paths:xe,options:{fillColor:Ce,fillOpacity:r===ee.id?.8:.5,strokeColor:Ce,strokeOpacity:1,strokeWeight:r===ee.id?3:2},onClick:()=>He({name:ee.properties.name,coordinates:Ho(ee.geometry.coordinates)}),onMouseOver:()=>n(ee.id),onMouseOut:()=>n(null)},ee.id)}return null}),e&&a&&o.jsx(fu,{position:a,onCloseClick:()=>{t(null),i(null)},children:o.jsxs("div",{className:"bg-black text-white rounded-lg p-4 text-xs min-w-[220px]",children:[o.jsx("h3",{className:"text-base font-semibold mb-2",children:e.name}),m[e.name]?o.jsx(o.Fragment,{children:(()=>{const{value:ee,details:xe}=m[e.name],[Ce,,_e]=e.name.split(" "),je=ee;if(s==="aforos"&&je!==void 0){const Fe=Ce.startsWith("1")||Ce.startsWith("2");let Be="",et="";return Fe?je>=14&&je<=16?(Be="Normal",et="text-green-400"):je>=12&&je<14||je>16&&je<=18?(Be="Precaucin",et="text-yellow-400"):(Be="Crtico",et="text-red-400"):je>=19&&je<=21?(Be="Normal",et="text-green-400"):je>=17&&je<19||je>21&&je<=23?(Be="Precaucin",et="text-yellow-400"):(Be="Crtico",et="text-red-400"),o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex justify-between mb-0.5",children:[o.jsx("span",{className:"font-semibold",children:"Caudal por gotero"}),o.jsxs("span",{className:`font-mono ${et}`,children:[je," ml/s (",Be,")"]})]})})}return xe.split(`
`).map((Fe,Be)=>{const[et,qt]=Fe.split(":");let $t=(qt==null?void 0:qt.trim())??"",Pt="text-white";return $t.includes("(Normal)")?Pt="text-green-400":$t.includes("(Precaucin)")?Pt="text-yellow-400":$t.includes("(Crtico)")&&(Pt="text-red-400"),o.jsxs("div",{className:"flex justify-between mb-0.5",children:[o.jsx("span",{className:"font-semibold",children:et.trim()}),o.jsx("span",{className:`${Pt} font-mono`,children:$t})]},Be)})})()}):o.jsx("p",{className:"text-white"})]})}),g&&o.jsx(fu,{position:g.position,onCloseClick:()=>v(null),children:o.jsxs("div",{className:"bg-[#1A1A1A] text-white rounded-lg p-4 min-w-[200px]",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:g.name}),g.type==="sensor"&&w?o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("p",{children:["ltima actualizacin: ",w.Timestamp??""]}),o.jsxs("p",{children:["Humedad Sustrato: ",w["Humedad Sustrato"]??"","%"]}),o.jsxs("p",{children:["C.E. Sustrato: ",w["C.E. Sustrato"]??""," mS/cm"]}),o.jsxs("p",{children:["Riego: ",w.Riego??""," ml"]}),o.jsxs("p",{children:["Riego Acum.: ",w["Riego Acumulado"]??""," ml"]}),o.jsxs("p",{children:["Dren Acumulado: ",w["Dren Acumulado"]??""," ml"]}),o.jsxs("p",{children:["% Dren Acumulado: ",w["% Dren Acumulado"]??"","%"]}),o.jsxs("p",{children:["Drenaje: ",w.Dren??""," ml"]}),o.jsxs("p",{children:["% Dren por Riego: ",w["% Dren"]??"","%"]})]}):g.type==="valve"&&g.sector?o.jsxs("p",{className:"text-sm",children:["Presin: ",((Bc=k[g.sector])==null?void 0:Bc.pressure)??"Sin datos"," bar"]}):o.jsx("p",{className:"text-sm",children:g.name})]})}),s==="pests"&&ue&&j&&Object.entries(m).map(([ee,xe])=>{if(xe.value===void 0)return null;const Ce=j.features.find(Be=>{var et;return((et=Be.properties)==null?void 0:et.name)===ee});if(!Ce||Ce.geometry.type!=="Polygon")return null;const _e=Ho(Ce.geometry.coordinates),je=new google.maps.LatLngBounds;_e.forEach(Be=>je.extend(Be));const Fe=je.getCenter().toJSON();return o.jsx(Mi,{position:Fe,mapPaneName:Mi.OVERLAY_MOUSE_TARGET,children:o.jsx("div",{className:`
           bg-black text-white text-[11px]
           px-2 py-1 rounded-md
           font-mono leading-none
           pointer-events-none
           shadow-md
         `,children:xe.value.toFixed(2)})},`pest-value-${ee}`)})]})]})}const Tk=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Lk={"1A":[1,16],"1B":[1,19],"1C":[1,20],"1D":[1,19],"1E":[1,16],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]},G7=["Trips","Gusano Soldado","Chinche Lygus","Corynespora","Botritis","Roya"];function V7(){const[e,t]=h.useState(!1),[r,n]=h.useState(new Date().toISOString().split("T")[0]),[a,i]=h.useState(""),[s,l]=h.useState(""),[c,u]=h.useState([{Fecha:r,Tunel:"",Cantidad:""}]),[d,f]=h.useState([]),p=async()=>{try{const{data:v,error:w}=await Tk.from("Muestreo Plagas y Enfermedades").select("*").range(0,9999);if(w)throw w;f(v),console.log(" Datos de plagas y enfermedades:",v)}catch(v){console.error(" Error al obtener los datos:",v),oe.error("Error al cargar los registros de plagas")}};h.useEffect(()=>{p()},[]);const x=()=>{u([...c,{Fecha:r,Tunel:"",Cantidad:""}])},m=v=>{if(c.length>1){const w=c.filter((C,k)=>k!==v);u(w)}},y=(v,w,C)=>{const k=[...c];k[v]={...k[v],[w]:C},u(k)},j=v=>{const w=Lk[v];if(!w)return[];const[C,k]=w;return Array.from({length:k-C+1},(S,_)=>(C+_).toString())},b=()=>a&&s&&c.every(v=>v.Tunel&&v.Cantidad!==""),g=async v=>{if(v.preventDefault(),!b()){oe.error("Por favor complete todos los campos requeridos");return}t(!0);try{const{error:w}=await Tk.from("Muestreo Plagas y Enfermedades").insert(c.map(C=>({Fecha:r,Plaga:a,Sector:s,Tunel:C.Tunel,Cantidad:parseFloat(C.Cantidad)})));if(w)throw w;oe.success("Muestreo guardado exitosamente"),u([{Fecha:r,Tunel:"",Cantidad:""}]),i(""),l("")}catch(w){oe.error("Error al guardar el muestreo"),console.error("Error:",w)}finally{t(!1)}};return o.jsxs("form",{onSubmit:g,className:"space-y-6",children:[o.jsx("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Fecha de Muestreo"}),o.jsx("input",{type:"date",value:r,onChange:v=>{n(v.target.value),u(c.map(w=>({...w,Fecha:v.target.value})))},className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-md p-2 text-white",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Plaga"}),o.jsxs("select",{value:a,onChange:v=>i(v.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-md p-2 text-white",required:!0,children:[o.jsx("option",{value:"",children:"Seleccione una plaga"}),G7.map(v=>o.jsx("option",{value:v,children:v},v))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Sector"}),o.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-md p-2 text-white",required:!0,children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Lk).map(v=>o.jsxs("option",{value:v,children:["Sector ",v]},v))]})]})]})}),c.map((v,w)=>o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Entrada ",w+1]}),c.length>1&&o.jsx("button",{type:"button",onClick:()=>m(w),className:"p-2 text-[#A3A3A3] hover:text-white transition-colors",children:o.jsx(Ns,{size:20})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-1",children:"Tnel"}),o.jsxs("select",{value:v.Tunel,onChange:C=>y(w,"Tunel",C.target.value),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-md p-2 text-white",required:!0,disabled:!s,children:[o.jsx("option",{value:"",children:"Seleccione un tnel"}),s&&j(s).map(C=>o.jsxs("option",{value:C,children:["Tnel ",C]},C))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-1",children:"Cantidad"}),o.jsx("input",{type:"number",step:"0.01",value:v.Cantidad,onChange:C=>y(w,"Cantidad",C.target.value),onWheel:C=>C.currentTarget.blur(),className:"w-full bg-[#2A2A2A] border border-[#404040] rounded-md p-2 text-white",required:!0,min:"0",placeholder:"0"})]})]})]},w)),o.jsxs("button",{type:"button",onClick:x,className:"w-full bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2A2A2A] transition-colors",children:[o.jsx(Js,{className:"w-5 h-5"}),"Aadir otro registro"]}),o.jsx("button",{type:"submit",disabled:e,className:"w-full bg-[#3B82F6] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2563EB] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e?o.jsxs(o.Fragment,{children:[o.jsx(ir,{className:"w-5 h-5 animate-spin"}),o.jsx("span",{children:"Guardando..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Bi,{className:"w-5 h-5"}),o.jsx("span",{children:"Guardar Datos"})]})})]})}const H7=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Dk={"1A":"1-16","1B":"1-19","1C":"1-20","1D":"1-19","1E":"1-16","2A":"1-20","2B":"1-20","2C":"1-20","2D":"1-22","2E":"1-26","3A":"1-25","3B":"1-20","3C":"1-20","4A":"1-23","4B":"1-20","4C":"1-20","5A":"1-22","5B":"1-20","5C":"1-20","6A":"1-29","6B":"15-28","6C":"1-38","6D":"1-37","7A":"1-14","7B":"1-29","7C":"1-35","7D":"1-25","7E":"1-19","8A":"1-25","8B":"1-23","8C":"1-24","8D":"1-20","8E":"1-17","8F":"1-23"},xx={id:"1",tunel:"",ce:"",ph:"",no3:"",ca:"",k:"",na:""};function X7({type:e}){const[t,r]=h.useState(new Date().toISOString().split("T")[0]),[n,a]=h.useState(""),[i,s]=h.useState([xx]),[l,c]=h.useState(!1),[u,d]=h.useState({entries:{}}),f=()=>{s([...i,{...xx,id:(i.length+1).toString()}])},p=g=>{i.length>1&&(s(i.filter(v=>v.id!==g)),d(v=>{const w={...v};return delete w.entries[g],w}))},x=(g,v,w)=>{s(i.map(C=>C.id===g?{...C,[v]:w}:C)),d(C=>({...C,entries:{...C.entries,[g]:{...C.entries[g],[v]:!1}}}))},m=g=>{const v=Dk[g];if(!v)return[];const[w,C]=v.split("-").map(Number);return Array.from({length:C-w+1},(k,S)=>(S+w).toString())},y=()=>{const g={samplingDate:!t,selectedSector:!n,entries:{}};return i.forEach(v=>{g.entries[v.id]={tunel:!v.tunel,ce:!v.ce,ph:!v.ph,no3:!v.no3,ca:!v.ca,k:!v.k,na:!v.na}}),d(g),!g.samplingDate&&!g.selectedSector&&Object.values(g.entries).every(v=>Object.values(v).every(w=>!w))},j=async g=>{if(g.preventDefault(),!y()){oe.error("Por favor complete todos los campos requeridos");return}c(!0);try{const{error:v}=await H7.from("Muestreos Nutricion").insert(i.map(w=>({Fecha:t,Sector:n,Tunel:parseInt(w.tunel),"C.E.":parseFloat(parseFloat(w.ce).toFixed(2)),pH:parseFloat(parseFloat(w.ph).toFixed(1)),NO3:parseInt(w.no3),Ca:parseInt(w.ca),K:parseInt(w.k),Na:parseInt(w.na),Tipo:e==="goteros"?"Goteros":"Exprimidos"})));if(v)throw v;oe.success("Datos de nutricin guardados exitosamente"),a(""),s([{...xx}])}catch(v){console.error("Error saving nutrient data:",v),oe.error("Error al guardar los datos de nutricin")}finally{c(!1)}},b=g=>`
    w-full bg-[#1F1F1F] border ${g?"border-red-500":"border-[#2A2A2A]"}
    text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2
    ${g?"focus:ring-red-500":"focus:ring-[#3B82F6]"}
    ${g?"animate-shake":""}
  `;return o.jsxs("form",{onSubmit:j,className:"space-y-6",children:[o.jsx("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Fecha de Muestreo"}),o.jsx("input",{type:"date",value:t,onChange:g=>{r(g.target.value),d(v=>({...v,samplingDate:!1}))},className:b(u.samplingDate||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Sector"}),o.jsxs("select",{value:n,onChange:g=>{a(g.target.value),d(v=>({...v,selectedSector:!1}))},className:b(u.selectedSector||!1),children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Dk).map(g=>o.jsxs("option",{value:g,children:["Sector ",g]},g))]})]})]})}),i.map(g=>{var v,w,C,k,S,_,A;return o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Entrada ",g.id]}),i.length>1&&o.jsx("button",{type:"button",onClick:()=>p(g.id),className:"text-[#A3A3A3] hover:text-white transition-colors",children:o.jsx(Ns,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tnel"}),o.jsxs("select",{value:g.tunel,onChange:E=>x(g.id,"tunel",E.target.value),className:b(((v=u.entries[g.id])==null?void 0:v.tunel)||!1),disabled:!n,children:[o.jsx("option",{value:"",children:"Seleccione un tnel"}),n&&m(n).map(E=>o.jsxs("option",{value:E,children:["Tnel ",E]},E))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"C.E."}),o.jsx("input",{type:"number",step:"0.1",placeholder:"ej. 1.5",value:g.ce,onChange:E=>x(g.id,"ce",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((w=u.entries[g.id])==null?void 0:w.ce)||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"pH"}),o.jsx("input",{type:"number",step:"0.1",placeholder:"ej. 6.5",value:g.ph,onChange:E=>x(g.id,"ph",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((C=u.entries[g.id])==null?void 0:C.ph)||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"NO"}),o.jsx("input",{type:"number",placeholder:"ej. 150",value:g.no3,onChange:E=>x(g.id,"no3",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((k=u.entries[g.id])==null?void 0:k.no3)||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Ca"}),o.jsx("input",{type:"number",placeholder:"ej. 200",value:g.ca,onChange:E=>x(g.id,"ca",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((S=u.entries[g.id])==null?void 0:S.ca)||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"K"}),o.jsx("input",{type:"number",placeholder:"ej. 180",value:g.k,onChange:E=>x(g.id,"k",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((_=u.entries[g.id])==null?void 0:_.k)||!1)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Na"}),o.jsx("input",{type:"number",placeholder:"ej. 40",value:g.na,onChange:E=>x(g.id,"na",E.target.value),onWheel:E=>E.currentTarget.blur(),className:b(((A=u.entries[g.id])==null?void 0:A.na)||!1)})]})]})]},g.id)}),o.jsxs("button",{type:"button",onClick:f,className:"w-full bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2A2A2A] transition-colors",children:[o.jsx(Js,{className:"w-5 h-5"}),"Aadir otro registro"]}),o.jsxs("button",{type:"submit",disabled:l,className:"w-full bg-[#3B82F6] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2563EB] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[l?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(Bi,{className:"w-5 h-5"}),l?"Guardando...":"Guardar Datos"]})]})}function $0(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function gy(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Y7=6048e5;function J7(e,t){const r=t==null?void 0:t.weekStartsOn,n=$0(e),a=n.getDay(),i=(a<r?7:0)+a-r;return n.setDate(n.getDate()-i),n.setHours(0,0,0,0),n}function sp(e){return J7(e,{weekStartsOn:1})}function Z7(e){const t=$0(e),r=t.getFullYear(),n=gy(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=sp(n),i=gy(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const s=sp(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=s.getTime()?r:r-1}function Q7(e){const t=Z7(e),r=gy(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),sp(r)}function xy(e){const t=$0(e),r=+sp(t)-+Q7(t);return Math.round(r/Y7)+1}const vx=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Tf={"1A":[1,16],"1B":[1,19],"1C":[1,20],"1D":[1,19],"1E":[1,16],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]},yx={id:"1",tunel:"",tiempo:"",mililitros:""},bx={id:"1",sector:"",presion:"",hora:"12:00"},jx={id:"1",sector:"",mililitros:"",hora:"Inicio del da"};function e9({initialTab:e="aforos"}){const[t,r]=h.useState(e),[n,a]=h.useState(new Date().toISOString().split("T")[0]),[i,s]=h.useState(""),[l,c]=h.useState([yx]),[u,d]=h.useState([bx]),[f,p]=h.useState([jx]),[x,m]=h.useState(!1),[y,j]=h.useState({entries:{}});h.useEffect(()=>{r(e)},[e]);const b=()=>{t==="aforos"?c([...l,{...yx,id:String(l.length+1)}]):t==="presiones"?d([...u,{...bx,id:String(u.length+1)}]):p([...f,{...jx,id:String(f.length+1)}])},g=E=>{t==="aforos"&&l.length>1?c(l.filter(N=>N.id!==E)):t==="presiones"&&u.length>1?d(u.filter(N=>N.id!==E)):t==="probetas"&&f.length>1&&p(f.filter(N=>N.id!==E))},v=(E,N,$)=>{c(l.map(z=>z.id===E?{...z,[N]:$}:z))},w=(E,N,$)=>{d(u.map(z=>z.id===E?{...z,[N]:$}:z))},C=(E,N,$)=>{p(f.map(z=>z.id===E?{...z,[N]:$}:z))},k=E=>{const N=Tf[E];if(!N)return[];const[$,z]=N;return Array.from({length:z-$+1},(T,I)=>($+I).toString())},S=()=>{const E={samplingDate:!n,sector:t==="aforos"&&!i,entries:{}};return t==="aforos"?l.forEach(N=>{E.entries[N.id]={tunel:!N.tunel,tiempo:!N.tiempo||parseInt(N.tiempo)<=0,mililitros:!N.mililitros||parseInt(N.mililitros)<=0}}):t==="presiones"?u.forEach(N=>{E.entries[N.id]={sector:!N.sector,presion:!N.presion||parseFloat(N.presion)<=0,hora:!N.hora}}):f.forEach(N=>{E.entries[N.id]={sector:!N.sector,mililitros:!N.mililitros||parseInt(N.mililitros)<=0,hora:!N.hora}}),j(E),!E.samplingDate&&!E.sector&&Object.values(E.entries).every(N=>Object.values(N).every($=>!$))},_=async E=>{if(E.preventDefault(),!S()){oe.error("Por favor complete todos los campos requeridos");return}m(!0);try{if(t==="aforos"){const{error:N}=await vx.from("Muestreos Aforos Riego").insert(l.map($=>{const z=parseInt($.tiempo),T=parseInt($.mililitros);return{Fecha:n,Sector:i,Tunel:parseInt($.tunel),Tiempo:z,Mililitros:T,Semana:xy(new Date(n)),CaudalGotero:Math.round(T/z*60*10)/10}}));if(N)throw N;oe.success("Datos de aforo guardados exitosamente"),c([yx]),s("")}else if(t==="presiones"){const{error:N}=await vx.from("Muestreos Presiones").insert(u.map($=>({Fecha:n,Sector:$.sector,Presion:parseFloat($.presion),Horario:$.hora})));if(N)throw N;oe.success("Datos de presin guardados exitosamente"),d([bx])}else{const{error:N}=await vx.from("Muestreos Probetas").insert(f.map($=>({Fecha:n,Sector:$.sector,Mililitros:parseInt($.mililitros),Semana:xy(new Date(n))})));if(N)throw N;oe.success("Datos de probeta guardados exitosamente"),p([jx])}}catch(N){console.error(N),oe.error(`Error al guardar los datos de ${t}`)}finally{m(!1)}},A=E=>`
    w-full bg-[#1F1F1F] border ${E?"border-red-500":"border-[#2A2A2A]"}
    text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2
    ${E?"focus:ring-red-500":"focus:ring-[#3B82F6]"}
    ${E?"animate-shake":""}
  `;return o.jsxs("form",{onSubmit:_,className:"space-y-6",children:[o.jsx("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Fecha de Muestreo"}),o.jsx("input",{type:"date",value:n,onChange:E=>{a(E.target.value),j(N=>({...N,samplingDate:!1}))},className:A(y.samplingDate||!1)})]}),t==="aforos"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Sector"}),o.jsxs("select",{value:i,onChange:E=>{s(E.target.value),j(N=>({...N,sector:!1}))},className:A(y.sector||!1),children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Tf).map(E=>o.jsxs("option",{value:E,children:["Sector ",E]},E))]})]})]})}),o.jsxs("div",{className:"space-y-4",children:[t==="aforos"&&l.map(E=>{var N,$,z;return o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Entrada ",E.id]}),l.length>1&&o.jsx("button",{type:"button",onClick:()=>g(E.id),className:"text-[#A3A3A3] hover:text-white transition-colors",children:o.jsx(Ns,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tnel"}),o.jsxs("select",{value:E.tunel,onChange:T=>v(E.id,"tunel",T.target.value),className:A(((N=y.entries[E.id])==null?void 0:N.tunel)||!1),disabled:!i,children:[o.jsx("option",{value:"",children:"Seleccione un tnel"}),i&&k(i).map(T=>o.jsxs("option",{value:T,children:["Tnel ",T]},T))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tiempo (s)"}),o.jsx("input",{type:"number",value:E.tiempo,onChange:T=>v(E.id,"tiempo",T.target.value),onWheel:T=>T.currentTarget.blur(),className:A((($=y.entries[E.id])==null?void 0:$.tiempo)||!1),min:"1"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Mililitros"}),o.jsx("input",{type:"number",value:E.mililitros,onChange:T=>v(E.id,"mililitros",T.target.value),onWheel:T=>T.currentTarget.blur(),className:A(((z=y.entries[E.id])==null?void 0:z.mililitros)||!1),min:"1"})]})]})]},E.id)}),t==="presiones"&&u.map(E=>{var N,$;return o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold",children:["Entrada ",E.id]}),u.length>1&&o.jsx("button",{type:"button",onClick:()=>g(E.id),children:o.jsx(Ns,{className:"w-5 h-5 text-[#A3A3A3] hover:text-white"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-2",children:"Sector"}),o.jsxs("select",{value:E.sector,onChange:z=>w(E.id,"sector",z.target.value),className:A(((N=y.entries[E.id])==null?void 0:N.sector)||!1),children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Tf).map(z=>o.jsxs("option",{value:z,children:["Sector ",z]},z))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-2",children:"Presin"}),o.jsx("input",{type:"number",step:"0.1",value:E.presion,onChange:z=>w(E.id,"presion",z.target.value),onWheel:z=>z.currentTarget.blur(),className:A((($=y.entries[E.id])==null?void 0:$.presion)||!1),min:"0",placeholder:"0.0"})]})]})]},E.id)}),t==="probetas"&&f.map(E=>{var N,$;return o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold",children:["Entrada ",E.id]}),f.length>1&&o.jsx("button",{type:"button",onClick:()=>g(E.id),children:o.jsx(Ns,{className:"w-5 h-5 text-[#A3A3A3] hover:text-white"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-2",children:"Sector"}),o.jsxs("select",{value:E.sector,onChange:z=>C(E.id,"sector",z.target.value),className:A(((N=y.entries[E.id])==null?void 0:N.sector)||!1),children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Tf).map(z=>o.jsxs("option",{value:z,children:["Sector ",z]},z))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-2",children:"Mililitros"}),o.jsx("input",{type:"number",value:E.mililitros,onChange:z=>C(E.id,"mililitros",z.target.value),onWheel:z=>z.currentTarget.blur(),className:A((($=y.entries[E.id])==null?void 0:$.mililitros)||!1),min:"0",placeholder:"0"})]})]})]},E.id)})]}),o.jsxs("button",{type:"button",onClick:b,className:"w-full bg-[#1F1F1F] border border-[#2A2A2A] rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2A2A2A]",children:[o.jsx(Js,{className:"w-5 h-5"})," Aadir otro registro"]}),o.jsxs("button",{type:"submit",disabled:x,className:"w-full bg-[#3B82F6] rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2563EB] disabled:opacity-50 disabled:cursor-not-allowed",children:[x?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(Bi,{className:"w-5 h-5"}),x?"Guardando...":"Guardar Datos"]})]})}const t9=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Ik={"1A":[1,16],"1B":[1,19],"1C":[1,20],"1D":[1,19],"1E":[1,16],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]},wx={id:"1",sector:"",tunelInicio:"",tunelFinal:"",cantidadCubetas:""};function r9(){const[e,t]=h.useState(new Date().toISOString().split("T")[0]),[r,n]=h.useState([wx]),[a,i]=h.useState(!1),[s,l]=h.useState({entries:{}}),c=()=>{n([...r,{...wx,id:(r.length+1).toString()}])},u=y=>{r.length>1&&(n(r.filter(j=>j.id!==y)),l(j=>{const b={...j};return delete b.entries[y],b}))},d=(y,j,b)=>{n(r.map(g=>{if(g.id===y){const v={...g,[j]:b};return j==="sector"&&(v.tunelInicio="",v.tunelFinal=""),v}return g})),l(g=>({...g,entries:{...g.entries,[y]:{...g.entries[y],[j]:!1}}}))},f=y=>{const j=Ik[y];if(!j)return[];const[b,g]=j;return Array.from({length:g-b+1},(v,w)=>(b+w).toString())},p=()=>{const y={samplingDate:!e,entries:{}};return r.forEach(j=>{y.entries[j.id]={sector:!j.sector,tunelInicio:!j.tunelInicio,tunelFinal:!j.tunelFinal,cantidadCubetas:!j.cantidadCubetas||parseInt(j.cantidadCubetas)<=0}}),l(y),!y.samplingDate&&Object.values(y.entries).every(j=>Object.values(j).every(b=>!b))},x=async y=>{if(y.preventDefault(),!p()){oe.error("Por favor complete todos los campos requeridos");return}i(!0);try{const{error:j}=await t9.from("Muestreos Cosecha").insert(r.map(b=>({Fecha:e,Sector:b.sector,Tunel_inicio:parseInt(b.tunelInicio),Tunel_final:parseInt(b.tunelFinal),Cantidad_cubetas:parseInt(b.cantidadCubetas)})));if(j)throw j;oe.success("Datos de cosecha guardados exitosamente"),n([{...wx}])}catch(j){console.error("Error saving harvest data:",j),oe.error("Error al guardar los datos de cosecha")}finally{i(!1)}},m=y=>`
    w-full bg-[#1F1F1F] border ${y?"border-red-500":"border-[#2A2A2A]"}
    text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2
    ${y?"focus:ring-red-500":"focus:ring-[#3B82F6]"}
    ${y?"animate-shake":""}
  `;return o.jsxs("form",{onSubmit:x,className:"space-y-6",children:[o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsx("label",{className:"block text-lg font-medium text-white mb-1",children:"Fecha de Cosecha"}),o.jsx("input",{type:"date",value:e,onChange:y=>{t(y.target.value),l(j=>({...j,samplingDate:!1}))},className:m(s.samplingDate||!1)})]}),o.jsx("div",{className:"space-y-4",children:r.map(y=>{var j,b,g,v;return o.jsxs("div",{className:"bg-[#1A1A1A] p-6 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Entrada ",y.id]}),r.length>1&&o.jsx("button",{type:"button",onClick:()=>u(y.id),className:"text-[#A3A3A3] hover:text-white transition-colors",children:o.jsx(Ns,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Sector"}),o.jsxs("select",{value:y.sector,onChange:w=>d(y.id,"sector",w.target.value),className:m(((j=s.entries[y.id])==null?void 0:j.sector)||!1),children:[o.jsx("option",{value:"",children:"Seleccione un sector"}),Object.keys(Ik).map(w=>o.jsxs("option",{value:w,children:["Sector ",w]},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tnel Inicial"}),o.jsxs("select",{value:y.tunelInicio,onChange:w=>d(y.id,"tunelInicio",w.target.value),className:m(((b=s.entries[y.id])==null?void 0:b.tunelInicio)||!1),disabled:!y.sector,children:[o.jsx("option",{value:"",children:"Seleccione un tnel"}),y.sector&&f(y.sector).map(w=>o.jsxs("option",{value:w,children:["Tnel ",w]},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Tnel Final"}),o.jsxs("select",{value:y.tunelFinal,onChange:w=>d(y.id,"tunelFinal",w.target.value),className:m(((g=s.entries[y.id])==null?void 0:g.tunelFinal)||!1),disabled:!y.sector,children:[o.jsx("option",{value:"",children:"Seleccione un tnel"}),y.sector&&f(y.sector).map(w=>o.jsxs("option",{value:w,children:["Tnel ",w]},w))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Cantidad de Cubetas"}),o.jsx("input",{type:"number",value:y.cantidadCubetas,onChange:w=>d(y.id,"cantidadCubetas",w.target.value),onWheel:w=>w.currentTarget.blur(),className:m(((v=s.entries[y.id])==null?void 0:v.cantidadCubetas)||!1),min:"1"})]})]})]},y.id)})}),o.jsxs("button",{type:"button",onClick:c,className:"w-full bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2A2A2A] transition-colors",children:[o.jsx(Js,{className:"w-5 h-5"}),"Aadir otro registro"]}),o.jsxs("button",{type:"submit",disabled:a,className:"w-full bg-[#3B82F6] text-white rounded-xl py-4 flex items-center justify-center gap-2 hover:bg-[#2563EB] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[a?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(Bi,{className:"w-5 h-5"}),a?"Guardando...":"Guardar Datos"]})]})}const en=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Zi={"1A":[1,16],"1B":[1,19],"1C":[1,20],"1D":[1,19],"1E":[1,16],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]};function n9(){var K,Z,he,re;const[e,t]=h.useState([]),[r,n]=h.useState(!0),[a,i]=h.useState(""),[s,l]=h.useState(!0),[c,u]=h.useState([]),[d,f]=h.useState({}),[p,x]=h.useState({}),[m,y]=h.useState([]),[j,b]=h.useState([]),[g,v]=h.useState(null),[w,C]=h.useState({}),[k,S]=h.useState([]),[_,A]=h.useState(!1),[E,N]=h.useState([]),[$,z]=h.useState([]),[T,I]=h.useState([]),[L,D]=h.useState(!1);Sc(),h.useEffect(()=>{(async()=>{const[V,J]=await Promise.all([en.from("Labores Personal").select("*").eq("Activo",!0).range(0,9999),en.from("Muestreos Labores").select('Seccion, "Nombre Labor"').range(0,9999)]);if(V.error||J.error){oe.error("Error al cargar datos");return}const ne=V.data.filter(W=>{var ae;return((ae=W.Tipo)==null?void 0:ae.toUpperCase().trim())!=="N/A"}).sort((W,ae)=>W["Nombre Labor"].localeCompare(ae["Nombre Labor"])),Q=new Set,me=new Set;ne.flatMap(W=>(W.Seccion||"").split(",")).map(W=>W.trim()).filter(W=>/^([1-8][A-F])\s+Tunel\s+\d+$/.test(W)).forEach(W=>me.add(W)),N(Array.from(Q).sort()),t(ne),n(!1)})()},[]),h.useEffect(()=>{(async()=>{if(!g)return;const V=e.find(ue=>ue.id===g);if(!V)return;const{data:J,error:ne}=await en.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",V["Nombre Labor"]).range(0,9999);if(ne){console.error("Error cargando muestreos:",ne);return}const Q={};J==null||J.forEach(ue=>{(ue.Seccion||"").split(",").map(W=>W.trim()).forEach(W=>{const ae=W.match(/^([1-8][A-F])\s+Tunel\s+(\d+)$/);if(ae){const we=ae[1],ve=parseInt(ae[2],10);Q[we]||(Q[we]=new Set),Q[we].add(ve)}})});const me=[];for(const[ue,[W,ae]]of Object.entries(Zi)){const we=new Set(Array.from({length:ae-W+1},(ve,G)=>G+W));Q[ue]&&we.size===Q[ue].size&&[...we].every(ve=>Q[ue].has(ve))&&me.push(ue)}z(me)})()},[g]),h.useEffect(()=>{(async()=>{var V,J;try{const Q=await(await fetch("/tunnels.json")).json(),me=[],ue=[];for(const W of Q.features){const ae=(J=(V=W.properties)==null?void 0:V.name)==null?void 0:J.trim();ae&&(ae.startsWith("Camino")?me.push(ae):ae.startsWith("Periferia")&&ue.push(ae))}y(me.sort()),b(ue.sort())}catch(ne){console.error("Error cargando tunnels.json:",ne)}})()},[]),h.useEffect(()=>{(async()=>{if(!g)return;const V=e.find(me=>me.id===g);if(!V)return;const{data:J,error:ne}=await en.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",V["Nombre Labor"]).range(0,9999);if(ne){console.error("Error cargando muestreos de periferias:",ne);return}const Q=new Set;J==null||J.forEach(me=>{(me.Seccion||"").split(",").map(ue=>ue.trim()).forEach(ue=>{ue.startsWith("Periferia")&&Q.add(ue)})}),I(Array.from(Q))})()},[g]),h.useEffect(()=>{(async()=>{if(!g)return;const V=e.find(me=>me.id===g);if(!V)return;const{data:J,error:ne}=await en.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",V["Nombre Labor"]).range(0,9999);if(ne){console.error("Error cargando muestreos de caminos:",ne);return}const Q=new Set;J==null||J.forEach(me=>{(me.Seccion||"").split(",").map(ue=>ue.trim()).forEach(ue=>{ue.startsWith("Camino")&&Q.add(ue)})}),S(Array.from(Q))})()},[g]),h.useEffect(()=>{const X=V=>{var J,ne;if(((J=V.data)==null?void 0:J.type)==="SECCIONES_MAPA"&&g!==null){if(d[g]==="N/A"){(ne=window.frames[0])==null||ne.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:[]},"*"),C(me=>({...me,[g]:{...me[g],secciones:[]}}));return}const Q=V.data.secciones;C(me=>({...me,[g]:{...me[g],secciones:Q}}))}};return window.addEventListener("message",X),()=>window.removeEventListener("message",X)},[g]);const O=async()=>{const{data:X,error:V}=await en.from("Labores Personal").select("*").eq("Activo",!0).range(0,9999);if(V){console.error("Error fetching labores:",V);return}const J=(X||[]).filter(ne=>{var Q;return((Q=ne.Tipo)==null?void 0:Q.toUpperCase().trim())!=="N/A"}).sort((ne,Q)=>ne["Nombre Labor"].localeCompare(Q["Nombre Labor"]));t(J),n(!1)},F=h.useRef(null);h.useEffect(()=>{const X=V=>{F.current&&!F.current.contains(V.target)&&setShowTipoDropdown(!1)};return document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}},[]);const q=async()=>{var W;const X=g,V=w[X??-1];if(!V||V.secciones.length===0||!X){console.warn("Faltan campos para activar o editar la labor");return}const J=V.secciones.flatMap(ae=>{if(Zi[ae]){const[we,ve]=Zi[ae];return Array.from({length:ve-we+1},(G,R)=>`${ae} Tunel ${R+we}`)}return[ae]}),ne=((W=e.find(ae=>ae.id===X))==null?void 0:W["Nombre Labor"])||"",Q=J.join(", "),me=new Date().toISOString().split("T")[0],{error:ue}=await en.from("Muestreos Labores").insert({"Nombre Labor":ne,Fecha:me,Seccion:Q});if(ue){console.error(" Error al insertar en Muestreos Labores:",ue),oe.error("Error al guardar el muestreo");return}oe.success("Muestreo guardado"),D(!1),v(null),A(!1),O()},te=async(X,V)=>{try{const{data:J,error:ne}=await en.from("Muestreos Labores").select("ID, Seccion").eq("Nombre Labor",X);if(ne)throw ne;const Q=[],me=[];for(const ue of J){const W=ue.ID,we=(ue.Seccion||"").split(",").map(ve=>ve.trim()).filter(Boolean).filter(ve=>!V.includes(ve));we.length===0?me.push(W):Q.push({id:W,Seccion:we.join(", ")})}if(me.length>0){const{error:ue}=await en.from("Muestreos Labores").delete().in("ID",me);if(ue)throw ue}for(const ue of Q){const{error:W}=await en.from("Muestreos Labores").update({Seccion:ue.Seccion}).eq("ID",ue.id);if(W)throw W}oe.success("Registros actualizados"),O(),D(!1),A(!1),v(null)}catch(J){console.error(" Error en eliminacin parcial:",J),oe.error("Error al actualizar registros")}},B=e.filter(X=>X["Nombre Labor"].toLowerCase().includes(a.toLowerCase())).filter(X=>X.Activo);return o.jsx("div",{className:"bg-[#0D0D0D] min-h-screen text-white font-sans",children:o.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Registro de labores"}),o.jsx("p",{className:"text-[#A3A3A3] mb-6",children:"Registra los avances diarios de las labores."}),o.jsx("div",{className:"flex flex-wrap gap-4 mb-4 items-end"}),o.jsx("input",{type:"text",placeholder:"Buscar labor...",value:a,onChange:X=>i(X.target.value),className:"w-full mb-6 px-4 py-2 rounded-lg bg-[#1A1A1A] border border-[#333] text-white"}),L&&g!==null&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center",children:o.jsxs("div",{className:"flex w-full max-w-6xl h-[90vh] bg-[#1A1A1A] rounded-lg border border-[#333] overflow-hidden shadow-lg",children:[o.jsxs("div",{className:"w-[320px] p-4 bg-[#1A1A1A] border-r border-[#333] overflow-y-auto",children:[o.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:((K=e.find(X=>X.id===g))==null?void 0:K["Nombre Labor"])||"Editar Labor"}),((Z=d[g])==null?void 0:Z.includes("TUNELES"))&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 font-semibold mb-2",children:"Tneles"}),(()=>{var ne,Q,me;const X=((ne=w[g])==null?void 0:ne.secciones)||[],V=Array.from(new Set(((me=(Q=e.find(ue=>ue.id===g))==null?void 0:Q.Seccion)==null?void 0:me.split(",").map(ue=>ue.trim()).map(ue=>{const W=ue.match(/^([1-8][A-F])\s+Tunel\s+\d+$/);return(W==null?void 0:W[1])||null}).filter(Boolean))||[])),J={"Etapa 1":V.filter(ue=>/^[12]/.test(ue)),"Etapa 2":V.filter(ue=>/^[3-5]/.test(ue)),"Etapa 3":V.filter(ue=>/^[67]/.test(ue)),"Etapa 4":V.filter(ue=>/^[8]/.test(ue))};return Object.entries(J).map(([ue,W])=>{const ae=W.flatMap(ve=>{const[G,R]=Zi[ve];return Array.from({length:R-G+1},(Y,ge)=>`${ve} Tunel ${ge+G}`)}),we=ae.every(ve=>X.includes(ve));return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:we,onChange:ve=>{var Y;const G=new Set(X);ve.target.checked?ae.forEach(ge=>G.add(ge)):ae.forEach(ge=>G.delete(ge));const R=Array.from(G);C(ge=>({...ge,[g]:{...ge[g],secciones:R}})),(Y=window.frames[0])==null||Y.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:R},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:ue})]}),o.jsx("div",{className:"grid grid-cols-2 gap-2 pl-2",children:W.map(ve=>{const[G,R]=Zi[ve],Y=Array.from({length:R-G+1},(de,Oe)=>`${ve} Tunel ${Oe+G}`),ge=Y.every(de=>X.includes(de));return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:ge,onChange:de=>{var Ue;const Oe=new Set(X);de.target.checked?Y.forEach(ie=>Oe.add(ie)):Y.forEach(ie=>Oe.delete(ie));const be=Array.from(Oe);C(ie=>({...ie,[g]:{...ie[g],secciones:be}})),(Ue=window.frames[0])==null||Ue.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:be},"*")},className:"accent-blue-500"}),ve]},ve)})})]},ue)})})()]}),((he=d[g])==null?void 0:he.includes("CAMINOS"))&&m.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 font-semibold mb-2",children:"Caminos"}),Object.entries({"Etapa 1":["Camino 1A-1C","Camino 1B-1D","Camino 1C-2B","Camino 1D-1E","Camino 2A-2C","Camino 2B-2D","Camino 2C-2E","Camino Reservorio-2A","Camino Zanja Principal-1A"],"Etapa 2":["Camino 3A-4A","Camino 3B-4B","Camino 3C-4C","Camino 4A-5A","Camino 4B-5B","Camino 4C-5C"],"Etapa 3":["Camino 7A-6B/6C","Camino 7B-7A/6B","Camino 7C-6D","Camino 7D-7C","Camino 7E","Camino 7E-7D","Camino Lateral derecho 7D-7C","Camino 6D-6C","Camino Principal 6s","Camino Principal 7s","Camino lateral derecho 6D-6C"]}).map(([X,V])=>{var Q;const J=((Q=w[g])==null?void 0:Q.secciones)||[],ne=V.every(me=>J.includes(me));return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:ne,onChange:me=>{var ae;const ue=new Set(J);me.target.checked?V.forEach(we=>ue.add(we)):V.forEach(we=>ue.delete(we));const W=Array.from(ue);C(we=>({...we,[g]:{...we[g],secciones:W}})),(ae=window.frames[0])==null||ae.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:W},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:X})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:V.map(me=>{const ue=J.includes(me);return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:ue,onChange:W=>{var ve;const ae=new Set(J);W.target.checked?ae.add(me):ae.delete(me);const we=Array.from(ae);C(G=>({...G,[g]:{...G[g],secciones:we}})),(ve=window.frames[0])==null||ve.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:we},"*")},className:"accent-blue-500"}),me]},me)})})]},X)})]}),((re=d[g])==null?void 0:re.includes("PERIFERIA"))&&j.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 font-semibold mb-2",children:"Periferias"}),Object.entries({"Etapa 1":["Periferia 2E","Periferia 2D","Periferia 1E","Periferia Camino 2mts 2A/2C-2B/2D","Periferia Camino 2mts 1A/1C/2B-1B/1D/1E","Periferia Canal Biloxi"],"Etapa 2":["Periferia 3A","Periferia 3B","Periferia 3C","Periferia Divemex 1","Periferia Divemex 2","Periferia Externa 5C","Periferia Interna 5C","Periferia Externa 5A","Periferia Interna 5A","Periferia Externa 5B","Periferia Interna 5B","Periferia Reyes","Periferia camino 2mts 2da etapa Bs y Cs","Periferia canal 2da etapa As y Bs"],"Etapa 3":["Periferia 7B","Periferia Canal 6C-6D","Periferia Canal 7E-7C","Periferia Lateral 7B-6A","Periferia Zanja Principal 6A","Periferia Zanja Principal 6C"]}).map(([X,V])=>{var Q;const J=((Q=w[g])==null?void 0:Q.secciones)||[],ne=V.every(me=>J.includes(me));return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:ne,onChange:me=>{var ae;const ue=new Set(J);me.target.checked?V.forEach(we=>ue.add(we)):V.forEach(we=>ue.delete(we));const W=Array.from(ue);C(we=>({...we,[g]:{...we[g],secciones:W}})),(ae=window.frames[0])==null||ae.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:W,estilo:"verde"},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:X})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:V.map(me=>{const ue=J.includes(me);return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:ue,onChange:W=>{var ve;const ae=new Set(J);W.target.checked?ae.add(me):ae.delete(me);const we=Array.from(ae);C(G=>({...G,[g]:{...G[g],secciones:we}})),(ve=window.frames[0])==null||ve.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:we},"*")},className:"accent-blue-500"}),me]},me)})})]},X)})]}),o.jsxs("div",{className:"flex gap-2 mt-2 justify-end",children:[o.jsx("button",{onClick:()=>{D(!1),v(null),A(!1)},className:"bg-gray-600 hover:bg-gray-700 text-white text-xs px-3 py-1 rounded",children:"Cancelar"}),_?o.jsx("button",{onClick:async()=>{var ne,Q;const X=g,V=((ne=e.find(me=>me.id===X))==null?void 0:ne["Nombre Labor"])||"",J=((Q=w[X??-1])==null?void 0:Q.secciones)||[];if(!V||J.length===0){oe.error("Selecciona al menos un tnel para eliminar");return}await te(V,J)},className:"bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 rounded",children:"Eliminar registros"}):o.jsx("button",{onClick:async()=>{await q(),D(!1),v(null),A(!1)},className:"bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded",children:"Guardar"})]})]}),o.jsx("div",{className:"flex-1 min-h-[600px] h-[calc(100vh-4rem)]",children:o.jsx("iframe",{src:`/#/app/form-labores-map?laborId=${g}&tipo=${d[g]}`,className:"w-full h-full border-none",title:"Mapa de Labores"})})]})}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{onClick:()=>l(!s),className:"flex items-center gap-2 cursor-pointer select-none text-[#3B82F6] mb-2",children:[o.jsx("svg",{className:`w-4 h-4 transform transition-transform ${s?"rotate-90":"rotate-0"}`,fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"Activa"})]}),s&&B.map(X=>o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center p-4 bg-[#1A1A1A] rounded-lg border border-[#333] mb-2",children:[o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("div",{className:"font-semibold text-lg mb-1",children:X["Nombre Labor"]}),o.jsx("div",{className:"flex flex-col text-sm text-gray-300 space-y-1",children:o.jsxs("div",{children:["Secciones:"," ",o.jsx("span",{className:"ml-1 underline text-gray-100 cursor-pointer",onClick:()=>alert(X.Seccion||"Sin secciones"),children:X.Seccion?X.Seccion.split(",")[0]+(X.Seccion.split(",").length>1?"...":""):""})]})})]}),o.jsxs("div",{className:"flex flex-col gap-2 mt-4 md:mt-0",children:[o.jsx("button",{onClick:async()=>{var ve;const{data:V,error:J}=await en.from("Labores Personal").select("Tipo").eq("id",X.id).single();if(J||!(V!=null&&V.Tipo)){oe.error("Error cargando tipo de labor");return}const ne=V.Tipo.toUpperCase().trim();f(G=>({...G,[X.id]:ne}));const{data:Q,error:me}=await en.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",X["Nombre Labor"]);if(me||!Q){oe.error("Error cargando secciones");return}const ue=Q.flatMap(G=>(G.Seccion||"").split(",").map(R=>R.trim()).filter(Boolean)),W=Array.from(new Set(ue));C(G=>({...G,[X.id]:{secciones:W}})),v(X.id),D(!0),A(!1),(ve=window.frames[0])==null||ve.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:W,estilo:"verde"},"*");const ae={};W.forEach(G=>{const R=G.match(/^([1-8][A-F])\s+Tunel\s+(\d+)$/);if(R){const Y=R[1],ge=parseInt(R[2],10);ae[Y]||(ae[Y]=new Set),ae[Y].add(ge)}});const we=[];for(const[G,[R,Y]]of Object.entries(Zi)){const ge=new Set(Array.from({length:Y-R+1},(de,Oe)=>Oe+R));ae[G]&&ge.size===ae[G].size&&[...ge].every(de=>ae[G].has(de))&&we.push(G)}z(we),S(W.filter(G=>G.startsWith("Camino"))),I(W.filter(G=>G.startsWith("Periferia")))},className:"bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded-md",children:"Agregar Registro"}),o.jsx("button",{onClick:async()=>{var ve;const{data:V,error:J}=await en.from("Labores Personal").select("Tipo").eq("id",X.id).single();if(J||!(V!=null&&V.Tipo)){oe.error("Error cargando tipo de labor");return}const ne=V.Tipo.toUpperCase().trim();f(G=>({...G,[X.id]:ne}));const{data:Q,error:me}=await en.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",X["Nombre Labor"]);if(me||!Q||Q.length===0){oe.error("No hay registros para eliminar");return}const ue=Q.flatMap(G=>(G.Seccion||"").split(",").map(R=>R.trim()).filter(Boolean)),W=Array.from(new Set(ue));C(G=>({...G,[X.id]:{secciones:W}})),v(X.id),D(!0),A(!0),(ve=window.frames[0])==null||ve.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:W,estilo:"Naranja"},"*");const ae={};W.forEach(G=>{const R=G.match(/^([1-8][A-F])\s+Tunel\s+(\d+)$/);if(R){const Y=R[1],ge=parseInt(R[2],10);ae[Y]||(ae[Y]=new Set),ae[Y].add(ge)}});const we=[];for(const[G,[R,Y]]of Object.entries(Zi)){const ge=new Set(Array.from({length:Y-R+1},(de,Oe)=>Oe+R));ae[G]&&ge.size===ae[G].size&&[...ge].every(de=>ae[G].has(de))&&we.push(G)}z(we),S(W.filter(G=>G.startsWith("Camino"))),I(W.filter(G=>G.startsWith("Periferia")))},className:"bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded-md",children:"Eliminar registros"})]})]},X.id))]})]})})}const o9={pests:"Plagas y Enfermedades",riego:"Riego",nutricion:"Nutricin",labor:"Labores",harvest:"Cosecha"},a9={riego:[{id:"aforos",label:"Aforos"},{id:"presiones",label:"Presiones"},{id:"probetas",label:"Probetas"}],nutricion:[{id:"goteros",label:"Goteros"},{id:"exprimidos",label:"Exprimidos"}]};function i9(){const[e,t]=h.useState("pests"),[r,n]=h.useState(""),a=c=>{t(c),n(c==="riego"?"aforos":c==="nutricion"?"goteros":"")},i=c=>`
    py-2 px-4 -mb-px ${e===c?"border-b-2 border-[#3B82F6] text-white":"text-[#A3A3A3] hover:text-white"}
  `,s=c=>`
    py-2 px-4 -mb-px ${r===c?"border-b-2 border-[#3B82F6] text-white":"text-[#A3A3A3] hover:text-white"}
  `,l=()=>{switch(e){case"pests":return o.jsx(V7,{});case"riego":return o.jsx(e9,{initialTab:r});case"nutricion":return o.jsx(X7,{type:r});case"harvest":return o.jsx(r9,{});case"labor":return o.jsx(n9,{});default:return null}};return o.jsxs("div",{className:"min-h-screen bg-[#0D0D0D] text-white p-8",children:[o.jsx(M0,{position:"top-right"}),o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Registro de Muestreo"}),o.jsx("p",{className:"text-[#A3A3A3] text-lg",children:"Complete los datos del muestreo"})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("div",{className:"flex space-x-4 border-b border-[#2A2A2A] overflow-x-auto",children:Object.entries(o9).map(([c,u])=>o.jsx("button",{onClick:()=>a(c),className:i(c),children:u},c))}),(e==="riego"||e==="nutricion")&&o.jsx("div",{className:"flex space-x-4 mt-4",children:a9[e].map(({id:c,label:u})=>o.jsx("button",{onClick:()=>n(c),className:s(c),children:u},c))})]}),l()]})]})}function ha(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function R0(e,t=[]){let r=[];function n(i,s){const l=h.createContext(s),c=r.length;r=[...r,s];const u=f=>{var b;const{scope:p,children:x,...m}=f,y=((b=p==null?void 0:p[e])==null?void 0:b[c])||l,j=h.useMemo(()=>m,Object.values(m));return o.jsx(y.Provider,{value:j,children:x})};u.displayName=i+"Provider";function d(f,p){var y;const x=((y=p==null?void 0:p[e])==null?void 0:y[c])||l,m=h.useContext(x);if(m)return m;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,d]}const a=()=>{const i=r.map(s=>h.createContext(s));return function(l){const c=(l==null?void 0:l[e])||i;return h.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return a.scopeName=e,[n,s9(a,...t)]}function s9(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=n.reduce((l,{useScope:c,scopeName:u})=>{const f=c(i)[`__scope${u}`];return{...l,...f}},{});return h.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}function $k(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function PM(...e){return t=>{let r=!1;const n=e.map(a=>{const i=$k(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():$k(e[a],null)}}}}function lp(...e){return h.useCallback(PM(...e),e)}function vy(e){const t=l9(e),r=h.forwardRef((n,a)=>{const{children:i,...s}=n,l=h.Children.toArray(i),c=l.find(d9);if(c){const u=c.props.children,d=l.map(f=>f===c?h.Children.count(u)>1?h.Children.only(null):h.isValidElement(u)?u.props.children:null:f);return o.jsx(t,{...s,ref:a,children:h.isValidElement(u)?h.cloneElement(u,void 0,d):null})}return o.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}function l9(e){const t=h.forwardRef((r,n)=>{const{children:a,...i}=r;if(h.isValidElement(a)){const s=f9(a),l=u9(i,a.props);return a.type!==h.Fragment&&(l.ref=n?PM(n,s):s),h.cloneElement(a,l)}return h.Children.count(a)>1?h.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var c9=Symbol("radix.slottable");function d9(e){return h.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===c9}function u9(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function f9(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function h9(e){const t=e+"CollectionProvider",[r,n]=R0(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=y=>{const{scope:j,children:b}=y,g=zn.useRef(null),v=zn.useRef(new Map).current;return o.jsx(a,{scope:j,itemMap:v,collectionRef:g,children:b})};s.displayName=t;const l=e+"CollectionSlot",c=vy(l),u=zn.forwardRef((y,j)=>{const{scope:b,children:g}=y,v=i(l,b),w=lp(j,v.collectionRef);return o.jsx(c,{ref:w,children:g})});u.displayName=l;const d=e+"CollectionItemSlot",f="data-radix-collection-item",p=vy(d),x=zn.forwardRef((y,j)=>{const{scope:b,children:g,...v}=y,w=zn.useRef(null),C=lp(j,w),k=i(d,b);return zn.useEffect(()=>(k.itemMap.set(w,{ref:w,...v}),()=>void k.itemMap.delete(w))),o.jsx(p,{[f]:"",ref:C,children:g})});x.displayName=d;function m(y){const j=i(e+"CollectionConsumer",y);return zn.useCallback(()=>{const g=j.collectionRef.current;if(!g)return[];const v=Array.from(g.querySelectorAll(`[${f}]`));return Array.from(j.itemMap.values()).sort((k,S)=>v.indexOf(k.ref.current)-v.indexOf(S.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:s,Slot:u,ItemSlot:x},m,n]}var cp=globalThis!=null&&globalThis.document?h.useLayoutEffect:()=>{},p9=Pb[" useId ".trim().toString()]||(()=>{}),m9=0;function MM(e){const[t,r]=h.useState(p9());return cp(()=>{r(n=>n??String(m9++))},[e]),t?`radix-${t}`:""}var g9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ac=g9.reduce((e,t)=>{const r=vy(`Primitive.${t}`),n=h.forwardRef((a,i)=>{const{asChild:s,...l}=a,c=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function x9(e){const t=h.useRef(e);return h.useEffect(()=>{t.current=e}),h.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}var v9=Pb[" useInsertionEffect ".trim().toString()]||cp;function OM({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,s]=y9({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const d=h.useRef(e!==void 0);h.useEffect(()=>{const f=d.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const u=h.useCallback(d=>{var f;if(l){const p=b9(d)?d(e):d;p!==e&&((f=s.current)==null||f.call(s,p))}else i(d)},[l,e,i,s]);return[c,u]}function y9({defaultProp:e,onChange:t}){const[r,n]=h.useState(e),a=h.useRef(r),i=h.useRef(t);return v9(()=>{i.current=t},[t]),h.useEffect(()=>{var s;a.current!==r&&((s=i.current)==null||s.call(i,r),a.current=r)},[r,a]),[r,n,i]}function b9(e){return typeof e=="function"}var j9=h.createContext(void 0);function TM(e){const t=h.useContext(j9);return e||t||"ltr"}var Sx="rovingFocusGroup.onEntryFocus",w9={bubbles:!1,cancelable:!0},Uu="RovingFocusGroup",[yy,LM,S9]=h9(Uu),[k9,DM]=R0(Uu,[S9]),[C9,_9]=k9(Uu),IM=h.forwardRef((e,t)=>o.jsx(yy.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(yy.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(A9,{...e,ref:t})})}));IM.displayName=Uu;var A9=h.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=e,p=h.useRef(null),x=lp(t,p),m=TM(i),[y,j]=OM({prop:s,defaultProp:l??null,onChange:c,caller:Uu}),[b,g]=h.useState(!1),v=x9(u),w=LM(r),C=h.useRef(!1),[k,S]=h.useState(0);return h.useEffect(()=>{const _=p.current;if(_)return _.addEventListener(Sx,v),()=>_.removeEventListener(Sx,v)},[v]),o.jsx(C9,{scope:r,orientation:n,dir:m,loop:a,currentTabStopId:y,onItemFocus:h.useCallback(_=>j(_),[j]),onItemShiftTab:h.useCallback(()=>g(!0),[]),onFocusableItemAdd:h.useCallback(()=>S(_=>_+1),[]),onFocusableItemRemove:h.useCallback(()=>S(_=>_-1),[]),children:o.jsx(Ac.div,{tabIndex:b||k===0?-1:0,"data-orientation":n,...f,ref:x,style:{outline:"none",...e.style},onMouseDown:ha(e.onMouseDown,()=>{C.current=!0}),onFocus:ha(e.onFocus,_=>{const A=!C.current;if(_.target===_.currentTarget&&A&&!b){const E=new CustomEvent(Sx,w9);if(_.currentTarget.dispatchEvent(E),!E.defaultPrevented){const N=w().filter(L=>L.focusable),$=N.find(L=>L.active),z=N.find(L=>L.id===y),I=[$,z,...N].filter(Boolean).map(L=>L.ref.current);FM(I,d)}}C.current=!1}),onBlur:ha(e.onBlur,()=>g(!1))})})}),$M="RovingFocusGroupItem",RM=h.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:s,...l}=e,c=MM(),u=i||c,d=_9($M,r),f=d.currentTabStopId===u,p=LM(r),{onFocusableItemAdd:x,onFocusableItemRemove:m,currentTabStopId:y}=d;return h.useEffect(()=>{if(n)return x(),()=>m()},[n,x,m]),o.jsx(yy.ItemSlot,{scope:r,id:u,focusable:n,active:a,children:o.jsx(Ac.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...l,ref:t,onMouseDown:ha(e.onMouseDown,j=>{n?d.onItemFocus(u):j.preventDefault()}),onFocus:ha(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:ha(e.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){d.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const b=P9(j,d.orientation,d.dir);if(b!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let v=p().filter(w=>w.focusable).map(w=>w.ref.current);if(b==="last")v.reverse();else if(b==="prev"||b==="next"){b==="prev"&&v.reverse();const w=v.indexOf(j.currentTarget);v=d.loop?M9(v,w+1):v.slice(w+1)}setTimeout(()=>FM(v))}}),children:typeof s=="function"?s({isCurrentTabStop:f,hasTabStop:y!=null}):s})})});RM.displayName=$M;var E9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function N9(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function P9(e,t,r){const n=N9(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return E9[n]}function FM(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function M9(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var O9=IM,T9=RM;function L9(e,t){return h.useReducer((r,n)=>t[r][n]??r,e)}var zM=e=>{const{present:t,children:r}=e,n=D9(t),a=typeof r=="function"?r({present:n.isPresent}):h.Children.only(r),i=lp(n.ref,I9(a));return typeof r=="function"||n.isPresent?h.cloneElement(a,{ref:i}):null};zM.displayName="Presence";function D9(e){const[t,r]=h.useState(),n=h.useRef(null),a=h.useRef(e),i=h.useRef("none"),s=e?"mounted":"unmounted",[l,c]=L9(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return h.useEffect(()=>{const u=Lf(n.current);i.current=l==="mounted"?u:"none"},[l]),cp(()=>{const u=n.current,d=a.current;if(d!==e){const p=i.current,x=Lf(u);e?c("MOUNT"):x==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&p!==x?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),cp(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=x=>{const y=Lf(n.current).includes(x.animationName);if(x.target===t&&y&&(c("ANIMATION_END"),!a.current)){const j=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=j)})}},p=x=>{x.target===t&&(i.current=Lf(n.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:h.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Lf(e){return(e==null?void 0:e.animationName)||"none"}function I9(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Am="Tabs",[$9,Jse]=R0(Am,[DM]),BM=DM(),[R9,F0]=$9(Am),UM=h.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:s="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=TM(l),[f,p]=OM({prop:n,onChange:a,defaultProp:i??"",caller:Am});return o.jsx(R9,{scope:r,baseId:MM(),value:f,onValueChange:p,orientation:s,dir:d,activationMode:c,children:o.jsx(Ac.div,{dir:d,"data-orientation":s,...u,ref:t})})});UM.displayName=Am;var WM="TabsList",qM=h.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,i=F0(WM,r),s=BM(r);return o.jsx(O9,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:n,children:o.jsx(Ac.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});qM.displayName=WM;var KM="TabsTrigger",GM=h.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=e,s=F0(KM,r),l=BM(r),c=XM(s.baseId,n),u=YM(s.baseId,n),d=n===s.value;return o.jsx(T9,{asChild:!0,...l,focusable:!a,active:d,children:o.jsx(Ac.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:ha(e.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?s.onValueChange(n):f.preventDefault()}),onKeyDown:ha(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&s.onValueChange(n)}),onFocus:ha(e.onFocus,()=>{const f=s.activationMode!=="manual";!d&&!a&&f&&s.onValueChange(n)})})})});GM.displayName=KM;var VM="TabsContent",HM=h.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...s}=e,l=F0(VM,r),c=XM(l.baseId,n),u=YM(l.baseId,n),d=n===l.value,f=h.useRef(d);return h.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),o.jsx(zM,{present:a||d,children:({present:p})=>o.jsx(Ac.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:u,tabIndex:0,...s,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:p&&i})})});HM.displayName=VM;function XM(e,t){return`${e}-trigger-${t}`}function YM(e,t){return`${e}-content-${t}`}var F9=UM,JM=qM,ZM=GM,QM=HM;function eO(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=eO(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function at(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=eO(e))&&(n&&(n+=" "),n+=t);return n}const z0="-",z9=e=>{const t=U9(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:s=>{const l=s.split(z0);return l[0]===""&&l.length!==1&&l.shift(),tO(l,t)||B9(s)},getConflictingClassGroupIds:(s,l)=>{const c=r[s]||[];return l&&n[s]?[...c,...n[s]]:c}}},tO=(e,t)=>{var s;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?tO(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(z0);return(s=t.validators.find(({validator:l})=>l(i)))==null?void 0:s.classGroupId},Rk=/^\[(.+)\]$/,B9=e=>{if(Rk.test(e)){const t=Rk.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},U9=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)by(r[a],n,a,t);return n},by=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:Fk(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(W9(a)){by(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,s])=>{by(s,Fk(t,i),r,n)})})},Fk=(e,t)=>{let r=e;return t.split(z0).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},W9=e=>e.isThemeGetter,q9=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,s)=>{r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let s=r.get(i);if(s!==void 0)return s;if((s=n.get(i))!==void 0)return a(i,s),s},set(i,s){r.has(i)?r.set(i,s):a(i,s)}}},jy="!",wy=":",K9=wy.length,G9=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const i=[];let s=0,l=0,c=0,u;for(let m=0;m<a.length;m++){let y=a[m];if(s===0&&l===0){if(y===wy){i.push(a.slice(c,m)),c=m+K9;continue}if(y==="/"){u=m;continue}}y==="["?s++:y==="]"?s--:y==="("?l++:y===")"&&l--}const d=i.length===0?a:a.substring(c),f=V9(d),p=f!==d,x=u&&u>c?u-c:void 0;return{modifiers:i,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:x}};if(t){const a=t+wy,i=n;n=s=>s.startsWith(a)?i(s.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:s,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=i=>r({className:i,parseClassName:a})}return n},V9=e=>e.endsWith(jy)?e.substring(0,e.length-1):e.startsWith(jy)?e.substring(1):e,H9=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let i=[];return n.forEach(s=>{s[0]==="["||t[s]?(a.push(...i.sort(),s),i=[]):i.push(s)}),a.push(...i.sort()),a}},X9=e=>({cache:q9(e.cacheSize),parseClassName:G9(e),sortModifiers:H9(e),...z9(e)}),Y9=/\s+/,J9=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:i}=t,s=[],l=e.trim().split(Y9);let c="";for(let u=l.length-1;u>=0;u-=1){const d=l[u],{isExternal:f,modifiers:p,hasImportantModifier:x,baseClassName:m,maybePostfixModifierPosition:y}=r(d);if(f){c=d+(c.length>0?" "+c:c);continue}let j=!!y,b=n(j?m.substring(0,y):m);if(!b){if(!j){c=d+(c.length>0?" "+c:c);continue}if(b=n(m),!b){c=d+(c.length>0?" "+c:c);continue}j=!1}const g=i(p).join(":"),v=x?g+jy:g,w=v+b;if(s.includes(w))continue;s.push(w);const C=a(b,j);for(let k=0;k<C.length;++k){const S=C[k];s.push(v+S)}c=d+(c.length>0?" "+c:c)}return c};function Z9(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=rO(t))&&(n&&(n+=" "),n+=r);return n}const rO=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=rO(e[n]))&&(r&&(r+=" "),r+=t);return r};function Q9(e,...t){let r,n,a,i=s;function s(c){const u=t.reduce((d,f)=>f(d),e());return r=X9(u),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=J9(c,r);return a(c,d),d}return function(){return i(Z9.apply(null,arguments))}}const tr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},nO=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,oO=/^\((?:(\w[\w-]*):)?(.+)\)$/i,eU=/^\d+\/\d+$/,tU=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rU=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,nU=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,oU=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,aU=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,fl=e=>eU.test(e),Ve=e=>!!e&&!Number.isNaN(Number(e)),Ua=e=>!!e&&Number.isInteger(Number(e)),kx=e=>e.endsWith("%")&&Ve(e.slice(0,-1)),Yo=e=>tU.test(e),iU=()=>!0,sU=e=>rU.test(e)&&!nU.test(e),aO=()=>!1,lU=e=>oU.test(e),cU=e=>aU.test(e),dU=e=>!Te(e)&&!Le(e),uU=e=>Ec(e,lO,aO),Te=e=>nO.test(e),Qi=e=>Ec(e,cO,sU),Cx=e=>Ec(e,gU,Ve),zk=e=>Ec(e,iO,aO),fU=e=>Ec(e,sO,cU),Df=e=>Ec(e,dO,lU),Le=e=>oO.test(e),rd=e=>Nc(e,cO),hU=e=>Nc(e,xU),Bk=e=>Nc(e,iO),pU=e=>Nc(e,lO),mU=e=>Nc(e,sO),If=e=>Nc(e,dO,!0),Ec=(e,t,r)=>{const n=nO.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},Nc=(e,t,r=!1)=>{const n=oO.exec(e);return n?n[1]?t(n[1]):r:!1},iO=e=>e==="position"||e==="percentage",sO=e=>e==="image"||e==="url",lO=e=>e==="length"||e==="size"||e==="bg-size",cO=e=>e==="length",gU=e=>e==="number",xU=e=>e==="family-name",dO=e=>e==="shadow",vU=()=>{const e=tr("color"),t=tr("font"),r=tr("text"),n=tr("font-weight"),a=tr("tracking"),i=tr("leading"),s=tr("breakpoint"),l=tr("container"),c=tr("spacing"),u=tr("radius"),d=tr("shadow"),f=tr("inset-shadow"),p=tr("text-shadow"),x=tr("drop-shadow"),m=tr("blur"),y=tr("perspective"),j=tr("aspect"),b=tr("ease"),g=tr("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...w(),Le,Te],k=()=>["auto","hidden","clip","visible","scroll"],S=()=>["auto","contain","none"],_=()=>[Le,Te,c],A=()=>[fl,"full","auto",..._()],E=()=>[Ua,"none","subgrid",Le,Te],N=()=>["auto",{span:["full",Ua,Le,Te]},Ua,Le,Te],$=()=>[Ua,"auto",Le,Te],z=()=>["auto","min","max","fr",Le,Te],T=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],I=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",..._()],D=()=>[fl,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",..._()],O=()=>[e,Le,Te],F=()=>[...w(),Bk,zk,{position:[Le,Te]}],q=()=>["no-repeat",{repeat:["","x","y","space","round"]}],te=()=>["auto","cover","contain",pU,uU,{size:[Le,Te]}],H=()=>[kx,rd,Qi],B=()=>["","none","full",u,Le,Te],K=()=>["",Ve,rd,Qi],Z=()=>["solid","dashed","dotted","double"],he=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],re=()=>[Ve,kx,Bk,zk],X=()=>["","none",m,Le,Te],V=()=>["none",Ve,Le,Te],J=()=>["none",Ve,Le,Te],ne=()=>[Ve,Le,Te],Q=()=>[fl,"full",..._()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Yo],breakpoint:[Yo],color:[iU],container:[Yo],"drop-shadow":[Yo],ease:["in","out","in-out"],font:[dU],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Yo],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Yo],shadow:[Yo],spacing:["px",Ve],text:[Yo],"text-shadow":[Yo],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",fl,Te,Le,j]}],container:["container"],columns:[{columns:[Ve,Te,Le,l]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:A()}],"inset-x":[{"inset-x":A()}],"inset-y":[{"inset-y":A()}],start:[{start:A()}],end:[{end:A()}],top:[{top:A()}],right:[{right:A()}],bottom:[{bottom:A()}],left:[{left:A()}],visibility:["visible","invisible","collapse"],z:[{z:[Ua,"auto",Le,Te]}],basis:[{basis:[fl,"full","auto",l,..._()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ve,fl,"auto","initial","none",Te]}],grow:[{grow:["",Ve,Le,Te]}],shrink:[{shrink:["",Ve,Le,Te]}],order:[{order:[Ua,"first","last","none",Le,Te]}],"grid-cols":[{"grid-cols":E()}],"col-start-end":[{col:N()}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":E()}],"row-start-end":[{row:N()}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":z()}],"auto-rows":[{"auto-rows":z()}],gap:[{gap:_()}],"gap-x":[{"gap-x":_()}],"gap-y":[{"gap-y":_()}],"justify-content":[{justify:[...T(),"normal"]}],"justify-items":[{"justify-items":[...I(),"normal"]}],"justify-self":[{"justify-self":["auto",...I()]}],"align-content":[{content:["normal",...T()]}],"align-items":[{items:[...I(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...I(),{baseline:["","last"]}]}],"place-content":[{"place-content":T()}],"place-items":[{"place-items":[...I(),"baseline"]}],"place-self":[{"place-self":["auto",...I()]}],p:[{p:_()}],px:[{px:_()}],py:[{py:_()}],ps:[{ps:_()}],pe:[{pe:_()}],pt:[{pt:_()}],pr:[{pr:_()}],pb:[{pb:_()}],pl:[{pl:_()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":_()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":_()}],"space-y-reverse":["space-y-reverse"],size:[{size:D()}],w:[{w:[l,"screen",...D()]}],"min-w":[{"min-w":[l,"screen","none",...D()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[s]},...D()]}],h:[{h:["screen","lh",...D()]}],"min-h":[{"min-h":["screen","lh","none",...D()]}],"max-h":[{"max-h":["screen","lh",...D()]}],"font-size":[{text:["base",r,rd,Qi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Le,Cx]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",kx,Te]}],"font-family":[{font:[hU,Te,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Le,Te]}],"line-clamp":[{"line-clamp":[Ve,"none",Le,Cx]}],leading:[{leading:[i,..._()]}],"list-image":[{"list-image":["none",Le,Te]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Le,Te]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:O()}],"text-color":[{text:O()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ve,"from-font","auto",Le,Qi]}],"text-decoration-color":[{decoration:O()}],"underline-offset":[{"underline-offset":[Ve,"auto",Le,Te]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:_()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Le,Te]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Le,Te]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:F()}],"bg-repeat":[{bg:q()}],"bg-size":[{bg:te()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ua,Le,Te],radial:["",Le,Te],conic:[Ua,Le,Te]},mU,fU]}],"bg-color":[{bg:O()}],"gradient-from-pos":[{from:H()}],"gradient-via-pos":[{via:H()}],"gradient-to-pos":[{to:H()}],"gradient-from":[{from:O()}],"gradient-via":[{via:O()}],"gradient-to":[{to:O()}],rounded:[{rounded:B()}],"rounded-s":[{"rounded-s":B()}],"rounded-e":[{"rounded-e":B()}],"rounded-t":[{"rounded-t":B()}],"rounded-r":[{"rounded-r":B()}],"rounded-b":[{"rounded-b":B()}],"rounded-l":[{"rounded-l":B()}],"rounded-ss":[{"rounded-ss":B()}],"rounded-se":[{"rounded-se":B()}],"rounded-ee":[{"rounded-ee":B()}],"rounded-es":[{"rounded-es":B()}],"rounded-tl":[{"rounded-tl":B()}],"rounded-tr":[{"rounded-tr":B()}],"rounded-br":[{"rounded-br":B()}],"rounded-bl":[{"rounded-bl":B()}],"border-w":[{border:K()}],"border-w-x":[{"border-x":K()}],"border-w-y":[{"border-y":K()}],"border-w-s":[{"border-s":K()}],"border-w-e":[{"border-e":K()}],"border-w-t":[{"border-t":K()}],"border-w-r":[{"border-r":K()}],"border-w-b":[{"border-b":K()}],"border-w-l":[{"border-l":K()}],"divide-x":[{"divide-x":K()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":K()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Z(),"hidden","none"]}],"divide-style":[{divide:[...Z(),"hidden","none"]}],"border-color":[{border:O()}],"border-color-x":[{"border-x":O()}],"border-color-y":[{"border-y":O()}],"border-color-s":[{"border-s":O()}],"border-color-e":[{"border-e":O()}],"border-color-t":[{"border-t":O()}],"border-color-r":[{"border-r":O()}],"border-color-b":[{"border-b":O()}],"border-color-l":[{"border-l":O()}],"divide-color":[{divide:O()}],"outline-style":[{outline:[...Z(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ve,Le,Te]}],"outline-w":[{outline:["",Ve,rd,Qi]}],"outline-color":[{outline:O()}],shadow:[{shadow:["","none",d,If,Df]}],"shadow-color":[{shadow:O()}],"inset-shadow":[{"inset-shadow":["none",f,If,Df]}],"inset-shadow-color":[{"inset-shadow":O()}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:O()}],"ring-offset-w":[{"ring-offset":[Ve,Qi]}],"ring-offset-color":[{"ring-offset":O()}],"inset-ring-w":[{"inset-ring":K()}],"inset-ring-color":[{"inset-ring":O()}],"text-shadow":[{"text-shadow":["none",p,If,Df]}],"text-shadow-color":[{"text-shadow":O()}],opacity:[{opacity:[Ve,Le,Te]}],"mix-blend":[{"mix-blend":[...he(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":he()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ve]}],"mask-image-linear-from-pos":[{"mask-linear-from":re()}],"mask-image-linear-to-pos":[{"mask-linear-to":re()}],"mask-image-linear-from-color":[{"mask-linear-from":O()}],"mask-image-linear-to-color":[{"mask-linear-to":O()}],"mask-image-t-from-pos":[{"mask-t-from":re()}],"mask-image-t-to-pos":[{"mask-t-to":re()}],"mask-image-t-from-color":[{"mask-t-from":O()}],"mask-image-t-to-color":[{"mask-t-to":O()}],"mask-image-r-from-pos":[{"mask-r-from":re()}],"mask-image-r-to-pos":[{"mask-r-to":re()}],"mask-image-r-from-color":[{"mask-r-from":O()}],"mask-image-r-to-color":[{"mask-r-to":O()}],"mask-image-b-from-pos":[{"mask-b-from":re()}],"mask-image-b-to-pos":[{"mask-b-to":re()}],"mask-image-b-from-color":[{"mask-b-from":O()}],"mask-image-b-to-color":[{"mask-b-to":O()}],"mask-image-l-from-pos":[{"mask-l-from":re()}],"mask-image-l-to-pos":[{"mask-l-to":re()}],"mask-image-l-from-color":[{"mask-l-from":O()}],"mask-image-l-to-color":[{"mask-l-to":O()}],"mask-image-x-from-pos":[{"mask-x-from":re()}],"mask-image-x-to-pos":[{"mask-x-to":re()}],"mask-image-x-from-color":[{"mask-x-from":O()}],"mask-image-x-to-color":[{"mask-x-to":O()}],"mask-image-y-from-pos":[{"mask-y-from":re()}],"mask-image-y-to-pos":[{"mask-y-to":re()}],"mask-image-y-from-color":[{"mask-y-from":O()}],"mask-image-y-to-color":[{"mask-y-to":O()}],"mask-image-radial":[{"mask-radial":[Le,Te]}],"mask-image-radial-from-pos":[{"mask-radial-from":re()}],"mask-image-radial-to-pos":[{"mask-radial-to":re()}],"mask-image-radial-from-color":[{"mask-radial-from":O()}],"mask-image-radial-to-color":[{"mask-radial-to":O()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[Ve]}],"mask-image-conic-from-pos":[{"mask-conic-from":re()}],"mask-image-conic-to-pos":[{"mask-conic-to":re()}],"mask-image-conic-from-color":[{"mask-conic-from":O()}],"mask-image-conic-to-color":[{"mask-conic-to":O()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:F()}],"mask-repeat":[{mask:q()}],"mask-size":[{mask:te()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Le,Te]}],filter:[{filter:["","none",Le,Te]}],blur:[{blur:X()}],brightness:[{brightness:[Ve,Le,Te]}],contrast:[{contrast:[Ve,Le,Te]}],"drop-shadow":[{"drop-shadow":["","none",x,If,Df]}],"drop-shadow-color":[{"drop-shadow":O()}],grayscale:[{grayscale:["",Ve,Le,Te]}],"hue-rotate":[{"hue-rotate":[Ve,Le,Te]}],invert:[{invert:["",Ve,Le,Te]}],saturate:[{saturate:[Ve,Le,Te]}],sepia:[{sepia:["",Ve,Le,Te]}],"backdrop-filter":[{"backdrop-filter":["","none",Le,Te]}],"backdrop-blur":[{"backdrop-blur":X()}],"backdrop-brightness":[{"backdrop-brightness":[Ve,Le,Te]}],"backdrop-contrast":[{"backdrop-contrast":[Ve,Le,Te]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ve,Le,Te]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ve,Le,Te]}],"backdrop-invert":[{"backdrop-invert":["",Ve,Le,Te]}],"backdrop-opacity":[{"backdrop-opacity":[Ve,Le,Te]}],"backdrop-saturate":[{"backdrop-saturate":[Ve,Le,Te]}],"backdrop-sepia":[{"backdrop-sepia":["",Ve,Le,Te]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":_()}],"border-spacing-x":[{"border-spacing-x":_()}],"border-spacing-y":[{"border-spacing-y":_()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Le,Te]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ve,"initial",Le,Te]}],ease:[{ease:["linear","initial",b,Le,Te]}],delay:[{delay:[Ve,Le,Te]}],animate:[{animate:["none",g,Le,Te]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,Le,Te]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:V()}],"rotate-x":[{"rotate-x":V()}],"rotate-y":[{"rotate-y":V()}],"rotate-z":[{"rotate-z":V()}],scale:[{scale:J()}],"scale-x":[{"scale-x":J()}],"scale-y":[{"scale-y":J()}],"scale-z":[{"scale-z":J()}],"scale-3d":["scale-3d"],skew:[{skew:ne()}],"skew-x":[{"skew-x":ne()}],"skew-y":[{"skew-y":ne()}],transform:[{transform:[Le,Te,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Q()}],"translate-x":[{"translate-x":Q()}],"translate-y":[{"translate-y":Q()}],"translate-z":[{"translate-z":Q()}],"translate-none":["translate-none"],accent:[{accent:O()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:O()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Le,Te]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":_()}],"scroll-mx":[{"scroll-mx":_()}],"scroll-my":[{"scroll-my":_()}],"scroll-ms":[{"scroll-ms":_()}],"scroll-me":[{"scroll-me":_()}],"scroll-mt":[{"scroll-mt":_()}],"scroll-mr":[{"scroll-mr":_()}],"scroll-mb":[{"scroll-mb":_()}],"scroll-ml":[{"scroll-ml":_()}],"scroll-p":[{"scroll-p":_()}],"scroll-px":[{"scroll-px":_()}],"scroll-py":[{"scroll-py":_()}],"scroll-ps":[{"scroll-ps":_()}],"scroll-pe":[{"scroll-pe":_()}],"scroll-pt":[{"scroll-pt":_()}],"scroll-pr":[{"scroll-pr":_()}],"scroll-pb":[{"scroll-pb":_()}],"scroll-pl":[{"scroll-pl":_()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Le,Te]}],fill:[{fill:["none",...O()]}],"stroke-w":[{stroke:[Ve,rd,Qi,Cx]}],stroke:[{stroke:["none",...O()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},yU=Q9(vU);function Ar(...e){return yU(at(e))}const bU=F9,uO=h.forwardRef(({className:e,...t},r)=>o.jsx(JM,{ref:r,className:Ar("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...t}));uO.displayName=JM.displayName;const Sy=h.forwardRef(({className:e,...t},r)=>o.jsx(ZM,{ref:r,className:Ar("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...t}));Sy.displayName=ZM.displayName;const ky=h.forwardRef(({className:e,...t},r)=>o.jsx(QM,{ref:r,className:Ar("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ky.displayName=QM.displayName;const bd=h.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:Ar("rounded-xl border bg-card text-card-foreground shadow",e),...t}));bd.displayName="Card";const jU=h.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:Ar("flex flex-col space-y-1.5 p-6",e),...t}));jU.displayName="CardHeader";const wU=h.forwardRef(({className:e,...t},r)=>o.jsx("h3",{ref:r,className:Ar("text-2xl font-semibold leading-none tracking-tight",e),...t}));wU.displayName="CardTitle";const SU=h.forwardRef(({className:e,...t},r)=>o.jsx("p",{ref:r,className:Ar("text-sm text-muted-foreground",e),...t}));SU.displayName="CardDescription";const fO=h.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:Ar("p-6 pt-0",e),...t}));fO.displayName="CardContent";const kU=h.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:Ar("flex items-center p-6 pt-0",e),...t}));kU.displayName="CardFooter";const xh=h.forwardRef(({className:e,...t},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:Ar("w-full caption-bottom text-sm",e),...t})}));xh.displayName="Table";const vh=h.forwardRef(({className:e,...t},r)=>o.jsx("thead",{ref:r,className:Ar("[&_tr]:border-b",e),...t}));vh.displayName="TableHeader";const yh=h.forwardRef(({className:e,...t},r)=>o.jsx("tbody",{ref:r,className:Ar("[&_tr:last-child]:border-0",e),...t}));yh.displayName="TableBody";const CU=h.forwardRef(({className:e,...t},r)=>o.jsx("tfoot",{ref:r,className:Ar("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));CU.displayName="TableFooter";const os=h.forwardRef(({className:e,...t},r)=>o.jsx("tr",{ref:r,className:Ar("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));os.displayName="TableRow";const Rt=h.forwardRef(({className:e,...t},r)=>o.jsx("th",{ref:r,className:Ar("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Rt.displayName="TableHead";const Ft=h.forwardRef(({className:e,...t},r)=>o.jsx("td",{ref:r,className:Ar("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Ft.displayName="TableCell";const _U=h.forwardRef(({className:e,...t},r)=>o.jsx("caption",{ref:r,className:Ar("mt-4 text-sm text-muted-foreground",e),...t}));_U.displayName="TableCaption";var Em={},hO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(hO);var B0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(B0);var U0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(U0);var Nm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",l="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const u=r[i];l?u==="\\"&&i+1<a?(i++,s+=r[i]):u===l?l="":s+=u:c?u==='"'||u==="'"?l=u:u==="]"?(c=!1,n.push(s),s=""):s+=u:u==="["?(c=!0,s&&(n.push(s),s="")):u==="."?s&&(n.push(s),s=""):s+=u,i++}return s&&n.push(s),n}e.toPath=t})(Nm);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hO,r=B0,n=U0,a=Nm;function i(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?i(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return s(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function s(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=i})(Em);var AU=Em.get;const Oi=no(AU);var pO={exports:{}},mt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vr=typeof Symbol=="function"&&Symbol.for,W0=vr?Symbol.for("react.element"):60103,q0=vr?Symbol.for("react.portal"):60106,Pm=vr?Symbol.for("react.fragment"):60107,Mm=vr?Symbol.for("react.strict_mode"):60108,Om=vr?Symbol.for("react.profiler"):60114,Tm=vr?Symbol.for("react.provider"):60109,Lm=vr?Symbol.for("react.context"):60110,K0=vr?Symbol.for("react.async_mode"):60111,Dm=vr?Symbol.for("react.concurrent_mode"):60111,Im=vr?Symbol.for("react.forward_ref"):60112,$m=vr?Symbol.for("react.suspense"):60113,EU=vr?Symbol.for("react.suspense_list"):60120,Rm=vr?Symbol.for("react.memo"):60115,Fm=vr?Symbol.for("react.lazy"):60116,NU=vr?Symbol.for("react.block"):60121,PU=vr?Symbol.for("react.fundamental"):60117,MU=vr?Symbol.for("react.responder"):60118,OU=vr?Symbol.for("react.scope"):60119;function Tn(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case W0:switch(e=e.type,e){case K0:case Dm:case Pm:case Om:case Mm:case $m:return e;default:switch(e=e&&e.$$typeof,e){case Lm:case Im:case Fm:case Rm:case Tm:return e;default:return t}}case q0:return t}}}function mO(e){return Tn(e)===Dm}mt.AsyncMode=K0;mt.ConcurrentMode=Dm;mt.ContextConsumer=Lm;mt.ContextProvider=Tm;mt.Element=W0;mt.ForwardRef=Im;mt.Fragment=Pm;mt.Lazy=Fm;mt.Memo=Rm;mt.Portal=q0;mt.Profiler=Om;mt.StrictMode=Mm;mt.Suspense=$m;mt.isAsyncMode=function(e){return mO(e)||Tn(e)===K0};mt.isConcurrentMode=mO;mt.isContextConsumer=function(e){return Tn(e)===Lm};mt.isContextProvider=function(e){return Tn(e)===Tm};mt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===W0};mt.isForwardRef=function(e){return Tn(e)===Im};mt.isFragment=function(e){return Tn(e)===Pm};mt.isLazy=function(e){return Tn(e)===Fm};mt.isMemo=function(e){return Tn(e)===Rm};mt.isPortal=function(e){return Tn(e)===q0};mt.isProfiler=function(e){return Tn(e)===Om};mt.isStrictMode=function(e){return Tn(e)===Mm};mt.isSuspense=function(e){return Tn(e)===$m};mt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Pm||e===Dm||e===Om||e===Mm||e===$m||e===EU||typeof e=="object"&&e!==null&&(e.$$typeof===Fm||e.$$typeof===Rm||e.$$typeof===Tm||e.$$typeof===Lm||e.$$typeof===Im||e.$$typeof===PU||e.$$typeof===MU||e.$$typeof===OU||e.$$typeof===NU)};mt.typeOf=Tn;pO.exports=mt;var TU=pO.exports,mr=e=>e===0?0:e>0?1:-1,An=e=>typeof e=="number"&&e!=+e,gs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Pe=e=>(typeof e=="number"||e instanceof Number)&&!An(e),Bo=e=>Pe(e)||typeof e=="string",LU=0,zs=e=>{var t=++LU;return"".concat(e||"").concat(t)},Hr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Pe(t)&&typeof t!="string")return n;var i;if(gs(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return An(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},gO=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},xn=(e,t)=>Pe(e)&&Pe(t)?r=>e+r*(t-e):()=>t;function xO(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Oi(n,t))===r)}var vt=e=>e===null||typeof e>"u",Wu=e=>vt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),DU=["viewBox","children"],IU=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Uk=["points","pathLength"],_x={svg:DU,polygon:Uk,polyline:Uk},G0=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],V0=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(h.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{G0.includes(a)&&(n[a]=i=>r[a](r,i))}),n},$U=(e,t,r)=>n=>(e(t,r,n),null),qu=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];G0.includes(a)&&typeof i=="function"&&(n||(n={}),n[a]=$U(i,t,r))}),n},Wk=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",qk=null,Ax=null,vO=e=>{if(e===qk&&Array.isArray(Ax))return Ax;var t=[];return h.Children.forEach(e,r=>{vt(r)||(TU.isFragment(r)?t=t.concat(vO(r.props.children)):t.push(r))}),Ax=t,qk=e,t};function Ku(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>Wk(a)):n=[Wk(t)],vO(e).forEach(a=>{var i=Oi(a,"type.displayName")||Oi(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var yO=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,RU=(e,t,r,n)=>{var a,i=(a=n&&(_x==null?void 0:_x[n]))!==null&&a!==void 0?a:[];return t.startsWith("data-")||typeof e!="function"&&(n&&i.includes(t)||IU.includes(t))||r&&G0.includes(t)},rt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(h.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;RU((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},FU=["children","width","height","viewBox","className","style","title","desc"];function Cy(){return Cy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cy.apply(null,arguments)}function zU(e,t){if(e==null)return{};var r,n,a=BU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var H0=h.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:c,desc:u}=e,d=zU(e,FU),f=i||{width:n,height:a,x:0,y:0},p=at("recharts-surface",s);return h.createElement("svg",Cy({},rt(d,!0,"svg"),{className:p,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),h.createElement("title",null,c),h.createElement("desc",null,u),r)}),UU=["children","className"];function _y(){return _y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_y.apply(null,arguments)}function WU(e,t){if(e==null)return{};var r,n,a=qU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xr=h.forwardRef((e,t)=>{var{children:r,className:n}=e,a=WU(e,UU),i=at("recharts-layer",n);return h.createElement("g",_y({className:i},rt(a,!0),{ref:t}),r)}),bO=h.createContext(null),KU=()=>h.useContext(bO);function bt(e){return function(){return e}}const jO=Math.cos,dp=Math.sin,Ao=Math.sqrt,up=Math.PI,zm=2*up,Ay=Math.PI,Ey=2*Ay,as=1e-6,GU=Ey-as;function wO(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function VU(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return wO;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class HU{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?wO:VU(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,u=a-r,d=s-t,f=l-r,p=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>as)if(!(Math.abs(f*c-u*d)>as)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let x=n-s,m=a-l,y=c*c+u*u,j=x*x+m*m,b=Math.sqrt(y),g=Math.sqrt(p),v=i*Math.tan((Ay-Math.acos((y+p-j)/(2*b*g)))/2),w=v/g,C=v/b;Math.abs(w-1)>as&&this._append`L${t+w*d},${r+w*f}`,this._append`A${i},${i},0,0,${+(f*x>d*m)},${this._x1=t+C*c},${this._y1=r+C*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^s,p=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>as||Math.abs(this._y1-d)>as)&&this._append`L${u},${d}`,n&&(p<0&&(p=p%Ey+Ey),p>GU?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:p>as&&this._append`A${n},${n},0,${+(p>=Ay)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function X0(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new HU(t)}function Y0(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function SO(e){this._context=e}SO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Bm(e){return new SO(e)}function kO(e){return e[0]}function CO(e){return e[1]}function _O(e,t){var r=bt(!0),n=null,a=Bm,i=null,s=X0(l);e=typeof e=="function"?e:e===void 0?kO:bt(e),t=typeof t=="function"?t:t===void 0?CO:bt(t);function l(c){var u,d=(c=Y0(c)).length,f,p=!1,x;for(n==null&&(i=a(x=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(f,u,c),+t(f,u,c));if(x)return i=null,x+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:bt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:bt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:bt(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function $f(e,t,r){var n=null,a=bt(!0),i=null,s=Bm,l=null,c=X0(u);e=typeof e=="function"?e:e===void 0?kO:bt(+e),t=typeof t=="function"?t:bt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?CO:bt(+r);function u(f){var p,x,m,y=(f=Y0(f)).length,j,b=!1,g,v=new Array(y),w=new Array(y);for(i==null&&(l=s(g=c())),p=0;p<=y;++p){if(!(p<y&&a(j=f[p],p,f))===b)if(b=!b)x=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=p-1;m>=x;--m)l.point(v[m],w[m]);l.lineEnd(),l.areaEnd()}b&&(v[p]=+e(j,p,f),w[p]=+t(j,p,f),l.point(n?+n(j,p,f):v[p],r?+r(j,p,f):w[p]))}if(g)return l=null,g+""||null}function d(){return _O().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:bt(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:bt(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:bt(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),u):i},u}class AO{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function XU(e){return new AO(e,!0)}function YU(e){return new AO(e,!1)}const J0={draw(e,t){const r=Ao(t/up);e.moveTo(r,0),e.arc(0,0,r,0,zm)}},JU={draw(e,t){const r=Ao(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},EO=Ao(1/3),ZU=EO*2,QU={draw(e,t){const r=Ao(t/ZU),n=r*EO;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},eW={draw(e,t){const r=Ao(t),n=-r/2;e.rect(n,n,r,r)}},tW=.8908130915292852,NO=dp(up/10)/dp(7*up/10),rW=dp(zm/10)*NO,nW=-jO(zm/10)*NO,oW={draw(e,t){const r=Ao(t*tW),n=rW*r,a=nW*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=zm*i/5,l=jO(s),c=dp(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},Ex=Ao(3),aW={draw(e,t){const r=-Ao(t/(Ex*3));e.moveTo(0,r*2),e.lineTo(-Ex*r,-r),e.lineTo(Ex*r,-r),e.closePath()}},Ln=-.5,Dn=Ao(3)/2,Ny=1/Ao(12),iW=(Ny/2+1)*3,sW={draw(e,t){const r=Ao(t/iW),n=r/2,a=r*Ny,i=n,s=r*Ny+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(Ln*n-Dn*a,Dn*n+Ln*a),e.lineTo(Ln*i-Dn*s,Dn*i+Ln*s),e.lineTo(Ln*l-Dn*c,Dn*l+Ln*c),e.lineTo(Ln*n+Dn*a,Ln*a-Dn*n),e.lineTo(Ln*i+Dn*s,Ln*s-Dn*i),e.lineTo(Ln*l+Dn*c,Ln*c-Dn*l),e.closePath()}};function lW(e,t){let r=null,n=X0(a);e=typeof e=="function"?e:bt(e||J0),t=typeof t=="function"?t:bt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:bt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:bt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function fp(){}function hp(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function PO(e){this._context=e}PO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:hp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:hp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cW(e){return new PO(e)}function MO(e){this._context=e}MO.prototype={areaStart:fp,areaEnd:fp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:hp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function dW(e){return new MO(e)}function OO(e){this._context=e}OO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:hp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uW(e){return new OO(e)}function TO(e){this._context=e}TO.prototype={areaStart:fp,areaEnd:fp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function fW(e){return new TO(e)}function Kk(e){return e<0?-1:1}function Gk(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(Kk(i)+Kk(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function Vk(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Nx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function pp(e){this._context=e}pp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Nx(this,this._t0,Vk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Nx(this,Vk(this,r=Gk(this,e,t)),r);break;default:Nx(this,this._t0,r=Gk(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function LO(e){this._context=new DO(e)}(LO.prototype=Object.create(pp.prototype)).point=function(e,t){pp.prototype.point.call(this,t,e)};function DO(e){this._context=e}DO.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function hW(e){return new pp(e)}function pW(e){return new LO(e)}function IO(e){this._context=e}IO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Hk(e),a=Hk(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Hk(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function mW(e){return new IO(e)}function Um(e,t){this._context=e,this._t=t}Um.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function gW(e){return new Um(e,.5)}function xW(e){return new Um(e,0)}function vW(e){return new Um(e,1)}function lc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Py(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function yW(e,t){return e[t]}function bW(e){const t=[];return t.key=e,t}function jW(){var e=bt([]),t=Py,r=lc,n=yW;function a(i){var s=Array.from(e.apply(this,arguments),bW),l,c=s.length,u=-1,d;for(const f of i)for(l=0,++u;l<c;++l)(s[l][u]=[0,+n(f,s[l].key,u,i)]).data=f;for(l=0,d=Y0(t(s));l<c;++l)s[d[l]].index=l;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:bt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:bt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Py:typeof i=="function"?i:bt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??lc,a):r},a}function wW(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}lc(e,t)}}function SW(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}lc(e,t)}}function kW(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,u=0;l<s;++l){for(var d=e[t[l]],f=d[n][1]||0,p=d[n-1][1]||0,x=(f-p)/2,m=0;m<l;++m){var y=e[t[m]],j=y[n][1]||0,b=y[n-1][1]||0;x+=j-b}c+=f,u+=x*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,lc(e,t)}}var CW=["type","size","sizeType"];function My(){return My=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},My.apply(null,arguments)}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){_W(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _W(e,t,r){return(t=AW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AW(e){var t=EW(e,"string");return typeof t=="symbol"?t:t+""}function EW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NW(e,t){if(e==null)return{};var r,n,a=PW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $O={symbolCircle:J0,symbolCross:JU,symbolDiamond:QU,symbolSquare:eW,symbolStar:oW,symbolTriangle:aW,symbolWye:sW},MW=Math.PI/180,OW=e=>{var t="symbol".concat(Wu(e));return $O[t]||J0},TW=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*MW;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},LW=(e,t)=>{$O["symbol".concat(Wu(e))]=t},Z0=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=NW(e,CW),i=Yk(Yk({},a),{},{type:t,size:r,sizeType:n}),s=()=>{var f=OW(t),p=lW().type(f).size(TW(r,n,t));return p()},{className:l,cx:c,cy:u}=i,d=rt(i,!0);return c===+c&&u===+u&&r===+r?h.createElement("path",My({},d,{className:at("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(u,")"),d:s()})):null};Z0.registerSymbol=LW;function Oy(){return Oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oy.apply(null,arguments)}function Jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jk(Object(r),!0).forEach(function(n){Q0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q0(e,t,r){return(t=IW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IW(e){var t=$W(e,"string");return typeof t=="symbol"?t:t+""}function $W(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var In=32;class e1 extends h.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=In/2,i=In/6,s=In/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return h.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:In,y2:a,className:"recharts-legend-icon"});if(c==="line")return h.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(In,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return h.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(In/8,"h").concat(In,"v").concat(In*3/4,"h").concat(-In,"z"),className:"recharts-legend-icon"});if(h.isValidElement(t.legendIcon)){var u=DW({},t);return delete u.legendIcon,h.cloneElement(t.legendIcon,u)}return h.createElement(Z0,{fill:l,cx:a,cy:a,size:In,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,l={x:0,y:0,width:In,height:In},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var p=d.formatter||a,x=at({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?i:d.color,y=p?p(d.value,d,f):d.value;return h.createElement("li",Oy({className:x,style:c,key:"legend-item-".concat(f)},qu(this.props,d,f)),h.createElement(H0,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(y," legend icon")},this.renderIcon(d,s)),h.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},y))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return h.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Q0(e1,"displayName","Legend");Q0(e1,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var RO={},FO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(FO);var t1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(t1);var zO={},Wm={},BO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(BO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BO;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Wm);var UO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(UO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wm,r=UO;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(zO);var WO={},qO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Em;function r(n){return function(a){return t.get(a,n)}}e.property=r})(qO);var KO={},Px={},Mx={},r1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(r1);var n1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(n1);var qm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(qm);var Zk;function RW(){return Zk||(Zk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o1(),r=r1,n=n1,a=qm;function i(f,p,x){return typeof x!="function"?t.isMatch(f,p):s(f,p,function m(y,j,b,g,v,w){const C=x(y,j,b,g,v,w);return C!==void 0?!!C:s(y,j,m,w)},new Map)}function s(f,p,x,m){if(p===f)return!0;switch(typeof p){case"object":return l(f,p,x,m);case"function":return Object.keys(p).length>0?s(f,{...p},x,m):a.eq(f,p);default:return r.isObject(f)?typeof p=="string"?p==="":!0:a.eq(f,p)}}function l(f,p,x,m){if(p==null)return!0;if(Array.isArray(p))return u(f,p,x,m);if(p instanceof Map)return c(f,p,x,m);if(p instanceof Set)return d(f,p,x,m);const y=Object.keys(p);if(f==null)return y.length===0;if(y.length===0)return!0;if(m&&m.has(p))return m.get(p)===f;m&&m.set(p,f);try{for(let j=0;j<y.length;j++){const b=y[j];if(!n.isPrimitive(f)&&!(b in f)||p[b]===void 0&&f[b]!==void 0||p[b]===null&&f[b]!==null||!x(f[b],p[b],b,f,p,m))return!1}return!0}finally{m&&m.delete(p)}}function c(f,p,x,m){if(p.size===0)return!0;if(!(f instanceof Map))return!1;for(const[y,j]of p.entries()){const b=f.get(y);if(x(b,j,y,f,p,m)===!1)return!1}return!0}function u(f,p,x,m){if(p.length===0)return!0;if(!Array.isArray(f))return!1;const y=new Set;for(let j=0;j<p.length;j++){const b=p[j];let g=!1;for(let v=0;v<f.length;v++){if(y.has(v))continue;const w=f[v];let C=!1;if(x(w,b,j,f,p,m)&&(C=!0),C){y.add(v),g=!0;break}}if(!g)return!1}return!0}function d(f,p,x,m){return p.size===0?!0:f instanceof Set?u([...f],[...p],x,m):!1}e.isMatchWith=i,e.isSetMatch=d}(Mx)),Mx}var Qk;function o1(){return Qk||(Qk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RW();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(Px)),Px}var GO={},a1={},i1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(i1);var Km={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Km);var Gm={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",p="[object ArrayBuffer]",x="[object Object]",m="[object Error]",y="[object DataView]",j="[object Uint8Array]",b="[object Uint8ClampedArray]",g="[object Uint16Array]",v="[object Uint32Array]",w="[object BigUint64Array]",C="[object Int8Array]",k="[object Int16Array]",S="[object Int32Array]",_="[object BigInt64Array]",A="[object Float32Array]",E="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=_,e.bigUint64ArrayTag=w,e.booleanTag=a,e.dataViewTag=y,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=A,e.float64ArrayTag=E,e.functionTag=f,e.int16ArrayTag=k,e.int32ArrayTag=S,e.int8ArrayTag=C,e.mapTag=c,e.numberTag=n,e.objectTag=x,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=g,e.uint32ArrayTag=v,e.uint8ArrayTag=j,e.uint8ClampedArrayTag=b})(Gm);var VO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(VO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i1,r=Km,n=Gm,a=n1,i=VO;function s(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,p,x=new Map,m=void 0){const y=m==null?void 0:m(d,f,p,x);if(y!=null)return y;if(a.isPrimitive(d))return d;if(x.has(d))return x.get(d);if(Array.isArray(d)){const j=new Array(d.length);x.set(d,j);for(let b=0;b<d.length;b++)j[b]=l(d[b],b,p,x,m);return Object.hasOwn(d,"index")&&(j.index=d.index),Object.hasOwn(d,"input")&&(j.input=d.input),j}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const j=new RegExp(d.source,d.flags);return j.lastIndex=d.lastIndex,j}if(d instanceof Map){const j=new Map;x.set(d,j);for(const[b,g]of d)j.set(b,l(g,b,p,x,m));return j}if(d instanceof Set){const j=new Set;x.set(d,j);for(const b of d)j.add(l(b,void 0,p,x,m));return j}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const j=new(Object.getPrototypeOf(d)).constructor(d.length);x.set(d,j);for(let b=0;b<d.length;b++)j[b]=l(d[b],b,p,x,m);return j}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const j=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return x.set(d,j),c(j,d,p,x,m),j}if(typeof File<"u"&&d instanceof File){const j=new File([d],d.name,{type:d.type});return x.set(d,j),c(j,d,p,x,m),j}if(d instanceof Blob){const j=new Blob([d],{type:d.type});return x.set(d,j),c(j,d,p,x,m),j}if(d instanceof Error){const j=new d.constructor;return x.set(d,j),j.message=d.message,j.name=d.name,j.stack=d.stack,j.cause=d.cause,c(j,d,p,x,m),j}if(typeof d=="object"&&u(d)){const j=Object.create(Object.getPrototypeOf(d));return x.set(d,j),c(j,d,p,x,m),j}return d}function c(d,f,p=d,x,m){const y=[...Object.keys(f),...t.getSymbols(f)];for(let j=0;j<y.length;j++){const b=y[j],g=Object.getOwnPropertyDescriptor(d,b);(g==null||g.writable)&&(d[b]=l(f[b],b,p,x,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=c})(a1);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a1;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(GO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o1(),r=GO;function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(KO);var HO={},XO={},YO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a1,r=Gm;function n(a,i){return t.cloneDeepWith(a,(s,l,c,u)=>{const d=i==null?void 0:i(s,l,c,u);if(d!=null)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(YO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YO;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(XO);var JO={},s1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(s1);var ZO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Km;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(ZO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B0,r=s1,n=ZO,a=Nm;function i(s,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(s==null?void 0:s[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=s;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=i})(JO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o1(),r=U0,n=XO,a=Em,i=JO;function s(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?i.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=s})(HO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t1,r=qO,n=KO,a=HO;function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(WO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FO,r=t1,n=zO,a=WO;function i(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(l)):[]}e.uniqBy=i})(RO);var FW=RO.uniqBy;const eC=no(FW);function QO(e,t,r){return t===!0?eC(e,r):typeof t=="function"?eC(e,t):e}var l1=h.createContext(null),zW=e=>e,Nt=()=>{var e=h.useContext(l1);return e?e.store.dispatch:zW},bh=()=>{},BW=()=>bh,UW=(e,t)=>e===t;function De(e){var t=h.useContext(l1);return SM.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:BW,t?t.store.getState:bh,t?t.store.getState:bh,t?e:bh,UW)}function WW(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function qW(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function KW(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var tC=e=>Array.isArray(e)?e:[e];function GW(e){const t=Array.isArray(e[0])?e[0]:e;return KW(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function VW(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var HW=class{constructor(e){this.value=e}deref(){return this.value}},XW=typeof WeakRef<"u"?WeakRef:HW,YW=0,rC=1;function Rf(){return{s:YW,v:void 0,o:null,p:null}}function eT(e,t={}){let r=Rf();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var f;let l=r;const{length:c}=arguments;for(let p=0,x=c;p<x;p++){const m=arguments[p];if(typeof m=="function"||typeof m=="object"&&m!==null){let y=l.o;y===null&&(l.o=y=new WeakMap);const j=y.get(m);j===void 0?(l=Rf(),y.set(m,l)):l=j}else{let y=l.p;y===null&&(l.p=y=new Map);const j=y.get(m);j===void 0?(l=Rf(),y.set(m,l)):l=j}}const u=l;let d;if(l.s===rC)d=l.v;else if(d=e.apply(null,arguments),i++,n){const p=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;p!=null&&n(p,d)&&(d=p,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new XW(d):d}return u.s=rC,u.v=d,d}return s.clearCache=()=>{r=Rf(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function JW(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),WW(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:p=[],argsMemoize:x=eT,argsMemoizeOptions:m=[]}=d,y=tC(p),j=tC(m),b=GW(a),g=f(function(){return i++,u.apply(null,arguments)},...y),v=x(function(){s++;const C=VW(b,arguments);return l=g.apply(null,C),l},...j);return Object.assign(v,{resultFunc:u,memoizedResultFunc:g,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:x})};return Object.assign(n,{withTypes:()=>n}),n}var le=JW(eT),ZW=Object.assign((e,t=le)=>{qW(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,c)=>(s[r[c]]=l,s),{}))},{withTypes:()=>ZW}),tT={},rT={},nT={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(nT);var oT={},c1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(c1);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c1,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(oT);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nT,r=oT,n=Nm;function a(i,s,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(x=>String(x));const u=(x,m)=>{let y=x;for(let j=0;j<m.length&&y!=null;++j)y=y[m[j]];return y},d=(x,m)=>m==null||x==null?m:typeof x=="object"&&"key"in x?Object.hasOwn(m,x.key)?m[x.key]:u(m,x.path):typeof x=="function"?x(m):Array.isArray(x)?u(m,x):typeof m=="object"?m[x]:m,f=s.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||r.isKey(x)?x:{key:x,path:n.toPath(x)}));return i.map(x=>({original:x,criteria:f.map(m=>d(m,x))})).slice().sort((x,m)=>{for(let y=0;y<f.length;y++){const j=t.compareValues(x.criteria[y],m.criteria[y],l[y]);if(j!==0)return j}return 0}).map(x=>x.original)}e.orderBy=a})(rT);var aT={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<i?s(d,c+1):a.push(d)}};return s(r,0),a}e.flatten=t})(aT);var d1={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s1,r=Wm,n=r1,a=qm;function i(s,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],s):!1}e.isIterateeCall=i})(d1);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rT,r=aT,n=d1;function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(tT);var QW=tT.sortBy;const Vm=no(QW);var iT=e=>e.legend.settings,eq=e=>e.legend.size,tq=e=>e.legend.payload,rq=le([tq,iT],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Vm(n,r):n});function nq(){return De(rq)}var Ff=1;function sT(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=h.useState({height:0,left:0,top:0,width:0}),n=h.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>Ff||Math.abs(s.left-t.left)>Ff||Math.abs(s.top-t.top)>Ff||Math.abs(s.width-t.width)>Ff)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function wr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var oq=typeof Symbol=="function"&&Symbol.observable||"@@observable",nC=oq,Ox=()=>Math.random().toString(36).substring(7).split("").join("."),aq={INIT:`@@redux/INIT${Ox()}`,REPLACE:`@@redux/REPLACE${Ox()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ox()}`},mp=aq;function u1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function lT(e,t,r){if(typeof e!="function")throw new Error(wr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(wr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(wr(1));return r(lT)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((j,b)=>{s.set(b,j)}))}function d(){if(c)throw new Error(wr(3));return a}function f(j){if(typeof j!="function")throw new Error(wr(4));if(c)throw new Error(wr(5));let b=!0;u();const g=l++;return s.set(g,j),function(){if(b){if(c)throw new Error(wr(6));b=!1,u(),s.delete(g),i=null}}}function p(j){if(!u1(j))throw new Error(wr(7));if(typeof j.type>"u")throw new Error(wr(8));if(typeof j.type!="string")throw new Error(wr(17));if(c)throw new Error(wr(9));try{c=!0,a=n(a,j)}finally{c=!1}return(i=s).forEach(g=>{g()}),j}function x(j){if(typeof j!="function")throw new Error(wr(10));n=j,p({type:mp.REPLACE})}function m(){const j=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(wr(11));function g(){const w=b;w.next&&w.next(d())}return g(),{unsubscribe:j(g)}},[nC](){return this}}}return p({type:mp.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:x,[nC]:m}}function iq(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:mp.INIT})>"u")throw new Error(wr(12));if(typeof r(void 0,{type:mp.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(wr(13))})}function cT(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{iq(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],p=r[f],x=s[f],m=p(x,l);if(typeof m>"u")throw l&&l.type,new Error(wr(14));u[f]=m,c=c||m!==x}return c=c||n.length!==Object.keys(s).length,c?u:s}}function gp(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function sq(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(wr(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},l=e.map(c=>c(s));return i=gp(...l)(a.dispatch),{...a,dispatch:i}}}function dT(e){return u1(e)&&"type"in e&&typeof e.type=="string"}var uT=Symbol.for("immer-nothing"),oC=Symbol.for("immer-draftable"),En=Symbol.for("immer-state");function bo(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var cc=Object.getPrototypeOf;function Bs(e){return!!e&&!!e[En]}function ka(e){var t;return e?fT(e)||Array.isArray(e)||!!e[oC]||!!((t=e.constructor)!=null&&t[oC])||Xm(e)||Ym(e):!1}var lq=Object.prototype.constructor.toString();function fT(e){if(!e||typeof e!="object")return!1;const t=cc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===lq}function xp(e,t){Hm(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Hm(e){const t=e[En];return t?t.type_:Array.isArray(e)?1:Xm(e)?2:Ym(e)?3:0}function Ty(e,t){return Hm(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function hT(e,t,r){const n=Hm(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function cq(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Xm(e){return e instanceof Map}function Ym(e){return e instanceof Set}function is(e){return e.copy_||e.base_}function Ly(e,t){if(Xm(e))return new Map(e);if(Ym(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=fT(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[En];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(cc(e),n)}else{const n=cc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function f1(e,t=!1){return Jm(e)||Bs(e)||!ka(e)||(Hm(e)>1&&(e.set=e.add=e.clear=e.delete=dq),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>f1(n,!0))),e}function dq(){bo(2)}function Jm(e){return Object.isFrozen(e)}var uq={};function Us(e){const t=uq[e];return t||bo(0,e),t}var pu;function pT(){return pu}function fq(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function aC(e,t){t&&(Us("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Dy(e){Iy(e),e.drafts_.forEach(hq),e.drafts_=null}function Iy(e){e===pu&&(pu=e.parent_)}function iC(e){return pu=fq(pu,e)}function hq(e){const t=e[En];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function sC(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[En].modified_&&(Dy(t),bo(4)),ka(e)&&(e=vp(t,e),t.parent_||yp(t,e)),t.patches_&&Us("Patches").generateReplacementPatches_(r[En].base_,e,t.patches_,t.inversePatches_)):e=vp(t,r,[]),Dy(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==uT?e:void 0}function vp(e,t,r){if(Jm(t))return t;const n=t[En];if(!n)return xp(t,(a,i)=>lC(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return yp(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),xp(i,(l,c)=>lC(e,n,a,l,c,r,s)),yp(e,a,!1),r&&e.patches_&&Us("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function lC(e,t,r,n,a,i,s){if(Bs(a)){const l=i&&t&&t.type_!==3&&!Ty(t.assigned_,n)?i.concat(n):void 0,c=vp(e,a,l);if(hT(r,n,c),Bs(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(ka(a)&&!Jm(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;vp(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&yp(e,a)}}function yp(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&f1(t,r)}function pq(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:pT(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=h1;r&&(a=[n],i=mu);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var h1={get(e,t){if(t===En)return e;const r=is(e);if(!Ty(r,t))return mq(e,r,t);const n=r[t];return e.finalized_||!ka(n)?n:n===Tx(e.base_,t)?(Lx(e),e.copy_[t]=Ry(n,e)):n},has(e,t){return t in is(e)},ownKeys(e){return Reflect.ownKeys(is(e))},set(e,t,r){const n=mT(is(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Tx(is(e),t),i=a==null?void 0:a[En];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(cq(r,a)&&(r!==void 0||Ty(e.base_,t)))return!0;Lx(e),$y(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Tx(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Lx(e),$y(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=is(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){bo(11)},getPrototypeOf(e){return cc(e.base_)},setPrototypeOf(){bo(12)}},mu={};xp(h1,(e,t)=>{mu[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});mu.deleteProperty=function(e,t){return mu.set.call(this,e,t,void 0)};mu.set=function(e,t,r){return h1.set.call(this,e[0],t,r,e[0])};function Tx(e,t){const r=e[En];return(r?is(r):e)[t]}function mq(e,t,r){var a;const n=mT(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function mT(e,t){if(!(t in e))return;let r=cc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=cc(r)}}function $y(e){e.modified_||(e.modified_=!0,e.parent_&&$y(e.parent_))}function Lx(e){e.copy_||(e.copy_=Ly(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var gq=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&bo(6),n!==void 0&&typeof n!="function"&&bo(7);let a;if(ka(t)){const i=iC(this),s=Ry(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?Dy(i):Iy(i)}return aC(i,n),sC(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===uT&&(a=void 0),this.autoFreeze_&&f1(a,!0),n){const i=[],s=[];Us("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else bo(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,c=>t(c,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ka(e)||bo(8),Bs(e)&&(e=pa(e));const t=iC(this),r=Ry(e,void 0);return r[En].isManual_=!0,Iy(t),r}finishDraft(e,t){const r=e&&e[En];(!r||!r.isManual_)&&bo(9);const{scope_:n}=r;return aC(n,t),sC(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Us("Patches").applyPatches_;return Bs(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Ry(e,t){const r=Xm(e)?Us("MapSet").proxyMap_(e,t):Ym(e)?Us("MapSet").proxySet_(e,t):pq(e,t);return(t?t.scope_:pT()).drafts_.push(r),r}function pa(e){return Bs(e)||bo(10,e),gT(e)}function gT(e){if(!ka(e)||Jm(e))return e;const t=e[En];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ly(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Ly(e,!0);return xp(r,(n,a)=>{hT(r,n,gT(a))}),t&&(t.finalized_=!1),r}var Nn=new gq,xT=Nn.produce;Nn.produceWithPatches.bind(Nn);Nn.setAutoFreeze.bind(Nn);Nn.setUseStrictShallowCopy.bind(Nn);Nn.applyPatches.bind(Nn);Nn.createDraft.bind(Nn);Nn.finishDraft.bind(Nn);function vT(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var xq=vT(),vq=vT,yq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?gp:gp.apply(null,arguments)};function to(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Sn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>dT(n)&&n.type===e,r}var yT=class jd extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,jd.prototype)}static get[Symbol.species](){return jd}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new jd(...t[0].concat(this)):new jd(...t.concat(this))}};function cC(e){return ka(e)?xT(e,()=>{}):e}function zf(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function bq(e){return typeof e=="boolean"}var jq=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new yT;return r&&(bq(r)?s.push(xq):s.push(vq(r.extraArgument))),s},wq="RTK_autoBatch",dC=e=>t=>{setTimeout(t,e)},Sq=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:dC(10):e.type==="callback"?e.queueNotification:dC(e.timeout),u=()=>{s=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),p=n.subscribe(f);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[wq]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},kq=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new yT(e);return n&&a.push(Sq(typeof n=="object"?n:void 0)),a};function Cq(e){const t=jq(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(u1(r))l=cT(r);else throw new Error(Sn(1));let c;typeof n=="function"?c=n(t):c=t();let u=gp;a&&(u=yq({trace:!1,...typeof a=="object"&&a}));const d=sq(...c),f=kq(d);let p=typeof s=="function"?s(f):f();const x=u(...p);return lT(l,i,x)}function bT(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Sn(28));if(l in t)throw new Error(Sn(29));return t[l]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function _q(e){return typeof e=="function"}function Aq(e,t){let[r,n,a]=bT(t),i;if(_q(e))i=()=>cC(e());else{const l=cC(e);i=()=>l}function s(l=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(Bs(d)){const x=f(d,c);return x===void 0?d:x}else{if(ka(d))return xT(d,p=>f(p,c));{const p=f(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return s.getInitialState=i,s}var Eq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Nq=(e=21)=>{let t="",r=e;for(;r--;)t+=Eq[Math.random()*64|0];return t},Pq=Symbol.for("rtk-slice-createasyncthunk");function Mq(e,t){return`${e}/${t}`}function Oq({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[Pq];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Sn(11));const l=(typeof a.reducers=="function"?a.reducers(Lq()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,C){const k=typeof w=="string"?w:w.type;if(!k)throw new Error(Sn(12));if(k in u.sliceCaseReducersByType)throw new Error(Sn(13));return u.sliceCaseReducersByType[k]=C,d},addMatcher(w,C){return u.sliceMatchers.push({matcher:w,reducer:C}),d},exposeAction(w,C){return u.actionCreators[w]=C,d},exposeCaseReducer(w,C){return u.sliceCaseReducersByName[w]=C,d}};c.forEach(w=>{const C=l[w],k={reducerName:w,type:Mq(i,w),createNotation:typeof a.reducers=="function"};Iq(C)?Rq(k,C,d,t):Dq(k,C,d)});function f(){const[w={},C=[],k=void 0]=typeof a.extraReducers=="function"?bT(a.extraReducers):[a.extraReducers],S={...w,...u.sliceCaseReducersByType};return Aq(a.initialState,_=>{for(let A in S)_.addCase(A,S[A]);for(let A of u.sliceMatchers)_.addMatcher(A.matcher,A.reducer);for(let A of C)_.addMatcher(A.matcher,A.reducer);k&&_.addDefaultCase(k)})}const p=w=>w,x=new Map,m=new WeakMap;let y;function j(w,C){return y||(y=f()),y(w,C)}function b(){return y||(y=f()),y.getInitialState()}function g(w,C=!1){function k(_){let A=_[w];return typeof A>"u"&&C&&(A=zf(m,k,b)),A}function S(_=p){const A=zf(x,C,()=>new WeakMap);return zf(A,_,()=>{const E={};for(const[N,$]of Object.entries(a.selectors??{}))E[N]=Tq($,_,()=>zf(m,_,b),C);return E})}return{reducerPath:w,getSelectors:S,get selectors(){return S(k)},selectSlice:k}}const v={name:i,reducer:j,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...g(s),injectInto(w,{reducerPath:C,...k}={}){const S=C??s;return w.inject({reducerPath:S,reducer:j},k),{...v,...g(S,!0)}}};return v}}function Tq(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var oo=Oq();function Lq(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Dq({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!$q(n))throw new Error(Sn(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?to(e,s):to(e))}function Iq(e){return e._reducerDefinitionType==="asyncThunk"}function $q(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Rq({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Sn(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:c,settled:u,options:d}=r,f=a(e,i,d);n.exposeAction(t,f),s&&n.addCase(f.fulfilled,s),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:s||Bf,pending:l||Bf,rejected:c||Bf,settled:u||Bf})}function Bf(){}var Fq="task",jT="listener",wT="completed",p1="cancelled",zq=`task-${p1}`,Bq=`task-${wT}`,Fy=`${jT}-${p1}`,Uq=`${jT}-${wT}`,Zm=class{constructor(e){_g(this,"name","TaskAbortError");_g(this,"message");this.code=e,this.message=`${Fq} ${p1} (reason: ${e})`}},m1=(e,t)=>{if(typeof e!="function")throw new TypeError(Sn(32))},bp=()=>{},ST=(e,t=bp)=>(e.catch(t),e),kT=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ps=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Ms=e=>{if(e.aborted){const{reason:t}=e;throw new Zm(t)}};function CT(e,t){let r=bp;return new Promise((n,a)=>{const i=()=>a(new Zm(e.reason));if(e.aborted){i();return}r=kT(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=bp})}var Wq=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Zm?"cancelled":"rejected",error:r}}finally{t==null||t()}},jp=e=>t=>ST(CT(e,t).then(r=>(Ms(e),r))),_T=e=>{const t=jp(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:zl}=Object,uC={},Qm="listenerMiddleware",qq=(e,t)=>{const r=n=>kT(e,()=>Ps(n,e.reason));return(n,a)=>{m1(n);const i=new AbortController;r(i);const s=Wq(async()=>{Ms(e),Ms(i.signal);const l=await n({pause:jp(i.signal),delay:_T(i.signal),signal:i.signal});return Ms(i.signal),l},()=>Ps(i,Bq));return a!=null&&a.autoJoin&&t.push(s.catch(bp)),{result:jp(e)(s),cancel(){Ps(i,zq)}}}},Kq=(e,t)=>{const r=async(n,a)=>{Ms(t);let i=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,p)=>{p.unsubscribe(),c([f,p.getState(),p.getOriginalState()])}});i=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await CT(t,Promise.race(l));return Ms(t),c}finally{i()}};return(n,a)=>ST(r(n,a))},AT=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=to(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Sn(21));return m1(i),{predicate:a,type:t,effect:i}},ET=zl(e=>{const{type:t,predicate:r,effect:n}=AT(e);return{id:Nq(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Sn(22))}}},{withTypes:()=>ET}),fC=(e,t)=>{const{type:r,effect:n,predicate:a}=AT(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},zy=e=>{e.pending.forEach(t=>{Ps(t,Fy)})},Gq=e=>()=>{e.forEach(zy),e.clear()},hC=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},NT=zl(to(`${Qm}/add`),{withTypes:()=>NT}),Vq=to(`${Qm}/removeAll`),PT=zl(to(`${Qm}/remove`),{withTypes:()=>PT}),Hq=(...e)=>{console.error(`${Qm}/error`,...e)},Gu=(e={})=>{const t=new Map,{extra:r,onError:n=Hq}=e;m1(n);const a=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),f=>{d.unsubscribe(),f!=null&&f.cancelActive&&zy(d)}),i=d=>{const f=fC(t,d)??ET(d);return a(f)};zl(i,{withTypes:()=>i});const s=d=>{const f=fC(t,d);return f&&(f.unsubscribe(),d.cancelActive&&zy(f)),!!f};zl(s,{withTypes:()=>s});const l=async(d,f,p,x)=>{const m=new AbortController,y=Kq(i,m.signal),j=[];try{d.pending.add(m),await Promise.resolve(d.effect(f,zl({},p,{getOriginalState:x,condition:(b,g)=>y(b,g).then(Boolean),take:y,delay:_T(m.signal),pause:jp(m.signal),extra:r,signal:m.signal,fork:qq(m.signal,j),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((b,g,v)=>{b!==m&&(Ps(b,Fy),v.delete(b))})},cancel:()=>{Ps(m,Fy),d.pending.delete(m)},throwIfCancelled:()=>{Ms(m.signal)}})))}catch(b){b instanceof Zm||hC(n,b,{raisedBy:"effect"})}finally{await Promise.all(j),Ps(m,Uq),d.pending.delete(m)}},c=Gq(t);return{middleware:d=>f=>p=>{if(!dT(p))return f(p);if(NT.match(p))return i(p.payload);if(Vq.match(p)){c();return}if(PT.match(p))return s(p.payload);let x=d.getState();const m=()=>{if(x===uC)throw new Error(Sn(23));return x};let y;try{if(y=f(p),t.size>0){const j=d.getState(),b=Array.from(t.values());for(const g of b){let v=!1;try{v=g.predicate(p,j,x)}catch(w){v=!1,hC(n,w,{raisedBy:"predicate"})}v&&l(g,p,d,m)}}}finally{x=uC}return y},startListening:i,stopListening:s,clearListeners:c}};function Sn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Xq={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},MT=oo({name:"chartLayout",initialState:Xq,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:Yq,setLayout:Jq,setChartSize:Zq,setScale:Qq}=MT.actions,eK=MT.reducer;function pC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pC(Object(r),!0).forEach(function(n){tK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tK(e,t,r){return(t=rK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rK(e){var t=nK(e,"string");return typeof t=="symbol"?t:t+""}function nK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wp=Math.PI/180,oK=e=>e*180/Math.PI,Zt=(e,t,r,n)=>({x:e+Math.cos(-wp*n)*r,y:t+Math.sin(-wp*n)*r}),OT=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},aK=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},iK=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=aK({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,c=Math.acos(l);return n>i&&(c=2*Math.PI-c),{radius:s,angle:oK(c),angleInRadian:c}},sK=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},lK=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},cK=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=iK({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:c,endAngle:u}=sK(t),d=i,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?mC(mC({},t),{},{radius:a,angle:lK(d,t)}):null};function gC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gC(Object(r),!0).forEach(function(n){dK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dK(e,t,r){return(t=uK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uK(e){var t=fK(e,"string");return typeof t=="symbol"?t:t+""}function fK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kt(e,t,r){return vt(e)||vt(t)?r:Bo(t)?Oi(e,t,r):typeof t=="function"?t(e):r}var hK=(e,t,r,n,a)=>{var i,s=-1,l=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var u=c>0?r[c-1].coordinate:r[l-1].coordinate,d=r[c].coordinate,f=c>=l-1?r[0].coordinate:r[c+1].coordinate,p=void 0;if(mr(d-u)!==mr(f-d)){var x=[];if(mr(f-d)===mr(a[1]-a[0])){p=f;var m=d+a[1]-a[0];x[0]=Math.min(m,(m+u)/2),x[1]=Math.max(m,(m+u)/2)}else{p=u;var y=f+a[1]-a[0];x[0]=Math.min(d,(y+d)/2),x[1]=Math.max(d,(y+d)/2)}var j=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(e>j[0]&&e<=j[1]||e>=x[0]&&e<=x[1]){({index:s}=r[c]);break}}else{var b=Math.min(u,f),g=Math.max(u,f);if(e>(b+d)/2&&e<=(g+d)/2){({index:s}=r[c]);break}}}else if(t){for(var v=0;v<l;v++)if(v===0&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v>0&&v<l-1&&e>(t[v].coordinate+t[v-1].coordinate)/2&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v===l-1&&e>(t[v].coordinate+t[v-1].coordinate)/2){({index:s}=t[v]);break}}return s},pK=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&Pe(e[i]))return Wn(Wn({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&Pe(e[s]))return Wn(Wn({},e),{},{[s]:e[s]+(a||0)})}return e},Ui=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",TT=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},LT=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:p,axisType:x}=e;if(!s)return null;var m=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,y=a==="category"&&s.bandwidth?s.bandwidth()/m:0;if(y=x==="angleAxis"&&i&&i.length>=2?mr(i[0]-i[1])*2*y:y,f||p){var j=(f||p||[]).map((b,g)=>{var v=n?n.indexOf(b):b;return{coordinate:s(v)+y,value:b,offset:y,index:g}});return j.filter(b=>!An(b.coordinate))}return c&&u?u.map((b,g)=>({coordinate:s(b)+y,value:b,index:g,offset:y})):s.ticks&&d!=null?s.ticks(d).map((b,g)=>({coordinate:s(b)+y,value:b,offset:y,index:g})):s.domain().map((b,g)=>({coordinate:s(b)+y,value:n?n[b]:b,index:g,offset:y}))},xC=1e-4,mK=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-xC,i=Math.max(n[0],n[1])+xC,s=e(t[0]),l=e(t[r-1]);(s<a||s>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},gK=(e,t)=>{if(!t||t.length!==2||!Pe(t[0])||!Pe(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Pe(e[0])||e[0]<r)&&(a[0]=r),(!Pe(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},xK=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var l=An(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1])}},vK=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=An(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},yK={sign:xK,expand:wW,none:lc,silhouette:SW,wiggle:kW,positive:vK},bK=(e,t,r)=>{var n=yK[r],a=jW().keys(t).value((i,s)=>+kt(i,s,0)).order(Py).offset(n);return a(e)};function DT(e){return e==null?void 0:String(e)}function vC(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!vt(a[t.dataKey])){var l=xO(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=kt(a,vt(s)?t.dataKey:s);return vt(c)?null:t.scale(c)}var yC=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=kt(i,t.dataKey,t.scale.domain()[s]);return vt(l)?null:t.scale(l)-a/2+n},jK=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},wK=e=>{var t=e.flat(2).filter(Pe);return[Math.min(...t),Math.max(...t)]},SK=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],kK=(e,t,r)=>{if(e!=null)return SK(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,l=s.reduce((c,u)=>{var d=wK(u.slice(t,r+1));return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},bC=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jC=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,gu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Vm(t,d=>d.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var c=a[s],u=a[s-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function wC(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Wn(Wn({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Pc(e,t){if(e)return String(e);if(typeof t=="string")return t}function CK(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?cK({x:e,y:t},n):null}var _K=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Wn(Wn(Wn({},n),Zt(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:c}=n;return Wn(Wn(Wn({},n),Zt(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},AK=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Ta=e=>e.layout.width,La=e=>e.layout.height,EK=e=>e.layout.scale,IT=e=>e.layout.margin,g1=le(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),x1=le(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),$T="data-recharts-item-index",RT="data-recharts-item-data-key",eg=60;function SC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SC(Object(r),!0).forEach(function(n){NK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NK(e,t,r){return(t=PK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PK(e){var t=MK(e,"string");return typeof t=="symbol"?t:t+""}function MK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OK=e=>e.brush.height,lr=le([Ta,La,IT,OK,g1,x1,iT,eq],(e,t,r,n,a,i,s,l)=>{var c=i.reduce((m,y)=>{var{orientation:j}=y;if(!y.mirror&&!y.hide){var b=typeof y.width=="number"?y.width:eg;return Wa(Wa({},m),{},{[j]:m[j]+b})}return m},{left:r.left||0,right:r.right||0}),u=a.reduce((m,y)=>{var{orientation:j}=y;return!y.mirror&&!y.hide?Wa(Wa({},m),{},{[j]:Oi(m,"".concat(j))+y.height}):m},{top:r.top||0,bottom:r.bottom||0}),d=Wa(Wa({},u),c),f=d.bottom;d.bottom+=n,d=pK(d,s,l);var p=e-d.left-d.right,x=t-d.top-d.bottom;return Wa(Wa({brushBottom:f},d),{},{width:Math.max(p,0),height:Math.max(x,0)})}),TK=le(lr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),FT=le(Ta,La,(e,t)=>({x:0,y:0,width:e,height:t})),LK=h.createContext(null),Zr=()=>h.useContext(LK)!=null,tg=e=>e.brush,rg=le([tg,lr,IT],(e,t,r)=>({height:e.height,x:Pe(e.x)?e.x:t.left,y:Pe(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Pe(e.width)?e.width:t.width})),v1=()=>{var e,t=Zr(),r=De(TK),n=De(rg),a=(e=De(tg))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},DK={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},zT=()=>{var e;return(e=De(lr))!==null&&e!==void 0?e:DK},y1=()=>De(Ta),b1=()=>De(La),IK={top:0,right:0,bottom:0,left:0},$K=()=>{var e;return(e=De(t=>t.layout.margin))!==null&&e!==void 0?e:IK},ut=e=>e.layout.layoutType,ng=()=>De(ut),RK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},BT=oo({name:"legend",initialState:RK,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=pa(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:kC,setLegendSettings:FK,addLegendPayload:UT,removeLegendPayload:WT}=BT.actions,zK=BT.reducer,BK=["contextPayload"];function By(){return By=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},By.apply(null,arguments)}function CC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CC(Object(r),!0).forEach(function(n){j1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j1(e,t,r){return(t=UK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UK(e){var t=WK(e,"string");return typeof t=="symbol"?t:t+""}function WK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qK(e,t){if(e==null)return{};var r,n,a=KK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GK(e){return e.value}function VK(e){var{contextPayload:t}=e,r=qK(e,BK),n=QO(t,e.payloadUniqBy,GK),a=dc(dc({},r),{},{payload:n});return h.isValidElement(e.content)?h.cloneElement(e.content,a):typeof e.content=="function"?h.createElement(e.content,a):h.createElement(e1,a)}function HK(e,t,r,n,a,i){var{layout:s,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&s==="vertical"?u={left:((n||0)-i.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),dc(dc({},u),d)}function XK(e){var t=Nt();return h.useEffect(()=>{t(FK(e))},[t,e]),null}function YK(e){var t=Nt();return h.useEffect(()=>(t(kC(e)),()=>{t(kC({width:0,height:0}))}),[t,e]),null}function JK(e){var t=nq(),r=KU(),n=$K(),{width:a,height:i,wrapperStyle:s,portal:l}=e,[c,u]=sT([t]),d=y1(),f=b1(),p=d-(n.left||0)-(n.right||0),x=ki.getWidthOrHeight(e.layout,i,a,p),m=l?s:dc(dc({position:"absolute",width:(x==null?void 0:x.width)||a||"auto",height:(x==null?void 0:x.height)||i||"auto"},HK(s,e,n,d,f,c)),s),y=l??r;if(y==null)return null;var j=h.createElement("div",{className:"recharts-legend-wrapper",style:m,ref:u},h.createElement(XK,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),h.createElement(YK,{width:c.width,height:c.height}),h.createElement(VK,By({},e,x,{margin:n,chartWidth:d,chartHeight:f,contextPayload:t})));return Pa.createPortal(j,y)}class ki extends h.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&Pe(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return h.createElement(JK,this.props)}}j1(ki,"displayName","Legend");j1(ki,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function Uy(){return Uy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uy.apply(null,arguments)}function _C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_C(Object(r),!0).forEach(function(n){ZK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_C(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZK(e,t,r){return(t=QK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QK(e){var t=eG(e,"string");return typeof t=="symbol"?t:t+""}function eG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tG(e){return Array.isArray(e)&&Bo(e[0])&&Bo(e[1])?e.join(" ~ "):e}var rG=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:p=!1}=e,x=()=>{if(i&&i.length){var C={padding:0,margin:0},k=(l?Vm(i,l):i).map((S,_)=>{if(S.type==="none")return null;var A=S.formatter||s||tG,{value:E,name:N}=S,$=E,z=N;if(A){var T=A(E,N,S,_,i);if(Array.isArray(T))[$,z]=T;else if(T!=null)$=T;else return null}var I=Dx({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return h.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_),style:I},Bo(z)?h.createElement("span",{className:"recharts-tooltip-item-name"},z):null,Bo(z)?h.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,h.createElement("span",{className:"recharts-tooltip-item-value"},$),h.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return h.createElement("ul",{className:"recharts-tooltip-item-list",style:C},k)}return null},m=Dx({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),y=Dx({margin:0},a),j=!vt(d),b=j?d:"",g=at("recharts-default-tooltip",c),v=at("recharts-tooltip-label",u);j&&f&&i!==void 0&&i!==null&&(b=f(d,i));var w=p?{role:"status","aria-live":"assertive"}:{};return h.createElement("div",Uy({className:g,style:m},w),h.createElement("p",{className:v,style:y},h.isValidElement(b)?b:"".concat(b)),x())},nd="recharts-tooltip-wrapper",nG={visibility:"hidden"};function oG(e){var{coordinate:t,translateX:r,translateY:n}=e;return at(nd,{["".concat(nd,"-right")]:Pe(r)&&t&&Pe(t.x)&&r>=t.x,["".concat(nd,"-left")]:Pe(r)&&t&&Pe(t.x)&&r<t.x,["".concat(nd,"-bottom")]:Pe(n)&&t&&Pe(t.y)&&n>=t.y,["".concat(nd,"-top")]:Pe(n)&&t&&Pe(t.y)&&n<t.y})}function AC(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(i&&Pe(i[n]))return i[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return s[n]?d:f;var p=c[n];if(p==null)return 0;if(s[n]){var x=d,m=p;return x<m?Math.max(f,p):Math.max(d,p)}if(u==null)return 0;var y=f+l,j=p+u;return y>j?Math.max(d,p):Math.max(f,p)}function aG(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function iG(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:l,viewBox:c}=e,u,d,f;return s.height>0&&s.width>0&&r?(d=AC({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=AC({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=aG({translateX:d,translateY:f,useTranslate3d:l})):u=nG,{cssProperties:u,cssClasses:oG({translateX:d,translateY:f,coordinate:r})}}function EC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EC(Object(r),!0).forEach(function(n){Wy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wy(e,t,r){return(t=sG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sG(e){var t=lG(e,"string");return typeof t=="symbol"?t:t+""}function lG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class cG extends h.PureComponent{constructor(){super(...arguments),Wy(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Wy(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:p,viewBox:x,wrapperStyle:m,lastBoundingBox:y,innerRef:j,hasPortalFromProps:b}=this.props,{cssClasses:g,cssProperties:v}=iG({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:y.height,width:y.width},useTranslate3d:p,viewBox:x}),w=b?{}:Uf(Uf({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},v),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),C=Uf(Uf({},w),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return h.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:g,style:C,ref:j},i)}}var dG=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Zs={isSsr:dG()},qT=()=>De(e=>e.rootProps.accessibilityLayer);function Pn(e){return Number.isFinite(e)}function uc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qy.apply(null,arguments)}function NC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NC(Object(r),!0).forEach(function(n){uG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uG(e,t,r){return(t=fG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fG(e){var t=hG(e,"string");return typeof t=="symbol"?t:t+""}function hG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MC={curveBasisClosed:dW,curveBasisOpen:uW,curveBasis:cW,curveBumpX:XU,curveBumpY:YU,curveLinearClosed:fW,curveLinear:Bm,curveMonotoneX:hW,curveMonotoneY:pW,curveNatural:mW,curveStep:gW,curveStepAfter:vW,curveStepBefore:xW},Wf=e=>Pn(e.x)&&Pn(e.y),od=e=>e.x,ad=e=>e.y,pG=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Wu(e));return(r==="curveMonotone"||r==="curveBump")&&t?MC["".concat(r).concat(t==="vertical"?"Y":"X")]:MC[r]||Bm},mG=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=pG(t,a),l=i?r.filter(Wf):r,c;if(Array.isArray(n)){var u=i?n.filter(f=>Wf(f)):n,d=l.map((f,p)=>PC(PC({},f),{},{base:u[p]}));return a==="vertical"?c=$f().y(ad).x1(od).x0(f=>f.base.x):c=$f().x(od).y1(ad).y0(f=>f.base.y),c.defined(Wf).curve(s),c(d)}return a==="vertical"&&Pe(n)?c=$f().y(ad).x1(od).x0(n):Pe(n)?c=$f().x(od).y1(ad).y0(n):c=_O().x(od).y(ad),c.defined(Wf).curve(s),c(l)},w1=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?mG(e):n;return h.createElement("path",qy({},rt(e,!1),V0(e),{className:at("recharts-curve",t),d:i===null?void 0:i,ref:a}))},gG=["x","y","top","left","width","height","className"];function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ky.apply(null,arguments)}function OC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OC(Object(r),!0).forEach(function(n){vG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vG(e,t,r){return(t=yG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yG(e){var t=bG(e,"string");return typeof t=="symbol"?t:t+""}function bG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jG(e,t){if(e==null)return{};var r,n,a=wG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SG=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),kG=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,c=jG(e,gG),u=xG({x:t,y:r,top:n,left:a,width:i,height:s},c);return!Pe(t)||!Pe(r)||!Pe(i)||!Pe(s)||!Pe(n)||!Pe(a)?null:h.createElement("path",Ky({},rt(u,!0),{className:at("recharts-cross",l),d:SG(t,r,i,s,n,a)}))};function CG(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function TC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _G(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TC(Object(r),!0).forEach(function(n){AG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AG(e,t,r){return(t=EG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EG(e){var t=NG(e,"string");return typeof t=="symbol"?t:t+""}function NG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ao(e,t){var r=_G({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}var KT={},GT={},VT={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t})(VT);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VT,r=i1,n=Km,a=Gm,i=qm;function s(u,d,f){return l(u,d,void 0,void 0,void 0,void 0,f)}function l(u,d,f,p,x,m,y){const j=y(u,d,f,p,x,m);if(j!==void 0)return j;if(typeof u==typeof d)switch(typeof u){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return u===d;case"number":return u===d||Object.is(u,d);case"function":return u===d;case"object":return c(u,d,m,y)}return c(u,d,m,y)}function c(u,d,f,p){if(Object.is(u,d))return!0;let x=n.getTag(u),m=n.getTag(d);if(x===a.argumentsTag&&(x=a.objectTag),m===a.argumentsTag&&(m=a.objectTag),x!==m)return!1;switch(x){case a.stringTag:return u.toString()===d.toString();case a.numberTag:{const b=u.valueOf(),g=d.valueOf();return i.eq(b,g)}case a.booleanTag:case a.dateTag:case a.symbolTag:return Object.is(u.valueOf(),d.valueOf());case a.regexpTag:return u.source===d.source&&u.flags===d.flags;case a.functionTag:return u===d}f=f??new Map;const y=f.get(u),j=f.get(d);if(y!=null&&j!=null)return y===d;f.set(u,d),f.set(d,u);try{switch(x){case a.mapTag:{if(u.size!==d.size)return!1;for(const[b,g]of u.entries())if(!d.has(b)||!l(g,d.get(b),b,u,d,f,p))return!1;return!0}case a.setTag:{if(u.size!==d.size)return!1;const b=Array.from(u.values()),g=Array.from(d.values());for(let v=0;v<b.length;v++){const w=b[v],C=g.findIndex(k=>l(w,k,void 0,u,d,f,p));if(C===-1)return!1;g.splice(C,1)}return!0}case a.arrayTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:case a.bigUint64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.bigInt64ArrayTag:case a.float32ArrayTag:case a.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(u)!==Buffer.isBuffer(d)||u.length!==d.length)return!1;for(let b=0;b<u.length;b++)if(!l(u[b],d[b],b,u,d,f,p))return!1;return!0}case a.arrayBufferTag:return u.byteLength!==d.byteLength?!1:c(new Uint8Array(u),new Uint8Array(d),f,p);case a.dataViewTag:return u.byteLength!==d.byteLength||u.byteOffset!==d.byteOffset?!1:c(new Uint8Array(u),new Uint8Array(d),f,p);case a.errorTag:return u.name===d.name&&u.message===d.message;case a.objectTag:{if(!(c(u.constructor,d.constructor,f,p)||t.isPlainObject(u)&&t.isPlainObject(d)))return!1;const g=[...Object.keys(u),...r.getSymbols(u)],v=[...Object.keys(d),...r.getSymbols(d)];if(g.length!==v.length)return!1;for(let w=0;w<g.length;w++){const C=g[w],k=u[C];if(!Object.hasOwn(d,C))return!1;const S=d[C];if(!l(k,S,C,u,d,f,p))return!1}return!0}default:return!1}}finally{f.delete(u),f.delete(d)}}e.isEqualWith=s})(GT);var HT={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t})(HT);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GT,r=HT;function n(a,i){return t.isEqualWith(a,i,r.noop)}e.isEqual=n})(KT);var PG=KT.isEqual;const MG=no(PG);function OG(e){var t={},r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[c,...u]=l;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}var Sp=1e-4,XT=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],YT=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),LC=(e,t)=>r=>{var n=XT(e,t);return YT(n,r)},TG=(e,t)=>r=>{var n=XT(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return YT(a,r)},DC=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(m=>parseFloat(m)))}}else s.length===4&&([t,n,r,a]=s);var u=LC(t,r),d=LC(n,a),f=TG(t,r),p=m=>m>1?1:m<0?0:m,x=m=>{for(var y=m>1?1:m,j=y,b=0;b<8;++b){var g=u(j)-y,v=f(j);if(Math.abs(g-y)<Sp||v<Sp)return d(j);j=p(j-g/v)}return d(j)};return x.isStepper=!1,x},LG=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,c)=>{var u=-(s-l)*r,d=c*n,f=c+(u-d)*a/1e3,p=c*a/1e3+s;return Math.abs(p-l)<Sp&&Math.abs(f)<Sp?[l,0]:[p,f]};return i.isStepper=!0,i.dt=a,i},DG=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return DC(e);case"spring":return LG();default:if(e.split("(")[0]==="cubic-bezier")return DC(e)}return typeof e=="function"?e:null};function IC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $C(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IC(Object(r),!0).forEach(function(n){IG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IG(e,t,r){return(t=$G(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $G(e){var t=RG(e,"string");return typeof t=="symbol"?t:t+""}function RG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FG=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),zG=(e,t,r)=>e.map(n=>"".concat(FG(n)," ").concat(t,"ms ").concat(r)).join(","),BG=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),xu=(e,t)=>Object.keys(t).reduce((r,n)=>$C($C({},r),{},{[n]:e(n,t[n])}),{});function RC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RC(Object(r),!0).forEach(function(n){UG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UG(e,t,r){return(t=WG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WG(e){var t=qG(e,"string");return typeof t=="symbol"?t:t+""}function qG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kp=(e,t,r)=>e+(t-e)*r,Gy=e=>{var{from:t,to:r}=e;return t!==r},JT=(e,t,r)=>{var n=xu((a,i)=>{if(Gy(i)){var[s,l]=e(i.from,i.to,i.velocity);return kr(kr({},i),{},{from:s,velocity:l})}return i},t);return r<1?xu((a,i)=>Gy(i)?kr(kr({},i),{},{velocity:kp(i.velocity,n[a].velocity,r),from:kp(i.from,n[a].from,r)}):i,t):JT(e,n,r-1)};function KG(e,t,r,n,a,i){var s,l=n.reduce((p,x)=>kr(kr({},p),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),c=()=>xu((p,x)=>x.from,l),u=()=>!Object.values(l).filter(Gy).length,d=null,f=p=>{s||(s=p);var x=p-s,m=x/r.dt;l=JT(r,l,m),a(kr(kr(kr({},e),t),c())),s=p,u()||(d=i.setTimeout(f))};return()=>(d=i.setTimeout(f),()=>{d()})}function GG(e,t,r,n,a,i,s){var l=null,c=a.reduce((f,p)=>kr(kr({},f),{},{[p]:[e[p],t[p]]}),{}),u,d=f=>{u||(u=f);var p=(f-u)/n,x=xu((y,j)=>kp(...j,r(p)),c);if(i(kr(kr(kr({},e),t),x)),p<1)l=s.setTimeout(d);else{var m=xu((y,j)=>kp(...j,r(1)),c);i(kr(kr(kr({},e),t),m))}};return()=>(l=s.setTimeout(d),()=>{l()})}const VG=(e,t,r,n,a,i)=>{var s=BG(e,t);return r.isStepper===!0?KG(e,t,r,s,a,i):GG(e,t,r,n,s,a,i)};class HG{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}var XG=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Vy(){return Vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vy.apply(null,arguments)}function YG(e,t){if(e==null)return{};var r,n,a=JG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function FC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FC(Object(r),!0).forEach(function(n){xs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xs(e,t,r){return(t=ZG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZG(e){var t=QG(e,"string");return typeof t=="symbol"?t:t+""}function QG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eV(){return OG(new HG)}class S1 extends h.PureComponent{constructor(t,r){super(t,r),xs(this,"mounted",!1),xs(this,"manager",null),xs(this,"stopJSAnimation",null),xs(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:i,to:s,children:l,duration:c,animationManager:u}=this.props;if(this.manager=u,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||c<=0){this.state={style:{}},typeof l=="function"&&(this.state={style:s});return}if(i){if(typeof l=="function"){this.state={style:i};return}this.state={style:a?{[a]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:i,to:s,from:l}=this.props,{style:c}=this.state;if(n){if(!r){var u={style:a?{[a]:s}:s};this.state&&c&&(a&&c[a]!==s||!a&&c!==s)&&this.setState(u);return}if(!(MG(t.to,s)&&t.canBegin&&t.isActive)){var d=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var f=d||i?l:t.to;if(this.state&&c){var p={style:a?{[a]:f}:f};(a&&c[a]!==f||!a&&c!==f)&&this.setState(p)}this.runAnimation(qa(qa({},this.props),{},{from:f,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:c}=t,u=VG(r,n,DG(i),a,this.changeStyle,this.manager.getTimeoutController()),d=()=>{this.stopJSAnimation=u()};this.manager.start([c,s,d,a,l])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:i,easing:s,onAnimationStart:l,onAnimationEnd:c,children:u}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof u=="function"||s==="spring"){this.runJSAnimation(t);return}var d=a?{[a]:i}:i,f=zG(Object.keys(d),n,s);this.manager.start([l,r,qa(qa({},d),{},{transition:f}),n,c])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:i,easing:s,isActive:l,from:c,to:u,canBegin:d,onAnimationEnd:f,shouldReAnimate:p,onAnimationReStart:x,animationManager:m}=t,y=YG(t,XG),j=h.Children.count(r),b=this.state.style;if(typeof r=="function")return r(b);if(!l||j===0||a<=0)return r;var g=v=>{var{style:w={},className:C}=v.props,k=h.cloneElement(v,qa(qa({},y),{},{style:qa(qa({},w),b),className:C}));return k};return j===1?g(h.Children.only(r)):h.createElement("div",null,h.Children.map(r,v=>g(v)))}}xs(S1,"displayName","Animate");xs(S1,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var tV=h.createContext(null);function Ti(e){var t,r,n=h.useContext(tV);return h.createElement(S1,Vy({},e,{animationManager:(t=(r=e.animationManager)!==null&&r!==void 0?r:n)!==null&&t!==void 0?t:eV()}))}function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(null,arguments)}var zC=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],f=0,p=4;f<p;f++)d[f]=a[f]>i?i:a[f];u="M".concat(e,",").concat(t+s*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),u+="L ".concat(e+r-l*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+s*d[1])),u+="L ".concat(e+r,",").concat(t+n-s*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-l*d[2],",").concat(t+n)),u+="L ".concat(e+l*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-s*d[3])),u+="Z"}else if(i>0&&a===+a&&a>0){var x=Math.min(i,a);u="M ".concat(e,",").concat(t+s*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+l*x,",").concat(t,`
            L `).concat(e+r-l*x,",").concat(t,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r,",").concat(t+s*x,`
            L `).concat(e+r,",").concat(t+n-s*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r-l*x,",").concat(t+n,`
            L `).concat(e+l*x,",").concat(t+n,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e,",").concat(t+n-s*x," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},rV={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ZT=e=>{var t=ao(e,rV),r=h.useRef(null),[n,a]=h.useState(-1);h.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&a(b)}catch{}},[]);var{x:i,y:s,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:x,isAnimationActive:m,isUpdateAnimationActive:y}=t;if(i!==+i||s!==+s||l!==+l||c!==+c||l===0||c===0)return null;var j=at("recharts-rectangle",d);return y?h.createElement(Ti,{canBegin:n>0,from:{width:l,height:c,x:i,y:s},to:{width:l,height:c,x:i,y:s},duration:p,animationEasing:f,isActive:y},b=>{var{width:g,height:v,x:w,y:C}=b;return h.createElement(Ti,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:p,isActive:m,easing:f},h.createElement("path",Cp({},rt(t,!0),{className:j,d:zC(w,C,g,v,u),ref:r})))}):h.createElement("path",Cp({},rt(t,!0),{className:j,d:zC(i,s,l,c,u)}))};function QT(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Zt(t,r,n,a),l=Zt(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Hy(){return Hy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hy.apply(null,arguments)}var nV=(e,t)=>{var r=mr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},qf=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:c}=e,u=l*(s?1:-1)+n,d=Math.asin(l/u)/wp,f=c?a:a+i*d,p=Zt(t,r,u,f),x=Zt(t,r,n,f),m=c?a-i*d:a,y=Zt(t,r,u*Math.cos(d*wp),m);return{center:p,circleTangency:x,lineTangency:y,theta:d}},eL=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=nV(i,s),c=i+l,u=Zt(t,r,a,i),d=Zt(t,r,a,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var p=Zt(t,r,n,i),x=Zt(t,r,n,c);f+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},oV=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=mr(u-c),{circleTangency:f,lineTangency:p,theta:x}=qf({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:i,cornerIsExternal:l}),{circleTangency:m,lineTangency:y,theta:j}=qf({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-x-j;if(b<0)return s?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):eL({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var g="M ".concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(y.x,",").concat(y.y,`
  `);if(n>0){var{circleTangency:v,lineTangency:w,theta:C}=qf({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:k,lineTangency:S,theta:_}=qf({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),A=l?Math.abs(c-u):Math.abs(c-u)-C-_;if(A<0&&i===0)return"".concat(g,"L").concat(t,",").concat(r,"Z");g+="L".concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(A>180),",").concat(+(d>0),",").concat(v.x,",").concat(v.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,"Z")}else g+="L".concat(t,",").concat(r,"Z");return g},aV={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},tL=e=>{var t=ao(e,aV),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(i<a||u===d)return null;var p=at("recharts-sector",f),x=i-a,m=Hr(s,x,0,!0),y;return m>0&&Math.abs(u-d)<360?y=oV({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(m,x/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):y=eL({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d}),h.createElement("path",Hy({},rt(t,!0),{className:p,d:y}))};function iV(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,p=Zt(l,c,u,f),x=Zt(l,c,d,f);n=p.x,a=p.y,i=x.x,s=x.y}else return QT(t);return[{x:n,y:a},{x:i,y:s}]}var rL={},nL={},oL={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c1;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(oL);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oL;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(nL);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=d1,r=nL;function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=s;return c}e.range=n})(rL);var sV=rL.range;const aL=no(sV);function Ci(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function lV(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function k1(e){let t,r,n;e.length!==2?(t=Ci,r=(l,c)=>Ci(e(l),c),n=(l,c)=>e(l)-c):(t=e===Ci||e===lV?e:cV,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function cV(){return 0}function iL(e){return e===null?NaN:+e}function*dV(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const uV=k1(Ci),Vu=uV.right;k1(iL).center;class BC extends Map{constructor(t,r=pV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(UC(this,t))}has(t){return super.has(UC(this,t))}set(t,r){return super.set(fV(this,t),r)}delete(t){return super.delete(hV(this,t))}}function UC({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function fV({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function hV({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function pV(e){return e!==null&&typeof e=="object"?e.valueOf():e}function mV(e=Ci){if(e===Ci)return sL;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function sL(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const gV=Math.sqrt(50),xV=Math.sqrt(10),vV=Math.sqrt(2);function _p(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=gV?10:i>=xV?5:i>=vV?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/s,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?_p(e,t,r*2):[l,c,u]}function Xy(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?_p(t,e,r):_p(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let u=0;u<l;++u)c[u]=(i-u)/-s;else for(let u=0;u<l;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<l;++u)c[u]=(a+u)/-s;else for(let u=0;u<l;++u)c[u]=(a+u)*s;return c}function Yy(e,t,r){return t=+t,e=+e,r=+r,_p(e,t,r)[2]}function Jy(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Yy(t,e,r):Yy(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function WC(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function qC(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function lL(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?sL:mV(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),x=Math.max(r,Math.floor(t-u*f/c+p)),m=Math.min(n,Math.floor(t+(c-u)*f/c+p));lL(e,t,x,m,a)}const i=e[t];let s=r,l=n;for(id(e,r,t),a(e[n],i)>0&&id(e,r,n);s<l;){for(id(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?id(e,r,l):(++l,id(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function id(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function yV(e,t,r){if(e=Float64Array.from(dV(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return qC(e);if(t>=1)return WC(e);var n,a=(n-1)*t,i=Math.floor(a),s=WC(lL(e,i).subarray(0,i+1)),l=qC(e.subarray(i+1));return s+(l-s)*(a-i)}}function bV(e,t,r=iL){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function jV(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function io(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Da(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Zy=Symbol("implicit");function C1(){var e=new BC,t=[],r=[],n=Zy;function a(i){let s=e.get(i);if(s===void 0){if(n!==Zy)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new BC;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return C1(t,r).unknown(n)},io.apply(a,arguments),a}function _1(){var e=C1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var p=t().length,x=a<n,m=x?a:n,y=x?n:a;i=(y-m)/Math.max(1,p-c+u*2),l&&(i=Math.floor(i)),m+=(y-m-i*(p-c))*d,s=i*(1-c),l&&(m=Math.round(m),s=Math.round(s));var j=jV(p).map(function(b){return m+i*b});return r(x?j.reverse():j)}return e.domain=function(p){return arguments.length?(t(p),f()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(p){return arguments.length?(l=!!p,f()):l},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),f()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),f()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,f()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),f()):d},e.copy=function(){return _1(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},io.apply(f(),arguments)}function cL(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return cL(t())},e}function wV(){return cL(_1.apply(null,arguments).paddingInner(1))}function A1(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function dL(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Hu(){}var vu=.7,Ap=1/vu,Bl="\\s*([+-]?\\d+)\\s*",yu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",SV=/^#([0-9a-f]{3,8})$/,kV=new RegExp(`^rgb\\(${Bl},${Bl},${Bl}\\)$`),CV=new RegExp(`^rgb\\(${zo},${zo},${zo}\\)$`),_V=new RegExp(`^rgba\\(${Bl},${Bl},${Bl},${yu}\\)$`),AV=new RegExp(`^rgba\\(${zo},${zo},${zo},${yu}\\)$`),EV=new RegExp(`^hsl\\(${yu},${zo},${zo}\\)$`),NV=new RegExp(`^hsla\\(${yu},${zo},${zo},${yu}\\)$`),KC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};A1(Hu,bu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:GC,formatHex:GC,formatHex8:PV,formatHsl:MV,formatRgb:VC,toString:VC});function GC(){return this.rgb().formatHex()}function PV(){return this.rgb().formatHex8()}function MV(){return uL(this).formatHsl()}function VC(){return this.rgb().formatRgb()}function bu(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=SV.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?HC(t):r===3?new sn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Kf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Kf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=kV.exec(e))?new sn(t[1],t[2],t[3],1):(t=CV.exec(e))?new sn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_V.exec(e))?Kf(t[1],t[2],t[3],t[4]):(t=AV.exec(e))?Kf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=EV.exec(e))?JC(t[1],t[2]/100,t[3]/100,1):(t=NV.exec(e))?JC(t[1],t[2]/100,t[3]/100,t[4]):KC.hasOwnProperty(e)?HC(KC[e]):e==="transparent"?new sn(NaN,NaN,NaN,0):null}function HC(e){return new sn(e>>16&255,e>>8&255,e&255,1)}function Kf(e,t,r,n){return n<=0&&(e=t=r=NaN),new sn(e,t,r,n)}function OV(e){return e instanceof Hu||(e=bu(e)),e?(e=e.rgb(),new sn(e.r,e.g,e.b,e.opacity)):new sn}function Qy(e,t,r,n){return arguments.length===1?OV(e):new sn(e,t,r,n??1)}function sn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}A1(sn,Qy,dL(Hu,{brighter(e){return e=e==null?Ap:Math.pow(Ap,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vu:Math.pow(vu,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new sn(Os(this.r),Os(this.g),Os(this.b),Ep(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:XC,formatHex:XC,formatHex8:TV,formatRgb:YC,toString:YC}));function XC(){return`#${vs(this.r)}${vs(this.g)}${vs(this.b)}`}function TV(){return`#${vs(this.r)}${vs(this.g)}${vs(this.b)}${vs((isNaN(this.opacity)?1:this.opacity)*255)}`}function YC(){const e=Ep(this.opacity);return`${e===1?"rgb(":"rgba("}${Os(this.r)}, ${Os(this.g)}, ${Os(this.b)}${e===1?")":`, ${e})`}`}function Ep(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Os(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function vs(e){return e=Os(e),(e<16?"0":"")+e.toString(16)}function JC(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new jo(e,t,r,n)}function uL(e){if(e instanceof jo)return new jo(e.h,e.s,e.l,e.opacity);if(e instanceof Hu||(e=bu(e)),!e)return new jo;if(e instanceof jo)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new jo(s,l,c,e.opacity)}function LV(e,t,r,n){return arguments.length===1?uL(e):new jo(e,t,r,n??1)}function jo(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}A1(jo,LV,dL(Hu,{brighter(e){return e=e==null?Ap:Math.pow(Ap,e),new jo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vu:Math.pow(vu,e),new jo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new sn(Ix(e>=240?e-240:e+120,a,n),Ix(e,a,n),Ix(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new jo(ZC(this.h),Gf(this.s),Gf(this.l),Ep(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ep(this.opacity);return`${e===1?"hsl(":"hsla("}${ZC(this.h)}, ${Gf(this.s)*100}%, ${Gf(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ZC(e){return e=(e||0)%360,e<0?e+360:e}function Gf(e){return Math.max(0,Math.min(1,e||0))}function Ix(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const E1=e=>()=>e;function DV(e,t){return function(r){return e+r*t}}function IV(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function $V(e){return(e=+e)==1?fL:function(t,r){return r-t?IV(t,r,e):E1(isNaN(t)?r:t)}}function fL(e,t){var r=t-e;return r?DV(e,r):E1(isNaN(e)?t:e)}const QC=function e(t){var r=$V(t);function n(a,i){var s=r((a=Qy(a)).r,(i=Qy(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),u=fL(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function RV(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function FV(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zV(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Mc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function BV(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Np(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function UV(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Mc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var eb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$x=new RegExp(eb.source,"g");function WV(e){return function(){return e}}function qV(e){return function(t){return e(t)+""}}function KV(e,t){var r=eb.lastIndex=$x.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=eb.exec(e))&&(a=$x.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:Np(n,a)})),r=$x.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?qV(c[0].x):WV(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function Mc(e,t){var r=typeof t,n;return t==null||r==="boolean"?E1(t):(r==="number"?Np:r==="string"?(n=bu(t))?(t=n,QC):KV:t instanceof bu?QC:t instanceof Date?BV:FV(t)?RV:Array.isArray(t)?zV:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?UV:Np)(e,t)}function N1(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function GV(e,t){t===void 0&&(t=e,e=Mc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function VV(e){return function(){return e}}function Pp(e){return+e}var e_=[0,1];function Gr(e){return e}function tb(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:VV(isNaN(t)?NaN:.5)}function HV(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function XV(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=tb(a,n),i=r(s,i)):(n=tb(n,a),i=r(i,s)),function(l){return i(n(l))}}function YV(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=tb(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=Vu(e,l,1,n)-1;return i[c](a[c](l))}}function Xu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function og(){var e=e_,t=e_,r=Mc,n,a,i,s=Gr,l,c,u;function d(){var p=Math.min(e.length,t.length);return s!==Gr&&(s=HV(e[0],e[p-1])),l=p>2?YV:XV,c=u=null,f}function f(p){return p==null||isNaN(p=+p)?i:(c||(c=l(e.map(n),t,r)))(n(s(p)))}return f.invert=function(p){return s(a((u||(u=l(t,e.map(n),Np)))(p)))},f.domain=function(p){return arguments.length?(e=Array.from(p,Pp),d()):e.slice()},f.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},f.rangeRound=function(p){return t=Array.from(p),r=N1,d()},f.clamp=function(p){return arguments.length?(s=p?!0:Gr,d()):s!==Gr},f.interpolate=function(p){return arguments.length?(r=p,d()):r},f.unknown=function(p){return arguments.length?(i=p,f):i},function(p,x){return n=p,a=x,d()}}function P1(){return og()(Gr,Gr)}function JV(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Mp(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function fc(e){return e=Mp(Math.abs(e)),e?e[1]:NaN}function ZV(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function QV(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var eH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ju(e){if(!(t=eH.exec(e)))throw new Error("invalid format: "+e);var t;return new M1({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ju.prototype=M1.prototype;function M1(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}M1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tH(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var hL;function rH(e,t){var r=Mp(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(hL=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Mp(e,Math.max(0,t+i-1))[0]}function t_(e,t){var r=Mp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const r_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:JV,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>t_(e*100,t),r:t_,s:rH,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function n_(e){return e}var o_=Array.prototype.map,a_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function nH(e){var t=e.grouping===void 0||e.thousands===void 0?n_:ZV(o_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?n_:QV(o_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=ju(f);var p=f.fill,x=f.align,m=f.sign,y=f.symbol,j=f.zero,b=f.width,g=f.comma,v=f.precision,w=f.trim,C=f.type;C==="n"?(g=!0,C="g"):r_[C]||(v===void 0&&(v=12),w=!0,C="g"),(j||p==="0"&&x==="=")&&(j=!0,p="0",x="=");var k=y==="$"?r:y==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",S=y==="$"?n:/[%p]/.test(C)?s:"",_=r_[C],A=/[defgprs%]/.test(C);v=v===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function E(N){var $=k,z=S,T,I,L;if(C==="c")z=_(N)+z,N="";else{N=+N;var D=N<0||1/N<0;if(N=isNaN(N)?c:_(Math.abs(N),v),w&&(N=tH(N)),D&&+N==0&&m!=="+"&&(D=!1),$=(D?m==="("?m:l:m==="-"||m==="("?"":m)+$,z=(C==="s"?a_[8+hL/3]:"")+z+(D&&m==="("?")":""),A){for(T=-1,I=N.length;++T<I;)if(L=N.charCodeAt(T),48>L||L>57){z=(L===46?a+N.slice(T+1):N.slice(T))+z,N=N.slice(0,T);break}}}g&&!j&&(N=t(N,1/0));var O=$.length+N.length+z.length,F=O<b?new Array(b-O+1).join(p):"";switch(g&&j&&(N=t(F+N,F.length?b-z.length:1/0),F=""),x){case"<":N=$+N+z+F;break;case"=":N=$+F+N+z;break;case"^":N=F.slice(0,O=F.length>>1)+$+N+z+F.slice(O);break;default:N=F+$+N+z;break}return i(N)}return E.toString=function(){return f+""},E}function d(f,p){var x=u((f=ju(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(fc(p)/3)))*3,y=Math.pow(10,-m),j=a_[8+m/3];return function(b){return x(y*b)+j}}return{format:u,formatPrefix:d}}var Vf,O1,pL;oH({thousands:",",grouping:[3],currency:["$",""]});function oH(e){return Vf=nH(e),O1=Vf.format,pL=Vf.formatPrefix,Vf}function aH(e){return Math.max(0,-fc(Math.abs(e)))}function iH(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(fc(t)/3)))*3-fc(Math.abs(e)))}function sH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,fc(t)-fc(e))+1}function mL(e,t,r,n){var a=Jy(e,t,r),i;switch(n=ju(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=iH(a,s))&&(n.precision=i),pL(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=sH(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=aH(a))&&(n.precision=i-(n.type==="%")*2);break}}return O1(n)}function Wi(e){var t=e.domain;return e.ticks=function(r){var n=t();return Xy(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return mL(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,u,d=10;for(l<s&&(u=s,s=l,l=u,u=a,a=i,i=u);d-- >0;){if(u=Yy(s,l,r),u===c)return n[a]=s,n[i]=l,t(n);if(u>0)s=Math.floor(s/u)*u,l=Math.ceil(l/u)*u;else if(u<0)s=Math.ceil(s*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function gL(){var e=P1();return e.copy=function(){return Xu(e,gL())},io.apply(e,arguments),Wi(e)}function xL(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Pp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return xL(e).unknown(t)},e=arguments.length?Array.from(e,Pp):[0,1],Wi(r)}function vL(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function i_(e){return Math.log(e)}function s_(e){return Math.exp(e)}function lH(e){return-Math.log(-e)}function cH(e){return-Math.exp(-e)}function dH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function uH(e){return e===10?dH:e===Math.E?Math.exp:t=>Math.pow(e,t)}function fH(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function l_(e){return(t,r)=>-e(-t,r)}function T1(e){const t=e(i_,s_),r=t.domain;let n=10,a,i;function s(){return a=fH(n),i=uH(n),r()[0]<0?(a=l_(a),i=l_(i),e(lH,cH)):e(i_,s_),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let p=a(u),x=a(d),m,y;const j=l==null?10:+l;let b=[];if(!(n%1)&&x-p<j){if(p=Math.floor(p),x=Math.ceil(x),u>0){for(;p<=x;++p)for(m=1;m<n;++m)if(y=p<0?m/i(-p):m*i(p),!(y<u)){if(y>d)break;b.push(y)}}else for(;p<=x;++p)for(m=n-1;m>=1;--m)if(y=p>0?m/i(-p):m*i(p),!(y<u)){if(y>d)break;b.push(y)}b.length*2<j&&(b=Xy(u,d,j))}else b=Xy(p,x,Math.min(x-p,j)).map(i);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ju(c)).precision==null&&(c.trim=!0),c=O1(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(vL(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function yL(){const e=T1(og()).domain([1,10]);return e.copy=()=>Xu(e,yL()).base(e.base()),io.apply(e,arguments),e}function c_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function d_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function L1(e){var t=1,r=e(c_(t),d_(t));return r.constant=function(n){return arguments.length?e(c_(t=+n),d_(t)):t},Wi(r)}function bL(){var e=L1(og());return e.copy=function(){return Xu(e,bL()).constant(e.constant())},io.apply(e,arguments)}function u_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function hH(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function pH(e){return e<0?-e*e:e*e}function D1(e){var t=e(Gr,Gr),r=1;function n(){return r===1?e(Gr,Gr):r===.5?e(hH,pH):e(u_(r),u_(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Wi(t)}function I1(){var e=D1(og());return e.copy=function(){return Xu(e,I1()).exponent(e.exponent())},io.apply(e,arguments),e}function mH(){return I1.apply(null,arguments).exponent(.5)}function f_(e){return Math.sign(e)*e*e}function gH(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function jL(){var e=P1(),t=[0,1],r=!1,n;function a(i){var s=gH(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(f_(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Pp)).map(f_)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return jL(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},io.apply(a,arguments),Wi(a)}function wL(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=bV(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Vu(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ci),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return wL().domain(e).range(t).unknown(n)},io.apply(i,arguments)}function SL(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Vu(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return SL().domain([e,t]).range(a).unknown(i)},io.apply(Wi(s),arguments)}function kL(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Vu(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return kL().domain(e).range(t).unknown(r)},io.apply(a,arguments)}const Rx=new Date,Fx=new Date;function cr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<s);return c},a.filter=i=>cr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Rx.setTime(+i),Fx.setTime(+s),e(Rx),e(Fx),Math.floor(r(Rx,Fx))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Op=cr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Op.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Op);Op.range;const da=1e3,Kn=da*60,ua=Kn*60,Ca=ua*24,$1=Ca*7,h_=Ca*30,zx=Ca*365,ys=cr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*da)},(e,t)=>(t-e)/da,e=>e.getUTCSeconds());ys.range;const R1=cr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*da)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getMinutes());R1.range;const F1=cr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Kn)},(e,t)=>(t-e)/Kn,e=>e.getUTCMinutes());F1.range;const z1=cr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*da-e.getMinutes()*Kn)},(e,t)=>{e.setTime(+e+t*ua)},(e,t)=>(t-e)/ua,e=>e.getHours());z1.range;const B1=cr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ua)},(e,t)=>(t-e)/ua,e=>e.getUTCHours());B1.range;const Yu=cr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Kn)/Ca,e=>e.getDate()-1);Yu.range;const ag=cr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ca,e=>e.getUTCDate()-1);ag.range;const CL=cr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ca,e=>Math.floor(e/Ca));CL.range;function Qs(e){return cr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Kn)/$1)}const ig=Qs(0),Tp=Qs(1),xH=Qs(2),vH=Qs(3),hc=Qs(4),yH=Qs(5),bH=Qs(6);ig.range;Tp.range;xH.range;vH.range;hc.range;yH.range;bH.range;function el(e){return cr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/$1)}const sg=el(0),Lp=el(1),jH=el(2),wH=el(3),pc=el(4),SH=el(5),kH=el(6);sg.range;Lp.range;jH.range;wH.range;pc.range;SH.range;kH.range;const U1=cr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());U1.range;const W1=cr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());W1.range;const _a=cr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());_a.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});_a.range;const Aa=cr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Aa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Aa.range;function _L(e,t,r,n,a,i){const s=[[ys,1,da],[ys,5,5*da],[ys,15,15*da],[ys,30,30*da],[i,1,Kn],[i,5,5*Kn],[i,15,15*Kn],[i,30,30*Kn],[a,1,ua],[a,3,3*ua],[a,6,6*ua],[a,12,12*ua],[n,1,Ca],[n,2,2*Ca],[r,1,$1],[t,1,h_],[t,3,3*h_],[e,1,zx]];function l(u,d,f){const p=d<u;p&&([u,d]=[d,u]);const x=f&&typeof f.range=="function"?f:c(u,d,f),m=x?x.range(u,+d+1):[];return p?m.reverse():m}function c(u,d,f){const p=Math.abs(d-u)/f,x=k1(([,,j])=>j).right(s,p);if(x===s.length)return e.every(Jy(u/zx,d/zx,f));if(x===0)return Op.every(Math.max(Jy(u,d,f),1));const[m,y]=s[p/s[x-1][2]<s[x][2]/p?x-1:x];return m.every(y)}return[l,c]}const[CH,_H]=_L(Aa,W1,sg,CL,B1,F1),[AH,EH]=_L(_a,U1,ig,Yu,z1,R1);function Bx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ux(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function sd(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function NH(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,u=ld(a),d=cd(a),f=ld(i),p=cd(i),x=ld(s),m=cd(s),y=ld(l),j=cd(l),b=ld(c),g=cd(c),v={a:D,A:O,b:F,B:q,c:null,d:y_,e:y_,f:ZH,g:lX,G:dX,H:XH,I:YH,j:JH,L:AL,m:QH,M:eX,p:te,q:H,Q:w_,s:S_,S:tX,u:rX,U:nX,V:oX,w:aX,W:iX,x:null,X:null,y:sX,Y:cX,Z:uX,"%":j_},w={a:B,A:K,b:Z,B:he,c:null,d:b_,e:b_,f:mX,g:CX,G:AX,H:fX,I:hX,j:pX,L:NL,m:gX,M:xX,p:re,q:X,Q:w_,s:S_,S:vX,u:yX,U:bX,V:jX,w:wX,W:SX,x:null,X:null,y:kX,Y:_X,Z:EX,"%":j_},C={a:E,A:N,b:$,B:z,c:T,d:x_,e:x_,f:KH,g:g_,G:m_,H:v_,I:v_,j:BH,L:qH,m:zH,M:UH,p:A,q:FH,Q:VH,s:HH,S:WH,u:LH,U:DH,V:IH,w:TH,W:$H,x:I,X:L,y:g_,Y:m_,Z:RH,"%":GH};v.x=k(r,v),v.X=k(n,v),v.c=k(t,v),w.x=k(r,w),w.X=k(n,w),w.c=k(t,w);function k(V,J){return function(ne){var Q=[],me=-1,ue=0,W=V.length,ae,we,ve;for(ne instanceof Date||(ne=new Date(+ne));++me<W;)V.charCodeAt(me)===37&&(Q.push(V.slice(ue,me)),(we=p_[ae=V.charAt(++me)])!=null?ae=V.charAt(++me):we=ae==="e"?" ":"0",(ve=J[ae])&&(ae=ve(ne,we)),Q.push(ae),ue=me+1);return Q.push(V.slice(ue,me)),Q.join("")}}function S(V,J){return function(ne){var Q=sd(1900,void 0,1),me=_(Q,V,ne+="",0),ue,W;if(me!=ne.length)return null;if("Q"in Q)return new Date(Q.Q);if("s"in Q)return new Date(Q.s*1e3+("L"in Q?Q.L:0));if(J&&!("Z"in Q)&&(Q.Z=0),"p"in Q&&(Q.H=Q.H%12+Q.p*12),Q.m===void 0&&(Q.m="q"in Q?Q.q:0),"V"in Q){if(Q.V<1||Q.V>53)return null;"w"in Q||(Q.w=1),"Z"in Q?(ue=Ux(sd(Q.y,0,1)),W=ue.getUTCDay(),ue=W>4||W===0?Lp.ceil(ue):Lp(ue),ue=ag.offset(ue,(Q.V-1)*7),Q.y=ue.getUTCFullYear(),Q.m=ue.getUTCMonth(),Q.d=ue.getUTCDate()+(Q.w+6)%7):(ue=Bx(sd(Q.y,0,1)),W=ue.getDay(),ue=W>4||W===0?Tp.ceil(ue):Tp(ue),ue=Yu.offset(ue,(Q.V-1)*7),Q.y=ue.getFullYear(),Q.m=ue.getMonth(),Q.d=ue.getDate()+(Q.w+6)%7)}else("W"in Q||"U"in Q)&&("w"in Q||(Q.w="u"in Q?Q.u%7:"W"in Q?1:0),W="Z"in Q?Ux(sd(Q.y,0,1)).getUTCDay():Bx(sd(Q.y,0,1)).getDay(),Q.m=0,Q.d="W"in Q?(Q.w+6)%7+Q.W*7-(W+5)%7:Q.w+Q.U*7-(W+6)%7);return"Z"in Q?(Q.H+=Q.Z/100|0,Q.M+=Q.Z%100,Ux(Q)):Bx(Q)}}function _(V,J,ne,Q){for(var me=0,ue=J.length,W=ne.length,ae,we;me<ue;){if(Q>=W)return-1;if(ae=J.charCodeAt(me++),ae===37){if(ae=J.charAt(me++),we=C[ae in p_?J.charAt(me++):ae],!we||(Q=we(V,ne,Q))<0)return-1}else if(ae!=ne.charCodeAt(Q++))return-1}return Q}function A(V,J,ne){var Q=u.exec(J.slice(ne));return Q?(V.p=d.get(Q[0].toLowerCase()),ne+Q[0].length):-1}function E(V,J,ne){var Q=x.exec(J.slice(ne));return Q?(V.w=m.get(Q[0].toLowerCase()),ne+Q[0].length):-1}function N(V,J,ne){var Q=f.exec(J.slice(ne));return Q?(V.w=p.get(Q[0].toLowerCase()),ne+Q[0].length):-1}function $(V,J,ne){var Q=b.exec(J.slice(ne));return Q?(V.m=g.get(Q[0].toLowerCase()),ne+Q[0].length):-1}function z(V,J,ne){var Q=y.exec(J.slice(ne));return Q?(V.m=j.get(Q[0].toLowerCase()),ne+Q[0].length):-1}function T(V,J,ne){return _(V,t,J,ne)}function I(V,J,ne){return _(V,r,J,ne)}function L(V,J,ne){return _(V,n,J,ne)}function D(V){return s[V.getDay()]}function O(V){return i[V.getDay()]}function F(V){return c[V.getMonth()]}function q(V){return l[V.getMonth()]}function te(V){return a[+(V.getHours()>=12)]}function H(V){return 1+~~(V.getMonth()/3)}function B(V){return s[V.getUTCDay()]}function K(V){return i[V.getUTCDay()]}function Z(V){return c[V.getUTCMonth()]}function he(V){return l[V.getUTCMonth()]}function re(V){return a[+(V.getUTCHours()>=12)]}function X(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var J=k(V+="",v);return J.toString=function(){return V},J},parse:function(V){var J=S(V+="",!1);return J.toString=function(){return V},J},utcFormat:function(V){var J=k(V+="",w);return J.toString=function(){return V},J},utcParse:function(V){var J=S(V+="",!0);return J.toString=function(){return V},J}}}var p_={"-":"",_:" ",0:"0"},yr=/^\s*\d+/,PH=/^%/,MH=/[\\^$*+?|[\]().{}]/g;function ct(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function OH(e){return e.replace(MH,"\\$&")}function ld(e){return new RegExp("^(?:"+e.map(OH).join("|")+")","i")}function cd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function TH(e,t,r){var n=yr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function LH(e,t,r){var n=yr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function DH(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function IH(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function $H(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function m_(e,t,r){var n=yr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function g_(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function RH(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function FH(e,t,r){var n=yr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function zH(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function x_(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function BH(e,t,r){var n=yr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function v_(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function UH(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function WH(e,t,r){var n=yr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function qH(e,t,r){var n=yr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function KH(e,t,r){var n=yr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function GH(e,t,r){var n=PH.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function VH(e,t,r){var n=yr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function HH(e,t,r){var n=yr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function y_(e,t){return ct(e.getDate(),t,2)}function XH(e,t){return ct(e.getHours(),t,2)}function YH(e,t){return ct(e.getHours()%12||12,t,2)}function JH(e,t){return ct(1+Yu.count(_a(e),e),t,3)}function AL(e,t){return ct(e.getMilliseconds(),t,3)}function ZH(e,t){return AL(e,t)+"000"}function QH(e,t){return ct(e.getMonth()+1,t,2)}function eX(e,t){return ct(e.getMinutes(),t,2)}function tX(e,t){return ct(e.getSeconds(),t,2)}function rX(e){var t=e.getDay();return t===0?7:t}function nX(e,t){return ct(ig.count(_a(e)-1,e),t,2)}function EL(e){var t=e.getDay();return t>=4||t===0?hc(e):hc.ceil(e)}function oX(e,t){return e=EL(e),ct(hc.count(_a(e),e)+(_a(e).getDay()===4),t,2)}function aX(e){return e.getDay()}function iX(e,t){return ct(Tp.count(_a(e)-1,e),t,2)}function sX(e,t){return ct(e.getFullYear()%100,t,2)}function lX(e,t){return e=EL(e),ct(e.getFullYear()%100,t,2)}function cX(e,t){return ct(e.getFullYear()%1e4,t,4)}function dX(e,t){var r=e.getDay();return e=r>=4||r===0?hc(e):hc.ceil(e),ct(e.getFullYear()%1e4,t,4)}function uX(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ct(t/60|0,"0",2)+ct(t%60,"0",2)}function b_(e,t){return ct(e.getUTCDate(),t,2)}function fX(e,t){return ct(e.getUTCHours(),t,2)}function hX(e,t){return ct(e.getUTCHours()%12||12,t,2)}function pX(e,t){return ct(1+ag.count(Aa(e),e),t,3)}function NL(e,t){return ct(e.getUTCMilliseconds(),t,3)}function mX(e,t){return NL(e,t)+"000"}function gX(e,t){return ct(e.getUTCMonth()+1,t,2)}function xX(e,t){return ct(e.getUTCMinutes(),t,2)}function vX(e,t){return ct(e.getUTCSeconds(),t,2)}function yX(e){var t=e.getUTCDay();return t===0?7:t}function bX(e,t){return ct(sg.count(Aa(e)-1,e),t,2)}function PL(e){var t=e.getUTCDay();return t>=4||t===0?pc(e):pc.ceil(e)}function jX(e,t){return e=PL(e),ct(pc.count(Aa(e),e)+(Aa(e).getUTCDay()===4),t,2)}function wX(e){return e.getUTCDay()}function SX(e,t){return ct(Lp.count(Aa(e)-1,e),t,2)}function kX(e,t){return ct(e.getUTCFullYear()%100,t,2)}function CX(e,t){return e=PL(e),ct(e.getUTCFullYear()%100,t,2)}function _X(e,t){return ct(e.getUTCFullYear()%1e4,t,4)}function AX(e,t){var r=e.getUTCDay();return e=r>=4||r===0?pc(e):pc.ceil(e),ct(e.getUTCFullYear()%1e4,t,4)}function EX(){return"+0000"}function j_(){return"%"}function w_(e){return+e}function S_(e){return Math.floor(+e/1e3)}var hl,ML,OL;NX({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NX(e){return hl=NH(e),ML=hl.format,hl.parse,OL=hl.utcFormat,hl.utcParse,hl}function PX(e){return new Date(e)}function MX(e){return e instanceof Date?+e:+new Date(+e)}function q1(e,t,r,n,a,i,s,l,c,u){var d=P1(),f=d.invert,p=d.domain,x=u(".%L"),m=u(":%S"),y=u("%I:%M"),j=u("%I %p"),b=u("%a %d"),g=u("%b %d"),v=u("%B"),w=u("%Y");function C(k){return(c(k)<k?x:l(k)<k?m:s(k)<k?y:i(k)<k?j:n(k)<k?a(k)<k?b:g:r(k)<k?v:w)(k)}return d.invert=function(k){return new Date(f(k))},d.domain=function(k){return arguments.length?p(Array.from(k,MX)):p().map(PX)},d.ticks=function(k){var S=p();return e(S[0],S[S.length-1],k??10)},d.tickFormat=function(k,S){return S==null?C:u(S)},d.nice=function(k){var S=p();return(!k||typeof k.range!="function")&&(k=t(S[0],S[S.length-1],k??10)),k?p(vL(S,k)):d},d.copy=function(){return Xu(d,q1(e,t,r,n,a,i,s,l,c,u))},d}function OX(){return io.apply(q1(AH,EH,_a,U1,ig,Yu,z1,R1,ys,ML).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function TX(){return io.apply(q1(CH,_H,Aa,W1,sg,ag,B1,F1,ys,OL).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function lg(){var e=0,t=1,r,n,a,i,s=Gr,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(p){var x,m;return arguments.length?([x,m]=p,s=f(x,m),u):[s(0),s(1)]}}return u.range=d(Mc),u.rangeRound=d(N1),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function qi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function TL(){var e=Wi(lg()(Gr));return e.copy=function(){return qi(e,TL())},Da.apply(e,arguments)}function LL(){var e=T1(lg()).domain([1,10]);return e.copy=function(){return qi(e,LL()).base(e.base())},Da.apply(e,arguments)}function DL(){var e=L1(lg());return e.copy=function(){return qi(e,DL()).constant(e.constant())},Da.apply(e,arguments)}function K1(){var e=D1(lg());return e.copy=function(){return qi(e,K1()).exponent(e.exponent())},Da.apply(e,arguments)}function LX(){return K1.apply(null,arguments).exponent(.5)}function IL(){var e=[],t=Gr;function r(n){if(n!=null&&!isNaN(n=+n))return t((Vu(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ci),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>yV(e,i/n))},r.copy=function(){return IL(t).domain(e)},Da.apply(r,arguments)}function cg(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,u=Gr,d,f=!1,p;function x(y){return isNaN(y=+y)?p:(y=.5+((y=+d(y))-i)*(n*y<n*i?l:c),u(f?Math.max(0,Math.min(1,y)):y))}x.domain=function(y){return arguments.length?([e,t,r]=y,a=d(e=+e),i=d(t=+t),s=d(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,x):[e,t,r]},x.clamp=function(y){return arguments.length?(f=!!y,x):f},x.interpolator=function(y){return arguments.length?(u=y,x):u};function m(y){return function(j){var b,g,v;return arguments.length?([b,g,v]=j,u=GV(y,[b,g,v]),x):[u(0),u(.5),u(1)]}}return x.range=m(Mc),x.rangeRound=m(N1),x.unknown=function(y){return arguments.length?(p=y,x):p},function(y){return d=y,a=y(e),i=y(t),s=y(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,x}}function $L(){var e=Wi(cg()(Gr));return e.copy=function(){return qi(e,$L())},Da.apply(e,arguments)}function RL(){var e=T1(cg()).domain([.1,1,10]);return e.copy=function(){return qi(e,RL()).base(e.base())},Da.apply(e,arguments)}function FL(){var e=L1(cg());return e.copy=function(){return qi(e,FL()).constant(e.constant())},Da.apply(e,arguments)}function G1(){var e=D1(cg());return e.copy=function(){return qi(e,G1()).exponent(e.exponent())},Da.apply(e,arguments)}function DX(){return G1.apply(null,arguments).exponent(.5)}const wd=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:_1,scaleDiverging:$L,scaleDivergingLog:RL,scaleDivergingPow:G1,scaleDivergingSqrt:DX,scaleDivergingSymlog:FL,scaleIdentity:xL,scaleImplicit:Zy,scaleLinear:gL,scaleLog:yL,scaleOrdinal:C1,scalePoint:wV,scalePow:I1,scaleQuantile:wL,scaleQuantize:SL,scaleRadial:jL,scaleSequential:TL,scaleSequentialLog:LL,scaleSequentialPow:K1,scaleSequentialQuantile:IL,scaleSequentialSqrt:LX,scaleSequentialSymlog:DL,scaleSqrt:mH,scaleSymlog:bL,scaleThreshold:kL,scaleTime:OX,scaleUtc:TX,tickFormat:mL},Symbol.toStringTag,{value:"Module"}));var tl=e=>e.chartData,V1=le([tl],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),H1=(e,t,r,n)=>n?V1(e):tl(e);function mc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Pn(t)&&Pn(r))return!0}return!1}function k_(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function IX(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Pn(r))a=r;else if(typeof r=="function")return;if(Pn(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(mc(s))return s}}function $X(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(mc(n))return k_(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Pe(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&bC.test(a)){var c=bC.exec(a);if(c==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Pe(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&jC.test(i)){var d=jC.exec(i);if(d==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var p=[s,l];if(mc(p))return t==null?p:k_(p,t,r)}}}var Oc=1e9,RX={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Y1,Et=!0,ro="[DecimalError] ",Ts=ro+"Invalid argument: ",X1=ro+"Exponent out of range: ",Tc=Math.floor,ss=Math.pow,FX=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,bn,fr=1e7,St=7,zL=9007199254740991,Dp=Tc(zL/St),Me={};Me.absoluteValue=Me.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Me.comparedTo=Me.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Me.decimalPlaces=Me.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*St;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Me.dividedBy=Me.div=function(e){return ma(this,new this.constructor(e))};Me.dividedToIntegerBy=Me.idiv=function(e){var t=this,r=t.constructor;return xt(ma(t,new r(e),0,1),r.precision)};Me.equals=Me.eq=function(e){return!this.cmp(e)};Me.exponent=function(){return Qt(this)};Me.greaterThan=Me.gt=function(e){return this.cmp(e)>0};Me.greaterThanOrEqualTo=Me.gte=function(e){return this.cmp(e)>=0};Me.isInteger=Me.isint=function(){return this.e>this.d.length-2};Me.isNegative=Me.isneg=function(){return this.s<0};Me.isPositive=Me.ispos=function(){return this.s>0};Me.isZero=function(){return this.s===0};Me.lessThan=Me.lt=function(e){return this.cmp(e)<0};Me.lessThanOrEqualTo=Me.lte=function(e){return this.cmp(e)<1};Me.logarithm=Me.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(bn))throw Error(ro+"NaN");if(r.s<1)throw Error(ro+(r.s?"NaN":"-Infinity"));return r.eq(bn)?new n(0):(Et=!1,t=ma(wu(r,i),wu(e,i),i),Et=!0,xt(t,a))};Me.minus=Me.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?WL(t,e):BL(t,(e.s=-e.s,e))};Me.modulo=Me.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ro+"NaN");return r.s?(Et=!1,t=ma(r,e,0,1).times(e),Et=!0,r.minus(t)):xt(new n(r),a)};Me.naturalExponential=Me.exp=function(){return UL(this)};Me.naturalLogarithm=Me.ln=function(){return wu(this)};Me.negated=Me.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Me.plus=Me.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?BL(t,e):WL(t,(e.s=-e.s,e))};Me.precision=Me.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ts+e);if(t=Qt(a)+1,n=a.d.length-1,r=n*St+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Me.squareRoot=Me.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ro+"NaN")}for(e=Qt(l),Et=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=$o(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Tc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(ma(l,i,s+2)).times(.5),$o(i.d).slice(0,s)===(t=$o(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(xt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return Et=!0,xt(n,r)};Me.times=Me.mul=function(e){var t,r,n,a,i,s,l,c,u,d=this,f=d.constructor,p=d.d,x=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=p.length,u=x.length,c<u&&(i=p,p=x,x=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+x[n]*p[a-n-1]+t,i[a--]=l%fr|0,t=l/fr|0;i[a]=(i[a]+t)%fr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Et?xt(e,f.precision):e};Me.toDecimalPlaces=Me.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Uo(e,0,Oc),t===void 0?t=n.rounding:Uo(t,0,8),xt(r,e+Qt(r)+1,t))};Me.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Ws(n,!0):(Uo(e,0,Oc),t===void 0?t=a.rounding:Uo(t,0,8),n=xt(new a(n),e+1,t),r=Ws(n,!0,e+1)),r};Me.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Ws(a):(Uo(e,0,Oc),t===void 0?t=i.rounding:Uo(t,0,8),n=xt(new i(a),e+Qt(a)+1,t),r=Ws(n.abs(),!1,e+Qt(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Me.toInteger=Me.toint=function(){var e=this,t=e.constructor;return xt(new t(e),Qt(e)+1,t.rounding)};Me.toNumber=function(){return+this};Me.toPower=Me.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(bn);if(l=new c(l),!l.s){if(e.s<1)throw Error(ro+"Infinity");return l}if(l.eq(bn))return l;if(n=c.precision,e.eq(bn))return xt(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=d<0?-d:d)<=zL){for(a=new c(bn),t=Math.ceil(n/St+4),Et=!1;r%2&&(a=a.times(l),__(a.d,t)),r=Tc(r/2),r!==0;)l=l.times(l),__(l.d,t);return Et=!0,e.s<0?new c(bn).div(a):xt(a,n)}}else if(i<0)throw Error(ro+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Et=!1,a=e.times(wu(l,n+u)),Et=!0,a=UL(a),a.s=i,a};Me.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Qt(a),n=Ws(a,r<=i.toExpNeg||r>=i.toExpPos)):(Uo(e,1,Oc),t===void 0?t=i.rounding:Uo(t,0,8),a=xt(new i(a),e,t),r=Qt(a),n=Ws(a,e<=r||r<=i.toExpNeg,e)),n};Me.toSignificantDigits=Me.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Uo(e,1,Oc),t===void 0?t=n.rounding:Uo(t,0,8)),xt(new n(r),e,t)};Me.toString=Me.valueOf=Me.val=Me.toJSON=Me[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Qt(e),r=e.constructor;return Ws(e,t<=r.toExpNeg||t>=r.toExpPos)};function BL(e,t){var r,n,a,i,s,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Et?xt(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,a=s,l=c.length),s=Math.ceil(f/St),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/fr|0,c[i]%=fr;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,Et?xt(t,f):t}function Uo(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ts+e)}function $o(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=St-n.length,r&&(i+=ei(r)),i+=n;s=e[t],n=s+"",r=St-n.length,r&&(i+=ei(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var ma=function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%fr|0,s=i/fr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*fr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,u,d,f,p,x,m,y,j,b,g,v,w,C,k,S,_,A=n.constructor,E=n.s==a.s?1:-1,N=n.d,$=a.d;if(!n.s)return new A(n);if(!a.s)throw Error(ro+"Division by zero");for(c=n.e-a.e,S=$.length,C=N.length,x=new A(E),m=x.d=[],u=0;$[u]==(N[u]||0);)++u;if($[u]>(N[u]||0)&&--c,i==null?g=i=A.precision:s?g=i+(Qt(n)-Qt(a))+1:g=i,g<0)return new A(0);if(g=g/St+2|0,u=0,S==1)for(d=0,$=$[0],g++;(u<C||d)&&g--;u++)v=d*fr+(N[u]||0),m[u]=v/$|0,d=v%$|0;else{for(d=fr/($[0]+1)|0,d>1&&($=e($,d),N=e(N,d),S=$.length,C=N.length),w=S,y=N.slice(0,S),j=y.length;j<S;)y[j++]=0;_=$.slice(),_.unshift(0),k=$[0],$[1]>=fr/2&&++k;do d=0,l=t($,y,S,j),l<0?(b=y[0],S!=j&&(b=b*fr+(y[1]||0)),d=b/k|0,d>1?(d>=fr&&(d=fr-1),f=e($,d),p=f.length,j=y.length,l=t(f,y,p,j),l==1&&(d--,r(f,S<p?_:$,p))):(d==0&&(l=d=1),f=$.slice()),p=f.length,p<j&&f.unshift(0),r(y,f,j),l==-1&&(j=y.length,l=t($,y,S,j),l<1&&(d++,r(y,S<j?_:$,j))),j=y.length):l===0&&(d++,y=[0]),m[u++]=d,l&&y[0]?y[j++]=N[w]||0:(y=[N[w]],j=1);while((w++<C||y[0]!==void 0)&&g--)}return m[0]||m.shift(),x.e=c,xt(x,s?i+Qt(x)+1:i)}}();function UL(e,t){var r,n,a,i,s,l,c=0,u=0,d=e.constructor,f=d.precision;if(Qt(e)>16)throw Error(X1+Qt(e));if(!e.s)return new d(bn);for(Et=!1,l=f,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(ss(2,u))/Math.LN10*2+5|0,l+=n,r=a=i=new d(bn),d.precision=l;;){if(a=xt(a.times(e),l),r=r.times(++c),s=i.plus(ma(a,r,l)),$o(s.d).slice(0,l)===$o(i.d).slice(0,l)){for(;u--;)i=xt(i.times(i),l);return d.precision=f,t==null?(Et=!0,xt(i,f)):i}i=s}}function Qt(e){for(var t=e.e*St,r=e.d[0];r>=10;r/=10)t++;return t}function Wx(e,t,r){if(t>e.LN10.sd())throw Et=!0,r&&(e.precision=r),Error(ro+"LN10 precision limit exceeded");return xt(new e(e.LN10),t)}function ei(e){for(var t="";e--;)t+="0";return t}function wu(e,t){var r,n,a,i,s,l,c,u,d,f=1,p=10,x=e,m=x.d,y=x.constructor,j=y.precision;if(x.s<1)throw Error(ro+(x.s?"NaN":"-Infinity"));if(x.eq(bn))return new y(0);if(t==null?(Et=!1,u=j):u=t,x.eq(10))return t==null&&(Et=!0),Wx(y,u);if(u+=p,y.precision=u,r=$o(m),n=r.charAt(0),i=Qt(x),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)x=x.times(e),r=$o(x.d),n=r.charAt(0),f++;i=Qt(x),n>1?(x=new y("0."+r),i++):x=new y(n+"."+r.slice(1))}else return c=Wx(y,u+2,j).times(i+""),x=wu(new y(n+"."+r.slice(1)),u-p).plus(c),y.precision=j,t==null?(Et=!0,xt(x,j)):x;for(l=s=x=ma(x.minus(bn),x.plus(bn),u),d=xt(x.times(x),u),a=3;;){if(s=xt(s.times(d),u),c=l.plus(ma(s,new y(a),u)),$o(c.d).slice(0,u)===$o(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(Wx(y,u+2,j).times(i+""))),l=ma(l,new y(f),u),y.precision=j,t==null?(Et=!0,xt(l,j)):l;l=c,a+=2}}function C_(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Tc(r/St),e.d=[],n=(r+1)%St,r<0&&(n+=St),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=St;n<a;)e.d.push(+t.slice(n,n+=St));t=t.slice(n),n=St-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Et&&(e.e>Dp||e.e<-Dp))throw Error(X1+r)}else e.s=0,e.e=0,e.d=[0];return e}function xt(e,t,r){var n,a,i,s,l,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=St,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/St),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=St,a=n-St+s}if(r!==void 0&&(i=ss(10,s-a-1),l=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/ss(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Qt(e),f.length=1,t=t-i-1,f[0]=ss(10,(St-t%St)%St),e.e=Tc(-t/St)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=ss(10,St-n),f[d]=a>0?(u/ss(10,s-a)%ss(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==fr&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=fr)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(Et&&(e.e>Dp||e.e<-Dp))throw Error(X1+Qt(e));return e}function WL(e,t){var r,n,a,i,s,l,c,u,d,f,p=e.constructor,x=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Et?xt(t,x):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(x/St),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=fr-1;--c[i],c[a]+=fr}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Et?xt(t,x):t):new p(0)}function Ws(e,t,r){var n,a=Qt(e),i=$o(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+ei(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ei(-a-1)+i,r&&(n=r-s)>0&&(i+=ei(n))):a>=s?(i+=ei(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+ei(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=ei(n))),e.s<0?"-"+i:i}function __(e,t){if(e.length>t)return e.length=t,!0}function qL(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ts+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return C_(s,i.toString())}else if(typeof i!="string")throw Error(Ts+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,FX.test(i))C_(s,i);else throw Error(Ts+i)}if(a.prototype=Me,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=qL,a.config=a.set=zX,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function zX(e){if(!e||typeof e!="object")throw Error(ro+"Object expected");var t,r,n,a=["precision",1,Oc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Tc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ts+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ts+r+": "+n);return this}var Y1=qL(RX);bn=new Y1(1);const ht=Y1;var BX=e=>e,KL={},GL=e=>e===KL,A_=e=>function t(){return arguments.length===0||arguments.length===1&&GL(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},VL=(e,t)=>e===1?t:A_(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==KL).length;return i>=e?t(...n):VL(e-i,A_(function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];var u=n.map(d=>GL(d)?l.shift():d);return t(...u,...l)}))}),dg=e=>VL(e.length,e),rb=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},UX=dg((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),WX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return BX;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((l,c)=>c(l),i(...arguments))}},nb=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),HL=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,l)=>{var c;return s===((c=t)===null||c===void 0?void 0:c[l])})||(t=a,r=e(...a)),r}};function XL(e){var t;return e===0?t=1:t=Math.floor(new ht(e).abs().log(10).toNumber())+1,t}function YL(e,t,r){for(var n=new ht(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}dg((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});dg((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});dg((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var JL=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},ZL=(e,t,r)=>{if(e.lte(0))return new ht(0);var n=XL(e.toNumber()),a=new ht(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new ht(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?new ht(c.toNumber()):new ht(Math.ceil(c.toNumber()))},qX=(e,t,r)=>{var n=new ht(1),a=new ht(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ht(10).pow(XL(e)-1),a=new ht(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ht(Math.floor(e)))}else e===0?a=new ht(Math.floor((t-1)/2)):r||(a=new ht(Math.floor(e)));var s=Math.floor((t-1)/2),l=WX(UX(c=>a.add(new ht(c-s).mul(n)).toNumber()),rb);return l(0,t)},QL=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ht(0),tickMin:new ht(0),tickMax:new ht(0)};var s=ZL(new ht(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new ht(0):(l=new ht(t).add(r).div(2),l=l.sub(new ht(l).mod(s)));var c=Math.ceil(l.sub(t).div(s).toNumber()),u=Math.ceil(new ht(r).sub(l).div(s).toNumber()),d=c+u+1;return d>n?QL(t,r,n,a,i+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:s,tickMin:l.sub(new ht(c).mul(s)),tickMax:l.add(new ht(u).mul(s))})};function KX(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,l]=JL([t,r]);if(s===-1/0||l===1/0){var c=l===1/0?[s,...rb(0,n-1).map(()=>1/0)]:[...rb(0,n-1).map(()=>-1/0),l];return t>r?nb(c):c}if(s===l)return qX(s,n,a);var{step:u,tickMin:d,tickMax:f}=QL(s,l,i,a,0),p=YL(d,f.add(new ht(.1).mul(u)),u);return t>r?nb(p):p}function GX(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=JL([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var l=Math.max(t,2),c=ZL(new ht(s).sub(i).div(l-1),a,0),u=[...YL(new ht(i),new ht(s),c),s];return a===!1&&(u=u.map(d=>Math.round(d))),r>n?nb(u):u}var VX=HL(KX),HX=HL(GX),e3=e=>e.rootProps.maxBarSize,XX=e=>e.rootProps.barGap,t3=e=>e.rootProps.barCategoryGap,YX=e=>e.rootProps.barSize,Ju=e=>e.rootProps.stackOffset,J1=e=>e.options.chartName,Z1=e=>e.rootProps.syncId,r3=e=>e.rootProps.syncMethod,Q1=e=>e.options.eventEmitter,aa={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},mn={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},ug=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},JX={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:aa.angleAxisId,includeHidden:!1,name:void 0,reversed:aa.reversed,scale:aa.scale,tick:aa.tick,tickCount:void 0,ticks:void 0,type:aa.type,unit:void 0},ZX={allowDataOverflow:mn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:mn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:mn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:mn.scale,tick:mn.tick,tickCount:mn.tickCount,ticks:void 0,type:mn.type,unit:void 0},QX={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:aa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:aa.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:aa.scale,tick:aa.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},eY={allowDataOverflow:mn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:mn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:mn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:mn.scale,tick:mn.tick,tickCount:mn.tickCount,ticks:void 0,type:"category",unit:void 0},ej=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?QX:JX,tj=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?eY:ZX,fg=e=>e.polarOptions,rj=le([Ta,La,lr],OT),n3=le([fg,rj],(e,t)=>{if(e!=null)return Hr(e.innerRadius,t,0)}),o3=le([fg,rj],(e,t)=>{if(e!=null)return Hr(e.outerRadius,t,t*.8)}),tY=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},a3=le([fg],tY);le([ej,a3],ug);var i3=le([rj,n3,o3],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});le([tj,i3],ug);var rY=le([ut,fg,n3,o3,Ta,La],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:c,endAngle:u}=t;return{cx:Hr(s,a,a/2),cy:Hr(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Vt=(e,t)=>t,Zu=(e,t,r)=>r;function E_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ip(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E_(Object(r),!0).forEach(function(n){nY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nY(e,t,r){return(t=oY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oY(e){var t=aY(e,"string");return typeof t=="symbol"?t:t+""}function aY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ob=[0,"auto"],fn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Ia=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??fn},hn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ob,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:eg},Ki=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??hn},iY={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},nj=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??iY},Ht=(e,t,r)=>{switch(t){case"xAxis":return Ia(e,r);case"yAxis":return Ki(e,r);case"zAxis":return nj(e,r);case"angleAxis":return ej(e,r);case"radiusAxis":return tj(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},sY=(e,t,r)=>{switch(t){case"xAxis":return Ia(e,r);case"yAxis":return Ki(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Qu=(e,t,r)=>{switch(t){case"xAxis":return Ia(e,r);case"yAxis":return Ki(e,r);case"angleAxis":return ej(e,r);case"radiusAxis":return tj(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},s3=e=>e.graphicalItems.countOfBars>0;function oj(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var hg=e=>e.graphicalItems.cartesianItems,lY=le([Vt,Zu],oj),aj=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),ef=le([hg,Ht,lY],aj),l3=e=>e.filter(t=>t.stackId===void 0),cY=le([ef],l3),ij=e=>e.map(t=>t.data).filter(Boolean).flat(1),dY=le([ef],ij),sj=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},pg=le([dY,H1],sj),lj=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:kt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:kt(a,n)}))):e.map(n=>({value:n})),mg=le([pg,Ht,ef],lj);function c3(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function rl(e){return e.filter(t=>Bo(t)||t instanceof Date).map(Number).filter(t=>An(t)===!1)}function uY(e,t,r){return!r||typeof t!="number"||An(t)?[]:r.length?rl(r.flatMap(n=>{var a=kt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Pn(i)||!Pn(s)))return[t-i,t+s]})):[]}var d3=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,l]=i,c=l.map(u=>u.dataKey);return[s,{stackedData:bK(e,c,r),graphicalItems:l}]}))},ab=le([pg,ef,Ju],d3),u3=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=kK(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},fY=le([ab,tl,Vt],u3),f3=(e,t,r,n)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var s,l,c=(s=i.errorBars)===null||s===void 0?void 0:s.filter(d=>c3(n,d)),u=kt(a,(l=t.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:u,errorDomain:uY(a,u,c)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:kt(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),hY=le(pg,Ht,cY,Vt,f3);function pY(e){var{value:t}=e;if(Bo(t)||t instanceof Date)return t}var mY=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=rl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},gY=(e,t,r)=>{var n=e.map(pY).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&gO(n))?aL(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},cj=e=>{var t;if(e==null||!("domain"in e))return ob;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=rl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:ob},dj=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},h3=e=>e.referenceElements.dots,Lc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),xY=le([h3,Vt,Zu],Lc),p3=e=>e.referenceElements.areas,vY=le([p3,Vt,Zu],Lc),m3=e=>e.referenceElements.lines,yY=le([m3,Vt,Zu],Lc),g3=(e,t)=>{var r=rl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},bY=le(xY,Vt,g3),x3=(e,t)=>{var r=rl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},jY=le([vY,Vt],x3),v3=(e,t)=>{var r=rl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},wY=le(yY,Vt,v3),SY=le(bY,wY,jY,(e,t,r)=>dj(e,r,t)),y3=le([Ht],cj),uj=(e,t,r,n,a)=>{var i=IX(t,e.allowDataOverflow);return i??$X(t,dj(r,a,mY(n)),e.allowDataOverflow)},kY=le([Ht,y3,fY,hY,SY],uj),CY=[0,1],fj=(e,t,r,n,a,i,s)=>{if(!(e==null||r==null||r.length===0)){var{dataKey:l,type:c}=e,u=Ui(t,i);return u&&l==null?aL(0,r.length):c==="category"?gY(n,e,u):a==="expand"?CY:s}},hj=le([Ht,ut,pg,mg,Ju,Vt,kY],fj),b3=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Wu(i));return l in wd?l:"point"}}},Dc=le([Ht,ut,s3,J1,Vt],b3);function _Y(e){if(e!=null){if(e in wd)return wd[e]();var t="scale".concat(Wu(e));if(t in wd)return wd[t]()}}function pj(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=_Y(t);if(a!=null){var i=a.domain(r).range(n);return mK(i),i}}}var mj=(e,t,r)=>{var n=cj(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&mc(e))return VX(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&mc(e))return HX(e,t.tickCount,t.allowDecimals)}},gj=le([hj,Qu,Dc],mj),xj=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&mc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(s,l)]}return t},AY=le([Ht,hj,gj,Vt],xj),EY=le(mg,Ht,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(rl(e.map(l=>l.value))).sort((l,c)=>l-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),j3=le(EY,ut,t3,lr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Pn(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=Hr(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),NY=(e,t)=>{var r=Ia(e,t);return r==null||typeof r.padding!="string"?0:j3(e,"xAxis",t,r.padding)},PY=(e,t)=>{var r=Ki(e,t);return r==null||typeof r.padding!="string"?0:j3(e,"yAxis",t,r.padding)},MY=le(Ia,NY,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),OY=le(Ki,PY,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),TY=le([lr,MY,rg,tg,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),LY=le([lr,ut,OY,rg,tg,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),tf=(e,t,r,n)=>{var a;switch(t){case"xAxis":return TY(e,r,n);case"yAxis":return LY(e,r,n);case"zAxis":return(a=nj(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return a3(e);case"radiusAxis":return i3(e,r);default:return}},w3=le([Ht,tf],ug),Ic=le([Ht,Dc,AY,w3],pj);le(ef,Vt,(e,t)=>e.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>c3(t,r)));function S3(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var gg=(e,t)=>t,xg=(e,t,r)=>r,DY=le(g1,gg,xg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(S3)),IY=le(x1,gg,xg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(S3)),k3=(e,t)=>({width:e.width,height:t.height}),$Y=(e,t)=>{var r=typeof t.width=="number"?t.width:eg;return{width:r,height:e.height}},C3=le(lr,Ia,k3),RY=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},FY=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},zY=le(La,lr,DY,gg,xg,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=k3(t,l);s==null&&(s=RY(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i}),BY=le(Ta,lr,IY,gg,xg,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=$Y(t,l);s==null&&(s=FY(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i}),UY=(e,t)=>{var r=lr(e),n=Ia(e,t);if(n!=null){var a=zY(e,n.orientation,n.mirror),i=a[t];return i==null?{x:r.left,y:0}:{x:r.left,y:i}}},WY=(e,t)=>{var r=lr(e),n=Ki(e,t);if(n!=null){var a=BY(e,n.orientation,n.mirror),i=a[t];return i==null?{x:0,y:r.top}:{x:i,y:r.top}}},_3=le(lr,Ki,(e,t)=>{var r=typeof t.width=="number"?t.width:eg;return{width:r,height:e.height}}),N_=(e,t,r)=>{switch(t){case"xAxis":return C3(e,r).width;case"yAxis":return _3(e,r).height;default:return}},A3=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=Ui(e,n),c=t.map(u=>u.value);if(s&&l&&i==="category"&&a&&gO(c))return c}},vj=le([ut,mg,Ht,Vt],A3),E3=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Ui(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},yj=le([ut,mg,Qu,Vt],E3),P_=le([ut,sY,Dc,Ic,vj,yj,tf,gj,Vt],(e,t,r,n,a,i,s,l,c)=>{if(t==null)return null;var u=Ui(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:l,range:s,realScaleType:r,scale:n}}),qY=(e,t,r,n,a,i,s,l,c)=>{if(!(t==null||n==null)){var u=Ui(e,c),{type:d,ticks:f,tickCount:p}=t,x=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/x:0;m=c==="angleAxis"&&i!=null&&i.length>=2?mr(i[0]-i[1])*2*m:m;var y=f||a;if(y){var j=y.map((b,g)=>{var v=s?s.indexOf(b):b;return{index:g,coordinate:n(v)+m,value:b,offset:m}});return j.filter(b=>!An(b.coordinate))}return u&&l?l.map((b,g)=>({coordinate:n(b)+m,value:b,index:g,offset:m})):n.ticks?n.ticks(p).map(b=>({coordinate:n(b)+m,value:b,offset:m})):n.domain().map((b,g)=>({coordinate:n(b)+m,value:s?s[b]:b,index:g,offset:m}))}},N3=le([ut,Qu,Dc,Ic,gj,tf,vj,yj,Vt],qY),KY=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=Ui(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&(n==null?void 0:n.length)>=2?mr(n[0]-n[1])*2*u:u,l&&i?i.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Li=le([ut,Qu,Ic,tf,vj,yj,Vt],KY),Wo=le(Ht,Ic,(e,t)=>{if(!(e==null||t==null))return Ip(Ip({},e),{},{scale:t})}),GY=le([Ht,Dc,hj,w3],pj);le((e,t,r)=>nj(e,r),GY,(e,t)=>{if(!(e==null||t==null))return Ip(Ip({},e),{},{scale:t})});var VY=le([ut,g1,x1],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),P3=e=>e.options.defaultTooltipEventType,M3=e=>e.options.validateTooltipEventTypes;function O3(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function bj(e,t){var r=P3(e),n=M3(e);return O3(t,r,n)}function HY(e){return De(t=>bj(t,e))}var T3=(e,t)=>{var r,n=Number(t);if(!(An(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},XY=e=>e.tooltip.settings,ii={active:!1,index:null,dataKey:void 0,coordinate:void 0},YY={itemInteraction:{click:ii,hover:ii},axisInteraction:{click:ii,hover:ii},keyboardInteraction:ii,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},L3=oo({name:"tooltip",initialState:YY,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=pa(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:JY,removeTooltipEntrySettings:ZY,setTooltipSettingsState:QY,setActiveMouseOverItemIndex:D3,mouseLeaveItem:eJ,mouseLeaveChart:I3,setActiveClickItemIndex:tJ,setMouseOverAxisIndex:$3,setMouseClickAxisIndex:rJ,setSyncInteraction:ib,setKeyboardInteraction:sb}=L3.actions,nJ=L3.reducer;function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){oJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oJ(e,t,r){return(t=aJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aJ(e){var t=iJ(e,"string");return typeof t=="symbol"?t:t+""}function iJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sJ(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function lJ(e){return e.index!=null}var R3=(e,t,r,n)=>{if(t==null)return ii;var a=sJ(e,t,r);if(a==null)return ii;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(lJ(a)){if(i)return Hf(Hf({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Hf(Hf({},ii),{},{coordinate:a.coordinate})},jj=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Pn(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},F3=(e,t,r,n,a,i,s,l)=>{if(!(i==null||l==null)){var c=s[0],u=c==null?void 0:l(c.positions,i);if(u!=null)return u;var d=a==null?void 0:a[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},z3=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},rf=e=>e.options.tooltipPayloadSearcher,$c=e=>e.tooltip;function O_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O_(Object(r),!0).forEach(function(n){cJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cJ(e,t,r){return(t=dJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dJ(e){var t=uJ(e,"string");return typeof t=="symbol"?t:t+""}function uJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fJ(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function hJ(e,t){return e??t}var B3=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((p,x)=>{var m,{dataDefinedOnItem:y,settings:j}=x,b=hJ(y,l),g=fJ(b,u,d),v=(m=j==null?void 0:j.dataKey)!==null&&m!==void 0?m:n==null?void 0:n.dataKey,w=j==null?void 0:j.nameKey,C;if(n!=null&&n.dataKey&&Array.isArray(g)&&!Array.isArray(g[0])&&s==="axis"?C=xO(g,n.dataKey,a):C=i(g,t,c,w),Array.isArray(C))C.forEach(S=>{var _=T_(T_({},j),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});p.push(wC({tooltipEntrySettings:_,dataKey:S.dataKey,payload:S.payload,value:kt(S.payload,S.dataKey),name:S.name}))});else{var k;p.push(wC({tooltipEntrySettings:j,dataKey:v,payload:C,value:kt(C,v),name:(k=kt(C,w))!==null&&k!==void 0?k:j==null?void 0:j.name}))}return p},f)}},br=e=>{var t=ut(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Rc=e=>e.tooltip.settings.axisId,Er=e=>{var t=br(e),r=Rc(e);return Qu(e,t,r)},wj=le([Er,ut,s3,J1,br],b3),pJ=le([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),mJ=le([br,Rc],oj),vg=le([pJ,Er,mJ],aj),gJ=le([vg],ij),nl=le([gJ,tl],sj),Sj=le([nl,Er,vg],lj),xJ=le([Er],cj),vJ=le([nl,vg,Ju],d3),yJ=le([vJ,tl,br],u3),bJ=le([vg],l3),jJ=le([nl,Er,bJ,br],f3),wJ=le([h3,br,Rc],Lc),SJ=le([wJ,br],g3),kJ=le([p3,br,Rc],Lc),CJ=le([kJ,br],x3),_J=le([m3,br,Rc],Lc),AJ=le([_J,br],v3),EJ=le([SJ,AJ,CJ],dj),NJ=le([Er,xJ,yJ,jJ,EJ],uj),U3=le([Er,ut,nl,Sj,Ju,br,NJ],fj),PJ=le([U3,Er,wj],mj),MJ=le([Er,U3,PJ,br],xj),W3=e=>{var t=br(e),r=Rc(e),n=!1;return tf(e,t,r,n)},q3=le([Er,W3],ug),K3=le([Er,wj,MJ,q3],pj),OJ=le([ut,Sj,Er,br],A3),TJ=le([ut,Sj,Er,br],E3),LJ=(e,t,r,n,a,i,s,l)=>{if(t){var{type:c}=t,u=Ui(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?mr(a[0]-a[1])*2*f:f,u&&s?s.map((p,x)=>({coordinate:n(p)+f,value:p,index:x,offset:f})):n.domain().map((p,x)=>({coordinate:n(p)+f,value:i?i[p]:p,index:x,offset:f}))}}},$a=le([ut,Er,wj,K3,W3,OJ,TJ,br],LJ),kj=le([P3,M3,XY],(e,t,r)=>O3(r.shared,e,t)),G3=e=>e.tooltip.settings.trigger,Cj=e=>e.tooltip.settings.defaultIndex,yg=le([$c,kj,G3,Cj],R3),Di=le([yg,nl],jj),V3=le([$a,Di],T3),H3=le([yg],e=>{if(e)return e.dataKey}),X3=le([$c,kj,G3,Cj],z3),DJ=le([Ta,La,ut,lr,$a,Cj,X3,rf],F3),IJ=le([yg,DJ],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),$J=le([yg],e=>e.active),RJ=le([X3,Di,tl,Er,V3,rf,kj],B3),FJ=le([RJ],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function L_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L_(Object(r),!0).forEach(function(n){zJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zJ(e,t,r){return(t=BJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BJ(e){var t=UJ(e,"string");return typeof t=="symbol"?t:t+""}function UJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WJ=()=>De(Er),qJ=()=>{var e=WJ(),t=De($a),r=De(K3);return gu(D_(D_({},e),{},{scale:r}),t)},KJ=()=>De(J1),_j=(e,t)=>t,Y3=(e,t,r)=>r,Aj=(e,t,r,n)=>n,GJ=le($a,e=>Vm(e,t=>t.coordinate)),Ej=le([$c,_j,Y3,Aj],R3),J3=le([Ej,nl],jj),VJ=(e,t,r)=>{if(t!=null){var n=$c(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Z3=le([$c,_j,Y3,Aj],z3),$p=le([Ta,La,ut,lr,$a,Aj,Z3,rf],F3),HJ=le([Ej,$p],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),Q3=le($a,J3,T3),XJ=le([Z3,J3,tl,Er,Q3,rf,_j],B3),YJ=le([Ej],e=>({isActive:e.active,activeIndex:e.index})),JJ=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i)){var c=CK(e.chartX,e.chartY,t,r,l);if(c){var u=AK(c,t),d=hK(u,s,i,n,a),f=_K(t,i,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function lb(){return lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lb.apply(null,arguments)}function I_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I_(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return(t=QJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QJ(e){var t=eZ(e,"string");return typeof t=="symbol"?t:t+""}function eZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tZ(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:l,tooltipEventType:c,chartName:u}=e,d=t,f=r,p=n;if(!l||!d||u!=="ScatterChart"&&c!=="axis")return null;var x,m;if(u==="ScatterChart")x=d,m=kG;else if(u==="BarChart")x=CG(s,d,a,i),m=ZT;else if(s==="radial"){var{cx:y,cy:j,radius:b,startAngle:g,endAngle:v}=QT(d);x={cx:y,cy:j,startAngle:g,endAngle:v,innerRadius:b,outerRadius:b},m=tL}else x={points:iV(s,d,a)},m=w1;var w=typeof l=="object"&&"className"in l?l.className:void 0,C=Xf(Xf(Xf(Xf({stroke:"#ccc",pointerEvents:"none"},a),x),rt(l,!1)),{},{payload:f,payloadIndex:p,className:at("recharts-tooltip-cursor",w)});return h.isValidElement(l)?h.cloneElement(l,C):h.createElement(m,C)}function rZ(e){var t=qJ(),r=zT(),n=ng(),a=KJ();return h.createElement(tZ,lb({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var eD=h.createContext(null),nZ=()=>h.useContext(eD),tD={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new a(d,f||c,p),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],x]:c._events[m].push(x):(c._events[m]=x,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,x=f.length,m=new Array(x);p<x;p++)m[p]=f[p].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,p,x,m){var y=r?r+u:u;if(!this._events[y])return!1;var j=this._events[y],b=arguments.length,g,v;if(j.fn){switch(j.once&&this.removeListener(u,j.fn,void 0,!0),b){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,d),!0;case 3:return j.fn.call(j.context,d,f),!0;case 4:return j.fn.call(j.context,d,f,p),!0;case 5:return j.fn.call(j.context,d,f,p,x),!0;case 6:return j.fn.call(j.context,d,f,p,x,m),!0}for(v=1,g=new Array(b-1);v<b;v++)g[v-1]=arguments[v];j.fn.apply(j.context,g)}else{var w=j.length,C;for(v=0;v<w;v++)switch(j[v].once&&this.removeListener(u,j[v].fn,void 0,!0),b){case 1:j[v].fn.call(j[v].context);break;case 2:j[v].fn.call(j[v].context,d);break;case 3:j[v].fn.call(j[v].context,d,f);break;case 4:j[v].fn.call(j[v].context,d,f,p);break;default:if(!g)for(C=1,g=new Array(b-1);C<b;C++)g[C-1]=arguments[C];j[v].fn.apply(j[v].context,g)}}return!0},l.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,p){var x=r?r+u:u;if(!this._events[x])return this;if(!d)return s(this,x),this;var m=this._events[x];if(m.fn)m.fn===d&&(!p||m.once)&&(!f||m.context===f)&&s(this,x);else{for(var y=0,j=[],b=m.length;y<b;y++)(m[y].fn!==d||p&&!m[y].once||f&&m[y].context!==f)&&j.push(m[y]);j.length?this._events[x]=j.length===1?j[0]:j:s(this,x)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(tD);var oZ=tD.exports;const aZ=no(oZ);var Su=new aZ,cb="recharts.syncEvent.tooltip",$_="recharts.syncEvent.brush";function Nj(e,t){if(t){var r=Number.parseInt(t,10);if(!An(r))return e==null?void 0:e[r]}}var iZ={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},rD=oo({name:"options",initialState:iZ,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),sZ=rD.reducer,{createEventEmitter:lZ}=rD.actions;function cZ(e){return e.tooltip.syncInteraction}var dZ={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},nD=oo({name:"chartData",initialState:dZ,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:R_,setDataStartEndIndexes:uZ,setComputedData:Zse}=nD.actions,fZ=nD.reducer,oD=()=>{};function hZ(){var e=De(Z1),t=De(Q1),r=Nt(),n=De(r3),a=De($a),i=ng(),s=v1(),l=De(c=>c.rootProps.className);h.useEffect(()=>{if(e==null)return oD;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){r(d);return}if(a!=null){var p;if(typeof n=="function"){var x={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},m=n(a,x);p=a[m]}else n==="value"&&(p=a.find(k=>String(k.value)===d.payload.label));var{coordinate:y}=d.payload;if(p==null||d.payload.active===!1||y==null||s==null){r(ib({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:j,y:b}=y,g=Math.min(j,s.x+s.width),v=Math.min(b,s.y+s.height),w={x:i==="horizontal"?p.coordinate:g,y:i==="horizontal"?v:p.coordinate},C=ib({active:d.payload.active,coordinate:w,dataKey:d.payload.dataKey,index:String(p.index),label:d.payload.label});r(C)}}};return Su.on(cb,c),()=>{Su.off(cb,c)}},[l,r,t,e,n,a,i,s])}function pZ(){var e=De(Z1),t=De(Q1),r=Nt();h.useEffect(()=>{if(e==null)return oD;var n=(a,i,s)=>{t!==s&&e===a&&r(uZ(i))};return Su.on($_,n),()=>{Su.off($_,n)}},[r,t,e])}function mZ(){var e=Nt();h.useEffect(()=>{e(lZ())},[e]),hZ(),pZ()}function gZ(e,t,r,n,a,i){var s=De(p=>VJ(p,e,t)),l=De(Q1),c=De(Z1),u=De(r3),d=De(cZ),f=d==null?void 0:d.active;h.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=ib({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});Su.emit(cb,c,p,l)}},[f,r,s,a,n,l,c,u,i])}function F_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F_(Object(r),!0).forEach(function(n){xZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xZ(e,t,r){return(t=vZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vZ(e){var t=yZ(e,"string");return typeof t=="symbol"?t:t+""}function yZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bZ(e){return e.dataKey}function jZ(e,t){return h.isValidElement(e)?h.cloneElement(e,t):typeof e=="function"?h.createElement(e,t):h.createElement(rG,t)}var B_=[],wZ={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Zs.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Yn(e){var t=ao(e,wZ),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:l,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:p,useTranslate3d:x,wrapperStyle:m,cursor:y,shared:j,trigger:b,defaultIndex:g,portal:v,axisId:w}=t,C=Nt(),k=typeof g=="number"?String(g):g;h.useEffect(()=>{C(QY({shared:j,trigger:b,axisId:w,active:r,defaultIndex:k}))},[C,j,b,w,r,k]);var S=v1(),_=qT(),A=HY(j),{activeIndex:E,isActive:N}=De(Z=>YJ(Z,A,b,k)),$=De(Z=>XJ(Z,A,b,k)),z=De(Z=>Q3(Z,A,b,k)),T=De(Z=>HJ(Z,A,b,k)),I=$,L=nZ(),D=r??N,[O,F]=sT([I,D]),q=A==="axis"?z:void 0;gZ(A,b,T,q,E,D);var te=v??L;if(te==null)return null;var H=I??B_;D||(H=B_),l&&H.length&&(H=QO(I.filter(Z=>Z.value!=null&&(Z.hide!==!0||t.includeHidden)),d,bZ));var B=H.length>0,K=h.createElement(cG,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:D,coordinate:T,hasPayload:B,offset:u,position:f,reverseDirection:p,useTranslate3d:x,viewBox:S,wrapperStyle:m,lastBoundingBox:O,innerRef:F,hasPortalFromProps:!!v},jZ(s,z_(z_({},t),{},{payload:H,label:q,active:D,coordinate:T,accessibilityLayer:_})));return h.createElement(h.Fragment,null,Pa.createPortal(K,te),D&&h.createElement(rZ,{cursor:y,tooltipEventType:A,coordinate:T,payload:I,index:E}))}var aD={},iD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=0,a={}){typeof a!="object"&&(a={});let i=null,s=null,l=null,c=0,u=null,d;const{leading:f=!1,trailing:p=!0,maxWait:x}=a,m="maxWait"in a,y=m?Math.max(Number(x)||0,n):0,j=S=>(i!==null&&(d=r.apply(s,i)),i=s=null,c=S,d),b=S=>(c=S,u=setTimeout(C,n),f&&i!==null?j(S):d),g=S=>(u=null,p&&i!==null?j(S):d),v=S=>{if(l===null)return!0;const _=S-l,A=_>=n||_<0,E=m&&S-c>=y;return A||E},w=S=>{const _=l===null?0:S-l,A=n-_,E=y-(S-c);return m?Math.min(A,E):A},C=()=>{const S=Date.now();if(v(S))return g(S);u=setTimeout(C,w(S))},k=function(...S){const _=Date.now(),A=v(_);if(i=S,s=this,l=_,A){if(u===null)return b(_);if(m)return clearTimeout(u),u=setTimeout(C,n),j(_)}return u===null&&(u=setTimeout(C,n)),d};return k.cancel=()=>{u!==null&&clearTimeout(u),c=0,l=i=s=u=null},k.flush=()=>u===null?d:g(Date.now()),k}e.debounce=t})(iD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iD;function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(aD);var SZ=aD.throttle;const kZ=no(SZ);var Fd=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function U_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U_(Object(r),!0).forEach(function(n){CZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CZ(e,t,r){return(t=_Z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Z(e){var t=AZ(e,"string");return typeof t=="symbol"?t:t+""}function AZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jn=h.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:p,onResize:x,style:m={}}=e,y=h.useRef(null),j=h.useRef();j.current=x,h.useImperativeHandle(t,()=>y.current);var[b,g]=h.useState({containerWidth:n.width,containerHeight:n.height}),v=h.useCallback((C,k)=>{g(S=>{var _=Math.round(C),A=Math.round(k);return S.containerWidth===_&&S.containerHeight===A?S:{containerWidth:_,containerHeight:A}})},[]);h.useEffect(()=>{var C=A=>{var E,{width:N,height:$}=A[0].contentRect;v(N,$),(E=j.current)===null||E===void 0||E.call(j,N,$)};d>0&&(C=kZ(C,d,{trailing:!0,leading:!1}));var k=new ResizeObserver(C),{width:S,height:_}=y.current.getBoundingClientRect();return v(S,_),k.observe(y.current),()=>{k.disconnect()}},[v,d]);var w=h.useMemo(()=>{var{containerWidth:C,containerHeight:k}=b;if(C<0||k<0)return null;Fd(gs(a)||gs(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),Fd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=gs(a)?C:a,_=gs(i)?k:i;return r&&r>0&&(S?_=S/r:_&&(S=_*r),c&&_>c&&(_=c)),Fd(S>0||_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,_,a,i,s,l,r),h.Children.map(u,A=>h.cloneElement(A,{width:S,height:_,style:qx({width:S,height:_},A.props.style)}))},[r,u,i,c,l,s,b,a]);return h.createElement("div",{id:f?"".concat(f):void 0,className:at("recharts-responsive-container",p),style:qx(qx({},m),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:c}),ref:y},h.createElement("div",{style:{width:0,height:0,overflow:"visible"}},w))}),Gi=e=>null;Gi.displayName="Cell";function W_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function db(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W_(Object(r),!0).forEach(function(n){EZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EZ(e,t,r){return(t=NZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NZ(e){var t=PZ(e,"string");return typeof t=="symbol"?t:t+""}function PZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pl={widthCache:{},cacheCount:0},MZ=2e3,OZ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},q_="recharts_measurement_span";function TZ(e){var t=db({},e);return Object.keys(t).forEach(r=>{t[r]||delete t[r]}),t}var zd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Zs.isSsr)return{width:0,height:0};var n=TZ(r),a=JSON.stringify({text:t,copyStyle:n});if(pl.widthCache[a])return pl.widthCache[a];try{var i=document.getElementById(q_);i||(i=document.createElement("span"),i.setAttribute("id",q_),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=db(db({},OZ),n);Object.assign(i.style,s),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return pl.widthCache[a]=c,++pl.cacheCount>MZ&&(pl.cacheCount=0,pl.widthCache={}),c}catch{return{width:0,height:0}}},K_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,G_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LZ=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,DZ=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,sD={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},IZ=Object.keys(sD),Pl="NaN";function $Z(e,t){return e*sD[t]}class rn{static parse(t){var r,[,n,a]=(r=DZ.exec(t))!==null&&r!==void 0?r:[];return new rn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,An(t)&&(this.unit=""),r!==""&&!LZ.test(r)&&(this.num=NaN,this.unit=""),IZ.includes(r)&&(this.num=$Z(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new rn(NaN,""):new rn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new rn(NaN,""):new rn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new rn(NaN,""):new rn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new rn(NaN,""):new rn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return An(this.num)}}function lD(e){if(e.includes(Pl))return Pl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=K_.exec(t))!==null&&r!==void 0?r:[],s=rn.parse(n??""),l=rn.parse(i??""),c=a==="*"?s.multiply(l):s.divide(l);if(c.isNaN())return Pl;t=t.replace(K_,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,p]=(u=G_.exec(t))!==null&&u!==void 0?u:[],x=rn.parse(d??""),m=rn.parse(p??""),y=f==="+"?x.add(m):x.subtract(m);if(y.isNaN())return Pl;t=t.replace(G_,y.toString())}return t}var V_=/\(([^()]*)\)/;function RZ(e){for(var t=e,r;(r=V_.exec(t))!=null;){var[,n]=r;t=t.replace(V_,lD(n))}return t}function FZ(e){var t=e.replace(/\s+/g,"");return t=RZ(t),t=lD(t),t}function zZ(e){try{return FZ(e)}catch{return Pl}}function Kx(e){var t=zZ(e.slice(5,-1));return t===Pl?"":t}var BZ=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],UZ=["dx","dy","angle","className","breakAll"];function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ub.apply(null,arguments)}function H_(e,t){if(e==null)return{};var r,n,a=WZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cD=/[ \f\n\r\t\v\u2028\u2029]+/,dD=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];vt(t)||(r?a=t.toString().split(""):a=t.toString().split(cD));var i=a.map(l=>({word:l,width:zd(l,n).width})),s=r?0:zd("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},qZ=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:c}=e,u=Pe(i),d=s,f=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce(($,z)=>{var{word:T,width:I}=z,L=$[$.length-1];if(L&&(n==null||a||L.width+I+r<Number(n)))L.words.push(T),L.width+=I+r;else{var D={words:[T],width:I};$.push(D)}return $},[])},p=f(t),x=E=>E.reduce((N,$)=>N.width>$.width?N:$);if(!u||a)return p;var m=p.length>i||x(p).width>Number(n);if(!m)return p;for(var y="",j=E=>{var N=d.slice(0,E),$=dD({breakAll:c,style:l,children:N+y}).wordsWithComputedWidth,z=f($),T=z.length>i||x(z).width>Number(n);return[T,z]},b=0,g=d.length-1,v=0,w;b<=g&&v<=d.length-1;){var C=Math.floor((b+g)/2),k=C-1,[S,_]=j(k),[A]=j(C);if(!S&&!A&&(b=C+1),S&&A&&(g=C-1),!S&&A){w=_;break}v++}return w||p},X_=e=>{var t=vt(e)?[]:e.toString().split(cD);return[{words:t}]},KZ=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!Zs.isSsr){var l,c,u=dD({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return X_(n);return qZ({breakAll:i,children:n,maxLines:s,style:a},l,c,t,r)}return X_(n)},Y_="#808080",bg=h.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:c="end",fill:u=Y_}=e,d=H_(e,BZ),f=h.useMemo(()=>KZ({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:p,dy:x,angle:m,className:y,breakAll:j}=d,b=H_(d,UZ);if(!Bo(r)||!Bo(n))return null;var g=r+(Pe(p)?p:0),v=n+(Pe(x)?x:0),w;switch(c){case"start":w=Kx("calc(".concat(i,")"));break;case"middle":w=Kx("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:w=Kx("calc(".concat(f.length-1," * -").concat(a,")"));break}var C=[];if(s){var k=f[0].width,{width:S}=d;C.push("scale(".concat(Pe(S)?S/k:1,")"))}return m&&C.push("rotate(".concat(m,", ").concat(g,", ").concat(v,")")),C.length&&(b.transform=C.join(" ")),h.createElement("text",ub({},rt(b,!0),{ref:t,x:g,y:v,className:at("recharts-text",y),textAnchor:l,fill:u.includes("url")?Y_:u}),f.map((_,A)=>{var E=_.words.join(j?"":" ");return h.createElement("tspan",{x:g,dy:A===0?w:a,key:"".concat(E,"-").concat(A)},E)}))});bg.displayName="Text";var GZ=["offset"],VZ=["labelRef"];function J_(e,t){if(e==null)return{};var r,n,a=HZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function HZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Z_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z_(Object(r),!0).forEach(function(n){XZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XZ(e,t,r){return(t=YZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YZ(e){var t=JZ(e,"string");return typeof t=="symbol"?t:t+""}function JZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ia(){return ia=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ia.apply(null,arguments)}var ZZ=e=>{var{value:t,formatter:r}=e,n=vt(e.children)?t:e.children;return typeof r=="function"?r(n):n},Pj=e=>e!=null&&typeof e=="function",QZ=(e,t)=>{var r=mr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},eQ=(e,t,r)=>{var{position:n,viewBox:a,offset:i,className:s}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:p,clockWise:x}=a,m=(u+d)/2,y=QZ(f,p),j=y>=0?1:-1,b,g;n==="insideStart"?(b=f+j*i,g=x):n==="insideEnd"?(b=p-j*i,g=!x):n==="end"&&(b=p+j*i,g=x),g=y<=0?g:!g;var v=Zt(l,c,m,b),w=Zt(l,c,m,b+(g?1:-1)*359),C="M".concat(v.x,",").concat(v.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(g?0:1,`,
    `).concat(w.x,",").concat(w.y),k=vt(e.id)?zs("recharts-radial-line-"):e.id;return h.createElement("text",ia({},r,{dominantBaseline:"central",className:at("recharts-radial-bar-label",s)}),h.createElement("defs",null,h.createElement("path",{id:k,d:C})),h.createElement("textPath",{xlinkHref:"#".concat(k)},t))},tQ=e=>{var{viewBox:t,offset:r,position:n}=e,{cx:a,cy:i,innerRadius:s,outerRadius:l,startAngle:c,endAngle:u}=t,d=(c+u)/2;if(n==="outside"){var{x:f,y:p}=Zt(a,i,l+r,d);return{x:f,y:p,textAnchor:f>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(s+l)/2,{x:m,y}=Zt(a,i,x,d);return{x:m,y,textAnchor:"middle",verticalAnchor:"middle"}},rQ=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,{x:i,y:s,width:l,height:c}=t,u=c>=0?1:-1,d=u*n,f=u>0?"end":"start",p=u>0?"start":"end",x=l>=0?1:-1,m=x*n,y=x>0?"end":"start",j=x>0?"start":"end";if(a==="top"){var b={x:i+l/2,y:s-u*n,textAnchor:"middle",verticalAnchor:f};return Xt(Xt({},b),r?{height:Math.max(s-r.y,0),width:l}:{})}if(a==="bottom"){var g={x:i+l/2,y:s+c+d,textAnchor:"middle",verticalAnchor:p};return Xt(Xt({},g),r?{height:Math.max(r.y+r.height-(s+c),0),width:l}:{})}if(a==="left"){var v={x:i-m,y:s+c/2,textAnchor:y,verticalAnchor:"middle"};return Xt(Xt({},v),r?{width:Math.max(v.x-r.x,0),height:c}:{})}if(a==="right"){var w={x:i+l+m,y:s+c/2,textAnchor:j,verticalAnchor:"middle"};return Xt(Xt({},w),r?{width:Math.max(r.x+r.width-w.x,0),height:c}:{})}var C=r?{width:l,height:c}:{};return a==="insideLeft"?Xt({x:i+m,y:s+c/2,textAnchor:j,verticalAnchor:"middle"},C):a==="insideRight"?Xt({x:i+l-m,y:s+c/2,textAnchor:y,verticalAnchor:"middle"},C):a==="insideTop"?Xt({x:i+l/2,y:s+d,textAnchor:"middle",verticalAnchor:p},C):a==="insideBottom"?Xt({x:i+l/2,y:s+c-d,textAnchor:"middle",verticalAnchor:f},C):a==="insideTopLeft"?Xt({x:i+m,y:s+d,textAnchor:j,verticalAnchor:p},C):a==="insideTopRight"?Xt({x:i+l-m,y:s+d,textAnchor:y,verticalAnchor:p},C):a==="insideBottomLeft"?Xt({x:i+m,y:s+c-d,textAnchor:j,verticalAnchor:f},C):a==="insideBottomRight"?Xt({x:i+l-m,y:s+c-d,textAnchor:y,verticalAnchor:f},C):a&&typeof a=="object"&&(Pe(a.x)||gs(a.x))&&(Pe(a.y)||gs(a.y))?Xt({x:i+Hr(a.x,l),y:s+Hr(a.y,c),textAnchor:"end",verticalAnchor:"end"},C):Xt({x:i+l/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},C)},nQ=e=>"cx"in e&&Pe(e.cx);function vn(e){var{offset:t=5}=e,r=J_(e,GZ),n=Xt({offset:t},r),{viewBox:a,position:i,value:s,children:l,content:c,className:u="",textBreakAll:d,labelRef:f}=n,p=v1(),x=a||p;if(!x||vt(s)&&vt(l)&&!h.isValidElement(c)&&typeof c!="function")return null;if(h.isValidElement(c)){var{labelRef:m}=n,y=J_(n,VZ);return h.cloneElement(c,y)}var j;if(typeof c=="function"){if(j=h.createElement(c,n),h.isValidElement(j))return j}else j=ZZ(n);var b=nQ(x),g=rt(n,!0);if(b&&(i==="insideStart"||i==="insideEnd"||i==="end"))return eQ(n,j,g);var v=b?tQ(n):rQ(n,x);return h.createElement(bg,ia({ref:f,className:at("recharts-label",u)},g,v,{breakAll:d}),j)}vn.displayName="Label";var uD=e=>{var{cx:t,cy:r,angle:n,startAngle:a,endAngle:i,r:s,radius:l,innerRadius:c,outerRadius:u,x:d,y:f,top:p,left:x,width:m,height:y,clockWise:j,labelViewBox:b}=e;if(b)return b;if(Pe(m)&&Pe(y)){if(Pe(d)&&Pe(f))return{x:d,y:f,width:m,height:y};if(Pe(p)&&Pe(x))return{x:p,y:x,width:m,height:y}}if(Pe(d)&&Pe(f))return{x:d,y:f,width:0,height:0};if(Pe(t)&&Pe(r))return{cx:t,cy:r,startAngle:a||n||0,endAngle:i||n||0,innerRadius:c||0,outerRadius:u||l||s||0,clockWise:j};if(e.viewBox)return e.viewBox},oQ=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?h.createElement(vn,ia({key:"label-implicit"},n)):Bo(e)?h.createElement(vn,ia({key:"label-implicit",value:e},n)):h.isValidElement(e)?e.type===vn?h.cloneElement(e,Xt({key:"label-implicit"},n)):h.createElement(vn,ia({key:"label-implicit",content:e},n)):Pj(e)?h.createElement(vn,ia({key:"label-implicit",content:e},n)):e&&typeof e=="object"?h.createElement(vn,ia({},e,{key:"label-implicit"},n)):null},aQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:a,labelRef:i}=t,s=uD(t),l=Ku(a,vn).map((u,d)=>h.cloneElement(u,{viewBox:r||s,key:"label-".concat(d)}));if(!n)return l;var c=oQ(t.label,r||s,i);return[c,...l]};vn.parseViewBox=uD;vn.renderCallByParent=aQ;var fD={},hD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(hD);var pD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(pD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hD,r=pD,n=Wm;function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(fD);var iQ=fD.last;const sQ=no(iQ);var lQ=["valueAccessor"],cQ=["data","dataKey","clockWise","id","textBreakAll"];function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(null,arguments)}function Q_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q_(Object(r),!0).forEach(function(n){dQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dQ(e,t,r){return(t=uQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uQ(e){var t=fQ(e,"string");return typeof t=="symbol"?t:t+""}function fQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tA(e,t){if(e==null)return{};var r,n,a=hQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pQ=e=>Array.isArray(e.value)?sQ(e.value):e.value;function _i(e){var{valueAccessor:t=pQ}=e,r=tA(e,lQ),{data:n,dataKey:a,clockWise:i,id:s,textBreakAll:l}=r,c=tA(r,cQ);return!n||!n.length?null:h.createElement(xr,{className:"recharts-label-list"},n.map((u,d)=>{var f=vt(a)?t(u,d):kt(u&&u.payload,a),p=vt(s)?{}:{id:"".concat(s,"-").concat(d)};return h.createElement(vn,Rp({},rt(u,!0),c,p,{parentViewBox:u.parentViewBox,value:f,textBreakAll:l,viewBox:vn.parseViewBox(vt(i)?u:eA(eA({},u),{},{clockWise:i})),key:"label-".concat(d),index:d}))}))}_i.displayName="LabelList";function mQ(e,t){return e?e===!0?h.createElement(_i,{key:"labelList-implicit",data:t}):h.isValidElement(e)||Pj(e)?h.createElement(_i,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?h.createElement(_i,Rp({data:t},e,{key:"labelList-implicit"})):null:null}function gQ(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,a=Ku(n,_i).map((s,l)=>h.cloneElement(s,{data:t,key:"labelList-".concat(l)}));if(!r)return a;var i=mQ(e.label,t);return[i,...a]}_i.renderCallByParent=gQ;function fb(){return fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fb.apply(null,arguments)}var mD=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=at("recharts-dot",a);return t===+t&&r===+r&&n===+n?h.createElement("circle",fb({},rt(e,!1),V0(e),{className:i,cx:t,cy:r,r:n})):null},gD=e=>e.graphicalItems.polarItems,xQ=le([Vt,Zu],oj),Mj=le([gD,Ht,xQ],aj),vQ=le([Mj],ij),Oj=le([vQ,V1],sj),yQ=le([Oj,Ht,Mj],lj),bQ=le([Oj,Ht,Mj],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=kt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:kt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),rA=()=>{},jQ=le([Ht,y3,rA,bQ,rA],uj),xD=le([Ht,ut,Oj,yQ,Ju,Vt,jQ],fj),wQ=le([xD,Ht,Dc],mj);le([Ht,xD,wQ,Vt],xj);var SQ={radiusAxis:{},angleAxis:{}},vD=oo({name:"polarAxis",initialState:SQ,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Qse,removeRadiusAxis:ele,addAngleAxis:tle,removeAngleAxis:rle}=vD.actions,kQ=vD.reducer;function nA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nA(Object(r),!0).forEach(function(n){CQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CQ(e,t,r){return(t=_Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Q(e){var t=AQ(e,"string");return typeof t=="symbol"?t:t+""}function AQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tj=(e,t)=>t,EQ=[],Lj=(e,t,r)=>(r==null?void 0:r.length)===0?EQ:r,yD=le([V1,Tj,Lj],(e,t,r)=>{var{chartData:n}=e,a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>oA(oA({},t.presentationProps),i.props))),a!=null)return a}),NQ=le([yD,Tj,Lj],(e,t,r)=>{if(e!=null)return e.map((n,a)=>{var i,s=kt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Pc(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),PQ=le([gD,Tj],(e,t)=>{if(e.some(r=>r.type==="pie"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),MQ=le([yD,PQ,Lj,lr],(e,t,r,n)=>{if(!(t==null||e==null))return bee({offset:n,pieSettings:t,displayedData:e,cells:r})}),OQ={countOfBars:0,cartesianItems:[],polarItems:[]},bD=oo({name:"graphicalItems",initialState:OQ,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=pa(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=pa(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=pa(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addBar:TQ,removeBar:LQ,addCartesianGraphicalItem:DQ,replaceCartesianGraphicalItem:IQ,removeCartesianGraphicalItem:$Q,addPolarGraphicalItem:RQ,removePolarGraphicalItem:FQ}=bD.actions,zQ=bD.reducer;function aA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aA(Object(r),!0).forEach(function(n){BQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BQ(e,t,r){return(t=UQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UQ(e){var t=WQ(e,"string");return typeof t=="symbol"?t:t+""}function WQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qQ(e){var t=Nt(),r=h.useRef(null);return h.useEffect(()=>{var n=iA(iA({},e),{},{stackId:DT(e.stackId)});r.current===null?t(DQ(n)):r.current!==n&&t(IQ({prev:r.current,next:n})),r.current=n},[t,e]),h.useEffect(()=>()=>{r.current&&(t($Q(r.current)),r.current=null)},[t]),null}function KQ(e){var t=Nt();return h.useEffect(()=>(t(RQ(e)),()=>{t(FQ(e))}),[t,e]),null}var jD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(jD);var GQ=jD.isPlainObject;const VQ=no(GQ);function Fp(){return Fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fp.apply(null,arguments)}var sA=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},HQ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XQ=e=>{var t=ao(e,HQ),r=h.useRef(),[n,a]=h.useState(-1);h.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var j=r.current.getTotalLength();j&&a(j)}catch{}},[]);var{x:i,y:s,upperWidth:l,lowerWidth:c,height:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:x,isUpdateAnimationActive:m}=t;if(i!==+i||s!==+s||l!==+l||c!==+c||u!==+u||l===0&&c===0||u===0)return null;var y=at("recharts-trapezoid",d);return m?h.createElement(Ti,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:u,x:i,y:s},to:{upperWidth:l,lowerWidth:c,height:u,x:i,y:s},duration:p,animationEasing:f,isActive:m},j=>{var{upperWidth:b,lowerWidth:g,height:v,x:w,y:C}=j;return h.createElement(Ti,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:p,easing:f},h.createElement("path",Fp({},rt(t,!0),{className:y,d:sA(w,C,b,g,v),ref:r})))}):h.createElement("g",null,h.createElement("path",Fp({},rt(t,!0),{className:y,d:sA(i,s,l,c,u)})))},YQ=["option","shapeType","propTransformer","activeClassName","isActive"];function JQ(e,t){if(e==null)return{};var r,n,a=ZQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function lA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lA(Object(r),!0).forEach(function(n){QQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QQ(e,t,r){return(t=eee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eee(e){var t=tee(e,"string");return typeof t=="symbol"?t:t+""}function tee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ree(e,t){return zp(zp({},t),e)}function nee(e,t){return e==="symbols"}function cA(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return h.createElement(ZT,r);case"trapezoid":return h.createElement(XQ,r);case"sector":return h.createElement(tL,r);case"symbols":if(nee(t))return h.createElement(Z0,r);break;default:return null}}function oee(e){return h.isValidElement(e)?e.props:e}function wD(e){var{option:t,shapeType:r,propTransformer:n=ree,activeClassName:a="recharts-active-shape",isActive:i}=e,s=JQ(e,YQ),l;if(h.isValidElement(t))l=h.cloneElement(t,zp(zp({},s),oee(t)));else if(typeof t=="function")l=t(s);else if(VQ(t)&&typeof t!="boolean"){var c=n(t,s);l=h.createElement(cA,{shapeType:r,elementProps:c})}else{var u=s;l=h.createElement(cA,{shapeType:r,elementProps:u})}return i?h.createElement(xr,{className:a},l):l}var Dj=(e,t)=>{var r=Nt();return(n,a)=>i=>{e==null||e(n,a,i),r(D3({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Ij=e=>{var t=Nt();return(r,n)=>a=>{e==null||e(r,n,a),t(eJ())}},$j=(e,t)=>{var r=Nt();return(n,a)=>i=>{e==null||e(n,a,i),r(tJ({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Rj(e){var{fn:t,args:r}=e,n=Nt(),a=Zr();return h.useEffect(()=>{if(!a){var i=t(r);return n(JY(i)),()=>{n(ZY(i))}}},[t,r,n,a]),null}var SD=()=>{};function kD(e){var{legendPayload:t}=e,r=Nt(),n=Zr();return h.useEffect(()=>n?SD:(r(UT(t)),()=>{r(WT(t))}),[r,n,t]),null}function aee(e){var{legendPayload:t}=e,r=Nt(),n=De(ut);return h.useEffect(()=>n!=="centric"&&n!=="radial"?SD:(r(UT(t)),()=>{r(WT(t))}),[r,n,t]),null}function Fj(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=h.useRef(zs(t)),n=h.useRef(e);return n.current!==e&&(r.current=zs(t),n.current=e),r.current}var iee=["onMouseEnter","onClick","onMouseLeave"];function see(e,t){if(e==null)return{};var r,n,a=lee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dA(Object(r),!0).forEach(function(n){jg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jg(e,t,r){return(t=cee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cee(e){var t=dee(e,"string");return typeof t=="symbol"?t:t+""}function dee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qs(){return qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qs.apply(null,arguments)}function uee(e){var t=h.useMemo(()=>rt(e,!1),[e]),r=h.useMemo(()=>Ku(e.children,Gi),[e.children]),n=h.useMemo(()=>({name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,minAngle:e.minAngle,paddingAngle:e.paddingAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,legendType:e.legendType,fill:e.fill,presentationProps:t}),[e.cornerRadius,e.cx,e.cy,e.data,e.dataKey,e.endAngle,e.innerRadius,e.minAngle,e.name,e.nameKey,e.outerRadius,e.paddingAngle,e.startAngle,e.tooltipType,e.legendType,e.fill,t]),a=De(i=>NQ(i,n,r));return h.createElement(aee,{legendPayload:a})}function fee(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:n==null?void 0:n.map(d=>d.tooltipPayload),positions:n==null?void 0:n.map(d=>d.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Pc(l,t),hide:c,type:u,color:s,unit:""}}}var hee=(e,t)=>e>t?"start":e<t?"end":"middle",pee=(e,t,r)=>typeof t=="function"?t(e):Hr(t,r,r*.8),mee=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=OT(i,s),c=a+Hr(e.cx,i,i/2),u=n+Hr(e.cy,s,s/2),d=Hr(e.innerRadius,l,0),f=pee(r,e.outerRadius,l),p=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:p}},gee=(e,t)=>{var r=mr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},xee=(e,t)=>{if(h.isValidElement(e))return h.cloneElement(e,t);if(typeof e=="function")return e(t);var r=at("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return h.createElement(w1,qs({},t,{type:"linear",className:r}))},vee=(e,t,r)=>{if(h.isValidElement(e))return h.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),h.isValidElement(n)))return n;var a=at("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return h.createElement(bg,qs({},t,{alignmentBaseline:"middle",className:a}),n)};function yee(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=rt(r,!1),c=rt(a,!1),u=rt(i,!1),d=typeof a=="object"&&"offsetRadius"in a&&a.offsetRadius||20,f=t.map((p,x)=>{var m=(p.startAngle+p.endAngle)/2,y=Zt(p.cx,p.cy,p.outerRadius+d,m),j=Ut(Ut(Ut(Ut({},l),p),{},{stroke:"none"},c),{},{index:x,textAnchor:hee(y.x,p.cx)},y),b=Ut(Ut(Ut(Ut({},l),p),{},{fill:"none",stroke:p.fill},u),{},{index:x,points:[Zt(p.cx,p.cy,p.outerRadius,m),y],key:"line"});return h.createElement(xr,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(x)},i&&xee(i,b),vee(a,j,kt(p,s)))});return h.createElement(xr,{className:"recharts-pie-labels"},f)}function CD(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,showLabels:i}=e,s=De(Di),{onMouseEnter:l,onClick:c,onMouseLeave:u}=a,d=see(a,iee),f=Dj(l,a.dataKey),p=Ij(u),x=$j(c,a.dataKey);return t==null?null:h.createElement(h.Fragment,null,t.map((m,y)=>{if((m==null?void 0:m.startAngle)===0&&(m==null?void 0:m.endAngle)===0&&t.length!==1)return null;var j=r&&String(y)===s,b=s?n:null,g=j?r:b,v=Ut(Ut({},m),{},{stroke:m.stroke,tabIndex:-1,[$T]:y,[RT]:a.dataKey});return h.createElement(xr,qs({tabIndex:-1,className:"recharts-pie-sector"},qu(d,m,y),{onMouseEnter:f(m,y),onMouseLeave:p(m,y),onClick:x(m,y),key:"sector-".concat(m==null?void 0:m.startAngle,"-").concat(m==null?void 0:m.endAngle,"-").concat(m.midAngle,"-").concat(y)}),h.createElement(wD,qs({option:g,isActive:j,shapeType:"sector"},v)))}),h.createElement(yee,{sectors:t,props:a,showLabels:i}))}function bee(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,p=Math.abs(r.minAngle),x=gee(l,c),m=Math.abs(x),y=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,j=n.filter(k=>kt(k,u,0)!==0).length,b=(m>=360?j:j-1)*y,g=m-j*p-b,v=n.reduce((k,S)=>{var _=kt(S,u,0);return k+(Pe(_)?_:0)},0),w;if(v>0){var C;w=n.map((k,S)=>{var _=kt(k,u,0),A=kt(k,d,S),E=mee(r,i,k),N=(Pe(_)?_:0)/v,$,z=Ut(Ut({},k),a&&a[S]&&a[S].props);S?$=C.endAngle+mr(x)*y*(_!==0?1:0):$=l;var T=$+mr(x)*((_!==0?p:0)+N*g),I=($+T)/2,L=(E.innerRadius+E.outerRadius)/2,D=[{name:A,value:_,payload:z,dataKey:u,type:f}],O=Zt(E.cx,E.cy,L,I);return C=Ut(Ut(Ut(Ut({},r.presentationProps),{},{percent:N,cornerRadius:s,name:A,tooltipPayload:D,midAngle:I,middleRadius:L,tooltipPosition:O},z),E),{},{value:kt(k,u),startAngle:$,endAngle:T,payload:z,paddingAngle:mr(x)*y}),C})}return w}function jee(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:f}=t,p=Fj(t,"recharts-pie-"),x=r.current,[m,y]=h.useState(!0),j=h.useCallback(()=>{typeof f=="function"&&f(),y(!1)},[f]),b=h.useCallback(()=>{typeof d=="function"&&d(),y(!0)},[d]);return h.createElement(Ti,{begin:i,duration:s,isActive:a,easing:l,from:{t:0},to:{t:1},onAnimationStart:b,onAnimationEnd:j,key:p},g=>{var{t:v}=g,w=[],C=n&&n[0],k=C.startAngle;return n.forEach((S,_)=>{var A=x&&x[_],E=_>0?Oi(S,"paddingAngle",0):0;if(A){var N=xn(A.endAngle-A.startAngle,S.endAngle-S.startAngle),$=Ut(Ut({},S),{},{startAngle:k+E,endAngle:k+N(v)+E});w.push($),k=$.endAngle}else{var{endAngle:z,startAngle:T}=S,I=xn(0,z-T),L=I(v),D=Ut(Ut({},S),{},{startAngle:k+E,endAngle:k+L+E});w.push(D),k=D.endAngle}}),r.current=w,h.createElement(xr,null,h.createElement(CD,{sectors:w,activeShape:c,inactiveShape:u,allOtherPieProps:t,showLabels:!m}))})}function wee(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:a}=e,i=h.useRef(null),s=i.current;return r&&t&&t.length&&(!s||s!==t)?h.createElement(jee,{props:e,previousSectorsRef:i}):h.createElement(CD,{sectors:t,activeShape:n,inactiveShape:a,allOtherPieProps:e,showLabels:!0})}function See(e){var{hide:t,className:r,rootTabIndex:n}=e,a=at("recharts-pie",r);return t?null:h.createElement(xr,{tabIndex:n,className:a},h.createElement(wee,e))}var _D={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Zs.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function kee(e){var t=ao(e,_D),r=h.useMemo(()=>Ku(e.children,Gi),[e.children]),n=rt(t,!1),a=h.useMemo(()=>({name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,minAngle:t.minAngle,paddingAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,legendType:t.legendType,fill:t.fill,presentationProps:n}),[t.cornerRadius,t.cx,t.cy,t.data,t.dataKey,t.endAngle,t.innerRadius,t.minAngle,t.name,t.nameKey,t.outerRadius,t.paddingAngle,t.startAngle,t.tooltipType,t.legendType,t.fill,n]),i=De(s=>MQ(s,a,r));return h.createElement(h.Fragment,null,h.createElement(Rj,{fn:fee,args:Ut(Ut({},t),{},{sectors:i})}),h.createElement(See,qs({},t,{sectors:i})))}class zj extends h.PureComponent{constructor(){super(...arguments),jg(this,"id",zs("recharts-pie-"))}render(){return h.createElement(h.Fragment,null,h.createElement(KQ,{data:this.props.data,dataKey:this.props.dataKey,hide:this.props.hide,angleAxisId:0,radiusAxisId:0,stackId:void 0,barSize:void 0,type:"pie"}),h.createElement(uee,this.props),h.createElement(kee,this.props),this.props.children)}}jg(zj,"displayName","Pie");jg(zj,"defaultProps",_D);var Cee=le([lr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),_ee=le([Cee,Ta,La],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Aee=e=>{var t=Zr();return De(r=>Wo(r,"xAxis",e,t))},Eee=e=>{var t=Zr();return De(r=>Wo(r,"yAxis",e,t))},Bj=()=>De(_ee),Nee=()=>De(FJ);function uA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uA(Object(r),!0).forEach(function(n){Pee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pee(e,t,r){return(t=Mee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mee(e){var t=Oee(e,"string");return typeof t=="symbol"?t:t+""}function Oee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tee=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=fA(fA({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},rt(a,!1)),V0(a)),l;return h.isValidElement(a)?l=h.cloneElement(a,s):typeof a=="function"?l=a(s):l=h.createElement(mD,s),h.createElement(xr,{className:"recharts-active-dot"},l)};function Lee(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=De(Di),s=Nee();if(t==null||s==null)return null;var l=t.find(c=>s.includes(c.payload));return vt(l)?null:Tee({point:l,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var Dee=()=>{var e=Nt();return h.useEffect(()=>(e(TQ()),()=>{e(LQ())})),null},Iee=["children"];function $ee(e,t){if(e==null)return{};var r,n,a=Ree(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ree(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hA=()=>{},AD=h.createContext({addErrorBar:hA,removeErrorBar:hA}),Fee={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},ED=h.createContext(Fee);function ND(e){var{children:t}=e,r=$ee(e,Iee);return h.createElement(ED.Provider,{value:r},t)}var zee=()=>h.useContext(ED),PD=e=>{var{children:t,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,data:s,stackId:l,hide:c,type:u,barSize:d}=e,[f,p]=h.useState([]),x=h.useCallback(j=>{p(b=>[...b,j])},[p]),m=h.useCallback(j=>{p(b=>b.filter(g=>g!==j))},[p]),y=Zr();return h.createElement(AD.Provider,{value:{addErrorBar:x,removeErrorBar:m}},h.createElement(qQ,{type:u,data:s,xAxisId:r,yAxisId:n,zAxisId:a,dataKey:i,errorBars:f,stackId:l,hide:c,barSize:d,isPanorama:y}),t)};function Bee(e){var{addErrorBar:t,removeErrorBar:r}=h.useContext(AD);return h.useEffect(()=>(t(e),()=>{r(e)}),[t,r,e]),null}var Uee=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function MD(e,t,r){return(t=Wee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wee(e){var t=qee(e,"string");return typeof t=="symbol"?t:t+""}function qee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(null,arguments)}function Kee(e,t){if(e==null)return{};var r,n,a=Gee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Vee(e){var{direction:t,width:r,dataKey:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l}=e,c=Kee(e,Uee),u=rt(c,!1),{data:d,dataPointFormatter:f,xAxisId:p,yAxisId:x,errorBarOffset:m}=zee(),y=Aee(p),j=Eee(x);if((y==null?void 0:y.scale)==null||(j==null?void 0:j.scale)==null||d==null||t==="x"&&y.type!=="number")return null;var b=d.map(g=>{var{x:v,y:w,value:C,errorVal:k}=f(g,n,t);if(!k)return null;var S=[],_,A;if(Array.isArray(k)?[_,A]=k:_=A=k,t==="x"){var{scale:E}=y,N=w+m,$=N+r,z=N-r,T=E(C-_),I=E(C+A);S.push({x1:I,y1:$,x2:I,y2:z}),S.push({x1:T,y1:N,x2:I,y2:N}),S.push({x1:T,y1:$,x2:T,y2:z})}else if(t==="y"){var{scale:L}=j,D=v+m,O=D-r,F=D+r,q=L(C-_),te=L(C+A);S.push({x1:O,y1:te,x2:F,y2:te}),S.push({x1:D,y1:q,x2:D,y2:te}),S.push({x1:O,y1:q,x2:F,y2:q})}var H="".concat(v+m,"px ").concat(w+m,"px");return h.createElement(xr,ku({className:"recharts-errorBar",key:"bar-".concat(S.map(B=>"".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2)))},u),S.map(B=>{var K=a?{transformOrigin:"".concat(B.x1-5,"px")}:void 0;return h.createElement(Ti,{from:{transform:"scaleY(0)",transformOrigin:H},to:{transform:"scaleY(1)",transformOrigin:H},begin:i,easing:l,isActive:a,duration:s,key:"line-".concat(B.x1,"-").concat(B.x2,"-").concat(B.y1,"-").concat(B.y2),style:{transformOrigin:H}},h.createElement("line",ku({},B,{style:K})))}))});return h.createElement(xr,{className:"recharts-errorBars"},b)}var OD=h.createContext(void 0);function Hee(e){var t=h.useContext(OD);return e??t??"x"}function TD(e){var{direction:t,children:r}=e;return h.createElement(OD.Provider,{value:t},r)}var LD={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function Xee(e){var t=Hee(e.direction),{width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:s}=ao(e,LD);return h.createElement(h.Fragment,null,h.createElement(Bee,{dataKey:e.dataKey,direction:t}),h.createElement(Vee,ku({},e,{direction:t,width:r,isAnimationActive:n,animationBegin:a,animationDuration:i,animationEasing:s})))}class DD extends h.Component{render(){return h.createElement(Xee,this.props)}}MD(DD,"defaultProps",LD);MD(DD,"displayName","ErrorBar");var Yee="Invariant failed";function Jee(e,t){throw new Error(Yee)}var Zee=["x","y"];function hb(){return hb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hb.apply(null,arguments)}function pA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pA(Object(r),!0).forEach(function(n){Qee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qee(e,t,r){return(t=ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ete(e){var t=tte(e,"string");return typeof t=="symbol"?t:t+""}function tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rte(e,t){if(e==null)return{};var r,n,a=nte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ote(e,t){var{x:r,y:n}=e,a=rte(e,Zee),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),p=parseInt(f,10);return dd(dd(dd(dd(dd({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:d,width:p,name:t.name,radius:t.radius})}function ID(e){return h.createElement(wD,hb({shapeType:"rectangle",propTransformer:ote,activeClassName:"recharts-active-bar"},e))}var ate=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Pe(t))return t;var i=Pe(n)||vt(n);return i?t(n,a):(i||Jee(),r)}};function Uj(e,t){var r,n,a=De(u=>Ia(u,e)),i=De(u=>Ki(u,t)),s=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:fn.allowDataOverflow,l=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:hn.allowDataOverflow,c=s||l;return{needClip:c,needClipX:s,needClipY:l}}function $D(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Bj(),{needClipX:i,needClipY:s,needClip:l}=Uj(t,r);if(!l)return null;var{x:c,y:u,width:d,height:f}=a;return h.createElement("clipPath",{id:"clipPath-".concat(n)},h.createElement("rect",{x:i?c:c-d/2,y:s?u:u-f/2,width:i?d:d*2,height:s?f:f*2}))}var ite=["onMouseEnter","onMouseLeave","onClick"],ste=["value","background","tooltipPosition"],lte=["onMouseEnter","onClick","onMouseLeave"];function Cu(){return Cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cu.apply(null,arguments)}function mA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mA(Object(r),!0).forEach(function(n){wg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wg(e,t,r){return(t=cte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cte(e){var t=dte(e,"string");return typeof t=="symbol"?t:t+""}function dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pb(e,t){if(e==null)return{};var r,n,a=ute(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ute(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fte=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Pc(r,t),payload:e}]};function hte(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Pc(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function pte(e){var t=De(Di),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:c}=i,u=pb(i,ite),d=Dj(s,n),f=Ij(l),p=$j(c,n);if(!a||r==null)return null;var x=rt(a,!1);return h.createElement(h.Fragment,null,r.map((m,y)=>{var{value:j,background:b,tooltipPosition:g}=m,v=pb(m,ste);if(!b)return null;var w=d(m,y),C=f(m,y),k=p(m,y),S=$r($r($r($r($r({option:a,isActive:String(y)===t},v),{},{fill:"#eee"},b),x),qu(u,m,y)),{},{onMouseEnter:w,onMouseLeave:C,onClick:k,dataKey:n,index:y,className:"recharts-bar-background-rectangle"});return h.createElement(ID,Cu({key:"background-bar-".concat(y)},S))}))}function RD(e){var{data:t,props:r,showLabels:n}=e,a=rt(r,!1),{shape:i,dataKey:s,activeBar:l}=r,c=De(Di),u=De(H3),{onMouseEnter:d,onClick:f,onMouseLeave:p}=r,x=pb(r,lte),m=Dj(d,s),y=Ij(p),j=$j(f,s);return t?h.createElement(h.Fragment,null,t.map((b,g)=>{var v=l&&String(g)===c&&(u==null||s===u),w=v?l:i,C=$r($r($r({},a),b),{},{isActive:v,option:w,index:g,dataKey:s});return h.createElement(xr,Cu({className:"recharts-bar-rectangle"},qu(x,b,g),{onMouseEnter:m(b,g),onMouseLeave:y(b,g),onClick:j(b,g),key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(g)}),h.createElement(ID,C))}),n&&_i.renderCallByParent(r,t)):null}function mte(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,p=Fj(t,"recharts-bar-"),[x,m]=h.useState(!1),y=h.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),j=h.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return h.createElement(Ti,{begin:s,duration:l,isActive:i,easing:c,from:{t:0},to:{t:1},onAnimationEnd:y,onAnimationStart:j,key:p},b=>{var{t:g}=b,v=g===1?n:n.map((w,C)=>{var k=f&&f[C];if(k){var S=xn(k.x,w.x),_=xn(k.y,w.y),A=xn(k.width,w.width),E=xn(k.height,w.height);return $r($r({},w),{},{x:S(g),y:_(g),width:A(g),height:E(g)})}if(a==="horizontal"){var N=xn(0,w.height),$=N(g);return $r($r({},w),{},{y:w.y+w.height-$,height:$})}var z=xn(0,w.width),T=z(g);return $r($r({},w),{},{width:T})});return g>0&&(r.current=v),h.createElement(xr,null,h.createElement(RD,{props:t,data:v,showLabels:!x}))})}function gte(e){var{data:t,isAnimationActive:r}=e,n=h.useRef(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?h.createElement(mte,{previousRectanglesRef:n,props:e}):h.createElement(RD,{props:e,data:t,showLabels:!0})}var FD=0,xte=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:kt(e,t)}};class vte extends h.PureComponent{constructor(){super(...arguments),wg(this,"id",zs("recharts-bar-"))}render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:c,id:u,layout:d}=this.props;if(t)return null;var f=at("recharts-bar",a),p=vt(u)?this.id:u;return h.createElement(xr,{className:f},l&&h.createElement("defs",null,h.createElement($D,{clipPathId:p,xAxisId:i,yAxisId:s})),h.createElement(xr,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(p,")"):null},h.createElement(pte,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),h.createElement(gte,this.props)),h.createElement(TD,{direction:d==="horizontal"?"y":"x"},this.props.children))}}var zD={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Zs.isSsr,legendType:"rect",minPointSize:FD,xAxisId:0,yAxisId:0};function yte(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=ao(e,zD),{needClip:f}=Uj(t,r),p=ng(),x=Zr(),m=h.useMemo(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:i,stackId:DT(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,i,e.stackId]),y=Ku(e.children,Gi),j=De(v=>Vte(v,t,r,x,m,y));if(p!=="vertical"&&p!=="horizontal")return null;var b,g=j==null?void 0:j[0];return g==null||g.height==null||g.width==null?b=0:b=p==="vertical"?g.height/2:g.width/2,h.createElement(ND,{xAxisId:t,yAxisId:r,data:j,dataPointFormatter:xte,errorBarOffset:b},h.createElement(vte,Cu({},e,{layout:p,needClip:f,data:j,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function bte(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:p,cells:x}=e,m=t==="horizontal"?l:s,y=d?m.scale.domain():null,j=jK({numericAxis:m});return f.map((b,g)=>{var v,w,C,k,S,_;d?v=gK(d[g],y):(v=kt(b,r),Array.isArray(v)||(v=[j,v]));var A=ate(n,FD)(v[1],g);if(t==="horizontal"){var E,[N,$]=[l.scale(v[0]),l.scale(v[1])];w=yC({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:b,index:g}),C=(E=$??N)!==null&&E!==void 0?E:void 0,k=a.size;var z=N-$;if(S=An(z)?0:z,_={x:w,y:p.top,width:k,height:p.height},Math.abs(A)>0&&Math.abs(S)<Math.abs(A)){var T=mr(S||A)*(Math.abs(A)-Math.abs(S));C-=T,S+=T}}else{var[I,L]=[s.scale(v[0]),s.scale(v[1])];if(w=I,C=yC({axis:l,ticks:u,bandSize:i,offset:a.offset,entry:b,index:g}),k=L-I,S=a.size,_={x:p.left,y:C,width:p.width,height:S},Math.abs(A)>0&&Math.abs(k)<Math.abs(A)){var D=mr(k||A)*(Math.abs(A)-Math.abs(k));k+=D}}var O=$r($r({},b),{},{x:w,y:C,width:k,height:S,value:d?v:v[1],payload:b,background:_,tooltipPosition:{x:w+k/2,y:C+S/2}},x&&x[g]&&x[g].props);return O})}class Ea extends h.PureComponent{render(){return h.createElement(PD,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},h.createElement(Dee,null),h.createElement(kD,{legendPayload:fte(this.props)}),h.createElement(Rj,{fn:hte,args:this.props}),h.createElement(yte,this.props))}}wg(Ea,"displayName","Bar");wg(Ea,"defaultProps",zD);function gA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gA(Object(r),!0).forEach(function(n){jte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jte(e,t,r){return(t=wte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wte(e){var t=Ste(e,"string");return typeof t=="symbol"?t:t+""}function Ste(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kte=(e,t)=>t,Cte=(e,t,r)=>r,_te=(e,t,r,n)=>n,Wj=(e,t,r,n,a)=>a,Ate=(e,t,r,n,a)=>a.maxBarSize,Ete=(e,t,r,n,a,i)=>i,xA=(e,t,r)=>{var n=r??e;if(!vt(n))return Hr(n,t,0)},Nte=le([ut,hg,kte,Cte,_te],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Pte=(e,t,r,n)=>{var a=ut(e);return a==="horizontal"?ab(e,"yAxis",r,n):ab(e,"xAxis",t,n)},Mte=(e,t,r)=>{var n=ut(e);return n==="horizontal"?N_(e,"xAxis",t):N_(e,"yAxis",r)};function Ote(e){return e.stackId!=null&&e.dataKey!=null}var Tte=(e,t,r)=>{var n={},a=e.filter(Ote),i=e.filter(u=>u.stackId==null),s=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(s).map(u=>{var[d,f]=u,p=f.map(m=>m.dataKey),x=xA(t,r,f[0].barSize);return{stackId:d,dataKeys:p,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(p=>p!=null),f=xA(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]},Lte=le([Nte,YX,Mte],Tte),Dte=(e,t,r,n,a)=>{var i,s,l=ut(e),c=e3(e),{maxBarSize:u}=a,d=vt(u)?c:u,f,p;return l==="horizontal"?(f=Wo(e,"xAxis",t,n),p=Li(e,"xAxis",t,n)):(f=Wo(e,"yAxis",r,n),p=Li(e,"yAxis",r,n)),(i=(s=gu(f,p,!0))!==null&&s!==void 0?s:d)!==null&&i!==void 0?i:0},BD=(e,t,r,n)=>{var a=ut(e),i,s;return a==="horizontal"?(i=Wo(e,"xAxis",t,n),s=Li(e,"xAxis",t,n)):(i=Wo(e,"yAxis",r,n),s=Li(e,"yAxis",r,n)),gu(i,s)};function Ite(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=Hr(e,r,0,!0),l,c=[];if(Pn(n[0].barSize)){var u=!1,d=r/i,f=n.reduce((b,g)=>b+(g.barSize||0),0);f+=(i-1)*s,f>=r&&(f-=(i-1)*s,s=0),f>=r&&d>0&&(u=!0,d*=.9,f=i*d);var p=(r-f)/2>>0,x={offset:p-s,size:0};l=n.reduce((b,g)=>{var v,w={stackId:g.stackId,dataKeys:g.dataKeys,position:{offset:x.offset+x.size+s,size:u?d:(v=g.barSize)!==null&&v!==void 0?v:0}},C=[...b,w];return x=C[C.length-1].position,C},c)}else{var m=Hr(t,r,0,!0);r-2*m-(i-1)*s<=0&&(s=0);var y=(r-2*m-(i-1)*s)/i;y>1&&(y>>=0);var j=Pn(a)?Math.min(y,a):y;l=n.reduce((b,g,v)=>[...b,{stackId:g.stackId,dataKeys:g.dataKeys,position:{offset:m+(y+s)*v+(y-j)/2,size:j}}],c)}return l}}var $te=(e,t,r,n,a,i,s)=>{var l=vt(s)?t:s,c=Ite(r,n,a!==i?a:i,e,l);return a!==i&&c!=null&&(c=c.map(u=>Yf(Yf({},u),{},{position:Yf(Yf({},u.position),{},{offset:u.position.offset-a/2})}))),c},Rte=le([Lte,e3,XX,t3,Dte,BD,Ate],$te),Fte=(e,t,r,n)=>Wo(e,"xAxis",t,n),zte=(e,t,r,n)=>Wo(e,"yAxis",r,n),Bte=(e,t,r,n)=>Li(e,"xAxis",t,n),Ute=(e,t,r,n)=>Li(e,"yAxis",r,n),Wte=le([Rte,Wj],(e,t)=>{if(e!=null){var r=e.find(n=>n.stackId===t.stackId&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),qte=(e,t)=>{if(!(!e||(t==null?void 0:t.dataKey)==null)){var{stackId:r}=t;if(r!=null){var n=e[r];if(n){var{stackedData:a}=n;if(a){var i=a.find(s=>s.key===t.dataKey);return i}}}}},Kte=le([hg,Wj],(e,t)=>{if(e.some(r=>r.type==="bar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId&&t.stackId===r.stackId))return t}),Gte=le([Pte,Wj],qte),Vte=le([lr,Fte,zte,Bte,Ute,Wte,ut,H1,BD,Gte,Kte,Ete],(e,t,r,n,a,i,s,l,c,u,d,f)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:m}=l;if(!(d==null||i==null||s!=="horizontal"&&s!=="vertical"||t==null||r==null||n==null||a==null||c==null)){var{data:y}=d,j;if(y!=null&&y.length>0?j=y:j=p==null?void 0:p.slice(x,m+1),j!=null)return bte({layout:s,barSettings:d,pos:i,bandSize:c,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,stackedData:u,displayedData:j,offset:e,cells:f})}}),UD=e=>{var{chartData:t}=e,r=Nt(),n=Zr();return h.useEffect(()=>n?()=>{}:(r(R_(t)),()=>{r(R_(void 0))}),[t,r,n]),null},vA={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},WD=oo({name:"brush",initialState:vA,reducers:{setBrushSettings(e,t){return t.payload==null?vA:t.payload}}}),{setBrushSettings:nle}=WD.actions,Hte=WD.reducer;function Xte(e,t,r){return(t=Yte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yte(e){var t=Jte(e,"string");return typeof t=="symbol"?t:t+""}function Jte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class qj{static create(t){return new qj(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}Xte(qj,"EPS",1e-4);function Zte(e){return(e%180+180)%180}var Qte=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Zte(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},ere={dots:[],areas:[],lines:[]},qD=oo({name:"referenceElements",initialState:ere,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=pa(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=pa(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=pa(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:ole,removeDot:ale,addArea:ile,removeArea:sle,addLine:lle,removeLine:cle}=qD.actions,tre=qD.reducer,rre=h.createContext(void 0),nre=e=>{var{children:t}=e,[r]=h.useState("".concat(zs("recharts"),"-clip")),n=Bj();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return h.createElement(rre.Provider,{value:r},h.createElement("defs",null,h.createElement("clipPath",{id:r},h.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function Gx(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function KD(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function ore(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Qte(n,r)}function are(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function Bp(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function ire(e,t){return KD(e,t+1)}function sre(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,c=0,u=1,d=s,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:KD(n,u)};var y=c,j,b=()=>(j===void 0&&(j=r(m,y)),j),g=m.coordinate,v=c===0||Bp(e,g,b,d,l);v||(c=0,d=s,u+=1),v&&(d=g+e*(b()/2+a),c+=u)},p;u<=i.length;)if(p=f(),p)return p.v;return[]}function yA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yA(Object(r),!0).forEach(function(n){lre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lre(e,t,r){return(t=cre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cre(e){var t=dre(e,"string");return typeof t=="symbol"?t:t+""}function dre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ure(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:c}=t,u=function(p){var x=i[p],m,y=()=>(m===void 0&&(m=r(x,p)),m);if(p===s-1){var j=e*(x.coordinate+e*y()/2-c);i[p]=x=Lr(Lr({},x),{},{tickCoord:j>0?x.coordinate-j*e:x.coordinate})}else i[p]=x=Lr(Lr({},x),{},{tickCoord:x.coordinate});var b=Bp(e,x.tickCoord,y,l,c);b&&(c=x.tickCoord-e*(y()/2+a),i[p]=Lr(Lr({},x),{},{isShow:!0}))},d=s-1;d>=0;d--)u(d);return i}function fre(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:c,end:u}=t;if(i){var d=n[l-1],f=r(d,l-1),p=e*(d.coordinate+e*f/2-u);s[l-1]=d=Lr(Lr({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate});var x=Bp(e,d.tickCoord,()=>f,c,u);x&&(u=d.tickCoord-e*(f/2+a),s[l-1]=Lr(Lr({},d),{},{isShow:!0}))}for(var m=i?l-1:l,y=function(g){var v=s[g],w,C=()=>(w===void 0&&(w=r(v,g)),w);if(g===0){var k=e*(v.coordinate-e*C()/2-c);s[g]=v=Lr(Lr({},v),{},{tickCoord:k<0?v.coordinate-k*e:v.coordinate})}else s[g]=v=Lr(Lr({},v),{},{tickCoord:v.coordinate});var S=Bp(e,v.tickCoord,C,c,u);S&&(c=v.tickCoord+e*(C()/2+a),s[g]=Lr(Lr({},v),{},{isShow:!0}))},j=0;j<m;j++)y(j);return s}function Kj(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(Pe(c)||Zs.isSsr){var p;return(p=ire(a,Pe(c)?c:0))!==null&&p!==void 0?p:[]}var x=[],m=l==="top"||l==="bottom"?"width":"height",y=d&&m==="width"?zd(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},j=(v,w)=>{var C=typeof u=="function"?u(v.value,w):v.value;return m==="width"?ore(zd(C,{fontSize:t,letterSpacing:r}),y,f):zd(C,{fontSize:t,letterSpacing:r})[m]},b=a.length>=2?mr(a[1].coordinate-a[0].coordinate):1,g=are(i,b,m);return c==="equidistantPreserveStart"?sre(b,g,j,a,s):(c==="preserveStart"||c==="preserveStartEnd"?x=fre(b,g,j,a,s,c==="preserveStartEnd"):x=ure(b,g,j,a,s),x.filter(v=>v.isShow))}var hre=["viewBox"],pre=["viewBox"];function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ml.apply(null,arguments)}function bA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bA(Object(r),!0).forEach(function(n){Gj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jA(e,t){if(e==null)return{};var r,n,a=mre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gj(e,t,r){return(t=gre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gre(e){var t=xre(e,"string");return typeof t=="symbol"?t:t+""}function xre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Vi extends h.Component{constructor(t){super(t),this.tickRefs=h.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,a=jA(t,hre),i=this.props,{viewBox:s}=i,l=jA(i,pre);return!Gx(n,s)||!Gx(a,l)||!Gx(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:a,height:i,orientation:s,tickSize:l,mirror:c,tickMargin:u}=this.props,d,f,p,x,m,y,j=c?-1:1,b=t.tickSize||l,g=Pe(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":d=f=t.coordinate,x=n+ +!c*i,p=x-j*b,y=p-j*u,m=g;break;case"left":p=x=t.coordinate,f=r+ +!c*a,d=f-j*b,m=d-j*u,y=g;break;case"right":p=x=t.coordinate,f=r+ +c*a,d=f+j*b,m=d+j*u,y=g;break;default:d=f=t.coordinate,x=n+ +c*i,p=x+j*b,y=p+j*u,m=g;break}return{line:{x1:d,y1:p,x2:f,y2:x},tick:{x:m,y}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l}=this.props,c=rr(rr(rr({},rt(this.props,!1)),rt(l,!1)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!s||i==="bottom"&&s);c=rr(rr({},c),{},{x1:t,y1:r+u*a,x2:t+n,y2:r+u*a})}else{var d=+(i==="left"&&!s||i==="right"&&s);c=rr(rr({},c),{},{x1:t+d*n,y1:r,x2:t+d*n,y2:r+a})}return h.createElement("line",Ml({},c,{className:at("recharts-cartesian-axis-line",Oi(l,"className"))}))}static renderTickItem(t,r,n){var a,i=at(r.className,"recharts-cartesian-axis-tick-value");if(h.isValidElement(t))a=h.cloneElement(t,rr(rr({},r),{},{className:i}));else if(typeof t=="function")a=t(rr(rr({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=at(s,t.className)),a=h.createElement(bg,Ml({},r,{className:s}),n)}return a}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:a,stroke:i,tick:s,tickFormatter:l,unit:c}=this.props,u=Kj(rr(rr({},this.props),{},{ticks:n}),t,r),d=this.getTickTextAnchor(),f=this.getTickVerticalAnchor(),p=rt(this.props,!1),x=rt(s,!1),m=rr(rr({},p),{},{fill:"none"},rt(a,!1)),y=u.map((j,b)=>{var{line:g,tick:v}=this.getTickLineCoord(j),w=rr(rr(rr(rr({textAnchor:d,verticalAnchor:f},p),{},{stroke:"none",fill:i},x),v),{},{index:b,payload:j,visibleTicksCount:u.length,tickFormatter:l});return h.createElement(xr,Ml({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},qu(this.props,j,b)),a&&h.createElement("line",Ml({},m,g,{className:at("recharts-cartesian-axis-tick-line",Oi(a,"className"))})),s&&Vi.renderTickItem(s,w,"".concat(typeof l=="function"?l(j.value,b):j.value).concat(c||"")))});return y.length>0?h.createElement("g",{className:"recharts-cartesian-axis-ticks"},y):null}render(){var{axisLine:t,width:r,height:n,className:a,hide:i}=this.props;if(i)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:h.createElement(xr,{className:at("recharts-cartesian-axis",a),ref:l=>{if(l){var c=l.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(c);var u=c[0];if(u){var d=window.getComputedStyle(u).fontSize,f=window.getComputedStyle(u).letterSpacing;(d!==this.state.fontSize||f!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(u).fontSize,letterSpacing:window.getComputedStyle(u).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),vn.renderCallByParent(this.props))}}Gj(Vi,"displayName","CartesianAxis");Gj(Vi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var vre=["x1","y1","x2","y2","key"],yre=["offset"],bre=["xAxisId","yAxisId"],jre=["xAxisId","yAxisId"];function wA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wA(Object(r),!0).forEach(function(n){wre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wre(e,t,r){return(t=Sre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sre(e){var t=kre(e,"string");return typeof t=="symbol"?t:t+""}function kre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bs(){return bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bs.apply(null,arguments)}function Up(e,t){if(e==null)return{};var r,n,a=Cre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Cre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _re=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return h.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function GD(e,t){var r;if(h.isValidElement(e))r=h.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:l}=t,c=Up(t,vre),u=rt(c,!1),{offset:d}=u,f=Up(u,yre);r=h.createElement("line",bs({},f,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function Are(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Up(e,bre),c=a.map((u,d)=>{var f=Rr(Rr({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return GD(n,f)});return h.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Ere(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Up(e,jre),c=a.map((u,d)=>{var f=Rr(Rr({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return GD(n,f)});return h.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Nre(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=l.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var x=!u[p+1],m=x?a+s-f:u[p+1]-f;if(m<=0)return null;var y=p%t.length;return h.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:m,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function Pre(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var x=!u[p+1],m=x?a+s-f:u[p+1]-f;if(m<=0)return null;var y=p%r.length;return h.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:m,height:l,stroke:"none",fill:r[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Mre=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return TT(Kj(Rr(Rr(Rr({},Vi.defaultProps),r),{},{ticks:LT(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},Ore=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return TT(Kj(Rr(Rr(Rr({},Vi.defaultProps),r),{},{ticks:LT(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},Tre={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function ko(e){var t=y1(),r=b1(),n=zT(),a=Rr(Rr({},ao(e,Tre)),{},{x:Pe(e.x)?e.x:n.left,y:Pe(e.y)?e.y:n.top,width:Pe(e.width)?e.width:n.width,height:Pe(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:p,verticalValues:x}=a,m=Zr(),y=De(A=>P_(A,"xAxis",i,m)),j=De(A=>P_(A,"yAxis",s,m));if(!Pe(u)||u<=0||!Pe(d)||d<=0||!Pe(l)||l!==+l||!Pe(c)||c!==+c)return null;var b=a.verticalCoordinatesGenerator||Mre,g=a.horizontalCoordinatesGenerator||Ore,{horizontalPoints:v,verticalPoints:w}=a;if((!v||!v.length)&&typeof g=="function"){var C=p&&p.length,k=g({yAxis:j?Rr(Rr({},j),{},{ticks:C?p:j.ticks}):void 0,width:t,height:r,offset:n},C?!0:f);Fd(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(v=k)}if((!w||!w.length)&&typeof b=="function"){var S=x&&x.length,_=b({xAxis:y?Rr(Rr({},y),{},{ticks:S?x:y.ticks}):void 0,width:t,height:r,offset:n},S?!0:f);Fd(Array.isArray(_),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(w=_)}return h.createElement("g",{className:"recharts-cartesian-grid"},h.createElement(_re,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),h.createElement(Nre,bs({},a,{horizontalPoints:v})),h.createElement(Pre,bs({},a,{verticalPoints:w})),h.createElement(Are,bs({},a,{offset:n,horizontalPoints:v,xAxis:y,yAxis:j})),h.createElement(Ere,bs({},a,{offset:n,verticalPoints:w,xAxis:y,yAxis:j})))}ko.displayName="CartesianGrid";var VD=(e,t,r,n)=>Wo(e,"xAxis",t,n),HD=(e,t,r,n)=>Li(e,"xAxis",t,n),XD=(e,t,r,n)=>Wo(e,"yAxis",r,n),YD=(e,t,r,n)=>Li(e,"yAxis",r,n),Lre=le([ut,VD,XD,HD,YD],(e,t,r,n,a)=>Ui(e,"xAxis")?gu(t,n,!1):gu(r,a,!1)),Dre=(e,t,r,n,a)=>a,Ire=le([hg,Dre],(e,t)=>{if(e.some(r=>r.type==="line"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),$re=le([ut,VD,XD,HD,YD,Ire,Lre,H1],(e,t,r,n,a,i,s,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:f,data:p}=i,x;if(p!=null&&p.length>0?x=p:x=c==null?void 0:c.slice(u,d+1),x!=null)return rne({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:s,displayedData:x})}}),Rre=["type","layout","connectNulls","needClip"],Fre=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function JD(e,t){if(e==null)return{};var r,n,a=zre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function SA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SA(Object(r),!0).forEach(function(n){Sg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sg(e,t,r){return(t=Bre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bre(e){var t=Ure(e,"string");return typeof t=="symbol"?t:t+""}function Ure(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gc(){return gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gc.apply(null,arguments)}var Wre=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Pc(r,t),payload:e}]};function qre(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:l,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Pc(s,t),hide:l,type:e.tooltipType,color:e.stroke,unit:c}}}var ZD=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function Kre(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var Gre=(e,t,r)=>{var n=r.reduce((f,p)=>f+p);if(!n)return ZD(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,l=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>i){l=[...r.slice(0,c),i-u];break}var d=l.length%2===0?[0,s]:[s];return[...Kre(r,a),...l,...d].map(f=>"".concat(f,"px")).join(", ")};function Vre(e,t){var r;if(h.isValidElement(e))r=h.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=at("recharts-line-dot",typeof e!="boolean"?e.className:"");r=h.createElement(mD,gc({},t,{className:n}))}return r}function Hre(e,t){return e==null?!1:t?!0:e.length===1}function Xre(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!Hre(r,a))return null;var l=yO(a),c=rt(n,!1),u=rt(a,!0),d=r.map((p,x)=>{var m=yo(yo(yo({key:"dot-".concat(x),r:3},c),u),{},{index:x,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return Vre(a,m)}),f={clipPath:s?"url(#clipPath-".concat(l?"":"dots-").concat(t,")"):null};return h.createElement(xr,gc({className:"recharts-line-dots",key:"dots"},f),d)}function mb(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i,showLabels:s}=e,{type:l,layout:c,connectNulls:u,needClip:d}=i,f=JD(i,Rre),p=yo(yo({},rt(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):null,points:n,type:l,layout:c,connectNulls:u,strokeDasharray:a??i.strokeDasharray});return h.createElement(h.Fragment,null,(n==null?void 0:n.length)>1&&h.createElement(w1,gc({},p,{pathRef:r})),h.createElement(Xre,{points:n,clipPathId:t,props:i}),s&&_i.renderCallByParent(i,n))}function Yre(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Jre(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:p,width:x,height:m,onAnimationEnd:y,onAnimationStart:j}=r,b=a.current,g=Fj(r,"recharts-line-"),[v,w]=h.useState(!1),C=h.useCallback(()=>{typeof y=="function"&&y(),w(!1)},[y]),k=h.useCallback(()=>{typeof j=="function"&&j(),w(!0)},[j]),S=Yre(n.current),_=i.current;return h.createElement(Ti,{begin:u,duration:d,isActive:c,easing:f,from:{t:0},to:{t:1},onAnimationEnd:C,onAnimationStart:k,key:g},A=>{var{t:E}=A,N=xn(_,S+_),$=Math.min(N(E),S),z;if(l){var T="".concat(l).split(/[,\s]+/gim).map(D=>parseFloat(D));z=Gre($,S,T)}else z=ZD(S,$);if(b){var I=b.length/s.length,L=E===1?s:s.map((D,O)=>{var F=Math.floor(O*I);if(b[F]){var q=b[F],te=xn(q.x,D.x),H=xn(q.y,D.y);return yo(yo({},D),{},{x:te(E),y:H(E)})}if(p){var B=xn(x*2,D.x),K=xn(m/2,D.y);return yo(yo({},D),{},{x:B(E),y:K(E)})}return yo(yo({},D),{},{x:D.x,y:D.y})});return a.current=L,h.createElement(mb,{props:r,points:L,clipPathId:t,pathRef:n,showLabels:!v,strokeDasharray:z})}return E>0&&S>0&&(a.current=s,i.current=$),h.createElement(mb,{props:r,points:s,clipPathId:t,pathRef:n,showLabels:!v,strokeDasharray:z})})}function Zre(e){var{clipPathId:t,props:r}=e,{points:n,isAnimationActive:a}=r,i=h.useRef(null),s=h.useRef(0),l=h.useRef(null),c=i.current;return a&&n&&n.length&&c!==n?h.createElement(Jre,{props:r,clipPathId:t,previousPointsRef:i,longestAnimatedLengthRef:s,pathRef:l}):h.createElement(mb,{props:r,points:n,clipPathId:t,pathRef:l,showLabels:!0})}var Qre=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:kt(e.payload,t)});class ene extends h.Component{constructor(){super(...arguments),Sg(this,"id",zs("recharts-line-"))}render(){var t,{hide:r,dot:n,points:a,className:i,xAxisId:s,yAxisId:l,top:c,left:u,width:d,height:f,id:p,needClip:x,layout:m}=this.props;if(r)return null;var y=at("recharts-line",i),j=vt(p)?this.id:p,{r:b=3,strokeWidth:g=2}=(t=rt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},v=yO(n),w=b*2+g;return h.createElement(h.Fragment,null,h.createElement(xr,{className:y},x&&h.createElement("defs",null,h.createElement($D,{clipPathId:j,xAxisId:s,yAxisId:l}),!v&&h.createElement("clipPath",{id:"clipPath-dots-".concat(j)},h.createElement("rect",{x:u-w/2,y:c-w/2,width:d+w,height:f+w}))),h.createElement(Zre,{props:this.props,clipPathId:j}),h.createElement(TD,{direction:m==="horizontal"?"y":"x"},h.createElement(ND,{xAxisId:s,yAxisId:l,data:a,dataPointFormatter:Qre,errorBarOffset:0},this.props.children))),h.createElement(Lee,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var QD={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Zs.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function tne(e){var t=ao(e,QD),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:p,xAxisId:x,yAxisId:m}=t,y=JD(t,Fre),{needClip:j}=Uj(x,m),{height:b,width:g,x:v,y:w}=Bj(),C=ng(),k=Zr(),S=h.useMemo(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),_=De(A=>$re(A,x,m,k,S));return C!=="horizontal"&&C!=="vertical"?null:h.createElement(ene,gc({},y,{connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:u,label:f,legendType:p,xAxisId:x,yAxisId:m,points:_,layout:C,height:b,width:g,left:v,top:w,needClip:j}))}function rne(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=kt(u,s);return t==="horizontal"?{x:vC({axis:r,ticks:a,bandSize:l,entry:u,index:d}),y:vt(f)?null:n.scale(f),value:f,payload:u}:{x:vt(f)?null:r.scale(f),y:vC({axis:n,ticks:i,bandSize:l,entry:u,index:d}),value:f,payload:u}})}class Ai extends h.PureComponent{render(){return h.createElement(PD,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},h.createElement(kD,{legendPayload:Wre(this.props)}),h.createElement(Rj,{fn:qre,args:this.props}),h.createElement(tne,this.props))}}Sg(Ai,"displayName","Line");Sg(Ai,"defaultProps",QD);function kA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kA(Object(r),!0).forEach(function(n){nne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nne(e,t,r){return(t=one(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function one(e){var t=ane(e,"string");return typeof t=="symbol"?t:t+""}function ane(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ine={xAxis:{},yAxis:{},zAxis:{}},eI=oo({name:"cartesianAxis",initialState:ine,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=CA(CA({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:sne,removeXAxis:lne,addYAxis:cne,removeYAxis:dne,addZAxis:dle,removeZAxis:ule,updateYAxisWidth:une}=eI.actions,fne=eI.reducer,hne=["children"],pne=["dangerouslySetInnerHTML","ticks"];function tI(e,t,r){return(t=mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=gne(e,"string");return typeof t=="symbol"?t:t+""}function gne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gb.apply(null,arguments)}function rI(e,t){if(e==null)return{};var r,n,a=xne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vne(e){var t=Nt(),r=h.useMemo(()=>{var{children:i}=e,s=rI(e,hne);return s},[e]),n=De(i=>Ia(i,r.id)),a=r===n;return h.useEffect(()=>(t(sne(r)),()=>{t(lne(r))}),[r,t]),a?e.children:null}var yne=e=>{var{xAxisId:t,className:r}=e,n=De(FT),a=Zr(),i="xAxis",s=De(x=>Ic(x,i,t,a)),l=De(x=>N3(x,i,t,a)),c=De(x=>C3(x,t)),u=De(x=>UY(x,t));if(c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f}=e,p=rI(e,pne);return h.createElement(Vi,gb({},p,{scale:s,x:u.x,y:u.y,width:c.width,height:c.height,className:at("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},bne=e=>{var t,r,n,a,i;return h.createElement(vne,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter},h.createElement(yne,e))};class kn extends h.Component{render(){return h.createElement(bne,this.props)}}tI(kn,"displayName","XAxis");tI(kn,"defaultProps",{allowDataOverflow:fn.allowDataOverflow,allowDecimals:fn.allowDecimals,allowDuplicatedCategory:fn.allowDuplicatedCategory,height:fn.height,hide:!1,mirror:fn.mirror,orientation:fn.orientation,padding:fn.padding,reversed:fn.reversed,scale:fn.scale,tickCount:fn.tickCount,type:fn.type,xAxisId:0});var jne=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){t.forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>s&&(s=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+i,u=s+c+l+(r?n:0);return Math.round(u)}return 0},wne=["dangerouslySetInnerHTML","ticks"];function nI(e,t,r){return(t=Sne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sne(e){var t=kne(e,"string");return typeof t=="symbol"?t:t+""}function kne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xb.apply(null,arguments)}function Cne(e,t){if(e==null)return{};var r,n,a=_ne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _ne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ane(e){var t=Nt();return h.useEffect(()=>(t(cne(e)),()=>{t(dne(e))}),[e,t]),null}var Ene=e=>{var t,{yAxisId:r,className:n,width:a,label:i}=e,s=h.useRef(null),l=h.useRef(null),c=De(FT),u=Zr(),d=Nt(),f="yAxis",p=De(v=>Ic(v,f,r,u)),x=De(v=>_3(v,r)),m=De(v=>WY(v,r)),y=De(v=>N3(v,f,r,u));if(h.useLayoutEffect(()=>{var v;if(!(a!=="auto"||!x||Pj(i)||h.isValidElement(i))){var w=s.current,C=w==null||(v=w.tickRefs)===null||v===void 0?void 0:v.current,{tickSize:k,tickMargin:S}=w.props,_=jne({ticks:C,label:l.current,labelGapWithTick:5,tickSize:k,tickMargin:S});Math.round(x.width)!==Math.round(_)&&d(une({id:r,width:_}))}},[s,s==null||(t=s.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,x==null?void 0:x.width,x,d,i,r,a]),x==null||m==null)return null;var{dangerouslySetInnerHTML:j,ticks:b}=e,g=Cne(e,wne);return h.createElement(Vi,xb({},g,{ref:s,labelRef:l,scale:p,x:m.x,y:m.y,width:x.width,height:x.height,className:at("recharts-".concat(f," ").concat(f),n),viewBox:c,ticks:y}))},Nne=e=>{var t,r,n,a,i;return h.createElement(h.Fragment,null,h.createElement(Ane,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(a=e.minTickGap)!==null&&a!==void 0?a:5,tick:(i=e.tick)!==null&&i!==void 0?i:!0,tickFormatter:e.tickFormatter}),h.createElement(Ene,e))},Pne={allowDataOverflow:hn.allowDataOverflow,allowDecimals:hn.allowDecimals,allowDuplicatedCategory:hn.allowDuplicatedCategory,hide:!1,mirror:hn.mirror,orientation:hn.orientation,padding:hn.padding,reversed:hn.reversed,scale:hn.scale,tickCount:hn.tickCount,type:hn.type,width:hn.width,yAxisId:0};class Cn extends h.Component{render(){return h.createElement(Nne,this.props)}}nI(Cn,"displayName","YAxis");nI(Cn,"defaultProps",Pne);var Mne={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf=h;function One(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tne=typeof Object.is=="function"?Object.is:One,Lne=nf.useSyncExternalStore,Dne=nf.useRef,Ine=nf.useEffect,$ne=nf.useMemo,Rne=nf.useDebugValue;Mne.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=Dne(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=$ne(function(){function c(x){if(!u){if(u=!0,d=x,x=n(x),a!==void 0&&s.hasValue){var m=s.value;if(a(m,x))return f=m}return f=x}if(m=f,Tne(d,x))return m;var y=n(x);return a!==void 0&&a(m,y)?(d=x,m):(d=x,f=y)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var l=Lne(e,i[0],i[1]);return Ine(function(){s.hasValue=!0,s.value=l},[l]),Rne(l),l};function Fne(e){e()}function zne(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Fne(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var _A={notify(){},get:()=>[]};function Bne(e,t){let r,n=_A,a=0,i=!1;function s(y){d();const j=n.subscribe(y);let b=!1;return()=>{b||(b=!0,j(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return i}function d(){a++,r||(r=e.subscribe(c),n=zne())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=_A)}function p(){i||(i=!0,d())}function x(){i&&(i=!1,f())}const m={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:x,getListeners:()=>n};return m}var Une=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wne=Une(),qne=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Kne=qne(),Gne=()=>Wne||Kne?h.useLayoutEffect:h.useEffect,Vne=Gne(),Vx=Symbol.for("react-redux-context"),Hx=typeof globalThis<"u"?globalThis:{};function Hne(){if(!h.createContext)return{};const e=Hx[Vx]??(Hx[Vx]=new Map);let t=e.get(h.createContext);return t||(t=h.createContext(null),e.set(h.createContext,t)),t}var Xne=Hne();function Yne(e){const{children:t,context:r,serverState:n,store:a}=e,i=h.useMemo(()=>{const c=Bne(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=h.useMemo(()=>a.getState(),[a]);Vne(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const l=r||Xne;return h.createElement(l.Provider,{value:i},t)}var Jne=Yne,Zne=(e,t)=>t,Vj=le([Zne,ut,rY,br,q3,$a,GJ,lr],JJ),Hj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},oI=to("mouseClick"),aI=Gu();aI.startListening({actionCreator:oI,effect:(e,t)=>{var r=e.payload,n=Vj(t.getState(),Hj(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(rJ({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var vb=to("mouseMove"),iI=Gu();iI.startListening({actionCreator:vb,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=bj(n,n.tooltip.settings.shared),i=Vj(n,Hj(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch($3({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(I3()))}});function Qne(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var AA={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},sI=oo({name:"rootProps",initialState:AA,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:AA.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),eoe=sI.reducer,{updateOptions:toe}=sI.actions,lI=oo({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:roe}=lI.actions,noe=lI.reducer,cI=to("keyDown"),dI=to("focus"),Xj=Gu();Xj.startListening({actionCreator:cI,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(jj(a,nl(r))),l=$a(r);if(i==="Enter"){var c=$p(r,"axis","hover",String(a.index));t.dispatch(sb({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var u=VY(r),d=u==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,p=s+f*d;if(!(l==null||p>=l.length||p<0)){var x=$p(r,"axis","hover",String(p));t.dispatch(sb({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:x}))}}}}});Xj.startListening({actionCreator:dI,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=$p(r,"axis","hover",String(i));t.dispatch(sb({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var $n=to("externalEvent"),uI=Gu();uI.startListening({actionCreator:$n,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:IJ(r),activeDataKey:H3(r),activeIndex:Di(r),activeLabel:V3(r),activeTooltipIndex:Di(r),isTooltipActive:$J(r)};e.payload.handler(n,e.payload.reactEvent)}}});var ooe=le([$c],e=>e.tooltipItemPayloads),aoe=le([ooe,rf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),fI=to("touchMove"),hI=Gu();hI.startListening({actionCreator:fI,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=bj(n,n.tooltip.settings.shared);if(a==="axis"){var i=Vj(n,Hj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch($3({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute($T),d=(s=c.getAttribute(RT))!==null&&s!==void 0?s:void 0,f=aoe(t.getState(),u,d);t.dispatch(D3({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var ioe=cT({brush:Hte,cartesianAxis:fne,chartData:fZ,graphicalItems:zQ,layout:eK,legend:zK,options:sZ,polarAxis:kQ,polarOptions:noe,referenceElements:tre,rootProps:eoe,tooltip:nJ}),soe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Cq({reducer:ioe,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([aI.middleware,iI.middleware,Xj.middleware,uI.middleware,hI.middleware]),devTools:{serialize:{replacer:Qne},name:"recharts-".concat(r)}})};function pI(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Zr(),i=h.useRef(null);if(a)return r;i.current==null&&(i.current=soe(t,n));var s=l1;return h.createElement(Jne,{context:s,store:i.current},r)}function mI(e){var{layout:t,width:r,height:n,margin:a}=e,i=Nt(),s=Zr();return h.useEffect(()=>{s||(i(Jq(t)),i(Zq({width:r,height:n})),i(Yq(a)))},[i,s,t,r,n,a]),null}function gI(e){var t=Nt();return h.useEffect(()=>{t(toe(e))},[t,e]),null}var loe=["children"];function coe(e,t){if(e==null)return{};var r,n,a=doe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function doe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Wp(){return Wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wp.apply(null,arguments)}var uoe={width:"100%",height:"100%"},foe=h.forwardRef((e,t)=>{var r=y1(),n=b1(),a=qT();if(!uc(r)||!uc(n))return null;var{children:i,otherAttributes:s,title:l,desc:c}=e,u,d;return typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?d=s.role:d=a?"application":void 0,h.createElement(H0,Wp({},s,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:uoe,ref:t}),i)}),hoe=e=>{var{children:t}=e,r=De(rg);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return h.createElement(H0,{width:n,height:a,x:s,y:i},t)},EA=h.forwardRef((e,t)=>{var{children:r}=e,n=coe(e,loe),a=Zr();return a?h.createElement(hoe,null,r):h.createElement(foe,Wp({ref:t},n),r)});function poe(){var e=Nt(),[t,r]=h.useState(null),n=De(EK);return h.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Pn(i)&&i!==n&&e(Qq(i))}},[t,e,n]),r}function NA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function moe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NA(Object(r),!0).forEach(function(n){goe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function goe(e,t,r){return(t=xoe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xoe(e){var t=voe(e,"string");return typeof t=="symbol"?t:t+""}function voe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yoe=h.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:p,onTouchEnd:x,onTouchMove:m,onTouchStart:y,style:j,width:b}=e,g=Nt(),[v,w]=h.useState(null),[C,k]=h.useState(null);mZ();var S=poe(),_=h.useCallback(H=>{S(H),typeof t=="function"&&t(H),w(H),k(H)},[S,t,w,k]),A=h.useCallback(H=>{g(oI(H)),g($n({handler:i,reactEvent:H}))},[g,i]),E=h.useCallback(H=>{g(vb(H)),g($n({handler:u,reactEvent:H}))},[g,u]),N=h.useCallback(H=>{g(I3()),g($n({handler:d,reactEvent:H}))},[g,d]),$=h.useCallback(H=>{g(vb(H)),g($n({handler:f,reactEvent:H}))},[g,f]),z=h.useCallback(()=>{g(dI())},[g]),T=h.useCallback(H=>{g(cI(H.key))},[g]),I=h.useCallback(H=>{g($n({handler:s,reactEvent:H}))},[g,s]),L=h.useCallback(H=>{g($n({handler:l,reactEvent:H}))},[g,l]),D=h.useCallback(H=>{g($n({handler:c,reactEvent:H}))},[g,c]),O=h.useCallback(H=>{g($n({handler:p,reactEvent:H}))},[g,p]),F=h.useCallback(H=>{g($n({handler:y,reactEvent:H}))},[g,y]),q=h.useCallback(H=>{g(fI(H)),g($n({handler:m,reactEvent:H}))},[g,m]),te=h.useCallback(H=>{g($n({handler:x,reactEvent:H}))},[g,x]);return h.createElement(eD.Provider,{value:v},h.createElement(bO.Provider,{value:C},h.createElement("div",{className:at("recharts-wrapper",n),style:moe({position:"relative",cursor:"default",width:b,height:a},j),onClick:A,onContextMenu:I,onDoubleClick:L,onFocus:z,onKeyDown:T,onMouseDown:D,onMouseEnter:E,onMouseLeave:N,onMouseMove:$,onMouseUp:O,onTouchEnd:te,onTouchMove:q,onTouchStart:F,ref:_},r)))}),boe=["children","className","width","height","style","compact","title","desc"];function joe(e,t){if(e==null)return{};var r,n,a=woe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function woe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xI=h.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:l,title:c,desc:u}=e,d=joe(e,boe),f=rt(d,!1);return l?h.createElement(EA,{otherAttributes:f,title:c,desc:u},r):h.createElement(yoe,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},h.createElement(EA,{otherAttributes:f,title:c,desc:u,ref:t},h.createElement(nre,null,r)))}),Soe=["width","height"];function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yb.apply(null,arguments)}function koe(e,t){if(e==null)return{};var r,n,a=Coe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Coe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _oe={top:5,right:5,bottom:5,left:5},Aoe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:_oe,reverseStackOrder:!1,syncMethod:"index"},vI=h.forwardRef(function(t,r){var n,a=ao(t.categoricalChartProps,Aoe),{width:i,height:s}=a,l=koe(a,Soe);if(!uc(i)||!uc(s))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:p}=t,x={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return h.createElement(pI,{preloadedState:{options:x},reduxStoreName:(n=p.id)!==null&&n!==void 0?n:c},h.createElement(UD,{chartData:p.data}),h.createElement(mI,{width:i,height:s,layout:a.layout,margin:a.margin}),h.createElement(gI,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),h.createElement(xI,yb({},l,{width:i,height:s,ref:r})))}),Eoe=["axis"],Bd=h.forwardRef((e,t)=>h.createElement(vI,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Eoe,tooltipPayloadSearcher:Nj,categoricalChartProps:e,ref:t})),Noe=["axis","item"],Fc=h.forwardRef((e,t)=>h.createElement(vI,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Noe,tooltipPayloadSearcher:Nj,categoricalChartProps:e,ref:t}));function Poe(e){var t=Nt();return h.useEffect(()=>{t(roe(e))},[t,e]),null}var Moe=["width","height","layout"];function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bb.apply(null,arguments)}function Ooe(e,t){if(e==null)return{};var r,n,a=Toe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Toe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Loe={top:5,right:5,bottom:5,left:5},Doe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Loe,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},Ioe=h.forwardRef(function(t,r){var n,a=ao(t.categoricalChartProps,Doe),{width:i,height:s,layout:l}=a,c=Ooe(a,Moe);if(!uc(i)||!uc(s))return null;var{chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:f,tooltipPayloadSearcher:p}=t,x={chartName:u,defaultTooltipEventType:d,validateTooltipEventTypes:f,tooltipPayloadSearcher:p,eventEmitter:void 0};return h.createElement(pI,{preloadedState:{options:x},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:u},h.createElement(UD,{chartData:a.data}),h.createElement(mI,{width:i,height:s,layout:l,margin:a.margin}),h.createElement(gI,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),h.createElement(Poe,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),h.createElement(xI,bb({width:i,height:s},c,{ref:r})))}),$oe=["item"],Roe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Foe=h.forwardRef((e,t)=>{var r=ao(e,Roe);return h.createElement(Ioe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:$oe,tooltipPayloadSearcher:Nj,categoricalChartProps:r,ref:t})});const PA=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg");function zoe(){const[e,t]=h.useState([]),[r,n]=h.useState([]),[a,i]=h.useState([]),[s,l]=h.useState([]),[c,u]=h.useState([]),d=[...a].sort((y,j)=>y-j),f=({active:y,payload:j,label:b})=>y&&j&&j.length?o.jsxs("div",{className:"bg-white p-2 rounded shadow text-black text-sm",children:[o.jsxs("p",{className:"font-bold",children:["Semana: ",b]}),j.map((g,v)=>o.jsxs("p",{style:{color:g.color},children:[g.name,": ",typeof g.value=="number"?g.value.toFixed(2):g.value]},v))]}):null;h.useEffect(()=>{async function y(){const{data:j,error:b}=await PA.from("Muestreos Nutricion").select("Sector, Semana").range(0,9999);if(!b&&j){const g=[...new Set(j.map(w=>w.Sector))].sort((w,C)=>{const[k,S]=[parseInt(w),w.slice(-1)],[_,A]=[parseInt(C),C.slice(-1)];return k-_||S.localeCompare(A)}),v=[...new Set(j.map(w=>w.Semana))].sort((w,C)=>C-w);l(g),u(v)}}y()},[]),h.useEffect(()=>{async function y(){let j=PA.from("Muestreos Nutricion").select("*").order("Fecha",{ascending:!1}).limit(1e4);a.length>0&&(j=j.in("Semana",a)),r.length>0&&(j=j.in("Sector",r));const{data:b,error:g}=await j;!g&&b?t(b):console.error("Error al obtener datos:",g)}y()},[r,a]);const x=(y=>{const j={};return y.forEach(b=>{j[b.Fecha]||(j[b.Fecha]={}),j[b.Fecha][b.Sector]||(j[b.Fecha][b.Sector]=[]),j[b.Fecha][b.Sector].push(b)}),Object.entries(j).map(([b,g])=>{const v=Object.entries(g).map(([S,_])=>({sector:S,entradas:_})),w=v.flatMap(S=>S.entradas),k=["Goteros","Exprimidos"].map(S=>{const _=w.filter(E=>E.Tipo===S);if(_.length===0)return null;const A=E=>(_.reduce((N,$)=>N+$[E],0)/_.length).toFixed(2);return{tipo:S,Prom_CE:A("C.E."),Prom_pH:A("pH"),Prom_NO3:A("NO3"),Prom_Ca:A("Ca"),Prom_K:A("K"),Prom_Na:A("Na")}}).filter(Boolean);return{fecha:b,sectores:v,total:k}})})(e),m=x.flatMap(y=>y.total.map(j=>({semana:y.sectores[0].entradas[0].Semana,...j})));return o.jsxs("div",{className:"p-6 space-y-4 bg-zinc-900 min-h-screen text-white",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Reportes de Nutricin"}),o.jsxs("div",{className:"flex gap-10 flex-wrap items-start",children:[o.jsxs("div",{className:"bg-zinc-800 text-white border border-zinc-700 px-4 py-2 rounded-md max-w-[400px]",children:[o.jsx("p",{className:"text-xl font-bold",children:"Sectores:"}),o.jsx("div",{className:"grid grid-cols-6 gap-1 max-h-[100px] overflow-y-auto",children:s.map(y=>o.jsxs("label",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"checkbox",checked:r.includes(y),onChange:()=>{r.includes(y)?n(j=>j.filter(b=>b!==y)):n(j=>[...j,y])}}),o.jsx("span",{children:y})]},y))})]}),o.jsxs("div",{className:"bg-zinc-800 text-white border border-zinc-700 px-5 py-2 rounded-md max-w-[300px]",children:[o.jsx("p",{className:"text-xl font-bold mb-1",children:"Semanas:"}),o.jsx("div",{className:"grid grid-cols-6 gap-1 max-h-[100px] overflow-y-auto text-sm",children:c.map(y=>o.jsxs("label",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"checkbox",checked:a.includes(y),onChange:()=>{i(j=>j.includes(y)?j.filter(b=>b!==y):[...j,y])}}),o.jsx("span",{children:y})]},y))})]})]}),o.jsxs(bU,{defaultValue:"tabla",children:[o.jsxs(uO,{className:"mt-4 bg-zinc-800 border border-zinc-700 text-white",children:[o.jsx(Sy,{value:"tabla",className:"data-[state=active]:bg-blue-600 px-4 py-2 rounded-l-md",children:"Tabla"}),o.jsx(Sy,{value:"grafica",className:"data-[state=active]:bg-blue-600 px-4 py-2 rounded-r-md",children:"Grfica"})]}),o.jsx(ky,{value:"tabla",children:x.map(({fecha:y,sectores:j,total:b},g)=>o.jsxs(bd,{className:"mt-6 bg-zinc-800 border border-zinc-700 text-white",children:[o.jsx("div",{className:"bg-zinc-900 px-5 py-3 rounded-t-md border-b border-zinc-700",children:o.jsxs("p",{className:"text-2xl font-bold",children:["Promedios del ",y]})}),o.jsxs(fO,{className:"pt-2",children:[j.map(({sector:v,entradas:w},C)=>o.jsxs("div",{className:"mb-6",children:[o.jsxs("p",{className:"text-xl font-semibold",children:["Sector ",v]}),o.jsxs(xh,{className:"mt-1 text-base",children:[o.jsx(vh,{children:o.jsxs(os,{children:[o.jsx(Rt,{children:"Tipo"}),o.jsx(Rt,{children:"Prom C.E."}),o.jsx(Rt,{children:"Prom pH"}),o.jsx(Rt,{children:"Prom NO3"}),o.jsx(Rt,{children:"Prom Ca"}),o.jsx(Rt,{children:"Prom K"}),o.jsx(Rt,{children:"Prom Na"})]})}),o.jsx(yh,{children:["Goteros","Exprimidos"].map(k=>{const S=w.filter(A=>A.Tipo===k);if(S.length===0)return null;const _=A=>(S.reduce((E,N)=>E+N[A],0)/S.length).toFixed(2);return o.jsxs(os,{className:"text-base",children:[o.jsx(Ft,{children:k}),o.jsx(Ft,{children:_("C.E.")}),o.jsx(Ft,{children:_("pH")}),o.jsx(Ft,{children:_("NO3")}),o.jsx(Ft,{children:_("Ca")}),o.jsx(Ft,{children:_("K")}),o.jsx(Ft,{children:_("Na")})]},k)})})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("p",{className:"text-xl font-semibold",children:"Valores individuales"}),o.jsxs(xh,{className:"mt-1 text-base",children:[o.jsx(vh,{children:o.jsxs(os,{children:[o.jsx(Rt,{className:"text-base",children:"Tipo"}),o.jsx(Rt,{className:"text-base",children:"C.E."}),o.jsx(Rt,{className:"text-base",children:"pH"}),o.jsx(Rt,{className:"text-base",children:"NO3"}),o.jsx(Rt,{className:"text-base",children:"Ca"}),o.jsx(Rt,{className:"text-base",children:"K"}),o.jsx(Rt,{className:"text-base",children:"Na"})]})}),o.jsx(yh,{children:w.map((k,S)=>o.jsxs(os,{className:"text-base",children:[o.jsx(Ft,{className:"text-base",children:k.Tipo}),o.jsx(Ft,{className:"text-base",children:k["C.E."].toFixed(2)}),o.jsx(Ft,{className:"text-base",children:k.pH.toFixed(2)}),o.jsx(Ft,{className:"text-base",children:k.NO3.toFixed(0)}),o.jsx(Ft,{className:"text-base",children:k.Ca.toFixed(0)}),o.jsx(Ft,{className:"text-base",children:k.K.toFixed(0)}),o.jsx(Ft,{className:"text-base",children:k.Na.toFixed(0)})]},S))})]})]})]},C)),b.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsx("p",{className:"text-xl font-semibold",children:"Total"}),o.jsxs(xh,{className:"text-base",children:[o.jsx(vh,{children:o.jsxs(os,{children:[o.jsx(Rt,{children:"Tipo"}),o.jsx(Rt,{children:"Prom C.E."}),o.jsx(Rt,{children:"Prom pH"}),o.jsx(Rt,{children:"Prom NO3"}),o.jsx(Rt,{children:"Prom Ca"}),o.jsx(Rt,{children:"Prom K"}),o.jsx(Rt,{children:"Prom Na"})]})}),o.jsx(yh,{children:b.map((v,w)=>o.jsxs(os,{className:"text-base",children:[o.jsx(Ft,{children:v.tipo}),o.jsx(Ft,{children:v.Prom_CE}),o.jsx(Ft,{children:v.Prom_pH}),o.jsx(Ft,{children:v.Prom_NO3}),o.jsx(Ft,{children:v.Prom_Ca}),o.jsx(Ft,{children:v.Prom_K}),o.jsx(Ft,{children:v.Prom_Na})]},w))})]})]})]})]},g))}),o.jsxs(ky,{value:"grafica",children:[o.jsxs(bd,{className:"bg-zinc-800 border border-zinc-700 p-4 mt-6 text-white",children:[o.jsx("p",{className:"text-xl font-semibold mb-2",children:"Histrico de pH"}),o.jsx(Jn,{width:"100%",height:250,children:o.jsxs(Bd,{data:m,children:[o.jsx(ko,{strokeDasharray:"3 3"}),o.jsx(kn,{dataKey:"semana",type:"category",ticks:d,interval:0,label:{value:"Semana",position:"insideBottom",offset:-5},tick:{fill:"#ccc",fontSize:12},tickFormatter:y=>y}),o.jsx(Cn,{}),o.jsx(Yn,{content:o.jsx(f,{})}),o.jsx(ki,{}),o.jsx(Ai,{type:"monotone",dataKey:"Prom_pH",stroke:"#10b981",name:"pH"})]})})]}),o.jsxs(bd,{className:"bg-zinc-800 border border-zinc-700 p-4 mt-6 text-white",children:[o.jsx("p",{className:"text-xl font-semibold mb-2",children:"Histrico de C.E."}),o.jsx(Jn,{width:"100%",height:250,children:o.jsxs(Bd,{data:m,children:[o.jsx(ko,{strokeDasharray:"3 3"}),o.jsx(kn,{dataKey:"semana",type:"category",ticks:d,interval:0,label:{value:"Semana",position:"insideBottom",offset:-5},tick:{fill:"#ccc",fontSize:12},tickFormatter:y=>y}),o.jsx(Cn,{}),o.jsx(Yn,{content:o.jsx(f,{})}),o.jsx(ki,{}),o.jsx(Ai,{type:"monotone",dataKey:"Prom_CE",stroke:"#3b82f6",name:"C.E."})]})})]}),[{key:"Prom_NO3",color:"#fbbf24",label:"NO3"},{key:"Prom_Ca",color:"#ef4444",label:"Ca"},{key:"Prom_K",color:"#8b5cf6",label:"K"},{key:"Prom_Na",color:"#f472b6",label:"Na"}].map(({key:y,color:j,label:b})=>o.jsxs(bd,{className:"bg-zinc-800 border border-zinc-700 p-4 mt-6 text-white",children:[o.jsxs("p",{className:"text-xl font-semibold mb-2",children:["Histrico de ",b]}),o.jsx(Jn,{width:"100%",height:250,children:o.jsxs(Bd,{data:m,children:[o.jsx(ko,{strokeDasharray:"3 3"}),o.jsx(kn,{dataKey:"semana",type:"category",ticks:d,interval:0,label:{value:"Semana",position:"insideBottom",offset:-5},tick:{fill:"#ccc",fontSize:12},tickFormatter:g=>g}),o.jsx(Cn,{}),o.jsx(Yn,{content:o.jsx(f,{})}),o.jsx(ki,{}),o.jsx(Ai,{type:"monotone",dataKey:y,stroke:j,name:b})]})})]},y))]})]})]})}function Boe(e){return{id:e.ID,email:e.email,password:e.password,name:e.name??null,tabs:e.tabs??"",role_id:e.role_id??null,is_active:e.is_active!==!1,is_admin:e.is_admin===!0,created_at:e.created_at}}function Yj(){const[e,t]=h.useState([]),[r,n]=h.useState(!0),{refreshPermissions:a}=Vo(),i=async()=>{n(!0);const{data:u,error:d}=await se.from("Users").select('"ID", email, name, tabs, role_id, is_active, is_admin, created_at').order("email");d?(console.error("[useUsers] fetch:",d),oe.error("Error al cargar usuarios")):t((u??[]).map(f=>Boe(f))),n(!1)};return h.useEffect(()=>{i()},[]),{users:e,isLoading:r,createUser:async u=>{const{error:d}=await se.from("Users").insert({email:u.email,password:u.password,name:u.name,role_id:u.role_id,tabs:"Mapa",is_active:!0,is_admin:!1});if(d)throw oe.error("Error al crear usuario"),d;oe.success("Usuario creado"),await i()},updateUser:async(u,d)=>{const f={...d};"password"in f&&!f.password&&delete f.password,delete f.id;const{error:p}=await se.from("Users").update(f).eq('"ID"',u);if(p)throw oe.error("Error al actualizar usuario"),p;oe.success("Usuario actualizado"),await i(),await a()},deleteUser:async u=>{const{error:d}=await se.from("Users").delete().eq('"ID"',u);if(d)throw oe.error("Error al eliminar usuario"),d;oe.success("Usuario eliminado"),await i()},refetch:i}}function yI(){const[e,t]=h.useState([]),[r,n]=h.useState({}),[a,i]=h.useState(!0),s=async()=>{i(!0);const[{data:f,error:p},{data:x,error:m}]=await Promise.all([se.from("roles").select("*").order("nombre"),se.from("role_nav_permissions").select("role_id, nav_key").eq("can_view",!0)]);p&&console.error("[useRoles] fetch roles:",p),m&&console.error("[useRoles] fetch perms:",m),t(f??[]);const y={};for(const j of x??[])y[j.role_id]||(y[j.role_id]=[]),y[j.role_id].push(j.nav_key);n(y),i(!1)};return h.useEffect(()=>{s()},[]),{roles:e,rolePermissionsMap:r,isLoading:a,createRole:async f=>{const{data:p,error:x}=await se.from("roles").insert(f).select().single();if(x)throw oe.error("Error al crear rol"),x;return oe.success("Rol creado"),await s(),p},updateRole:async(f,p)=>{const{error:x}=await se.from("roles").update(p).eq("id",f);if(x)throw oe.error("Error al actualizar rol"),x;oe.success("Rol actualizado"),await s()},deleteRole:async f=>{const{count:p}=await se.from("Users").select('"ID"',{count:"exact",head:!0}).eq("role_id",f);if(p&&p>0){oe.error(`No se puede eliminar: ${p} usuario(s) tienen este rol asignado`);return}const{error:x}=await se.from("roles").delete().eq("id",f);if(x)throw oe.error("Error al eliminar rol"),x;oe.success("Rol eliminado"),await s()},setRolePermissions:async(f,p)=>{const{error:x}=await se.from("role_nav_permissions").delete().eq("role_id",f).select();if(x)throw console.error("[useRoles] delete role_nav_permissions:",x),oe.error("Error al actualizar permisos del rol"),x;if(p.length>0){const m=p.map(j=>({role_id:f,nav_key:j,can_view:!0})),{error:y}=await se.from("role_nav_permissions").insert(m);if(y)throw oe.error("Error al guardar permisos del rol"),y}oe.success("Permisos del rol actualizados"),await s()},refetch:s}}function Uoe({users:e,roles:t,selectedUserId:r,onSelect:n,onNewUser:a,isLoading:i}){const[s,l]=h.useState(""),c=Object.fromEntries(t.map(f=>[f.id,f])),d=[...e.filter(f=>{const p=s.toLowerCase();return f.email.toLowerCase().includes(p)||(f.name??"").toLowerCase().includes(p)})].sort((f,p)=>f.is_admin!==p.is_admin?f.is_admin?-1:1:f.is_active!==p.is_active?f.is_active?-1:1:(f.name??f.email).localeCompare(p.name??p.email));return o.jsxs("div",{className:"flex flex-col h-full bg-[#111] border-r border-[#222]",children:[o.jsxs("div",{className:"p-4 border-b border-[#222]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h2",{className:"text-sm font-semibold text-white",children:"Usuarios"}),o.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 text-xs bg-[#3B82F6] hover:bg-[#2563EB] text-white px-3 py-1.5 rounded-lg transition-colors",children:[o.jsx(yd,{className:"w-3.5 h-3.5"}),"Nuevo"]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(Fl,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[#555]"}),o.jsx("input",{type:"text",placeholder:"Buscar por nombre o email",value:s,onChange:f=>l(f.target.value),className:"w-full bg-[#1A1A1A] text-white text-xs pl-8 pr-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6] placeholder-[#555]"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:i?o.jsx("div",{className:"flex items-center justify-center h-32 text-[#555] text-sm",children:"Cargando"}):d.length===0?o.jsx("div",{className:"flex items-center justify-center h-32 text-[#555] text-sm",children:s?"Sin resultados":"Sin usuarios"}):d.map(f=>{const p=f.role_id?c[f.role_id]:null,x=f.id===r,m=!f.role_id&&!f.is_admin;return o.jsx("button",{onClick:()=>n(f.id),className:`w-full text-left px-4 py-3 border-b border-[#1a1a1a] transition-colors ${x?"bg-[#1e2a3a] border-l-2 border-l-[#3B82F6]":"hover:bg-[#161616] border-l-2 border-l-transparent"}`,children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[o.jsx("span",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${f.is_active?"bg-[#10B981]":"bg-[#EF4444]"}`,title:f.is_active?"Activo":"Inactivo"}),o.jsx("span",{className:"text-sm text-white truncate font-medium",children:f.name??f.email.split("@")[0]}),f.is_admin&&o.jsx("span",{className:"text-[10px] text-[#EF4444] font-bold flex-shrink-0",children:"ADMIN"})]}),o.jsx("div",{className:"text-[11px] text-[#555] truncate pl-3",children:f.email})]}),o.jsx("div",{className:"flex-shrink-0 flex flex-col items-end gap-1",children:p?o.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded-full",style:{background:p.color+"25",color:p.color},children:p.nombre}):m?o.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded-full bg-[#F59E0B20] text-[#F59E0B]",title:"Sin rol asignado  requiere migracin",children:" Sin rol"}):null})]})},f.id)})}),o.jsxs("div",{className:"p-3 border-t border-[#222] flex gap-3 text-[11px] text-[#555]",children:[o.jsxs("span",{children:[e.filter(f=>f.is_active).length," activos"]}),o.jsx("span",{children:""}),o.jsxs("span",{children:[e.filter(f=>!f.role_id&&!f.is_admin).length," sin rol"]})]})]})}function Woe(e,t){const[r,n]=h.useState([]),[a,i]=h.useState([]),[s,l]=h.useState(!1),{refreshPermissions:c}=Vo(),u=h.useCallback(async()=>{if(!e){n([]),i([]);return}l(!0);const[{data:x,error:m},{data:y,error:j}]=await Promise.all([se.from("user_nav_overrides").select("id, user_id, nav_key, can_view").eq("user_id",e),t?se.from("role_nav_permissions").select("nav_key").eq("role_id",t).eq("can_view",!0):Promise.resolve({data:[],error:null})]);m&&console.error("[useNavOverrides] overrides:",m),j&&console.error("[useNavOverrides] role perms:",j),n(x??[]),i((y??[]).map(b=>b.nav_key)),l(!1)},[e,t]);h.useEffect(()=>{u()},[u]);const d=async(x,m)=>{if(!e)return;const y=a.includes(x);m===y?await se.from("user_nav_overrides").delete().eq("user_id",e).eq("nav_key",x):await se.from("user_nav_overrides").upsert({user_id:e,nav_key:x,can_view:m},{onConflict:"user_id,nav_key"}),await u(),await c()},f=async()=>{if(!e)return;const{error:x}=await se.from("user_nav_overrides").delete().eq("user_id",e);if(x){oe.error("Error al restablecer permisos");return}oe.success("Permisos restablecidos al rol"),await u(),await c()},p=[...a.filter(x=>!r.some(m=>m.nav_key===x&&!m.can_view)),...r.filter(x=>x.can_view&&!a.includes(x.nav_key)).map(x=>x.nav_key)];return{overrides:r,roleKeys:a,effectiveKeys:p,isLoading:s,setOverride:d,resetToRole:f}}function MA({nav_key:e,label:t,icon:r,isActive:n,isInherited:a,isOverride:i,readOnly:s,onChange:l}){return o.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-[#1f1f1f] group",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[r&&o.jsx("span",{className:"text-sm flex-shrink-0",children:r}),o.jsx("span",{className:`text-sm truncate ${n?"text-white":"text-[#666]"}`,children:t}),a&&!i&&o.jsx("span",{className:"text-[10px] text-[#555] flex-shrink-0",title:"Heredado del rol",children:""}),i&&o.jsx("span",{className:`text-[10px] flex-shrink-0 font-semibold px-1.5 py-0.5 rounded ${n?"bg-[#10B98120] text-[#10B981]":"bg-[#EF444420] text-[#EF4444]"}`,title:"Override individual (sobreescribe el rol)",children:"override"})]}),!s&&o.jsx("button",{onClick:()=>l(e,!n),className:`relative w-9 h-5 rounded-full transition-colors flex-shrink-0 ml-3 ${n?"bg-[#3B82F6]":"bg-[#333]"}`,title:n?"Quitar acceso":"Dar acceso",children:o.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${n?"translate-x-4":"translate-x-0.5"}`})}),s&&o.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ml-3 ${n?"bg-[#3B82F6]":"bg-[#333]"}`})]})}function Xx({title:e,icon:t,children:r,defaultOpen:n=!0,anyActive:a=!1}){const[i,s]=zn.useState(n);return o.jsxs("div",{className:"mb-1",children:[o.jsxs("button",{onClick:()=>s(l=>!l),className:"w-full flex items-center gap-2 px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[#666] hover:text-[#999] transition-colors",children:[o.jsx("span",{children:i?"":""}),t&&o.jsx("span",{children:t}),o.jsx("span",{children:e}),a&&!i&&o.jsx("span",{className:"ml-auto w-2 h-2 rounded-full bg-[#3B82F6]"})]}),i&&o.jsx("div",{className:"pl-2",children:r})]})}function bI({activeKeys:e,inheritedKeys:t=[],onChange:r,readOnly:n=!1}){const a=Ak.filter(l=>{const c=e.includes(l),u=t.includes(l);return c!==u}),i=l=>({nav_key:l.key,label:l.label,icon:l.icon,isActive:e.includes(l.key),isInherited:t.includes(l.key),isOverride:a.includes(l.key),readOnly:n??!1,onChange:r}),s=l=>Ak.includes(l.key)?o.jsx(MA,{...i(l)},l.key):null;return o.jsxs("div",{className:"space-y-1",children:[o.jsx(Xx,{title:"Acceso directo",icon:"",anyActive:["mapa","muestreos","reportes","configuracion"].some(l=>e.includes(l)),children:ip.filter(l=>l.level==="direct").map(s)}),ip.filter(l=>l.level==="group").map(l=>{var c;return(c=l.children)==null?void 0:c.map(u=>{var d,f;if(u.level==="subgroup"&&((d=u.children)!=null&&d.length)){const p=u.children.some(x=>e.includes(x.key));return o.jsx(Xx,{title:u.label,icon:u.icon,defaultOpen:p,anyActive:p,children:u.children.map(s)},u.key)}if(u.level==="section"){if((f=u.children)!=null&&f.length){const p=[u.key,...u.children.map(x=>x.key)].some(x=>e.includes(x));return o.jsxs(Xx,{title:u.label,icon:u.icon,defaultOpen:p,anyActive:p,children:[o.jsx(MA,{...i(u)}),o.jsx("div",{className:"pl-4 border-l border-[#222] ml-3 mt-1",children:u.children.map(s)})]},u.key)}return o.jsx("div",{className:"pl-2",children:s(u)},u.key)}return null})}),!n&&o.jsxs("div",{className:"mt-4 pt-3 border-t border-[#222] flex flex-wrap gap-3 px-3",children:[o.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] text-[#555]",children:[o.jsx("span",{children:""})," Heredado del rol"]}),o.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] text-[#10B981]",children:[o.jsx("span",{className:"bg-[#10B98120] px-1.5 py-0.5 rounded font-semibold text-[10px]",children:"override"}),"Permiso individual activo"]}),o.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] text-[#EF4444]",children:[o.jsx("span",{className:"bg-[#EF444420] px-1.5 py-0.5 rounded font-semibold text-[10px] text-[#EF4444]",children:"override"}),"Permiso quitado individualmente"]})]})]})}const jI=[{action_key:"exportacion.kanban.advance_without_docs",label:"Avanzar embarque sin documentos completos",module:"Exportacin  Pipeline"},{action_key:"exportacion.embarque.delete",label:"Eliminar embarque",module:"Exportacin"},{action_key:"exportacion.embarque.edit",label:"Editar datos de un embarque",module:"Exportacin"},{action_key:"exportacion.catalogos.edit",label:"Editar catlogos (warehouses, contactos)",module:"Exportacin  Catlogos"},{action_key:"cosecha.corte.delete",label:"Eliminar corte de cosecha",module:"Cosecha"},{action_key:"cosecha.merma.delete",label:"Eliminar registro de merma",module:"Cosecha"},{action_key:"inventario.ajuste.negativo",label:"Ajuste negativo de inventario",module:"Inventario"},{action_key:"inventario.item.delete",label:"Eliminar tem de inventario",module:"Inventario"},{action_key:"personal.baja",label:"Dar de baja a un trabajador",module:"Personal"},{action_key:"plagas.aplicacion.delete",label:"Eliminar registro de aplicacin",module:"Plagas y Enfermedades"},{action_key:"usuarios.delete",label:"Eliminar usuario del sistema",module:"Configuracin  Usuarios"}],wI=Object.fromEntries(jI.map(e=>[e.action_key,e]));function qoe(e,t){if(!e)return null;const r=e.split(",").map(a=>a.trim());if(r.includes("Personal"))return t.find(a=>a.nombre==="Supervisor Campo")??null;const n=e.toLowerCase();return n.includes("exportaci")?t.find(a=>a.nombre==="Exportacin")??null:n.includes("cosecha")?t.find(a=>a.nombre==="Cosecha")??null:n.includes("empaque")||n.includes("inventario")?t.find(a=>a.nombre==="Empaque")??null:r.every(a=>["Mapa","Reportes"].includes(a))?t.find(a=>a.nombre==="Visor")??null:null}function Koe({user:e,roles:t,isCreating:r,onSaved:n,onDeleted:a,onCancelNew:i}){var H;const[s,l]=h.useState("identidad"),[c,u]=h.useState(""),[d,f]=h.useState(""),[p,x]=h.useState(""),[m,y]=h.useState(""),[j,b]=h.useState(!0),[g,v]=h.useState(!1),[w,C]=h.useState(!1),[k,S]=h.useState(!1),{createUser:_,updateUser:A,deleteUser:E}=Yj(),{overrides:N,roleKeys:$,effectiveKeys:z,isLoading:T,setOverride:I,resetToRole:L}=Woe((e==null?void 0:e.id)??null,(e==null?void 0:e.role_id)??null);h.useEffect(()=>{var B;e?(u(e.name??""),f(e.email),x(""),y(e.role_id??""),b(e.is_active),v(e.is_admin)):r&&(u(""),f(""),x(""),y(((B=t[0])==null?void 0:B.id)??""),b(!0),v(!1)),l("identidad"),S(!1)},[e==null?void 0:e.id,r]);const D=async()=>{if(!d){oe.error("El email es obligatorio");return}if(r&&!p){oe.error("La contrasea es obligatoria para usuarios nuevos");return}C(!0);try{r?(await _({email:d,password:p,name:c,role_id:m||null}),n()):e&&(await A(e.id,{name:c||null,email:d,...p?{password:p}:{},role_id:m||null,is_active:j,is_admin:g}),n())}finally{C(!1)}},O=async()=>{if(e){if(!k){S(!0);return}await E(e.id),a()}},F=e&&!e.role_id?qoe(e.tabs??"",t):null,q=async()=>{!e||!F||(y(F.id),oe.success(`Rol "${F.nombre}" seleccionado. Guarda para confirmar.`))};if(!e&&!r)return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-[#555] select-none",children:[o.jsx("span",{className:"text-4xl mb-3",children:""}),o.jsx("p",{className:"text-sm",children:"Selecciona un usuario para editar"}),o.jsx("p",{className:"text-xs mt-1",children:"o crea uno nuevo"})]});const te=[{id:"identidad",label:"Identidad",icon:""},{id:"permisos",label:"Permisos",icon:""},{id:"acciones",label:"Acciones",icon:""}];return o.jsxs("div",{className:"flex flex-col h-full bg-[#0D0D0D]",children:[o.jsxs("div",{className:"px-6 pt-5 pb-0 border-b border-[#222]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-semibold text-base",children:r?"Nuevo Usuario":(e==null?void 0:e.name)??(e==null?void 0:e.email)??""}),!r&&e&&o.jsx("p",{className:"text-[#555] text-xs mt-0.5",children:e.email})]}),r&&o.jsx("button",{onClick:i,className:"text-[#555] hover:text-white text-sm transition-colors",children:" Cancelar"})]}),o.jsx("nav",{className:"flex gap-0",children:te.map(B=>o.jsxs("button",{onClick:()=>l(B.id),className:`flex items-center gap-1.5 px-4 py-2.5 text-sm font-medium border-b-2 transition-all whitespace-nowrap ${s===B.id?"border-[#3B82F6] text-white":"border-transparent text-[#555] hover:text-[#999]"}`,children:[o.jsx("span",{children:B.icon}),B.label,B.id==="permisos"&&N.length>0&&o.jsx("span",{className:"ml-1 text-[10px] bg-[#3B82F620] text-[#3B82F6] px-1.5 py-0.5 rounded-full font-semibold",children:N.length})]},B.id))})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s==="identidad"&&o.jsxs("div",{className:"p-6 space-y-4 max-w-lg",children:[F&&o.jsxs("div",{className:"flex items-start gap-3 bg-[#F59E0B10] border border-[#F59E0B30] rounded-lg p-3",children:[o.jsx($8,{className:"w-4 h-4 text-[#F59E0B] flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-[#F59E0B] text-xs font-semibold",children:"Usuario en modo legacy"}),o.jsxs("p",{className:"text-[#999] text-xs mt-0.5",children:["Tabs actuales: ",o.jsx("code",{className:"text-[#F59E0B]",children:e==null?void 0:e.tabs})]}),o.jsxs("p",{className:"text-[#999] text-xs",children:["Rol sugerido: ",o.jsx("strong",{className:"text-white",children:F.nombre})]}),o.jsx("button",{onClick:q,className:"mt-2 text-xs bg-[#F59E0B20] hover:bg-[#F59E0B30] text-[#F59E0B] px-3 py-1 rounded-lg transition-colors",children:"Asignar rol sugerido"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Nombre"}),o.jsx("input",{type:"text",value:c,onChange:B=>u(B.target.value),placeholder:"Nombre visible",className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Email"}),o.jsx("input",{type:"email",value:d,onChange:B=>f(B.target.value),className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:r?"Contrasea":"Nueva contrasea (dejar vaco para no cambiar)"}),o.jsx("input",{type:"password",value:p,onChange:B=>x(B.target.value),placeholder:r?"Contrasea":"",className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Rol"}),o.jsxs("select",{value:m,onChange:B=>y(B.target.value),className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]",children:[o.jsx("option",{value:"",children:" Sin rol asignado "}),t.map(B=>o.jsx("option",{value:B.id,children:B.nombre},B.id))]})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:j,onChange:B=>b(B.target.checked),className:"w-4 h-4 rounded"}),o.jsx("span",{className:"text-sm text-white",children:"Usuario activo"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:g,onChange:B=>v(B.target.checked),className:"w-4 h-4 rounded"}),o.jsx("span",{className:"text-sm text-white",children:"Administrador"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[o.jsxs("button",{onClick:D,disabled:w,className:"flex items-center gap-2 bg-[#3B82F6] hover:bg-[#2563EB] disabled:opacity-50 text-white text-sm px-4 py-2 rounded-lg transition-colors",children:[w?o.jsx(ir,{className:"w-4 h-4 animate-spin"}):o.jsx(Bi,{className:"w-4 h-4"}),r?"Crear usuario":"Guardar cambios"]}),!r&&e&&o.jsxs("button",{onClick:O,className:`flex items-center gap-2 text-sm px-4 py-2 rounded-lg transition-colors ${k?"bg-[#EF4444] text-white":"text-[#EF4444] hover:bg-[#EF444415]"}`,children:[o.jsx(Cm,{className:"w-4 h-4"}),k?"Confirmar?":"Eliminar"]}),k&&o.jsx("button",{onClick:()=>S(!1),className:"text-sm text-[#555] hover:text-white",children:"Cancelar"})]})]}),s==="permisos"&&o.jsx("div",{className:"p-4",children:r?o.jsxs("div",{className:"text-[#555] text-sm text-center py-12",children:["Guarda el usuario primero para configurar permisos individuales.",o.jsx("br",{}),"Los permisos se heredan del rol seleccionado."]}):T?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(ir,{className:"w-5 h-5 animate-spin text-[#555]"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-xs text-[#555]",children:["Rol base:"," ",o.jsx("span",{className:"text-white font-medium",children:((H=t.find(B=>B.id===(e==null?void 0:e.role_id)))==null?void 0:H.nombre)??"Sin rol"})]}),N.length>0&&o.jsxs("p",{className:"text-xs text-[#555] mt-0.5",children:[N.length," override",N.length!==1?"s":""," individual",N.length!==1?"es":""]})]}),N.length>0&&o.jsxs("button",{onClick:L,className:"flex items-center gap-1.5 text-xs text-[#F59E0B] hover:text-[#FBBF24] transition-colors",children:[o.jsx(X8,{className:"w-3.5 h-3.5"}),"Restablecer al rol"]})]}),o.jsx(bI,{activeKeys:z,inheritedKeys:$,onChange:I})]})}),s==="acciones"&&o.jsxs("div",{className:"p-4",children:[o.jsxs("p",{className:"text-xs text-[#555] mb-4 px-1",children:["Estado de acciones sensibles segn el rol del usuario. La configuracin de permisos de ejecucin por rol se hace en la seccin ",o.jsx("strong",{className:"text-white",children:"Roles"}),"."]}),o.jsx("div",{className:"space-y-1",children:jI.map(({action_key:B,label:K,module:Z})=>o.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5 rounded-lg hover:bg-[#111]",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-white",children:K}),o.jsx("p",{className:"text-[11px] text-[#555] mt-0.5",children:Z})]}),g?o.jsx("span",{className:"text-[11px] text-[#10B981] bg-[#10B98115] px-2 py-0.5 rounded-full font-medium flex-shrink-0 ml-3",children:" Admin  directo"}):o.jsx("span",{className:"text-[11px] text-[#F59E0B] bg-[#F59E0B15] px-2 py-0.5 rounded-full font-medium flex-shrink-0 ml-3",children:"Requiere aprobacin"})]},B))})]})]})]})}function Goe(){const[e,t]=h.useState(null),[r,n]=h.useState(!1),{users:a,isLoading:i,refetch:s}=Yj(),{roles:l,isLoading:c}=yI(),u=a.find(m=>m.id===e)??null,d=m=>{t(m),n(!1)},f=()=>{t(null),n(!0)},p=async()=>{await s(),r&&n(!1)},x=async()=>{t(null),await s()};return o.jsxs("div",{className:"flex h-[calc(100vh-112px)]",children:[" ",o.jsx("div",{className:"w-72 flex-shrink-0",children:o.jsx(Uoe,{users:a,roles:l,selectedUserId:r?null:e,onSelect:d,onNewUser:f,isLoading:i||c})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(Koe,{user:r?null:u,roles:l,isCreating:r,onSaved:p,onDeleted:x,onCancelNew:()=>n(!1)})})]})}const Voe=["a1000000-0000-0000-0000-000000000001","a1000000-0000-0000-0000-000000000002","a1000000-0000-0000-0000-000000000003","a1000000-0000-0000-0000-000000000004","a1000000-0000-0000-0000-000000000005","a1000000-0000-0000-0000-000000000006"],Yx=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#00C9A7","#6B7280"];function Hoe({users:e}){const{roles:t,rolePermissionsMap:r,isLoading:n,createRole:a,updateRole:i,deleteRole:s,setRolePermissions:l}=yI(),[c,u]=h.useState(null),[d,f]=h.useState(!1),[p,x]=h.useState(""),[m,y]=h.useState(""),[j,b]=h.useState(Yx[3]),[g,v]=h.useState([]),[w,C]=h.useState(!1),[k,S]=h.useState(!1),_=t.find(T=>T.id===c)??null;h.useEffect(()=>{_?(x(_.nombre),y(_.descripcion),b(_.color),v(r[_.id]??[]),S(!1)):d&&(x(""),y(""),b(Yx[3]),v([]))},[c,d,r]);const A=async()=>{if(p.trim()){C(!0);try{if(d){const T=await a({nombre:p,descripcion:m,color:j});await l(T.id,g),f(!1),u(T.id)}else _&&(await i(_.id,{nombre:p,descripcion:m,color:j}),await l(_.id,g))}finally{C(!1)}}},E=async()=>{if(_){if(!k){S(!0);return}await s(_.id),u(null)}},N=(T,I)=>{v(L=>I?[...L,T]:L.filter(D=>D!==T))},$=_?Voe.includes(_.id):!1,z=Object.fromEntries(t.map(T=>[T.id,e.filter(I=>I.role_id===T.id).length]));return o.jsxs("div",{className:"flex h-full",children:[o.jsxs("div",{className:"w-64 flex-shrink-0 flex flex-col bg-[#111] border-r border-[#222]",children:[o.jsxs("div",{className:"p-4 border-b border-[#222] flex items-center justify-between",children:[o.jsx("h2",{className:"text-sm font-semibold text-white",children:"Roles"}),o.jsxs("button",{onClick:()=>{f(!0),u(null)},className:"flex items-center gap-1 text-xs bg-[#3B82F6] hover:bg-[#2563EB] text-white px-2.5 py-1.5 rounded-lg transition-colors",children:[o.jsx(Js,{className:"w-3 h-3"}),"Nuevo"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:n?o.jsx("div",{className:"flex items-center justify-center h-24 text-[#555]",children:o.jsx(ir,{className:"w-4 h-4 animate-spin"})}):t.map(T=>{const I=T.id===c&&!d,L=z[T.id]??0;return o.jsxs("button",{onClick:()=>{u(T.id),f(!1)},className:`w-full text-left px-4 py-3 border-b border-[#1a1a1a] transition-colors ${I?"bg-[#1e2a3a] border-l-2 border-l-[#3B82F6]":"hover:bg-[#161616] border-l-2 border-l-transparent"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{background:T.color}}),o.jsx("span",{className:"text-sm text-white font-medium truncate",children:T.nombre})]}),o.jsxs("div",{className:"text-[11px] text-[#555] pl-5",children:[L," usuario",L!==1?"s":""]})]},T.id)})})]}),o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden bg-[#0D0D0D]",children:!_&&!d?o.jsxs("div",{className:"flex items-center justify-center h-full text-[#555] text-sm select-none flex-col gap-2",children:[o.jsx("span",{className:"text-3xl",children:""}),"Selecciona un rol para editar"]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-6 pt-5 pb-4 border-b border-[#222] flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-4 h-4 rounded-full",style:{background:j}}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-semibold text-base",children:d?"Nuevo Rol":_==null?void 0:_.nombre}),$&&o.jsx("p",{className:"text-[11px] text-[#555] mt-0.5",children:"Rol del sistema"})]})]}),d&&o.jsx("button",{onClick:()=>f(!1),className:"text-[#555] hover:text-white text-sm",children:" Cancelar"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Nombre del rol"}),o.jsx("input",{type:"text",value:p,onChange:T=>x(T.target.value),className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Color del badge"}),o.jsx("div",{className:"flex gap-2 flex-wrap",children:Yx.map(T=>o.jsx("button",{onClick:()=>b(T),className:`w-6 h-6 rounded-full transition-transform ${j===T?"scale-125 ring-2 ring-white ring-offset-1 ring-offset-[#0D0D0D]":""}`,style:{background:T}},T))})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"block text-xs font-medium text-[#999] mb-1.5",children:"Descripcin"}),o.jsx("input",{type:"text",value:m,onChange:T=>y(T.target.value),placeholder:"Quin tiene este rol?",className:"w-full bg-[#1A1A1A] text-white text-sm px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"})]})]}),o.jsxs("div",{className:"border border-[#222] rounded-xl p-4 bg-[#0a0a0a]",children:[o.jsx("p",{className:"text-xs font-semibold text-[#555] uppercase tracking-wider mb-3",children:"Permisos de navegacin"}),o.jsx(bI,{activeKeys:g,onChange:N})]}),o.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[o.jsxs("button",{onClick:A,disabled:w||!p.trim(),className:"flex items-center gap-2 bg-[#3B82F6] hover:bg-[#2563EB] disabled:opacity-50 text-white text-sm px-4 py-2 rounded-lg transition-colors",children:[w?o.jsx(ir,{className:"w-4 h-4 animate-spin"}):o.jsx(Bi,{className:"w-4 h-4"}),d?"Crear rol":"Guardar cambios"]}),!d&&_&&!$&&o.jsxs("button",{onClick:E,className:`flex items-center gap-2 text-sm px-4 py-2 rounded-lg transition-colors ${k?"bg-[#EF4444] text-white":"text-[#EF4444] hover:bg-[#EF444415]"}`,children:[o.jsx(Cm,{className:"w-4 h-4"}),k?"Confirmar?":"Eliminar rol"]}),k&&o.jsx("button",{onClick:()=>S(!1),className:"text-sm text-[#555] hover:text-white",children:"Cancelar"})]})]})})]})})]})}function Xoe(){const{users:e}=Yj();return o.jsx(Hoe,{users:e})}const Yoe=3e4;function SI(){const[e,t]=h.useState([]),[r,n]=h.useState([]),[a,i]=h.useState(!0),{user:s}=Vo(),l=h.useRef(null),c=h.useCallback(async()=>{if(!s){i(!1);return}i(!0);try{try{await se.rpc("expire_old_approval_requests")}catch{}const[x,m]=await Promise.all([se.from("approval_requests").select("*").eq("status","pending").order("created_at",{ascending:!1}),se.from("approval_requests").select("*").neq("status","pending").order("created_at",{ascending:!1}).limit(100)]);x.error?(console.error("[useApprovals] fetch pending:",x.error),oe.error("Error al cargar solicitudes: "+x.error.message)):t(x.data??[]),m.error?console.error("[useApprovals] fetch history:",m.error):n(m.data??[])}catch(x){console.error("[useApprovals] fetchAll exception:",x),oe.error("Error inesperado al cargar solicitudes")}finally{i(!1)}},[s]);h.useEffect(()=>(c(),l.current=setInterval(c,Yoe),()=>{l.current&&clearInterval(l.current)}),[c]);const u=async x=>{if(!s)throw new Error("No hay sesin activa");if(s.is_admin)return oe("Admin: accin ejecutada sin aprobacin.",{icon:""}),"admin-bypass";const{data:m}=await se.from("approval_requests").select("id").eq("requested_by",s.id).eq("action_key",x.action_key).eq("status","pending").maybeSingle();if(m)return oe("Ya tienes una solicitud pendiente para esta accin.",{icon:""}),m.id;const{data:y,error:j}=await se.from("approval_requests").insert({requested_by:s.id,action_key:x.action_key,context_id:x.context_id??null,context_data:x.context_data??null,status:"pending"}).select("id").single();if(j)throw oe.error("Error al enviar la solicitud de autorizacin"),j;return oe.success("Solicitud enviada. El administrador recibir una notificacin."),await c(),y.id},d=async x=>{const{action_key:m,context_id:y,context_data:j}=x,b=j;try{if(m==="exportacion.kanban.advance_without_docs"&&y&&(b!=null&&b.next_status)){const g=b.next_status,{error:v}=await se.from("embarques").update({status:g,updated_at:new Date().toISOString()}).eq("id",y);if(v)throw v;await se.from("embarque_tracking").insert({embarque_id:y,etapa_nueva:g,notas:"Avanzado automticamente tras aprobacin del administrador."}),oe.success(` Embarque avanzado automticamente a ${b.etapa_destino??g}`)}}catch(g){console.error("[autoExecute] Error ejecutando accin:",g),oe.error("La accin fue aprobada pero no se pudo ejecutar automticamente. El usuario deber ejecutarla manualmente.")}},f=async x=>{if(!(s!=null&&s.is_admin)){oe.error("Solo el administrador puede revisar solicitudes");return}const m=x.decision==="approved",y=new Date,j=m?new Date(y.getTime()+4*60*60*1e3).toISOString():null,{error:b}=await se.from("approval_requests").update({status:x.decision,reviewed_by:s.id,reviewed_at:y.toISOString(),expires_at:j,admin_notes:x.admin_notes??null}).eq("id",x.request_id);if(b)throw oe.error("Error al procesar la solicitud"),b;if(m){const g=[...e].find(v=>v.id===x.request_id);g&&await d(g)}oe.success(m?" Solicitud aprobada y accin ejecutada":" Solicitud rechazada"),await c()},p=async(x,m)=>{if(!s)return"denied";if(s.is_admin)return"allowed";let y=se.from("approval_requests").select("id, expires_at").eq("requested_by",s.id).eq("action_key",x).eq("status","approved").gt("expires_at",new Date().toISOString());m&&(y=y.eq("context_id",m));const{data:j,error:b}=await y.limit(1);return b||!(j!=null&&j.length)?"needs_approval":"allowed"};return{pending:e,history:r,pendingCount:e.length,isLoading:a,requestApproval:u,reviewRequest:f,checkApproval:p,refetch:c}}function Joe({status:e}){const r={pending:{label:"Pendiente",cls:"bg-[#F59E0B15] text-[#F59E0B]",icon:""},approved:{label:"Aprobada",cls:"bg-[#10B98115] text-[#10B981]",icon:""},rejected:{label:"Rechazada",cls:"bg-[#EF444415] text-[#EF4444]",icon:""},expired:{label:"Expirada",cls:"bg-[#33333380] text-[#666]",icon:""}}[e];return o.jsxs("span",{className:`text-[11px] font-semibold px-2 py-0.5 rounded-full ${r.cls}`,children:[r.icon," ",r.label]})}function Zoe({request:e,showActions:t,onApprove:r,onReject:n}){const[a,i]=h.useState(""),[s,l]=h.useState(null),c=wI[e.action_key],u=e.context_data,d=f=>{s===f?(f==="approve"?r==null||r(e.id,a||void 0):n==null||n(e.id,a||void 0),l(null),i("")):l(f)};return o.jsxs("div",{className:"bg-[#111] border border-[#222] rounded-xl p-4 space-y-3",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-white font-medium",children:(c==null?void 0:c.label)??e.action_key}),o.jsxs("p",{className:"text-[11px] text-[#555] mt-0.5",children:[(c==null?void 0:c.module)??"","  ",new Date(e.created_at).toLocaleString("es-MX")]})]}),o.jsx(Joe,{status:e.status})]}),u&&Object.keys(u).length>0&&o.jsx("div",{className:"bg-[#0a0a0a] rounded-lg px-3 py-2 text-xs space-y-1",children:Object.entries(u).map(([f,p])=>o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("span",{className:"text-[#555] capitalize",children:[f,":"]}),o.jsx("span",{className:"text-[#ccc]",children:String(p)})]},f))}),e.admin_notes&&o.jsxs("div",{className:"text-xs text-[#999] italic border-l-2 border-[#333] pl-3",children:['"',e.admin_notes,'"']}),t&&o.jsxs(o.Fragment,{children:[s&&o.jsx("input",{type:"text",placeholder:"Nota opcional para el usuario",value:a,onChange:f=>i(f.target.value),className:"w-full bg-[#1A1A1A] text-white text-xs px-3 py-2 rounded-lg border border-[#333] focus:outline-none focus:border-[#3B82F6]"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:()=>d("approve"),className:"flex items-center gap-1.5 text-xs bg-[#10B98120] hover:bg-[#10B98130] text-[#10B981] px-3 py-1.5 rounded-lg transition-colors",children:[o.jsx(B8,{className:"w-3.5 h-3.5"}),s==="approve"?"Confirmar aprobacin":"Aprobar"]}),o.jsxs("button",{onClick:()=>d("reject"),className:"flex items-center gap-1.5 text-xs bg-[#EF444420] hover:bg-[#EF444430] text-[#EF4444] px-3 py-1.5 rounded-lg transition-colors",children:[o.jsx(vM,{className:"w-3.5 h-3.5"}),s==="reject"?"Confirmar rechazo":"Rechazar"]}),s&&o.jsx("button",{onClick:()=>l(null),className:"text-xs text-[#555] hover:text-white px-2",children:"Cancelar"})]})]})]})}function Qoe(){const[e,t]=h.useState("pendientes"),{pending:r,history:n,isLoading:a,reviewRequest:i}=SI(),s=async(d,f)=>{await i({request_id:d,decision:"approved",admin_notes:f})},l=async(d,f)=>{await i({request_id:d,decision:"rejected",admin_notes:f})},c=[{id:"pendientes",label:"Pendientes",count:r.length},{id:"historial",label:"Historial"}],u=e==="pendientes"?r:n;return o.jsxs("div",{className:"p-6 max-w-3xl",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-white font-semibold text-lg",children:"Solicitudes de Autorizacin"}),o.jsx("p",{className:"text-[#555] text-sm mt-1",children:"Revisa y acta sobre las acciones que requieren aprobacin de administrador."})]}),o.jsx("div",{className:"flex gap-0 border-b border-[#222] mb-5",children:c.map(d=>o.jsxs("button",{onClick:()=>t(d.id),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-all ${e===d.id?"border-[#3B82F6] text-white":"border-transparent text-[#555] hover:text-[#999]"}`,children:[d.label,d.count!==void 0&&d.count>0&&o.jsx("span",{className:"bg-[#EF4444] text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center",children:d.count>9?"9+":d.count})]},d.id))}),a?o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsx(ir,{className:"w-6 h-6 animate-spin text-[#555]"})}):u.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-[#555]",children:[o.jsx(q8,{className:"w-8 h-8 mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:e==="pendientes"?"No hay solicitudes pendientes":"Sin historial de solicitudes"}),e==="pendientes"&&o.jsx("p",{className:"text-xs mt-1 text-[#444]",children:"Las solicitudes aparecern aqu cuando un usuario intente realizar una accin sensible"})]}):o.jsx("div",{className:"space-y-3",children:u.map(d=>o.jsx(Zoe,{request:d,showActions:e==="pendientes",onApprove:s,onReject:l},d.id))})]})}function eae(){const{isAdmin:e,isLoaded:t}=_c();return t?e?o.jsx(Qoe,{}):o.jsx(ho,{to:"/app/configuracion/usuarios",replace:!0}):null}const Ka=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),tn={"1A":[1,16],"1B":[1,19],"1C":[1,20],"1D":[1,19],"1E":[1,16],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]};function tae(){var V,J,ne,Q,me,ue;const[e,t]=h.useState([]),[r,n]=h.useState(!0),[a,i]=h.useState(""),[s,l]=h.useState(!1),[c,u]=h.useState(""),[d,f]=h.useState(!0),[p,x]=h.useState(!0),[m,y]=h.useState(null),[j,b]=h.useState([]),[g,v]=h.useState({}),[w,C]=h.useState({}),[k,S]=h.useState([]),[_,A]=h.useState([]),[E,N]=h.useState(null),[$,z]=h.useState([]),[T,I]=h.useState(!1),L=["TUNELES","CAMINOS","PERIFERIA","N/A"],[D,O]=h.useState({}),[F,q]=h.useState(!1);Sc(),h.useEffect(()=>{te()},[]),h.useEffect(()=>{(async()=>{var ae,we;try{const G=await(await fetch("/tunnels.json")).json(),R=[],Y=[];for(const ge of G.features){const de=(we=(ae=ge.properties)==null?void 0:ae.name)==null?void 0:we.trim();de&&(de.startsWith("Camino")?R.push(de):de.startsWith("Periferia")&&Y.push(de))}S(R.sort()),A(Y.sort())}catch(ve){console.error("Error cargando tunnels.json:",ve)}})()},[]),h.useEffect(()=>{const W=ae=>{var we,ve;if(((we=ae.data)==null?void 0:we.type)==="SECCIONES_MAPA"&&E!==null){if(g[E]==="N/A"){(ve=window.frames[0])==null||ve.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:[]},"*"),O(R=>({...R,[E]:{...R[E],secciones:[]}}));return}const G=ae.data.secciones;O(R=>({...R,[E]:{...R[E],secciones:G}}))}};return window.addEventListener("message",W),()=>window.removeEventListener("message",W)},[E]);const te=async()=>{const{data:W,error:ae}=await Ka.from("Labores Personal").select("*").order('"Nombre Labor"',{ascending:!0}).range(0,9999);if(ae){console.error("Error fetching labores:",ae);return}t(W||[]),n(!1)},H=h.useRef(null);h.useEffect(()=>{const W=ae=>{H.current&&!H.current.contains(ae.target)&&I(!1)};return document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[]);const B=async(W,ae)=>{var ve;if(!ae){const{data:G,error:R}=await Ka.from("Labores Personal").select("Tipo").eq("id",W).single();if(R){console.error("Error fetching tipo:",R);return}const Y=((ve=G==null?void 0:G.Tipo)==null?void 0:ve.toUpperCase().trim())||"";v(de=>({...de,[W]:Y}));const ge=[];if(Y==="CAMINOS"){if(k.length===0){oe.error("Secciones de caminos an no cargadas");return}ge.push(...k)}else if(Y==="TUNELES")ge.push(...Object.keys(tn));else if(Y==="PERIFERIA"){if(_.length===0){oe.error("Secciones de periferia an no cargadas");return}ge.push(..._)}else if(Y.includes(",")){const de=Y.split(",").map(Oe=>Oe.trim());if(de.includes("CAMINOS")){if(k.length===0){oe.error("Secciones de caminos an no cargadas");return}ge.push(...k)}if(de.includes("TUNELES")&&ge.push(...Object.keys(tn)),de.includes("PERIFERIA")){if(_.length===0){oe.error("Secciones de periferia an no cargadas");return}ge.push(..._)}}C(de=>({...de,[W]:ge})),y(W)}const{error:we}=await Ka.from("Labores Personal").update({Activo:!1,"Fecha Inicio":null,"Fecha Fin":null,Seccion:null}).eq("id",W);if(we){console.error("Error desactivando labor:",we);return}await te()},K=async()=>{const W=m??E,ae=D[W??-1],we=g[W??-1]||"";if(!ae||!ae.inicio||!ae.fin){oe.error("Debes seleccionar una fecha de inicio y fin");return}if(we!=="N/A"&&(!ae.secciones||ae.secciones.length===0)){oe.error("Debes seleccionar al menos una seccin");return}const ve=ae.secciones.flatMap(R=>{if(tn[R]){const[Y,ge]=tn[R];return Array.from({length:ge-Y+1},(de,Oe)=>`${R} Tunel ${Oe+Y}`)}return[R]}),{error:G}=await Ka.from("Labores Personal").update({Activo:!0,"Fecha Inicio":ae.inicio,"Fecha Fin":ae.fin,Seccion:ve.join(",")}).eq("id",W);G?(console.error(" Error al guardar:",G),oe.error("Error al guardar")):(oe.success("Cambios guardados correctamente"),y(null),N(null),O(R=>{const Y={...R};return delete Y[W],Y}),te())},Z=async()=>{const W=a.trim().length>0,ae=$.length>0;if(!W||!ae){oe.error("Debes ingresar un nombre y seleccionar al menos un tipo");return}l(!0);const{data:we,error:ve}=await Ka.from("Labores Personal").insert([{"Nombre Labor":a.trim(),Activo:!0,Tipo:$.join(", ")}]).select();if(ve){console.error("Error adding labor:",ve),l(!1);return}we&&(t([...e,...we]),i(""),z([])),l(!1)},he=e.filter(W=>W["Nombre Labor"].toLowerCase().includes(c.toLowerCase())),re=he.filter(W=>{var ae;return W.Activo&&((ae=W.Tipo)==null?void 0:ae.toUpperCase().trim())!=="N/A"}),X=he.filter(W=>{var ae;return!W.Activo&&((ae=W.Tipo)==null?void 0:ae.toUpperCase().trim())!=="N/A"});return o.jsx("div",{className:"bg-[#0D0D0D] min-h-screen text-white font-sans",children:o.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Planeacin de Labores"}),o.jsx("p",{className:"text-[#A3A3A3] mb-6",children:"Activa, desactiva o crea nuevas labores disponibles para asignacin."}),o.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[o.jsxs("div",{className:"flex flex-col flex-1 min-w-[200px]",children:[o.jsx("label",{className:"text-sm font-semibold text-white mb-1",children:"Nombre Labor"}),o.jsx("input",{type:"text",value:a,onChange:W=>{const ae=W.target.value.toUpperCase().replace(/[^A-Z ]/g,"");i(ae)},placeholder:"Nueva Labor (Maysculas, sin acentos)",className:"px-4 py-2 rounded-lg bg-[#1A1A1A] border border-[#333] text-white w-full"})]}),o.jsxs("div",{ref:H,className:"flex flex-col min-w-[200px] relative",children:[o.jsx("label",{className:"text-sm font-semibold text-white mb-1",children:"Tipo"}),o.jsx("button",{onClick:()=>I(!T),className:"bg-[#1A1A1A] text-white border border-[#333] px-4 py-2 rounded text-left w-full",children:$.length>0?$.join(", "):"Seleccione uno o ms"}),T&&o.jsx("div",{className:"absolute z-50 mt-2 bg-[#1A1A1A] border border-[#333] rounded w-full shadow-md",children:L.map(W=>o.jsxs("label",{className:"flex items-center px-4 py-2 text-sm text-white hover:bg-[#2A2A2A]",children:[o.jsx("input",{type:"checkbox",className:"mr-2 accent-blue-500",checked:$.includes(W),onChange:()=>{z(ae=>ae.includes(W)?ae.filter(ve=>ve!==W):W==="N/A"?["N/A"]:ae.includes("N/A")?(oe.error('No puedes seleccionar otros tipos junto con "N/A"'),ae):ae.length>=3?(oe.error("Solo puedes seleccionar hasta 3 tipos"),ae):[...ae,W])}}),W]},W))})]}),o.jsx("div",{children:o.jsx("button",{onClick:Z,disabled:s||a.trim()===""||$.length===0,className:`px-5 py-2 rounded-lg text-white font-medium ${s||a.trim()===""||$.length===0?"bg-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:s?"Agregando...":"Agregar"})})]}),o.jsx("input",{type:"text",placeholder:"Buscar labor...",value:c,onChange:W=>u(W.target.value),className:"w-full mb-6 px-4 py-2 rounded-lg bg-[#1A1A1A] border border-[#333] text-white"}),F&&E!==null&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center",children:o.jsxs("div",{className:"flex w-full max-w-6xl h-[90vh] bg-[#1A1A1A] rounded-lg border border-[#333] overflow-hidden shadow-lg",children:[o.jsxs("div",{className:"w-[320px] p-4 bg-[#1A1A1A] border-r border-[#333] overflow-y-auto",children:[o.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:((V=e.find(W=>W.id===E))==null?void 0:V["Nombre Labor"])||"Editar Labor"}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"text-[17px] text-blue-400 mb-1 block",children:"Fecha Inicio"}),o.jsx("input",{type:"date",value:((J=D[E])==null?void 0:J.inicio)||"",onChange:W=>O(ae=>({...ae,[E]:{...ae[E],inicio:W.target.value}})),className:"bg-[#1A1A1A] text-white border border-[#333] px-3 py-2 rounded w-full"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"text-[17px] text-blue-400 mb-1 block",children:"Fecha Fin"}),o.jsx("input",{type:"date",value:((ne=D[E])==null?void 0:ne.fin)||"",onChange:W=>O(ae=>({...ae,[E]:{...ae[E],fin:W.target.value}})),className:"bg-[#1A1A1A] text-white border border-[#333] px-3 py-2 rounded w-full"})]}),((Q=g[E])==null?void 0:Q.includes("TUNELES"))&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 font-semibold mb-2",children:"Tneles"}),Object.entries({"Etapa 1":Object.keys(tn).filter(W=>/^[12]/.test(W)),"Etapa 2":Object.keys(tn).filter(W=>/^[3-5]/.test(W)),"Etapa 3":Object.keys(tn).filter(W=>/^[67]/.test(W)),"Etapa 4":Object.keys(tn).filter(W=>/^[8]/.test(W))}).map(([W,ae])=>{const we=ae.flatMap(G=>{const[R,Y]=tn[G];return Array.from({length:Y-R+1},(ge,de)=>`${G} Tunel ${de+R}`)}),ve=we.every(G=>{var R;return(((R=D[E])==null?void 0:R.secciones)||[]).includes(G)});return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:ve,onChange:G=>{var Y,ge;const R=new Set(((Y=D[E])==null?void 0:Y.secciones)||[]);G.target.checked?we.forEach(de=>R.add(de)):we.forEach(de=>R.delete(de)),O(de=>({...de,[E]:{...de[E],secciones:Array.from(R)}})),(ge=window.frames[0])==null||ge.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:Array.from(R)},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:W})]}),o.jsx("div",{className:"grid grid-cols-2 gap-2 pl-2",children:ae.map(G=>{const[R,Y]=tn[G],ge=Array.from({length:Y-R+1},(Oe,be)=>`${G} Tunel ${be+R}`),de=ge.every(Oe=>{var be;return(((be=D[E])==null?void 0:be.secciones)||[]).includes(Oe)});return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:de,onChange:Oe=>{var Ue,ie;const be=new Set(((Ue=D[E])==null?void 0:Ue.secciones)||[]);Oe.target.checked?(be.add(G),ge.forEach(pe=>be.add(pe))):(be.delete(G),ge.forEach(pe=>be.delete(pe))),O(pe=>({...pe,[E]:{...pe[E],secciones:Array.from(be)}})),(ie=window.frames[0])==null||ie.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:Array.from(be)},"*")},className:"accent-blue-500"}),G]},G)})})]},W)})]}),((me=g[E])==null?void 0:me.includes("CAMINOS"))&&k.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 mb-2",children:"Caminos"}),Object.entries({"Etapa 1":["Camino 1A-1C","Camino 1B-1D","Camino 1C-2B","Camino 1D-1E","Camino 2A-2C","Camino 2B-2D","Camino 2C-2E","Camino Reservorio-2A","Camino Zanja Principal-1A"],"Etapa 2":["Camino 3A-4A","Camino 3B-4B","Camino 3C-4C","Camino 4A-5A","Camino 4B-5B","Camino 4C-5C"],"Etapa 3":["Camino 7A-6B/6C","Camino 7B-7A/6B","Camino 7C-6D","Camino 7D-7C","Camino 7E","Camino 7E-7D","Camino Lateral derecho 7D-7C","Camino 6D-6C","Camino Principal 6s","Camino Principal 7s","Camino lateral derecho 6D-6C"]}).map(([W,ae])=>{const we=ae.every(ve=>{var G;return(((G=D[E])==null?void 0:G.secciones)||[]).includes(ve)});return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:we,onChange:ve=>{var Y,ge;const G=new Set(((Y=D[E])==null?void 0:Y.secciones)||[]);ve.target.checked?ae.forEach(de=>G.add(de)):ae.forEach(de=>G.delete(de));const R=Array.from(G);O(de=>({...de,[E]:{...de[E],secciones:R}})),(ge=window.frames[0])==null||ge.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:R},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:W})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:ae.map(ve=>{var G;return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:(((G=D[E])==null?void 0:G.secciones)||[]).includes(ve),onChange:R=>{var de,Oe;const Y=new Set(((de=D[E])==null?void 0:de.secciones)||[]);R.target.checked?Y.add(ve):Y.delete(ve);const ge=Array.from(Y);O(be=>({...be,[E]:{...be[E],secciones:ge}})),(Oe=window.frames[0])==null||Oe.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:ge},"*")},className:"accent-blue-500"}),ve]},ve)})})]},W)})]}),((ue=g[E])==null?void 0:ue.includes("PERIFERIA"))&&_.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-[17px] text-blue-400 mb-2",children:"Periferias"}),Object.entries({"Etapa 1":["Periferia 2E","Periferia 2D","Periferia 1E","Periferia Camino 2mts 2A/2C-2B/2D","Periferia Camino 2mts 1A/1C/2B-1B/1D/1E","Periferia Canal Biloxi"],"Etapa 2":["Periferia 3A","Periferia 3B","Periferia 3C","Periferia Divemex 1","Periferia Divemex 2","Periferia Externa 5C","Periferia Interna 5C","Periferia Externa 5A","Periferia Interna 5A","Periferia Externa 5B","Periferia Interna 5B","Periferia Reyes","Periferia camino 2mts 2da etapa Bs y Cs","Periferia canal 2da etapa As y Bs"],"Etapa 3":["Periferia 7B","Periferia Canal 6C-6D","Periferia Canal 7E-7C","Periferia Lateral 7B-6A","Periferia Zanja Principal 6A","Periferia Zanja Principal 6C"]}).map(([W,ae])=>{const we=ae.every(ve=>{var G;return(((G=D[E])==null?void 0:G.secciones)||[]).includes(ve)});return o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:we,onChange:ve=>{var Y,ge;const G=new Set(((Y=D[E])==null?void 0:Y.secciones)||[]);ve.target.checked?ae.forEach(de=>G.add(de)):ae.forEach(de=>G.delete(de));const R=Array.from(G);O(de=>({...de,[E]:{...de[E],secciones:R}})),(ge=window.frames[0])==null||ge.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:R},"*")},className:"accent-blue-500"}),o.jsx("strong",{children:W})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:ae.map(ve=>{var G;return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:(((G=D[E])==null?void 0:G.secciones)||[]).includes(ve),onChange:R=>{var de,Oe;const Y=new Set(((de=D[E])==null?void 0:de.secciones)||[]);R.target.checked?Y.add(ve):Y.delete(ve);const ge=Array.from(Y);O(be=>({...be,[E]:{...be[E],secciones:ge}})),(Oe=window.frames[0])==null||Oe.postMessage({type:"ACTUALIZAR_POLIGONOS_MAPA",secciones:ge},"*")},className:"accent-blue-500"}),ve]},ve)})})]},W)})]}),o.jsxs("div",{className:"flex gap-2 mt-2 justify-end",children:[o.jsx("button",{onClick:()=>{q(!1),N(null)},className:"bg-gray-600 hover:bg-gray-700 text-white text-xs px-3 py-1 rounded",children:"Cancelar"}),o.jsx("button",{onClick:K,className:"bg-green-600 hover:bg-green-700 text-white text-xs px-3 py-1 rounded",children:"Guardar"})]})]}),o.jsx("div",{className:"flex-1 min-h-[600px] h-[calc(100vh-4rem)]",children:o.jsx("iframe",{src:`/#/app/labores-map?laborId=${E}&tipo=${g[E]}`,className:"w-full h-full border-none",title:"Mapa de Labores"})})]})}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{onClick:()=>f(!d),className:"flex items-center gap-2 cursor-pointer select-none text-[#3B82F6] mb-2",children:[o.jsx("svg",{className:`w-4 h-4 transform transition-transform ${d?"rotate-90":"rotate-0"}`,fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"Activa"})]}),d&&re.map(W=>o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center p-4 bg-[#1A1A1A] rounded-lg border border-[#333] mb-2",children:[o.jsxs("div",{className:"w-full md:w-auto",children:[o.jsx("div",{className:"font-semibold text-lg mb-1",children:W["Nombre Labor"]}),o.jsxs("div",{className:"flex flex-col text-sm text-gray-300 space-y-1",children:[o.jsxs("div",{children:["Inicio: ",W["Fecha Inicio"]??""," | Fin: ",W["Fecha Fin"]??""]}),o.jsxs("div",{children:["Secciones:"," ",o.jsx("span",{className:"ml-1 underline text-gray-100 cursor-pointer",onClick:()=>alert(W.Seccion||"Sin secciones"),children:W.Seccion?W.Seccion.split(",")[0]+(W.Seccion.split(",").length>1?"...":""):""})]})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 mt-4 md:mt-0",children:[o.jsx("button",{onClick:async()=>{const{data:ae,error:we}=await Ka.from("Labores Personal").select("Tipo").eq("id",W.id).single();if(we||!(ae!=null&&ae.Tipo)){oe.error("Error cargando tipo de labor");return}const ve=ae.Tipo.toUpperCase().trim();v(de=>({...de,[W.id]:ve}));let G=[];ve.includes("TUNELES")&&G.push(...Object.keys(tn)),ve.includes("CAMINOS")&&G.push(...k),ve.includes("PERIFERIA")&&G.push(..._),C(de=>({...de,[W.id]:G}));const R=(W.Seccion||"").split(",").map(de=>de.trim()).filter(Boolean);let Y=[];if(ve.includes("TUNELES")){const de=R.map(Oe=>{const be=Oe.match(/^([1-8][A-F])\s+Tunel\s+\d+$/i);return be?be[1]:null}).filter(Boolean);Y.push(...de)}ve.includes("CAMINOS")&&Y.push(...R.filter(de=>k.includes(de))),ve.includes("PERIFERIA")&&Y.push(...R.filter(de=>_.includes(de)));const ge=Array.from(new Set(Y));O(de=>({...de,[W.id]:{inicio:W["Fecha Inicio"]||"",fin:W["Fecha Fin"]||"",secciones:ge}})),b(ge),N(W.id),q(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded-md",children:"Modificar"}),o.jsx("button",{onClick:()=>B(W.id,W.Activa),className:"px-4 py-1 text-sm bg-green-600 hover:bg-red-700 text-white rounded-lg w-fit",children:"Desactivar"})]})]},W.id))]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{onClick:()=>x(!p),className:"flex items-center gap-2 cursor-pointer select-none text-[#3B82F6] mb-2",children:[o.jsx("svg",{className:`w-4 h-4 transform transition-transform ${p?"rotate-90":"rotate-0"}`,fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"Inactivas"})]}),p&&X.map(W=>{var ae,we,ve,G,R,Y,ge,de,Oe;return o.jsxs("div",{className:"flex flex-col p-4 bg-[#1A1A1A] rounded-lg border border-[#333] mb-2",children:[o.jsx("span",{className:"font-semibold mb-2",children:W["Nombre Labor"]}),m===W.id?o.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-2 bg-[#111] p-4 rounded-lg",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[17px] text-blue-400 mb-1 block",children:"Fecha Inicio"}),o.jsx("input",{type:"date",value:((ae=D[W.id])==null?void 0:ae.inicio)||"",onChange:be=>{const Ue=be.target.value;O(ie=>{var pe,Se;return{...ie,[W.id]:{...ie[E],inicio:Ue,fin:((pe=ie[W.id])==null?void 0:pe.fin)||"",secciones:((Se=ie[W.id])==null?void 0:Se.secciones)||[]}}})},className:"bg-[#1A1A1A] text-blue-400 border border-[#333] px-3 py-2 rounded w-full"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[17px] text-blue-400 mb-1 block",children:"Fecha Fin"}),o.jsx("input",{type:"date",value:((we=D[E])==null?void 0:we.fin)||"",onChange:be=>{const Ue=be.target.value;O(ie=>{var pe,Se;return{...ie,[W.id]:{...ie[W.id],inicio:((pe=ie[W.id])==null?void 0:pe.inicio)||"",fin:Ue,secciones:((Se=ie[W.id])==null?void 0:Se.secciones)||[]}}})},className:"bg-[#1A1A1A] text-blue-400 border border-[#333] px-3 py-2 rounded w-full"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[17px] text-blue-400 mb-2 block",children:"Secciones"}),((ve=g[W.id])==null?void 0:ve.includes("TUNELES"))&&Object.entries({"Etapa 1":(G=w[W.id])==null?void 0:G.filter(be=>/^[12]/.test(be)),"Etapa 2":(R=w[W.id])==null?void 0:R.filter(be=>/^[3-5]/.test(be)),"Etapa 3":(Y=w[W.id])==null?void 0:Y.filter(be=>/^[67]/.test(be)),"Etapa 4":(ge=w[W.id])==null?void 0:ge.filter(be=>/^[8]/.test(be))}).map(([be,Ue])=>Ue.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300 mb-2",children:[o.jsx("input",{type:"checkbox",checked:Ue.every(ie=>{var pe;return(((pe=D[W.id])==null?void 0:pe.secciones)||[]).includes(ie)}),onChange:ie=>{var Se;const pe=new Set(((Se=D[W.id])==null?void 0:Se.secciones)||[]);Ue.forEach($e=>ie.target.checked?pe.add($e):pe.delete($e)),O($e=>({...$e,[W.id]:{...$e[W.id],secciones:Array.from(pe)}}))},className:"accent-blue-500"}),o.jsx("strong",{children:be})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:Ue.map(ie=>{var pe;return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:(((pe=D[W.id])==null?void 0:pe.secciones)||[]).includes(ie),onChange:Se=>{var He;const $e=new Set(((He=D[W.id])==null?void 0:He.secciones)||[]);Se.target.checked?$e.add(ie):$e.delete(ie),O(nt=>({...nt,[W.id]:{...nt[W.id],secciones:Array.from($e)}}))},className:"accent-blue-500"}),ie]},ie)})})]},be)),((de=g[W.id])==null?void 0:de.includes("CAMINOS"))&&k.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-sm text-blue-300 mb-2",children:"Caminos"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:k.map(be=>{var Ue;return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:(((Ue=D[W.id])==null?void 0:Ue.secciones)||[]).includes(be),onChange:ie=>{var Se;const pe=new Set(((Se=D[W.id])==null?void 0:Se.secciones)||[]);ie.target.checked?pe.add(be):pe.delete(be),O($e=>({...$e,[W.id]:{...$e[W.id],secciones:Array.from(pe)}}))},className:"accent-blue-500"}),be]},be)})})]}),((Oe=g[W.id])==null?void 0:Oe.includes("PERIFERIA"))&&_.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("strong",{className:"block text-sm text-blue-300 mb-2",children:"Periferias"}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-4",children:_.map(be=>{var Ue;return o.jsxs("label",{className:"flex items-center gap-2 text-sm text-blue-300",children:[o.jsx("input",{type:"checkbox",checked:(((Ue=D[W.id])==null?void 0:Ue.secciones)||[]).includes(be),onChange:ie=>{const pe=D[W.id]||{inicio:"",fin:"",secciones:[]},Se=new Set(pe.secciones);ie.target.checked?Se.add(be):Se.delete(be),O($e=>({...$e,[W.id]:{...pe,secciones:Array.from(Se)}}))},className:"accent-blue-500"}),be]},be)})})]})]}),o.jsxs("div",{className:"flex gap-2 mt-4",children:[o.jsx("button",{onClick:async()=>{const be=D[W.id];if(!be||!be.inicio||!be.fin||be.secciones.length===0){alert("Faltan campos por llenar");return}const Ue=be.secciones.flatMap(Se=>{if(tn[Se]){const[$e,He]=tn[Se];return Array.from({length:He-$e+1},(nt,It)=>`${Se} Tunel ${It+$e}`)}else return[Se]}),{data:ie,error:pe}=await Ka.from("Labores Personal").update({Activo:!0,"Fecha Inicio":be.inicio,"Fecha Fin":be.fin,Seccion:Ue.join(",")}).eq("id",Number(W.id)).select();pe?(console.error("Error activando labor:",pe),alert("Error al guardar")):(y(null),O(Se=>{const $e={...Se};return delete $e[W.id],$e}),te())},className:"bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg",children:"Confirmar"}),o.jsx("button",{onClick:()=>{y(null),O(be=>{const Ue={...be};return delete Ue[W.id],Ue})},className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-4 py-2 rounded-lg",children:"Cancelar"})]})]}):o.jsx("button",{onClick:async()=>{const{data:be,error:Ue}=await Ka.from("Labores Personal").select("Tipo").eq("id",W.id).single();if(Ue||!(be!=null&&be.Tipo)){oe.error("Error cargando tipo de labor");return}const ie=be.Tipo.toUpperCase().trim();v(nt=>({...nt,[W.id]:ie}));let pe=[];ie.includes("TUNELES")&&pe.push(...Object.keys(tn)),ie.includes("CAMINOS")&&pe.push(...k),ie.includes("PERIFERIA")&&pe.push(..._),C(nt=>({...nt,[W.id]:pe}));const Se=(W.Seccion||"").split(",").map(nt=>nt.trim()).filter(Boolean);let $e=[];if(ie.includes("TUNELES")){const nt=Se.map(It=>{const Ho=It.match(/^([1-8][A-F])\s+Tunel\s+\d+$/i);return Ho?Ho[1]:null}).filter(Boolean);$e.push(...nt)}ie.includes("CAMINOS")&&$e.push(...Se.filter(nt=>k.includes(nt))),ie.includes("PERIFERIA")&&$e.push(...Se.filter(nt=>_.includes(nt)));const He=Array.from(new Set($e));O(nt=>({...nt,[W.id]:{inicio:W["Fecha Inicio"]||"",fin:W["Fecha Fin"]||"",secciones:He}})),b(He),N(W.id),q(!0)},className:"px-4 py-1 text-sm bg-red-600 hover:bg-green-700 text-white rounded-lg w-fit",children:"Activar"})]},W.id)})]})]})})}const Gn=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),rae=[{id:"p1",shortCode:"8x18oz",targetFruits:250,targetWeight:525},{id:"p2",shortCode:"12x18oz",targetFruits:250,targetWeight:525},{id:"p3",shortCode:"JMB",targetFruits:100,targetWeight:288},{id:"p4",shortCode:"6oz",targetFruits:105,targetWeight:177},{id:"p5",shortCode:"PNT",targetFruits:150,targetWeight:325}],nae=[{id:"c1",name:"TwinRiver",code:"TWR"},{id:"c2",name:"RiverRun",code:"RVR"},{id:"c3",name:"Hortifrut",code:"HF"},{id:"c4",name:"BerryLovers",code:"BL"}],oae=[{id:"v1",name:"Biloxi"},{id:"v2",name:"Azra3"},{id:"v3",name:"Azra2"},{id:"v4",name:"Azra4s"},{id:"v5",name:"Azra6s"},{id:"v6",name:"Azra7s"},{id:"v7",name:"Sunset"},{id:"v8",name:"Max"},{id:"v9",name:"Sunrise"}],aae=[{id:"s1",name:"Sector 1A"},{id:"s2",name:"Sector 1B"},{id:"s3",name:"Sector 1C"},{id:"s4",name:"Sector 1D"},{id:"s5",name:"Sector 1E"},{id:"s6",name:"Sector 2A"},{id:"s7",name:"Sector 2B"},{id:"s8",name:"Sector 2C"},{id:"s9",name:"Sector 2D"},{id:"s10",name:"Sector 2E"},{id:"s11",name:"Sector 3A"},{id:"s12",name:"Sector 3B"},{id:"s13",name:"Sector 3C"},{id:"s14",name:"Sector 4A"},{id:"s15",name:"Sector 4B"},{id:"s16",name:"Sector 4C"},{id:"s17",name:"Sector 5A"},{id:"s18",name:"Sector 5B"},{id:"s19",name:"Sector 5C"},{id:"s20",name:"Sector 6A"},{id:"s21",name:"Sector 6B"},{id:"s22",name:"Sector 6C"},{id:"s23",name:"Sector 6D"},{id:"s24",name:"Sector 7A"},{id:"s25",name:"Sector 7B"},{id:"s26",name:"Sector 7C"},{id:"s27",name:"Sector 7D"},{id:"s28",name:"Sector 7E"},{id:"s29",name:"Sector 8A"},{id:"s30",name:"Sector 8B"},{id:"s31",name:"Sector 8C"},{id:"s32",name:"Sector 8D"},{id:"s33",name:"Sector 8E"},{id:"s34",name:"Sector 8F"}],iae={"8x18oz":4.2,"12x18oz":6.31,"6oz":2.12,JMB:3.5,PNT:3.84,Jumbo:3.45,JumboK:3.5,"12x18":6.31,"8x18":4.2,PintasC:3.92,"6x12":2.12,PintaC:3.84,"4oz":1.54,PintaP:3.84,Granel:2.65,"Cubeta 5kg":5};function cs(e,t){return Math.round((iae[e]??0)*t*100)/100}const Gt=[{key:"insectLarva",label:"Insecto / Larva",dbCol:"Insecto",limit:0,group:"zero"},{key:"birdPeck",label:"Picada de pjaro",dbCol:"PicadaPajaro",limit:0,group:"zero"},{key:"rot",label:"Pudricin",dbCol:"Pudricion",limit:.8,group:"low"},{key:"dehydration",label:"Deshidratacin",dbCol:"Deshidratado",limit:5,group:"merma1"},{key:"soft",label:"Blanda",dbCol:"Blanda",limit:5,group:"merma1"},{key:"torn",label:"Rasgada",dbCol:"Rasgada",limit:5,group:"merma1"},{key:"redFruit",label:"Fruta roja",dbCol:"Roja",limit:5,group:"merma2"},{key:"scar",label:"Cicatriz",dbCol:"Cicatrizada",limit:5,group:"merma2"},{key:"stem",label:"Pednculo",dbCol:"Pedunculo",limit:5,group:"merma2"},{key:"smallFruit",label:"Pequea (<11mm)",dbCol:"Pequea",limit:5,group:"merma2"},{key:"floralRemnant",label:"Resto floral",dbCol:"Resto Floral",limit:5,group:"merma2"}],jb=Gt.filter(e=>e.group==="merma1").map(e=>e.key),wb=Gt.filter(e=>e.group==="merma2").map(e=>e.key),U={bg:"#0f0f17",surface:"#1a1a28",card:"#1e1e2e",cardHover:"#252538",input:"#282840",inputBorder:"#3a3a52",inputFocus:"#4f6bf6",border:"#2a2a3e",text:"#f0f0f5",textSecondary:"#9999b0",textMuted:"#666680",accent:"#4f6bf6",accentLight:"#6b83f7",accentDim:"rgba(79,107,246,0.15)",merma:"#f97316",mermaLight:"#fb923c"},qp={excellent:{label:"Excelente",color:"#34d399",bg:"rgba(52,211,153,0.12)",border:"rgba(52,211,153,0.3)"},good:{label:"Buena",color:"#60a5fa",bg:"rgba(96,165,250,0.12)",border:"rgba(96,165,250,0.3)"},medium:{label:"Media",color:"#fbbf24",bg:"rgba(251,191,36,0.12)",border:"rgba(251,191,36,0.3)"},poor:{label:"Baja",color:"#fb923c",bg:"rgba(251,146,60,0.12)",border:"rgba(251,146,60,0.3)"},reject:{label:"Rechazo",color:"#f87171",bg:"rgba(248,113,113,0.12)",border:"rgba(248,113,113,0.3)"}};function Sb(e){return e===0?"excellent":"reject"}function kI(e){return e===0?"excellent":e<=.3?"good":e<=.5?"medium":e<=.8?"poor":"reject"}function CI(e){return e<=1?"excellent":e<=2?"good":e<=3.5?"medium":e<=5?"poor":"reject"}function _I(e){return e<=5?"excellent":e<=8.5?"good":e<=12?"medium":e<=15?"poor":"reject"}const OA={excellent:0,good:1,medium:2,poor:3,reject:4};function sae(e){let t="excellent";for(const r of Object.values(e))OA[r]>OA[t]&&(t=r);return t}function lae(e){const t=Number(e.FrutaTotal)||0,r={},n={},a={};Gt.forEach(u=>{const d=Number(e[u.dbCol])||0;a[u.key]=d,r[u.key]=t>0?Math.round(d/t*100*100)/100:0});const i=Math.round(jb.reduce((u,d)=>u+(r[d]||0),0)*100)/100,s=Math.round(wb.reduce((u,d)=>u+(r[d]||0),0)*100)/100;n.insectLarva=Sb(r.insectLarva),n.birdPeck=Sb(r.birdPeck),n.rot=kI(r.rot);const l=CI(i);jb.forEach(u=>{n[u]=l});const c=_I(s);return wb.forEach(u=>{n[u]=c}),{percentages:r,grades:n,defectCounts:a,overallGrade:sae(n),merma1Sum:i,merma2Sum:s}}function Xr(){return new Date().toLocaleDateString("en-CA",{timeZone:"America/Mexico_City"})}function Jj(){return new Date().toLocaleTimeString("en-US",{timeZone:"America/Mexico_City",hour:"2-digit",minute:"2-digit",hour12:!0})}function Zj(){const e=new Intl.DateTimeFormat("en-CA",{timeZone:"America/Mexico_City",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(new Date),t=r=>{var n;return((n=e.find(a=>a.type===r))==null?void 0:n.value)||"00"};return`${t("hour")}:${t("minute")}:${t("second")}`}function Sd(e){const t=new Date(e+"T12:00:00"),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));const n=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-n.getTime())/864e5+1)/7)}function cae(){return new Date().getFullYear()}function Jf(e,t){const[r,n]=h.useState(t),[a,i]=h.useState(!1);h.useEffect(()=>{(async()=>{try{const l=await window.storage.get(e);l&&l.value&&n(JSON.parse(l.value))}catch{}i(!0)})()},[e]);const s=h.useCallback(async l=>{n(l);try{await window.storage.set(e,JSON.stringify(l))}catch{}},[e]);return[r,s,a]}const Ot={Dashboard:()=>o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]}),Packing:()=>o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"}),o.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),o.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),Quality:()=>o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M9 12l2 2 4-4"}),o.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),Fruit:()=>o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"14",r:"7"}),o.jsx("path",{d:"M12 7c0 0-1-4 0-5 1 1 0 5 0 5z"}),o.jsx("path",{d:"M9.5 8c0 0-3-2-2.5-4 2 0 2.5 4 2.5 4z"})]}),Merma:()=>o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),KPI:()=>o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),o.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),o.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),Plus:()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Trash:()=>o.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[o.jsx("polyline",{points:"3 6 5 6 21 6"}),o.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]}),Eye:()=>o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[o.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Loader:()=>o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",className:"bp-spin",children:o.jsx("path",{d:"M21 12a9 9 0 11-6.219-8.56"})})},dt=({children:e,className:t="",style:r={}})=>o.jsx("div",{className:t,style:{background:U.card,borderRadius:14,border:`1px solid ${U.border}`,padding:22,...r},children:e}),ud=({grade:e})=>{const t=qp[e];return t?o.jsx("span",{style:{display:"inline-block",padding:"3px 10px",borderRadius:20,fontSize:11,fontWeight:700,letterSpacing:.5,background:t.bg,color:t.color,border:`1.5px solid ${t.border}`,textTransform:"uppercase"},children:t.label}):null},ga=({value:e,onChange:t,options:r,placeholder:n,style:a={}})=>o.jsxs("select",{value:e,onChange:i=>t(i.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${U.inputBorder}`,fontSize:14,background:U.input,color:e?U.text:U.textMuted,outline:"none",...a},children:[o.jsx("option",{value:"",children:n||"Seleccionar..."}),r.map(i=>o.jsx("option",{value:i.value,children:i.label},i.value))]}),Yt=({type:e="text",value:t,onChange:r,placeholder:n,style:a={},...i})=>o.jsx("input",{type:e,value:t,onChange:s=>r(s.target.value),placeholder:n,style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${U.inputBorder}`,fontSize:14,outline:"none",boxSizing:"border-box",background:U.input,color:U.text,...a},...i}),Fr=({children:e,onClick:t,variant:r="primary",style:n={},disabled:a=!1})=>{const i={padding:"10px 20px",borderRadius:10,border:"none",fontSize:14,fontWeight:600,cursor:a?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:7,transition:"all 0.15s",opacity:a?.4:1},s={primary:{...i,background:U.accent,color:"#fff"},secondary:{...i,background:U.surface,color:U.textSecondary,border:`1.5px solid ${U.border}`},danger:{...i,background:"rgba(248,113,113,0.1)",color:"#f87171",border:"1.5px solid rgba(248,113,113,0.25)"},ghost:{...i,background:"transparent",color:U.textMuted,padding:"6px 10px"}};return o.jsx("button",{onClick:t,disabled:a,style:{...s[r],...n},children:e})},Je=({children:e})=>o.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:U.textSecondary,marginBottom:6,textTransform:"uppercase",letterSpacing:.6},children:e}),xa=({children:e})=>o.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${Array.isArray(e)?e.filter(Boolean).length:1}, 1fr)`,gap:16,marginBottom:16},children:e}),of=({children:e,action:t})=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[o.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:U.text},children:e}),t]}),af=({message:e})=>o.jsxs("div",{style:{textAlign:"center",padding:"48px 20px",color:U.textMuted},children:[o.jsx("div",{style:{fontSize:40,marginBottom:10,opacity:.5},children:""}),o.jsx("p",{style:{margin:0,fontSize:14},children:e})]}),yn=({label:e,value:t,color:r,sub:n})=>o.jsxs(dt,{children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6},children:e}),o.jsx("div",{style:{fontSize:38,fontWeight:700,color:r||U.accent,marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:t}),n&&o.jsx("div",{style:{fontSize:12,color:U.textMuted,marginTop:6},children:n})]}),ds=({value:e,max:t,color:r=U.accent})=>o.jsx("div",{style:{flex:1,height:8,background:U.input,borderRadius:4,overflow:"hidden",minWidth:60},children:o.jsx("div",{style:{width:`${t>0?Math.min(e/t*100,100):0}%`,height:"100%",background:`linear-gradient(90deg, ${r}, ${r}cc)`,borderRadius:4}})}),dae=({date:e,onChange:t})=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:12,color:U.textMuted,fontWeight:600},children:""}),o.jsx("input",{type:"date",value:e,onChange:r=>t(r.target.value),style:{padding:"7px 12px",borderRadius:8,border:`1.5px solid ${U.inputBorder}`,background:U.input,color:U.text,fontSize:13,outline:"none",fontFamily:"'DM Mono', monospace"}}),e!==Xr()&&o.jsx(Fr,{variant:"ghost",style:{fontSize:11,padding:"4px 8px"},onClick:()=>t(Xr()),children:"Hoy"})]}),uae=`
  * { box-sizing: border-box; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .bp-fade { animation: fadeIn 0.25s ease-out; }
  @keyframes spin { to { transform: rotate(360deg); } }
  .bp-spin { animation: spin 1s linear infinite; }
  select:focus, input:focus { border-color: ${U.inputFocus} !important; box-shadow: 0 0 0 3px rgba(79,107,246,0.2) !important; }
  ::-webkit-scrollbar { width: 6px; height: 6px; } ::-webkit-scrollbar-track { background: ${U.bg}; } ::-webkit-scrollbar-thumb { background: ${U.inputBorder}; border-radius: 3px; }
  table { border-collapse: collapse; width: 100%; }
  th { text-align: left; padding: 11px 14px; font-size: 11px; font-weight: 700; color: ${U.textMuted}; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid ${U.border}; background: ${U.surface}; }
  td { padding: 11px 14px; font-size: 13px; color: ${U.textSecondary}; border-bottom: 1px solid ${U.border}; }
  tr:hover td { background: ${U.cardHover}; }
  option { background: ${U.card}; color: ${U.text}; }
`;function fae(){const[e,t]=h.useState("dashboard"),[r,n]=h.useState(Xr()),[a]=Jf("bp-presentations",rae),[i]=Jf("bp-clients",nae),[s]=Jf("bp-varieties",oae),[l]=Jf("bp-sectors",aae),[c,u]=h.useState([]),[d,f]=h.useState(!0),[p,x]=h.useState([]),[m,y]=h.useState(!0),[j,b]=h.useState([]),[g,v]=h.useState(!0),[w,C]=h.useState([]),[k,S]=h.useState(!0),_=h.useCallback(async()=>{f(!0);try{const{data:L,error:D}=await Gn.from("Muestreos Empaque").select("*").order("Fecha",{ascending:!1});if(D)throw D;u(L||[])}catch(L){console.error(L)}finally{f(!1)}},[]),A=h.useCallback(async()=>{y(!0);try{const{data:L,error:D}=await Gn.from("Calidad Empaque").select("*").neq("tipo","merma").order("FechaHora",{ascending:!1});if(D)throw D;x(L||[])}catch(L){console.error(L)}finally{y(!1)}},[]),E=h.useCallback(async()=>{v(!0);try{const{data:L,error:D}=await Gn.from("Calidad Empaque").select("*").eq("tipo","merma").order("FechaHora",{ascending:!1});if(D)throw D;b(L||[])}catch(L){console.error(L)}finally{v(!1)}},[]),N=h.useCallback(async()=>{S(!0);try{const{data:L,error:D}=await Gn.from("muestreos_fruta").select("*").order("fecha_hora",{ascending:!1});if(D)throw D;C(L||[])}catch(L){console.error(L)}finally{S(!1)}},[]);h.useEffect(()=>{_(),A(),E(),N()},[_,A,E,N]);const $=p.map(L=>{const D=lae(L),O=a.find(q=>q.shortCode===L.Presentacion),F=O&&Number(L.PesoClam)>=O.targetWeight?"pass":"fail";return{...L,...D,weightGrade:F}}),z=j.map(L=>{const D=Number(L.FrutaTotal)||0,O={},F={};return Gt.forEach(q=>{const te=Number(L[q.dbCol])||0;O[q.key]=te,F[q.key]=D>0?Math.round(te/D*100*100)/100:0}),{...L,totalG:D,defectGrams:O,percentages:F}}),T=[{id:"dashboard",label:"Resumen",icon:Ot.Dashboard},{id:"packing",label:"Empaque",icon:Ot.Packing},{id:"quality",label:"Calidad",icon:Ot.Quality},{id:"merma",label:"Merma",icon:Ot.Merma},{id:"fruit",label:"Muestreos Fruta",icon:Ot.Fruit},{id:"kpis",label:"KPIs",icon:Ot.KPI}],I=L=>L==="merma"?U.merma:L==="kpis"?"#a78bfa":U.accent;return o.jsxs("div",{style:{fontFamily:"'DM Sans', sans-serif",background:U.bg,minHeight:"100vh",color:U.text},children:[o.jsx("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap",rel:"stylesheet"}),o.jsx("style",{children:uae}),o.jsxs("nav",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:U.surface,borderBottom:`1px solid ${U.border}`,paddingRight:24},children:[o.jsx("div",{style:{display:"flex",overflowX:"auto"},children:T.map(L=>o.jsxs("button",{onClick:()=>t(L.id),style:{display:"flex",alignItems:"center",gap:7,padding:"14px 20px",border:"none",background:"none",fontSize:14,fontWeight:e===L.id?700:500,cursor:"pointer",color:e===L.id?I(L.id):U.textMuted,transition:"all 0.15s",whiteSpace:"nowrap",borderBottom:e===L.id?`2.5px solid ${I(L.id)}`:"2.5px solid transparent"},children:[o.jsx(L.icon,{}),L.label]},L.id))}),e!=="kpis"&&o.jsx(dae,{date:r,onChange:n})]}),o.jsxs("main",{style:{padding:24,maxWidth:1300,margin:"0 auto"},className:"bp-fade",children:[e==="dashboard"&&o.jsx(hae,{packingEntries:c,qualitySamples:$,mermaSamples:z,fruitSamples:w,presentations:a,clients:i,loading:d||m,selectedDate:r}),e==="packing"&&o.jsx(pae,{entries:c,onRefresh:_,presentations:a,clients:i,varieties:s,loading:d,selectedDate:r}),e==="quality"&&o.jsx(mae,{samples:$,onRefresh:A,presentations:a,clients:i,sectors:l,loading:m,selectedDate:r}),e==="merma"&&o.jsx(gae,{samples:z,onRefresh:E,sectors:l,loading:g,selectedDate:r}),e==="fruit"&&o.jsx(xae,{samples:w,onRefresh:N,sectors:l,varieties:s,loading:k,selectedDate:r}),e==="kpis"&&o.jsx(vae,{packingEntries:c,qualitySamples:$,mermaSamples:z,fruitSamples:w,presentations:a,clients:i})]},e+r)]})}function hae({packingEntries:e,qualitySamples:t,mermaSamples:r,fruitSamples:n,presentations:a,clients:i,loading:s,selectedDate:l}){const c=e.filter(k=>k.Fecha===l),u=t.filter(k=>k.FechaHora&&k.FechaHora.substring(0,10)===l),d=r.filter(k=>k.FechaHora&&k.FechaHora.substring(0,10)===l),f=n.filter(k=>k.fecha_hora&&k.fecha_hora.substring(0,10)===l),p=c.reduce((k,S)=>k+(Number(S.Cantidad_cajas)||0),0),x=c.reduce((k,S)=>k+cs(S.Tipo_embalaje,Number(S.Cantidad_cajas)||0),0),m=d.reduce((k,S)=>k+(Number(S.kg_merma_total)||0),0),y=a.map(k=>({...k,boxes:c.filter(S=>S.Tipo_embalaje===k.shortCode).reduce((S,_)=>S+(Number(_.Cantidad_cajas)||0),0)})),j=i.map(k=>({...k,boxes:c.filter(S=>S.Cliente===k.name).reduce((S,_)=>S+(Number(_.Cantidad_cajas)||0),0)})),b={excellent:0,good:0,medium:0,poor:0,reject:0};u.forEach(k=>{k.overallGrade&&b[k.overallGrade]++});const g={};Gt.forEach(k=>{g[k.key]=u.length>0?Math.round(u.reduce((S,_)=>{var A;return S+(((A=_.percentages)==null?void 0:A[k.key])||0)},0)/u.length*100)/100:0});const v=k=>{const S=g[k.key];return k.group==="zero"?Sb(S):k.group==="low"?kI(S):k.group==="merma1"?CI(Math.round(jb.reduce((_,A)=>_+(g[A]||0),0)*100)/100):_I(Math.round(wb.reduce((_,A)=>_+(g[A]||0),0)*100)/100)},w=f.length>0?Math.round(f.reduce((k,S)=>k+Number(S.grados_brix||0),0)/f.length*100)/100:0,C=Gt.map(k=>{const S=d.reduce((E,N)=>{var $;return E+((($=N.defectGrams)==null?void 0:$[k.key])||0)},0),_=d.reduce((E,N)=>E+(N.totalG||0),0),A=_>0?Math.round(S/_*1e4)/100:0;return{...k,totalG:S,pct:A}}).filter(k=>k.pct>0).sort((k,S)=>S.pct-k.pct).slice(0,5);return o.jsxs("div",{className:"bp-fade",children:[o.jsxs(of,{children:["Resumen  ",l]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[o.jsx(yn,{label:"Cajas Empacadas",value:s?"...":p.toLocaleString()}),o.jsx(yn,{label:"Kg Empacados",value:s?"...":x>0?`${x.toLocaleString(void 0,{maximumFractionDigits:1})} kg`:"",color:"#34d399"}),o.jsx(yn,{label:"Muestreos Calidad",value:u.length}),o.jsx(yn,{label:"Kg Merma del Da",value:m>0?`${m.toFixed(1)} kg`:"",color:U.merma}),o.jsx(yn,{label:"Muestreos Fruta",value:f.length}),o.jsx(yn,{label:"Brix Promedio",value:w>0?`${w}`:"",color:"#34d399"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:24},children:[o.jsxs(dt,{children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Cajas por Presentacin"}),y.map(k=>o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0",borderBottom:`1px solid ${U.border}`},children:[o.jsx("span",{style:{fontSize:14,fontWeight:600,color:U.textSecondary},children:k.shortCode}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("div",{style:{width:110,height:8,background:U.input,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${p?k.boxes/p*100:0}%`,height:"100%",background:`linear-gradient(90deg, ${U.accent}, ${U.accentLight})`,borderRadius:4}})}),o.jsx("span",{style:{fontSize:14,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace",minWidth:44,textAlign:"right"},children:k.boxes})]})]},k.id))]}),o.jsxs(dt,{children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Cajas por Cliente"}),j.map(k=>o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0",borderBottom:`1px solid ${U.border}`},children:[o.jsx("span",{style:{fontSize:14,fontWeight:600,color:U.textSecondary},children:k.name}),o.jsx("span",{style:{fontSize:14,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace"},children:k.boxes})]},k.id+k.name))]})]}),o.jsxs(dt,{style:{marginBottom:24},children:[o.jsxs("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:["Top 5 Defectos de Merma del Da ",o.jsx("span",{style:{fontSize:12,fontWeight:400,color:U.textMuted},children:" % sobre peso del muestreo"})]}),C.length===0?o.jsx("p",{style:{color:U.textMuted,fontSize:14,margin:0},children:"Sin registros de merma para esta fecha."}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:C.map((k,S)=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("span",{style:{fontSize:12,fontWeight:700,color:U.merma,fontFamily:"'DM Mono', monospace",minWidth:22},children:["#",S+1]}),o.jsx("span",{style:{fontSize:13,color:U.textSecondary,minWidth:160},children:k.label}),o.jsx(ds,{value:k.pct,max:C[0].pct,color:U.merma}),o.jsxs("span",{style:{fontSize:14,fontWeight:700,color:U.mermaLight,fontFamily:"'DM Mono', monospace",minWidth:60,textAlign:"right"},children:[k.pct,"%"]}),o.jsxs("span",{style:{fontSize:11,color:U.textMuted,minWidth:60,textAlign:"right"},children:[k.totalG.toFixed(0),"g"]})]},k.key))})]}),o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Distribucin de Calidad"}),u.length===0?o.jsx("p",{style:{color:U.textMuted,fontSize:14},children:"No hay muestreos de calidad en esta fecha."}):o.jsx("div",{style:{display:"flex",gap:12},children:Object.entries(qp).map(([k,S])=>o.jsxs("div",{style:{flex:1,textAlign:"center",padding:16,borderRadius:12,background:S.bg,border:`1.5px solid ${S.border}`},children:[o.jsx("div",{style:{fontSize:28,fontWeight:700,color:S.color,fontFamily:"'DM Mono', monospace"},children:b[k]}),o.jsx("div",{style:{fontSize:11,fontWeight:700,color:S.color,marginTop:4,textTransform:"uppercase",letterSpacing:.5},children:S.label})]},k))})]}),o.jsxs(dt,{children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Promedio de Defectos"}),u.length===0?o.jsx("p",{style:{color:U.textMuted,fontSize:13},children:"Sin datos disponibles."}):o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(165px, 1fr))",gap:12},children:Gt.map(k=>{const S=g[k.key],_=v(k),A=qp[_];return o.jsxs("div",{style:{padding:14,borderRadius:10,background:A.bg,border:`1px solid ${A.border}`},children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.3},children:k.label}),o.jsxs("div",{style:{fontSize:22,fontWeight:700,color:A.color,fontFamily:"'DM Mono', monospace",margin:"6px 0"},children:[S,"%"]}),o.jsxs("div",{style:{fontSize:10,color:A.color,fontWeight:600},children:["Lmite: ",k.group==="merma1"?"5% grp":k.group==="merma2"?"15% grp":k.limit+"%"]})]},k.key)})})]})]})}function pae({entries:e,onRefresh:t,presentations:r,clients:n,varieties:a,loading:i,selectedDate:s}){const[l,c]=h.useState(!1),[u,d]=h.useState(!1),[f,p]=h.useState({clientId:"",presentationId:"",boxCount:"",varietyId:"",fecha:Xr()}),x=(b,g)=>p(v=>({...v,[b]:g})),m=e.filter(b=>b.Fecha===s),y=async()=>{if(!f.clientId||!f.presentationId||!f.boxCount||!f.fecha){oe.error("Complete todos los campos requeridos");return}const b=n.find(w=>w.id===f.clientId),g=r.find(w=>w.id===f.presentationId),v=a.find(w=>w.id===f.varietyId);d(!0);try{const{error:w}=await Gn.from("Muestreos Empaque").insert({Semana:Sd(f.fecha),Fecha:f.fecha,Cliente:(b==null?void 0:b.name)||"",Cantidad_cajas:parseInt(f.boxCount),Tipo_embalaje:(g==null?void 0:g.shortCode)||"",Variedad:(v==null?void 0:v.name)||""});if(w)throw w;oe.success("Registro guardado"),p({clientId:"",presentationId:"",boxCount:"",varietyId:"",fecha:Xr()}),c(!1),t()}catch(w){console.error(w),oe.error("Error al guardar")}finally{d(!1)}},j=async b=>{try{const{error:g}=await Gn.from("Muestreos Empaque").delete().eq("ID",b);if(g)throw g;oe.success("Eliminado"),t()}catch{oe.error("Error")}};return o.jsxs("div",{className:"bp-fade",children:[o.jsxs(of,{action:o.jsxs(Fr,{onClick:()=>c(!l),children:[o.jsx(Ot.Plus,{}),l?"Cancelar":"Nuevo Registro"]}),children:[" Registro de Empaque ",o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:U.textMuted,marginLeft:8},children:["(",m.length," registros)"]})]}),l&&o.jsxs(dt,{className:"bp-fade",style:{marginBottom:20},children:[o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Fecha"}),o.jsx(Yt,{type:"date",value:f.fecha,onChange:b=>x("fecha",b)})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Cliente"}),o.jsx(ga,{value:f.clientId,onChange:b=>x("clientId",b),options:n.map(b=>({value:b.id,label:b.name})),placeholder:"Seleccionar cliente..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Presentacin"}),o.jsx(ga,{value:f.presentationId,onChange:b=>x("presentationId",b),options:r.map(b=>({value:b.id,label:b.shortCode})),placeholder:"Seleccionar..."})]})]}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Cantidad de Cajas"}),o.jsx(Yt,{type:"number",value:f.boxCount,onChange:b=>x("boxCount",b),placeholder:"0",min:"0"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Variedad"}),o.jsx(ga,{value:f.varietyId,onChange:b=>x("varietyId",b),options:a.map(b=>({value:b.id,label:b.name})),placeholder:"Seleccionar..."})]})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:o.jsx(Fr,{onClick:y,disabled:u||!f.clientId||!f.presentationId||!f.boxCount,style:{padding:"12px 32px"},children:u?o.jsxs(o.Fragment,{children:[o.jsx(Ot.Loader,{}),"Guardando..."]}):" Guardar"})})]}),o.jsx(dt,{children:i?o.jsxs("div",{style:{textAlign:"center",padding:40,color:U.textMuted},children:[o.jsx(Ot.Loader,{}),"Cargando..."]}):m.length===0?o.jsx(af,{message:`No hay registros de empaque para ${s}.`}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Sem."}),o.jsx("th",{children:"Fecha"}),o.jsx("th",{children:"Cliente"}),o.jsx("th",{children:"Presentacin"}),o.jsx("th",{children:"Cajas"}),o.jsx("th",{children:"Kg"}),o.jsx("th",{children:"Variedad"}),o.jsx("th",{})]})}),o.jsx("tbody",{children:m.map(b=>{const g=cs(b.Tipo_embalaje,Number(b.Cantidad_cajas)||0);return o.jsxs("tr",{children:[o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:b.Semana}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:b.Fecha}),o.jsx("td",{style:{fontWeight:600,color:U.text},children:b.Cliente}),o.jsx("td",{children:o.jsx("span",{style:{background:U.accentDim,color:U.accentLight,padding:"4px 10px",borderRadius:8,fontSize:12,fontWeight:700},children:b.Tipo_embalaje})}),o.jsx("td",{style:{fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.text,fontSize:15},children:b.Cantidad_cajas}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",color:"#34d399",fontWeight:600},children:g>0?`${g.toLocaleString(void 0,{maximumFractionDigits:1})} kg`:""}),o.jsx("td",{children:b.Variedad||""}),o.jsx("td",{children:o.jsx(Fr,{variant:"ghost",onClick:()=>j(b.ID),children:o.jsx(Ot.Trash,{})})})]},b.ID)})})]})})})]})}function mae({samples:e,onRefresh:t,presentations:r,clients:n,sectors:a,loading:i,selectedDate:s}){var C,k;const[l,c]=h.useState(!1),[u,d]=h.useState(!1),[f,p]=h.useState(null),x=Object.fromEntries(Gt.map(S=>[S.key,""])),[m,y]=h.useState({fecha:Xr(),sectorId:"",presentationId:"",clientId:"",inspector:"",totalFruitCount:"",clamWeight:"",defects:{...x}}),j=(S,_)=>y(A=>({...A,[S]:_})),b=(S,_)=>y(A=>({...A,defects:{...A.defects,[S]:_}})),g=e.filter(S=>S.FechaHora&&S.FechaHora.substring(0,10)===s),v=async()=>{if(!m.presentationId||!m.totalFruitCount){oe.error("Complete la presentacin y el conteo de frutas");return}const S=n.find(N=>N.id===m.clientId),_=r.find(N=>N.id===m.presentationId),A=a.find(N=>N.id===m.sectorId),E={FechaHora:`${m.fecha}T${Zj()}`,tipo:"calidad",Sector:(A==null?void 0:A.name)||"",Cliente:(S==null?void 0:S.name)||"",Presentacion:(_==null?void 0:_.shortCode)||"",NombreInsp:m.inspector||"",FrutaTotal:parseInt(m.totalFruitCount)||0,PesoClam:parseInt(m.clamWeight)||0};Gt.forEach(N=>{E[N.dbCol]=parseInt(m.defects[N.key])||0}),d(!0);try{const{error:N}=await Gn.from("Calidad Empaque").insert(E);if(N)throw N;oe.success("Muestreo guardado"),y({fecha:Xr(),sectorId:"",presentationId:"",clientId:"",inspector:"",totalFruitCount:"",clamWeight:"",defects:{...x}}),c(!1),t()}catch(N){console.error(N),oe.error("Error al guardar")}finally{d(!1)}},w=async S=>{try{const{error:_}=await Gn.from("Calidad Empaque").delete().eq("id",S);if(_)throw _;oe.success("Eliminado"),t()}catch{oe.error("Error")}};if(f!==null){const S=g.find(A=>A.id===f)||e.find(A=>A.id===f);if(!S)return o.jsxs(dt,{children:[o.jsx("p",{style:{color:U.textMuted},children:"Muestreo no encontrado."}),o.jsx(Fr,{variant:"secondary",onClick:()=>p(null),children:" Volver"})]});const _=S.FechaHora?new Date(S.FechaHora).toLocaleString("es-MX",{timeZone:"America/Mexico_City"}):"";return o.jsxs("div",{className:"bp-fade",children:[o.jsx(Fr,{variant:"secondary",onClick:()=>p(null),style:{marginBottom:16},children:" Volver a lista"}),o.jsxs(dt,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:14,marginBottom:24},children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Fecha/Hora"}),o.jsx("div",{style:{fontSize:14,fontWeight:600,color:U.text},children:_})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Sector"}),o.jsx("div",{style:{fontSize:14,color:U.text},children:S.Sector||""})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Cliente"}),o.jsx("div",{style:{fontSize:14,fontWeight:600,color:U.text},children:S.Cliente||""})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Presentacin"}),o.jsx("span",{style:{background:U.accentDim,color:U.accentLight,padding:"4px 10px",borderRadius:8,fontSize:12,fontWeight:700},children:S.Presentacion})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:14,marginBottom:24},children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Total Frutas"}),o.jsx("div",{style:{fontSize:26,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace"},children:S.FrutaTotal})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Clam"}),o.jsxs("div",{style:{fontSize:26,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace"},children:[S.PesoClam,"g"]})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Peso"}),o.jsx("div",{style:{padding:"6px 12px",borderRadius:8,display:"inline-block",fontWeight:700,fontSize:13,background:S.weightGrade==="pass"?"rgba(52,211,153,0.12)":"rgba(248,113,113,0.12)",color:S.weightGrade==="pass"?"#34d399":"#f87171"},children:S.weightGrade==="pass"?" Cumple":" No cumple"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Grado General"}),o.jsx(ud,{grade:S.overallGrade})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:14,marginBottom:24},children:[o.jsxs("div",{style:{background:U.surface,padding:16,borderRadius:12,border:`1px solid ${U.border}`},children:[o.jsx(Je,{children:"Merma 1  Deshidrat. + Blanda + Rasgada"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:4},children:[o.jsxs("span",{style:{fontSize:22,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace"},children:[S.merma1Sum,"%"]}),o.jsx("span",{style:{fontSize:12,color:U.textMuted},children:"/ 5%"}),o.jsx(ud,{grade:((C=S.grades)==null?void 0:C.dehydration)||"excellent"})]})]}),o.jsxs("div",{style:{background:U.surface,padding:16,borderRadius:12,border:`1px solid ${U.border}`},children:[o.jsx(Je,{children:"Merma 2  Roja + Cicat. + Ped. + Peq. + Floral"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:4},children:[o.jsxs("span",{style:{fontSize:22,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace"},children:[S.merma2Sum,"%"]}),o.jsx("span",{style:{fontSize:12,color:U.textMuted},children:"/ 15%"}),o.jsx(ud,{grade:((k=S.grades)==null?void 0:k.redFruit)||"excellent"})]})]})]}),o.jsx("h4",{style:{margin:"0 0 14px",fontSize:15,fontWeight:700,color:U.text},children:"Desglose de Defectos"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Defecto"}),o.jsx("th",{children:"Cantidad"}),o.jsx("th",{children:"Porcentaje"}),o.jsx("th",{children:"Lmite"}),o.jsx("th",{children:"Grado"})]})}),o.jsx("tbody",{children:Gt.map(A=>o.jsxs("tr",{children:[o.jsxs("td",{style:{fontWeight:600,color:U.text},children:[A.label,A.group==="merma1"?o.jsx("span",{style:{fontSize:9,color:U.accent,marginLeft:4},children:"M1"}):A.group==="merma2"?o.jsx("span",{style:{fontSize:9,color:U.accent,marginLeft:4},children:"M2"}):null]}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:S.defectCounts[A.key]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace"},children:[S.percentages[A.key],"%"]}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",color:U.textMuted},children:A.group==="merma1"?"5% grp":A.group==="merma2"?"15% grp":A.limit+"%"}),o.jsx("td",{children:o.jsx(ud,{grade:S.grades[A.key]})})]},A.key))})]})})]})]})}return o.jsxs("div",{className:"bp-fade",children:[o.jsxs(of,{action:o.jsxs(Fr,{onClick:()=>c(!l),children:[o.jsx(Ot.Plus,{}),l?"Cancelar":"Nuevo Muestreo"]}),children:[" Control de Calidad ",o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:U.textMuted,marginLeft:8},children:["(",g.length," muestreos)"]})]}),l&&o.jsxs(dt,{className:"bp-fade",style:{marginBottom:20},children:[o.jsx("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:18},children:o.jsxs("div",{style:{fontSize:12,color:U.textMuted,fontFamily:"'DM Mono', monospace",background:U.input,padding:"5px 12px",borderRadius:8},children:[" Ahora: ",Xr(),"  ",Jj()]})}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Fecha del Muestreo"}),o.jsx(Yt,{type:"date",value:m.fecha,onChange:S=>j("fecha",S)})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Sector"}),o.jsx(ga,{value:m.sectorId,onChange:S=>j("sectorId",S),options:a.map(S=>({value:S.id,label:S.name})),placeholder:"Seleccionar..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Cliente"}),o.jsx(ga,{value:m.clientId,onChange:S=>j("clientId",S),options:n.map(S=>({value:S.id,label:S.name})),placeholder:"Seleccionar..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Presentacin"}),o.jsx(ga,{value:m.presentationId,onChange:S=>j("presentationId",S),options:r.map(S=>({value:S.id,label:S.shortCode})),placeholder:"Seleccionar..."})]})]}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Inspector"}),o.jsx(Yt,{value:m.inspector,onChange:S=>j("inspector",S),placeholder:"Nombre..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Total Frutas"}),o.jsx(Yt,{type:"number",value:m.totalFruitCount,onChange:S=>j("totalFruitCount",S),placeholder:"ej. 250",min:"0"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Clam (g)"}),o.jsx(Yt,{type:"number",value:m.clamWeight,onChange:S=>j("clamWeight",S),placeholder:"ej. 525",min:"0"})]})]}),o.jsx("h4",{style:{margin:"6px 0 14px",fontSize:14,fontWeight:700,color:U.text,borderTop:`1px solid ${U.border}`,paddingTop:16},children:"Conteo de Defectos"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:18},children:Gt.map(S=>o.jsxs("div",{style:{background:U.surface,padding:"12px 14px",borderRadius:10,border:`1px solid ${U.border}`},children:[o.jsxs("label",{style:{display:"block",fontSize:10,fontWeight:700,color:U.textMuted,marginBottom:6,textTransform:"uppercase",letterSpacing:.3},children:[S.label," ",o.jsxs("span",{style:{opacity:.6},children:["(",S.group==="merma1"?"5% grp":S.group==="merma2"?"15% grp":S.limit+"%",")"]})]}),o.jsx(Yt,{type:"number",value:m.defects[S.key],onChange:_=>b(S.key,_),placeholder:"0",min:"0"})]},S.key))}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:o.jsx(Fr,{onClick:v,disabled:u||!m.fecha||!m.presentationId||!m.totalFruitCount,style:{padding:"12px 32px"},children:u?o.jsxs(o.Fragment,{children:[o.jsx(Ot.Loader,{}),"Guardando..."]}):" Guardar"})})]}),o.jsx(dt,{children:i?o.jsxs("div",{style:{textAlign:"center",padding:40,color:U.textMuted},children:[o.jsx(Ot.Loader,{}),"Cargando..."]}):g.length===0?o.jsx(af,{message:`No hay muestreos de calidad para ${s}.`}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Fecha/Hora"}),o.jsx("th",{children:"Sector"}),o.jsx("th",{children:"Cliente"}),o.jsx("th",{children:"Pres."}),o.jsx("th",{children:"Frutas"}),o.jsx("th",{children:"Peso"}),o.jsx("th",{children:"Grado"}),o.jsx("th",{}),o.jsx("th",{})]})}),o.jsx("tbody",{children:g.map(S=>{const _=S.FechaHora?new Date(S.FechaHora).toLocaleString("es-MX",{timeZone:"America/Mexico_City",day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return o.jsxs("tr",{children:[o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:_}),o.jsx("td",{children:S.Sector||""}),o.jsx("td",{style:{fontWeight:600,color:U.text},children:S.Cliente||""}),o.jsx("td",{children:o.jsx("span",{style:{background:U.accentDim,color:U.accentLight,padding:"4px 10px",borderRadius:8,fontSize:12,fontWeight:700},children:S.Presentacion||""})}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:S.FrutaTotal}),o.jsxs("td",{children:[o.jsxs("span",{style:{fontFamily:"'DM Mono', monospace"},children:[S.PesoClam,"g"]}),S.weightGrade==="fail"&&o.jsx("span",{style:{color:"#f87171",fontSize:11,marginLeft:4},children:""})]}),o.jsx("td",{children:o.jsx(ud,{grade:S.overallGrade})}),o.jsx("td",{children:o.jsx(Fr,{variant:"ghost",onClick:()=>p(S.id),children:o.jsx(Ot.Eye,{})})}),o.jsx("td",{children:o.jsx(Fr,{variant:"ghost",onClick:()=>w(S.id),children:o.jsx(Ot.Trash,{})})})]},S.id)})})]})})})]})}function gae({samples:e,onRefresh:t,sectors:r,loading:n,selectedDate:a}){const[i,s]=h.useState(!1),[l,c]=h.useState(!1),u=Object.fromEntries(Gt.map(v=>[v.key,""])),[d,f]=h.useState({fecha:Xr(),sectorId:"",inspector:"",totalWeightG:"",kgMermaTotal:"",defects:{...u}}),p=(v,w)=>f(C=>({...C,[v]:w})),x=(v,w)=>f(C=>({...C,defects:{...C.defects,[v]:w}})),m=e.filter(v=>v.FechaHora&&v.FechaHora.substring(0,10)===a),y=m.reduce((v,w)=>v+(Number(w.kg_merma_total)||0),0),j=Gt.map(v=>{const w=m.reduce((S,_)=>{var A;return S+(((A=_.defectGrams)==null?void 0:A[v.key])||0)},0),C=m.reduce((S,_)=>S+(_.totalG||0),0),k=C>0?Math.round(w/C*1e4)/100:0;return{...v,totalG:w,pct:k}}).filter(v=>v.pct>0).sort((v,w)=>w.pct-v.pct).slice(0,5),b=async()=>{if(!d.totalWeightG){oe.error("Ingresa el peso total del muestreo en gramos");return}const v=r.find(C=>C.id===d.sectorId),w={FechaHora:`${d.fecha}T${Zj()}`,tipo:"merma",Sector:(v==null?void 0:v.name)||"",NombreInsp:d.inspector||"",FrutaTotal:parseFloat(d.totalWeightG)||0,kg_merma_total:parseFloat(d.kgMermaTotal)||null,Cliente:"",Presentacion:"",PesoClam:0};Gt.forEach(C=>{w[C.dbCol]=parseFloat(d.defects[C.key])||0}),c(!0);try{const{error:C}=await Gn.from("Calidad Empaque").insert(w);if(C)throw C;oe.success("Registro de merma guardado"),f({fecha:Xr(),sectorId:"",inspector:"",totalWeightG:"",kgMermaTotal:"",defects:{...u}}),s(!1),t()}catch(C){console.error(C),oe.error("Error al guardar")}finally{c(!1)}},g=async v=>{try{const{error:w}=await Gn.from("Calidad Empaque").delete().eq("id",v);if(w)throw w;oe.success("Eliminado"),t()}catch{oe.error("Error")}};return o.jsxs("div",{className:"bp-fade",children:[o.jsx(of,{action:o.jsxs(Fr,{onClick:()=>s(!i),style:{background:U.merma},children:[o.jsx(Ot.Plus,{}),i?"Cancelar":"Nuevo Registro"]}),children:o.jsxs("span",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx("span",{style:{color:U.merma},children:""})," Merma de Empaque",o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:U.textMuted},children:["(",m.length," registros hoy)"]})]})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 2fr",gap:16,marginBottom:24},children:[o.jsx(yn,{label:"Kg Merma Total Hoy",value:y>0?`${y.toFixed(1)} kg`:"",color:U.merma}),o.jsx(yn,{label:"Registros del Da",value:m.length,color:U.mermaLight}),o.jsxs(dt,{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6,marginBottom:12},children:["Top 5 Defectos del Da ",o.jsx("span",{style:{fontSize:10,color:U.textMuted,fontWeight:400},children:" % sobre peso muestreo"})]}),j.length===0?o.jsx("div",{style:{fontSize:20,fontWeight:700,color:U.textMuted},children:""}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:j.map((v,w)=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsxs("span",{style:{fontSize:11,fontWeight:700,color:U.merma,minWidth:20,fontFamily:"'DM Mono', monospace"},children:["#",w+1]}),o.jsx("span",{style:{fontSize:12,color:U.textSecondary,minWidth:130},children:v.label}),o.jsx(ds,{value:v.pct,max:j[0].pct,color:U.merma}),o.jsxs("span",{style:{fontSize:13,fontWeight:700,color:U.mermaLight,fontFamily:"'DM Mono', monospace",minWidth:50,textAlign:"right"},children:[v.pct,"%"]}),o.jsxs("span",{style:{fontSize:11,color:U.textMuted,minWidth:46,textAlign:"right"},children:[v.totalG.toFixed(0),"g"]})]},v.key))})]})]}),i&&o.jsxs(dt,{className:"bp-fade",style:{marginBottom:20,border:`1.5px solid ${U.merma}44`},children:[o.jsx("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:18},children:o.jsxs("div",{style:{fontSize:12,color:U.textMuted,fontFamily:"'DM Mono', monospace",background:U.input,padding:"5px 12px",borderRadius:8},children:[" Ahora: ",Xr(),"  ",Jj()]})}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Fecha del Registro"}),o.jsx(Yt,{type:"date",value:d.fecha,onChange:v=>p("fecha",v),style:{borderColor:U.merma+"66"}})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Sector"}),o.jsx(ga,{value:d.sectorId,onChange:v=>p("sectorId",v),options:r.map(v=>({value:v.id,label:v.name})),placeholder:"Seleccionar..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Inspector"}),o.jsx(Yt,{value:d.inspector,onChange:v=>p("inspector",v),placeholder:"Nombre..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Kg Merma Total del Da"}),o.jsx(Yt,{type:"number",value:d.kgMermaTotal,onChange:v=>p("kgMermaTotal",v),placeholder:"ej. 45.5",min:"0",step:"0.1",style:{borderColor:U.merma+"66"}}),o.jsx("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:"Kilogramos totales de merma del empaque en el da"})]})]}),o.jsx(xa,{children:o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Total del Muestreo (g)"}),o.jsx(Yt,{type:"number",value:d.totalWeightG,onChange:v=>p("totalWeightG",v),placeholder:"ej. 1500",min:"1",step:"0.1"}),o.jsx("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:"Peso total en gramos de todas las frutas del muestreo"})]})}),o.jsxs("div",{style:{borderTop:`1px solid ${U.border}`,paddingTop:16,marginTop:4},children:[o.jsxs("h4",{style:{margin:"0 0 14px",fontSize:14,fontWeight:700,color:U.text},children:["Peso de Defectos (g) ",o.jsx("span",{style:{fontSize:12,fontWeight:400,color:U.textMuted,marginLeft:6},children:" Gramos de cada defecto sobre el total del muestreo"})]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:18},children:Gt.map(v=>{const w=d.totalWeightG&&parseFloat(d.defects[v.key])>0?Math.round(parseFloat(d.defects[v.key])/parseFloat(d.totalWeightG)*1e4)/100:null;return o.jsxs("div",{style:{background:U.surface,padding:"12px 14px",borderRadius:10,border:`1px solid ${U.border}`},children:[o.jsx("label",{style:{display:"block",fontSize:10,fontWeight:700,color:U.textMuted,marginBottom:6,textTransform:"uppercase",letterSpacing:.3},children:v.label}),o.jsx(Yt,{type:"number",value:d.defects[v.key],onChange:C=>x(v.key,C),placeholder:"0",min:"0",step:"0.1"}),w!==null&&o.jsxs("div",{style:{fontSize:11,color:U.mermaLight,marginTop:4,fontFamily:"'DM Mono', monospace"},children:[w,"%"]})]},v.key)})})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:o.jsx(Fr,{onClick:b,disabled:l||!d.totalWeightG,style:{padding:"12px 32px",background:U.merma},children:l?o.jsxs(o.Fragment,{children:[o.jsx(Ot.Loader,{}),"Guardando..."]}):" Guardar Registro"})})]}),o.jsx(dt,{children:n?o.jsxs("div",{style:{textAlign:"center",padding:40,color:U.textMuted},children:[o.jsx(Ot.Loader,{}),"Cargando..."]}):m.length===0?o.jsx(af,{message:`No hay registros de merma para ${a}.`}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Hora"}),o.jsx("th",{children:"Sector"}),o.jsx("th",{children:"Inspector"}),o.jsx("th",{children:"Kg Merma"}),o.jsx("th",{children:"Peso Muestra (g)"}),Gt.map(v=>o.jsx("th",{style:{minWidth:120},children:v.label},v.key)),o.jsx("th",{})]})}),o.jsx("tbody",{children:m.map(v=>{const w=v.FechaHora?new Date(v.FechaHora).toLocaleTimeString("es-MX",{timeZone:"America/Mexico_City",hour:"2-digit",minute:"2-digit"}):"";return o.jsxs("tr",{children:[o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:w}),o.jsx("td",{children:v.Sector||""}),o.jsx("td",{style:{fontSize:12,color:U.textMuted},children:v.NombreInsp||""}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontWeight:700,color:U.merma},children:v.kg_merma_total?`${Number(v.kg_merma_total).toFixed(1)} kg`:""}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:v.totalG>0?`${v.totalG.toFixed(0)}g`:""}),Gt.map(C=>o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12},children:v.defectGrams[C.key]>0?o.jsxs("span",{children:[v.defectGrams[C.key].toFixed(0),"g",o.jsxs("span",{style:{color:U.mermaLight,fontSize:10,marginLeft:4},children:["(",v.percentages[C.key],"%)"]})]}):o.jsx("span",{style:{color:U.textMuted},children:""})},C.key)),o.jsx("td",{children:o.jsx(Fr,{variant:"ghost",onClick:()=>g(v.id),children:o.jsx(Ot.Trash,{})})})]},v.id)})})]})})})]})}function xae({samples:e,onRefresh:t,sectors:r,varieties:n,loading:a,selectedDate:i}){const[s,l]=h.useState(!1),[c,u]=h.useState(!1),[d,f]=h.useState({fecha:Xr(),sectorId:"",varietyId:"",inspector:"",brix:"",pesoTotal:"",totalFrutas:"",jumbo18:"",jumbo19:"",notas:""}),p=(_,A)=>f(E=>({...E,[_]:A})),x=e.filter(_=>_.fecha_hora&&_.fecha_hora.substring(0,10)===i),m=x.reduce((_,A)=>_+Number(A.peso_fruta_g||0),0),y=x.reduce((_,A)=>_+Number(A.total_frutas||0),0),j=y>0?Math.round(m/y*100)/100:0,b=x.reduce((_,A)=>_+Number(A.frutas_jumbo_18mm||0),0),g=x.reduce((_,A)=>_+Number(A.frutas_jumbo_19mm||0),0),v=m>0?Math.round(b/m*1e3)/10:0,w=m>0?Math.round(g/m*1e3)/10:0,C=x.length>0?Math.round(x.reduce((_,A)=>_+Number(A.grados_brix||0),0)/x.length*100)/100:0,k=async()=>{if(!d.sectorId||!d.varietyId||!d.brix||!d.pesoTotal||!d.totalFrutas){oe.error("Complete sector, variedad, brix, peso y total frutas");return}const _=r.find(E=>E.id===d.sectorId),A=n.find(E=>E.id===d.varietyId);u(!0);try{const{error:E}=await Gn.from("muestreos_fruta").insert({fecha_hora:`${d.fecha}T${Zj()}`,sector:(_==null?void 0:_.name)||"",variedad:(A==null?void 0:A.name)||"",inspector:d.inspector||"",grados_brix:parseFloat(d.brix)||0,peso_fruta_g:parseFloat(d.pesoTotal)||0,total_frutas:parseInt(d.totalFrutas)||1,frutas_jumbo_18mm:parseFloat(d.jumbo18)||0,frutas_jumbo_19mm:parseFloat(d.jumbo19)||0,notas:d.notas||""});if(E)throw E;oe.success("Muestreo de fruta guardado"),f({fecha:Xr(),sectorId:"",varietyId:"",inspector:"",brix:"",pesoTotal:"",totalFrutas:"",jumbo18:"",jumbo19:"",notas:""}),l(!1),t()}catch(E){console.error(E),oe.error("Error al guardar")}finally{u(!1)}},S=async _=>{try{const{error:A}=await Gn.from("muestreos_fruta").delete().eq("id",_);if(A)throw A;oe.success("Eliminado"),t()}catch{oe.error("Error")}};return o.jsxs("div",{className:"bp-fade",children:[o.jsxs(of,{action:o.jsxs(Fr,{onClick:()=>l(!s),children:[o.jsx(Ot.Plus,{}),s?"Cancelar":"Nuevo Muestreo"]}),children:[" Muestreos de Fruta ",o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:U.textMuted,marginLeft:8},children:["(",x.length," registros)"]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:24},children:[o.jsxs(dt,{children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"Grados Brix (prom)"}),o.jsx("div",{style:{fontSize:36,fontWeight:700,color:"#34d399",marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:C>0?`${C}`:""})]}),o.jsxs(dt,{children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"Peso Prom. / Fruta"}),o.jsx("div",{style:{fontSize:36,fontWeight:700,color:"#60a5fa",marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:j>0?`${j}g`:""}),o.jsx("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:"PesoTotal / #Frutas"})]}),o.jsxs(dt,{children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"% Jumbo +18mm"}),o.jsx("div",{style:{fontSize:36,fontWeight:700,color:"#fbbf24",marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:x.length>0?`${v}%`:""}),o.jsxs("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:[b.toFixed(0),"g / ",m.toFixed(0),"g"]})]}),o.jsxs(dt,{children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"% Jumbo +19mm"}),o.jsx("div",{style:{fontSize:36,fontWeight:700,color:"#fb923c",marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:x.length>0?`${w}%`:""}),o.jsxs("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:[g.toFixed(0),"g / ",m.toFixed(0),"g"]})]})]}),x.length>0&&(()=>{const _={};return x.forEach(A=>{const E=A.variedad||"Sin var.";_[E]||(_[E]=[]),_[E].push(A)}),o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Mtricas por Variedad"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Variedad"}),o.jsx("th",{children:"Muestreos"}),o.jsx("th",{children:"Brix Prom."}),o.jsx("th",{children:"Peso Prom. (g/fruta)"}),o.jsx("th",{children:"% J+18mm"}),o.jsx("th",{children:"% J+19mm"})]})}),o.jsx("tbody",{children:Object.entries(_).map(([A,E])=>{const N=Math.round(E.reduce((D,O)=>D+Number(O.grados_brix),0)/E.length*100)/100,$=E.reduce((D,O)=>D+Number(O.peso_fruta_g),0),z=E.reduce((D,O)=>D+Number(O.total_frutas),0),T=z>0?Math.round($/z*100)/100:0,I=E.reduce((D,O)=>D+Number(O.frutas_jumbo_18mm),0),L=E.reduce((D,O)=>D+Number(O.frutas_jumbo_19mm),0);return o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:600,color:U.text},children:A}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:E.length}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#34d399",fontWeight:700},children:[N,""]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace"},children:[T,"g"]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#fbbf24"},children:[$>0?Math.round(I/$*1e3)/10:0,"%"]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#fb923c"},children:[$>0?Math.round(L/$*1e3)/10:0,"%"]})]},A)})})]})})]})})(),s&&o.jsxs(dt,{className:"bp-fade",style:{marginBottom:20},children:[o.jsx("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:18},children:o.jsxs("div",{style:{fontSize:12,color:U.textMuted,fontFamily:"'DM Mono', monospace",background:U.input,padding:"5px 12px",borderRadius:8},children:[" Fecha y hora actual: ",o.jsxs("strong",{style:{color:U.textSecondary},children:[Xr(),"  ",Jj()]})]})}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Fecha del Muestreo"}),o.jsx(Yt,{type:"date",value:d.fecha,onChange:_=>p("fecha",_)}),o.jsx("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:"Fecha que se registrar en la BD"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Sector"}),o.jsx(ga,{value:d.sectorId,onChange:_=>p("sectorId",_),options:r.map(_=>({value:_.id,label:_.name})),placeholder:"Seleccionar..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Variedad"}),o.jsx(ga,{value:d.varietyId,onChange:_=>p("varietyId",_),options:n.map(_=>({value:_.id,label:_.name})),placeholder:"Seleccionar..."})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Inspector"}),o.jsx(Yt,{value:d.inspector,onChange:_=>p("inspector",_),placeholder:"Nombre..."})]})]}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Grados Brix"}),o.jsx(Yt,{type:"number",value:d.brix,onChange:_=>p("brix",_),placeholder:"ej. 12.5",min:"0",max:"35",step:"0.1"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Total Muestra (g)"}),o.jsx(Yt,{type:"number",value:d.pesoTotal,onChange:_=>p("pesoTotal",_),placeholder:"ej. 1050",min:"0",step:"0.1"}),o.jsx("div",{style:{fontSize:11,color:U.textMuted,marginTop:4},children:"Peso de todas las frutas juntas"})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Total Frutas Muestra"}),o.jsx(Yt,{type:"number",value:d.totalFrutas,onChange:_=>p("totalFrutas",_),placeholder:"ej. 50",min:"1"})]})]}),o.jsxs(xa,{children:[o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Jumbo +18mm (g)"}),o.jsx(Yt,{type:"number",value:d.jumbo18,onChange:_=>p("jumbo18",_),placeholder:"0",min:"0",step:"0.1"}),d.pesoTotal&&parseFloat(d.jumbo18)>0&&o.jsxs("div",{style:{fontSize:11,color:"#fbbf24",marginTop:4,fontFamily:"'DM Mono', monospace"},children:["%J18 = ",Math.round(parseFloat(d.jumbo18)/parseFloat(d.pesoTotal)*1e3)/10,"%"]})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Peso Jumbo +19mm (g)"}),o.jsx(Yt,{type:"number",value:d.jumbo19,onChange:_=>p("jumbo19",_),placeholder:"0",min:"0",step:"0.1"}),d.pesoTotal&&parseFloat(d.jumbo19)>0&&o.jsxs("div",{style:{fontSize:11,color:"#fb923c",marginTop:4,fontFamily:"'DM Mono', monospace"},children:["%J19 = ",Math.round(parseFloat(d.jumbo19)/parseFloat(d.pesoTotal)*1e3)/10,"%"]})]}),o.jsxs("div",{children:[o.jsx(Je,{children:"Notas"}),o.jsx(Yt,{value:d.notas,onChange:_=>p("notas",_),placeholder:"Observaciones..."})]})]}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:o.jsx(Fr,{onClick:k,disabled:c||!d.fecha||!d.sectorId||!d.varietyId||!d.brix||!d.pesoTotal||!d.totalFrutas,style:{padding:"12px 32px"},children:c?o.jsxs(o.Fragment,{children:[o.jsx(Ot.Loader,{}),"Guardando..."]}):" Guardar"})})]}),o.jsx(dt,{children:a?o.jsxs("div",{style:{textAlign:"center",padding:40,color:U.textMuted},children:[o.jsx(Ot.Loader,{}),"Cargando..."]}):x.length===0?o.jsx(af,{message:`No hay muestreos de fruta para ${i}.`}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Hora"}),o.jsx("th",{children:"Sector"}),o.jsx("th",{children:"Variedad"}),o.jsx("th",{children:"Brix"}),o.jsx("th",{children:"Peso Total (g)"}),o.jsx("th",{children:"Frutas"}),o.jsx("th",{children:"g/Fruta"}),o.jsx("th",{children:"J+18mm"}),o.jsx("th",{children:"J+19mm"}),o.jsx("th",{children:"Inspector"}),o.jsx("th",{})]})}),o.jsx("tbody",{children:x.map(_=>{const A=_.fecha_hora?new Date(_.fecha_hora).toLocaleTimeString("es-MX",{timeZone:"America/Mexico_City",hour:"2-digit",minute:"2-digit"}):"",E=Number(_.peso_fruta_g||0),N=Number(_.total_frutas||0),$=N>0?Math.round(E/N*100)/100:0,z=E>0?Math.round(Number(_.frutas_jumbo_18mm)/E*1e3)/10:0,T=E>0?Math.round(Number(_.frutas_jumbo_19mm)/E*1e3)/10:0;return o.jsxs("tr",{children:[o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:A}),o.jsx("td",{children:_.sector}),o.jsx("td",{style:{fontWeight:600,color:U.text},children:_.variedad}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",fontWeight:700,color:"#34d399"},children:[_.grados_brix,""]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#60a5fa",fontWeight:600},children:[E.toFixed(1),"g"]}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:N}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",color:U.textSecondary},children:$>0?`${$}g`:""}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#fbbf24"},children:[Number(_.frutas_jumbo_18mm).toFixed(0),"g ",o.jsxs("span",{style:{fontSize:10,color:U.textMuted},children:["(",z,"%)"]})]}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",color:"#fb923c"},children:[Number(_.frutas_jumbo_19mm).toFixed(0),"g ",o.jsxs("span",{style:{fontSize:10,color:U.textMuted},children:["(",T,"%)"]})]}),o.jsx("td",{style:{fontSize:12,color:U.textMuted},children:_.inspector||""}),o.jsx("td",{children:o.jsx(Fr,{variant:"ghost",onClick:()=>S(_.id),children:o.jsx(Ot.Trash,{})})})]},_.id)})})]})})})]})}function vae({packingEntries:e,qualitySamples:t,mermaSamples:r,fruitSamples:n,presentations:a,clients:i}){const s=cae(),l=Sd(Xr()),[c,u]=h.useState(s-1),[d,f]=h.useState(40),[p,x]=h.useState(s),[m,y]=h.useState(l),j=[s-2,s-1,s,s+1].map(R=>({value:R,label:String(R)})),b=Array.from({length:52},(R,Y)=>({value:Y+1,label:`Sem. ${Y+1}`})),g=(R,Y)=>R*100+Y,v=g(c,d),w=g(p,m);function C(R){if(!R)return!1;const Y=R.substring(0,10),ge=new Date(Y+"T12:00:00").getFullYear(),de=Sd(Y),Oe=g(ge,de);return Oe>=v&&Oe<=w}const k=e.filter(R=>C(R.Fecha)),S=t.filter(R=>{var Y;return C((Y=R.FechaHora)==null?void 0:Y.substring(0,10))}),_=r.filter(R=>{var Y;return C((Y=R.FechaHora)==null?void 0:Y.substring(0,10))}),A=n.filter(R=>{var Y;return C((Y=R.fecha_hora)==null?void 0:Y.substring(0,10))}),E=k.reduce((R,Y)=>R+(Number(Y.Cantidad_cajas)||0),0),N=k.reduce((R,Y)=>R+cs(Y.Tipo_embalaje,Number(Y.Cantidad_cajas)||0),0),$={};k.forEach(R=>{const Y=R.Cliente||"",ge=R.Tipo_embalaje||"",de=Number(R.Cantidad_cajas)||0,Oe=cs(ge,de);$[Y]||($[Y]={cajas:0,kg:0,pres:[]}),$[Y].cajas+=de,$[Y].kg+=Oe;const be=$[Y].pres.find(Ue=>Ue.pres===ge);be?(be.cajas+=de,be.kg+=Oe):$[Y].pres.push({pres:ge,cajas:de,kg:Oe})});const z=Object.entries($).map(([R,Y])=>({name:R,...Y,pres:Y.pres.sort((ge,de)=>de.cajas-ge.cajas)})).sort((R,Y)=>Y.cajas-R.cajas),T=a.map(R=>({code:R.shortCode,cajas:k.filter(Y=>Y.Tipo_embalaje===R.shortCode).reduce((Y,ge)=>Y+(Number(ge.Cantidad_cajas)||0),0),kg:k.filter(Y=>Y.Tipo_embalaje===R.shortCode).reduce((Y,ge)=>Y+cs(R.shortCode,Number(ge.Cantidad_cajas)||0),0)})).filter(R=>R.cajas>0).sort((R,Y)=>Y.cajas-R.cajas),I={};k.forEach(R=>{const Y=new Date((R.Fecha||"")+"T12:00:00").getFullYear(),ge=R.Semana||Sd(R.Fecha||""),de=`${Y}-${String(ge).padStart(2,"0")}`,Oe=R.Tipo_embalaje||"",be=Number(R.Cantidad_cajas)||0,Ue=cs(Oe,be);I[de]||(I[de]={cajas:0,kg:0,byPres:{}}),I[de].cajas+=be,I[de].kg+=Ue,I[de].byPres[Oe]||(I[de].byPres[Oe]={cajas:0,kg:0}),I[de].byPres[Oe].cajas+=be,I[de].byPres[Oe].kg+=Ue});const L=Object.entries(I).sort((R,Y)=>R[0].localeCompare(Y[0])),D=[...new Set(k.map(R=>R.Tipo_embalaje).filter(Boolean))].sort();Math.max(...L.map(([,R])=>R.kg),1);const O=_.reduce((R,Y)=>R+(Number(Y.kg_merma_total)||0),0),F={};_.forEach(R=>{var be;const Y=((be=R.FechaHora)==null?void 0:be.substring(0,10))||"";if(!Y)return;const ge=new Date(Y+"T12:00:00").getFullYear(),de=Sd(Y),Oe=`${ge}-${String(de).padStart(2,"0")}`;F[Oe]=(F[Oe]||0)+(Number(R.kg_merma_total)||0)});const q=Object.entries(F).sort((R,Y)=>R[0].localeCompare(Y[0])),te=Math.max(...q.map(([,R])=>R),1),H=_.reduce((R,Y)=>R+(Y.totalG||0),0),K=Gt.map(R=>{const Y=_.reduce((de,Oe)=>{var be;return de+(((be=Oe.defectGrams)==null?void 0:be[R.key])||0)},0),ge=H>0?Math.round(Y/H*1e4)/100:0;return{...R,totalG:Y,pct:ge}}).filter(R=>R.pct>0).sort((R,Y)=>Y.pct-R.pct).slice(0,5),Z=Math.max(...K.map(R=>R.pct),1),he=Gt.map(R=>{const Y=_.reduce((de,Oe)=>{var be;return de+(((be=Oe.defectGrams)==null?void 0:be[R.key])||0)},0),ge=H>0?Math.round(Y/H*1e4)/100:0;return{...R,totalG:Y,pct:ge}}).filter(R=>R.totalG>0).sort((R,Y)=>Y.pct-R.pct),re=Math.max(...he.map(R=>R.pct),1),X={excellent:0,good:0,medium:0,poor:0,reject:0};S.forEach(R=>{R.overallGrade&&X[R.overallGrade]++});const V=S.length,J=V>0?Math.round(X.excellent/V*100):0,ne=V>0?Math.round(X.reject/V*100):0,Q=A.length>0?Math.round(A.reduce((R,Y)=>R+Number(Y.grados_brix||0),0)/A.length*100)/100:0,me={};Gt.forEach(R=>{me[R.key]=V>0?Math.round(S.reduce((Y,ge)=>{var de;return Y+(((de=ge.percentages)==null?void 0:de[R.key])||0)},0)/V*100)/100:0});const ue=Gt.map(R=>({...R,avg:me[R.key]})).sort((R,Y)=>Y.avg-R.avg),W=Math.max(...ue.map(R=>R.avg),1),ae=k.length===0&&S.length===0&&_.length===0,we=v>w,ve=({emoji:R,title:Y,color:ge=U.accent})=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,margin:"32px 0 16px",paddingBottom:12,borderBottom:`2px solid ${ge}44`},children:[o.jsx("span",{style:{fontSize:22},children:R}),o.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:U.text},children:Y}),o.jsx("div",{style:{flex:1,height:2,background:`linear-gradient(90deg, ${ge}44, transparent)`,borderRadius:2}})]}),G={padding:"7px 12px",borderRadius:8,border:`1.5px solid ${U.inputBorder}`,background:U.input,color:U.text,fontSize:13,outline:"none",fontFamily:"'DM Mono', monospace"};return o.jsxs("div",{className:"bp-fade",children:[o.jsxs(dt,{style:{marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6},children:"Desde"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("select",{value:c,onChange:R=>u(Number(R.target.value)),style:G,children:j.map(R=>o.jsx("option",{value:R.value,children:R.label},R.value))}),o.jsx("select",{value:d,onChange:R=>f(Number(R.target.value)),style:{...G,minWidth:90},children:b.map(R=>o.jsx("option",{value:R.value,children:R.label},R.value))})]})]}),o.jsx("div",{style:{color:U.textMuted,fontSize:20,marginTop:16},children:""}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6},children:"Hasta"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("select",{value:p,onChange:R=>x(Number(R.target.value)),style:G,children:j.map(R=>o.jsx("option",{value:R.value,children:R.label},R.value))}),o.jsx("select",{value:m,onChange:R=>y(Number(R.target.value)),style:{...G,minWidth:90},children:b.map(R=>o.jsx("option",{value:R.value,children:R.label},R.value))})]})]}),o.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",gap:6},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6},children:"Atajos de ciclo"}),o.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[{label:"Ciclo actual",yf:s-1,wf:40,yt:s,wt:l},{label:"Ciclo anterior",yf:s-2,wf:40,yt:s-1,wt:22},{label:"ltimas 8 sem.",yf:l-7>0?s:s-1,wf:(()=>{const R=l-7;return R>0?R:52+(l-7)})(),yt:s,wt:l},{label:"Este ao",yf:s,wf:1,yt:s,wt:52}].map(R=>{const Y=c===R.yf&&d===R.wf&&p===R.yt&&m===R.wt;return o.jsx("button",{onClick:()=>{u(R.yf),f(R.wf),x(R.yt),y(R.wt)},style:{padding:"6px 12px",borderRadius:8,border:`1.5px solid ${Y?U.accent:U.inputBorder}`,background:Y?U.accent:U.input,color:Y?"#fff":U.textMuted,fontSize:12,fontWeight:600,cursor:"pointer"},children:R.label},R.label)})})]})]}),we&&o.jsx("div",{style:{marginTop:12,padding:"8px 14px",borderRadius:8,background:"rgba(248,113,113,0.1)",border:"1px solid rgba(248,113,113,0.3)",color:"#f87171",fontSize:13},children:" La fecha de inicio es posterior a la fecha fin. Ajusta el rango."})]}),o.jsxs("div",{style:{fontSize:13,color:U.textMuted,marginBottom:24,paddingLeft:4},children:[k.length," reg. empaque  ",V," muestreos calidad  ",_.length," reg. merma  ",A.length," muestreos fruta",o.jsxs("span",{style:{marginLeft:16,color:U.accent},children:[E.toLocaleString()," cajas  ",N.toLocaleString(void 0,{maximumFractionDigits:0})," kg"]})]}),(ae||we)&&!we&&o.jsx(af,{message:"No hay datos en el perodo seleccionado."}),!ae&&!we&&o.jsxs(o.Fragment,{children:[o.jsx(ve,{emoji:"",title:"Produccin  Empaque",color:U.accent}),o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 16px",fontSize:15,fontWeight:700,color:U.text},children:"Distribucin por Cliente y Presentacin"}),z.length===0?o.jsx("p",{style:{color:U.textMuted,fontSize:13},children:"Sin datos"}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Cliente"}),o.jsx("th",{children:"Presentacin"}),o.jsx("th",{style:{textAlign:"right"},children:"Cajas"}),o.jsx("th",{style:{textAlign:"right"},children:"Kg"}),o.jsx("th",{style:{textAlign:"right"},children:"% Cajas"})]})}),o.jsxs("tbody",{children:[z.map(R=>o.jsxs(o.Fragment,{children:[R.pres.map((Y,ge)=>o.jsxs("tr",{children:[ge===0&&o.jsx("td",{rowSpan:R.pres.length+1,style:{fontWeight:700,color:U.text,verticalAlign:"top",paddingTop:14,borderRight:`1px solid ${U.border}`},children:R.name}),o.jsx("td",{children:o.jsx("span",{style:{background:U.accentDim,color:U.accentLight,padding:"3px 8px",borderRadius:6,fontSize:12,fontWeight:700},children:Y.pres})}),o.jsx("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",fontWeight:600,color:U.text},children:Y.cajas.toLocaleString()}),o.jsxs("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",color:"#34d399"},children:[Y.kg.toLocaleString(void 0,{maximumFractionDigits:0})," kg"]}),o.jsxs("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",color:U.textMuted,fontSize:12},children:[E>0?Math.round(Y.cajas/E*100):0,"%"]})]},`${R.name}-${Y.pres}`)),o.jsxs("tr",{style:{borderTop:`1.5px solid ${U.accent}33`},children:[o.jsx("td",{colSpan:1,style:{fontSize:11,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.4},children:"Subtotal"}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.text,fontSize:14},children:R.cajas.toLocaleString()}),o.jsxs("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:"#34d399",fontSize:14},children:[R.kg.toLocaleString(void 0,{maximumFractionDigits:0})," kg"]}),o.jsxs("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",fontWeight:700,color:U.accent,fontSize:12},children:[E>0?Math.round(R.cajas/E*100):0,"%"]})]})]})),o.jsxs("tr",{style:{borderTop:`2px solid ${U.accent}66`,background:U.surface},children:[o.jsx("td",{colSpan:2,style:{fontWeight:700,color:U.text,fontSize:13},children:"TOTAL GENERAL"}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.accent,fontSize:15},children:E.toLocaleString()}),o.jsxs("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:"#34d399",fontSize:15},children:[N.toLocaleString(void 0,{maximumFractionDigits:0})," kg"]}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,color:U.textMuted},children:"100%"})]})]})]})})]}),T.length>0&&o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:"Cajas y Kg por Presentacin"}),T.map(R=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:14},children:[o.jsx("div",{style:{fontSize:13,fontWeight:700,color:U.accentLight,background:U.accentDim,padding:"3px 10px",borderRadius:8,minWidth:80,textAlign:"center"},children:R.code}),o.jsx(ds,{value:R.cajas,max:T[0].cajas,color:U.accentLight}),o.jsx("span",{style:{fontSize:14,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace",minWidth:60,textAlign:"right"},children:R.cajas.toLocaleString()}),o.jsxs("span",{style:{fontSize:12,color:"#34d399",fontFamily:"'DM Mono', monospace",minWidth:80,textAlign:"right"},children:[R.kg.toLocaleString(void 0,{maximumFractionDigits:0})," kg"]}),o.jsxs("span",{style:{fontSize:12,color:U.textMuted,minWidth:38,textAlign:"right"},children:[E>0?Math.round(R.cajas/E*100):0,"%"]})]},R.code))]}),L.length>0&&o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:"Produccin por Semana  Cajas y Kg por Presentacin"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsxs("thead",{children:[o.jsxs("tr",{children:[o.jsx("th",{style:{minWidth:80},children:"Semana"}),D.map(R=>o.jsx("th",{style:{minWidth:120,textAlign:"center"},colSpan:2,children:o.jsx("span",{style:{background:U.accentDim,color:U.accentLight,padding:"2px 8px",borderRadius:6},children:R})},R)),o.jsx("th",{style:{minWidth:80,textAlign:"right"},children:"Total Cajas"}),o.jsx("th",{style:{minWidth:80,textAlign:"right"},children:"Total Kg"})]}),o.jsxs("tr",{children:[o.jsx("th",{}),D.map(R=>o.jsxs(o.Fragment,{children:[o.jsx("th",{style:{textAlign:"right",fontSize:10},children:"Cajas"},R+"-c"),o.jsx("th",{style:{textAlign:"right",fontSize:10,color:"#34d399"},children:"Kg"},R+"-k")]})),o.jsx("th",{}),o.jsx("th",{})]})]}),o.jsxs("tbody",{children:[L.map(([R,Y])=>{const[ge]=R.split("-"),de=R.split("-")[1];return o.jsxs("tr",{children:[o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:U.textMuted},children:[o.jsxs("span",{style:{fontSize:10,color:U.textMuted},children:[ge," "]}),"Sem.",parseInt(de)]}),D.map(Oe=>{const be=Y.byPres[Oe];return o.jsxs(o.Fragment,{children:[o.jsx("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",color:be?U.text:U.textMuted},children:be?be.cajas.toLocaleString():""},Oe+"-c"),o.jsx("td",{style:{textAlign:"right",fontFamily:"'DM Mono', monospace",color:be?"#34d399":U.textMuted,fontSize:12},children:be?be.kg.toLocaleString(void 0,{maximumFractionDigits:0}):""},Oe+"-k")]})}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.accent},children:Y.cajas.toLocaleString()}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:"#34d399"},children:Y.kg.toLocaleString(void 0,{maximumFractionDigits:0})})]},R)}),o.jsxs("tr",{style:{borderTop:`2px solid ${U.accent}66`,background:U.surface},children:[o.jsx("td",{style:{fontWeight:700,color:U.text,fontSize:12},children:"TOTAL"}),D.map(R=>{const Y=k.filter(de=>de.Tipo_embalaje===R).reduce((de,Oe)=>de+(Number(Oe.Cantidad_cajas)||0),0),ge=k.filter(de=>de.Tipo_embalaje===R).reduce((de,Oe)=>de+cs(R,Number(Oe.Cantidad_cajas)||0),0);return o.jsxs(o.Fragment,{children:[o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.accent},children:Y.toLocaleString()},R+"-ct"),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:"#34d399"},children:ge.toLocaleString(void 0,{maximumFractionDigits:0})},R+"-kt")]})}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:U.accent,fontSize:15},children:E.toLocaleString()}),o.jsx("td",{style:{textAlign:"right",fontWeight:700,fontFamily:"'DM Mono', monospace",color:"#34d399",fontSize:15},children:N.toLocaleString(void 0,{maximumFractionDigits:0})})]})]})]})})]}),o.jsx(ve,{emoji:"",title:"Merma de Empaque",color:U.merma}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:20,marginBottom:24},children:[o.jsx(yn,{label:"Total Kg Merma",value:O>0?`${O.toFixed(1)} kg`:"",color:U.merma}),o.jsxs(dt,{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:U.textMuted,textTransform:"uppercase",letterSpacing:.6,marginBottom:12},children:["Top 5 Defectos del Perodo ",o.jsx("span",{style:{fontWeight:400,fontSize:10},children:" % sobre peso total del muestreo"})]}),K.length===0?o.jsx("div",{style:{fontSize:20,fontWeight:700,color:U.textMuted},children:""}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:K.map((R,Y)=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("span",{style:{fontSize:11,fontWeight:700,color:U.merma,minWidth:22,fontFamily:"'DM Mono', monospace"},children:["#",Y+1]}),o.jsx("span",{style:{fontSize:13,color:U.textSecondary,minWidth:160},children:R.label}),o.jsx(ds,{value:R.pct,max:Z,color:U.merma}),o.jsxs("span",{style:{fontSize:14,fontWeight:700,color:U.mermaLight,fontFamily:"'DM Mono', monospace",minWidth:55,textAlign:"right"},children:[R.pct,"%"]}),o.jsxs("span",{style:{fontSize:11,color:U.textMuted,minWidth:60,textAlign:"right"},children:[R.totalG.toFixed(0),"g"]})]},R.key))})]})]}),q.length>0&&o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:"Kg Merma por Semana"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:q.map(([R,Y])=>{const[ge,de]=R.split("-");return o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("span",{style:{fontSize:12,color:U.textMuted,fontFamily:"'DM Mono', monospace",minWidth:100},children:[o.jsxs("span",{style:{fontSize:10},children:[ge," "]}),"Sem. ",parseInt(de)]}),o.jsx(ds,{value:Y,max:te,color:U.merma}),o.jsxs("span",{style:{fontSize:14,fontWeight:700,color:U.merma,fontFamily:"'DM Mono', monospace",minWidth:72,textAlign:"right"},children:[Y.toFixed(1)," kg"]})]},R)})})]}),he.length>0&&o.jsxs(dt,{style:{marginBottom:24},children:[o.jsxs("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:["Desglose de Defectos  Merma Empaque ",o.jsx("span",{style:{fontSize:12,fontWeight:400,color:U.textMuted},children:"% sobre peso total del muestreo"})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:he.map(R=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("span",{style:{fontSize:13,color:U.textSecondary,minWidth:170},children:R.label}),o.jsx(ds,{value:R.pct,max:re,color:U.mermaLight}),o.jsxs("span",{style:{fontSize:13,fontWeight:700,color:U.mermaLight,fontFamily:"'DM Mono', monospace",minWidth:55,textAlign:"right"},children:[R.pct,"%"]}),o.jsxs("span",{style:{fontSize:12,color:U.textMuted,fontFamily:"'DM Mono', monospace",minWidth:65,textAlign:"right"},children:[R.totalG.toFixed(0),"g"]})]},R.key))})]}),o.jsx(ve,{emoji:"",title:"Control de Calidad",color:"#60a5fa"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[o.jsx(yn,{label:"Muestreos Calidad",value:V,color:"#60a5fa"}),o.jsx(yn,{label:"% Excelente",value:V>0?`${J}%`:"",color:"#34d399"}),o.jsx(yn,{label:"% Rechazo",value:V>0?`${ne}%`:"",color:"#f87171"}),o.jsx(yn,{label:"Brix Promedio",value:Q>0?`${Q}`:"",color:"#34d399"})]}),V>0&&o.jsxs(dt,{style:{marginBottom:24},children:[o.jsx("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:"Distribucin de Grados de Calidad"}),o.jsx("div",{style:{display:"flex",gap:12},children:Object.entries(qp).map(([R,Y])=>o.jsxs("div",{style:{flex:1,textAlign:"center",padding:16,borderRadius:12,background:Y.bg,border:`1.5px solid ${Y.border}`},children:[o.jsx("div",{style:{fontSize:30,fontWeight:700,color:Y.color,fontFamily:"'DM Mono', monospace"},children:X[R]}),o.jsx("div",{style:{fontSize:11,fontWeight:700,color:Y.color,marginTop:4,textTransform:"uppercase",letterSpacing:.5},children:Y.label}),o.jsxs("div",{style:{fontSize:12,color:Y.color,opacity:.7,marginTop:2},children:[V>0?Math.round(X[R]/V*100):0,"%"]})]},R))})]}),V>0&&ue.some(R=>R.avg>0)&&o.jsxs(dt,{style:{marginBottom:32},children:[o.jsx("h3",{style:{margin:"0 0 18px",fontSize:15,fontWeight:700,color:U.text},children:"Promedio de Defectos  Calidad Empaque"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:ue.map(R=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("span",{style:{fontSize:13,color:U.textSecondary,minWidth:160},children:R.label}),o.jsx(ds,{value:R.avg,max:W,color:"#60a5fa"}),o.jsxs("span",{style:{fontSize:13,fontWeight:700,color:U.text,fontFamily:"'DM Mono', monospace",minWidth:50,textAlign:"right"},children:[R.avg,"%"]}),o.jsxs("span",{style:{fontSize:11,color:U.textMuted,minWidth:70,textAlign:"right"},children:["lm: ",R.group==="merma1"?"5% grp":R.group==="merma2"?"15% grp":R.limit+"%"]})]},R.key))})]})]})]})}const yae=({level:e=0,tankId:t})=>{const r=Math.min(100,Math.max(0,e)),n=`calc(100% - ${r}% - 1%)`,a={9:{low:20,medium:40},default:{low:20,medium:40}},{low:i,medium:s}=a[t]||a.default;let l="#29ABE2",c="#0000FF";return r>s?(l="#29ABE2",c="#0000FF"):r>=i?(l="#FFFF00",c="#FFD700"):(l="#FF0000",c="#8B0000"),o.jsxs("div",{className:"relative w-40 h-64 border-2 border-gray-600 border-t-0 rounded-b-lg overflow-hidden",children:[o.jsx("div",{className:"absolute w-full h-full overflow-hidden",children:o.jsxs("svg",{className:"absolute w-[300%] h-full animate-waves",style:{top:n},viewBox:"0 0 200 100",children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:`waterGradient-${t}`,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[o.jsx("stop",{offset:"0",stopColor:l}),o.jsx("stop",{offset:"1",stopColor:c})]})}),o.jsx("path",{fill:`url(#waterGradient-${t})`,d:`M 0,0 v 100 h 200 v -100 
              c -10,0 -15,5 -25,5 c -10,0 -15,-5 -25,-5
              c -10,0 -15,5 -25,5 c -10,0 -15,-5 -25,-5
              c -10,0 -15,5 -25,5 c -10,0 -15,-5 -25,-5
              c -10,0 -15,5 -25,5 c -10,0 -15,-5 -25,-5`})]})}),o.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-white text-2xl font-bold pointer-events-none",children:[r.toFixed(0),"%"]}),o.jsx("div",{className:"absolute right-0 bg-gray-600 h-1 w-4 bottom-[25%]"}),o.jsx("div",{className:"absolute right-0 bg-gray-600 h-1 w-4 bottom-[50%]"}),o.jsx("div",{className:"absolute right-0 bg-gray-600 h-1 w-4 bottom-[75%]"})]})},Zf=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),TA=[{id:1,name:"Tanque 1",nutrient:"Biloxi",capacity:2500,product:`Sulfatos
Fosfatos
Nitratos
Micros`},{id:2,name:"Tanque 2",nutrient:"Biloxi",capacity:2500,product:`Nitrato de calcio
Nitrato de magnesio`},{id:3,name:"Tanque 3",nutrient:"AZRA 4s",capacity:2500,product:`Sulfatos
Fosfatos
Nitratos
Micros`},{id:4,name:"Tanque 4",nutrient:"AZRA 4s",capacity:2500,product:`Nitrato de calcio
Nitrato de magnesio`},{id:5,name:"Tanque 5",nutrient:"AZRA 3s y 5s",capacity:2500,product:`Sulfatos
Fosfatos
Nitratos
Micros`},{id:6,name:"Tanque 6",nutrient:"AZRA 3s y 5s",capacity:2500,product:`Nitrato de calcio
Nitrato de magnesio`},{id:7,name:"Tanque 7",nutrient:"AZRA 6s y 7s",capacity:2500,product:`Sulfatos
Fosfatos
Nitratos
Micros`},{id:8,name:"Tanque 8",nutrient:"AZRA 6s y 7s",capacity:2500,product:`Nitrato de calcio
Nitrato de magnesio`},{id:9,name:"cido",nutrient:"",capacity:1e3,product:""}],bae=e=>{const t=new Date(e);t.setDate(t.getDate()+3-(t.getDay()+6)%7);const r=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-r.getTime())/864e5-3+(r.getDay()+6)%7)/7)},jae=()=>{const{session:e}=xM(),[t,r]=h.useState({}),[n,a]=h.useState({}),[i,s]=h.useState({}),[l,c]=h.useState(!0),[u,d]=h.useState(!1),[f,p]=h.useState([]);h.useEffect(()=>{e&&Zf.auth.setSession(e),x()},[e]);const x=async()=>{try{const{data:v,error:w}=await Zf.from("TanquesNutricion").select("*").order("Timestamp",{ascending:!1}).range(0,9999);if(w)throw w;const C={},k={},S=new Set;v.forEach(_=>{const A=parseInt(_.Tanque);S.has(A)||(C[A]=_.Nivel||0,k[A]=_.Fecha||"Sin fecha",S.add(A))}),r(C),a(k)}catch(v){console.error("Error fetching levels:",v),or.error("Error al cargar niveles de tanques")}finally{c(!1)}},m=async()=>{try{const{data:v,error:w}=await Zf.from("TanquesNutricion").select("*").eq("Llenado",!0).order("Fecha",{ascending:!1}).range(0,9999);if(w)throw w;p(v)}catch(v){console.error("Error fetching bitacora:",v),or.error("Error al cargar bitcora")}},y=(v,w)=>{let C=parseFloat(w);isNaN(C)&&(C=0),C=Math.max(0,Math.min(100,C)),s(k=>({...k,[v]:C}))},j=async()=>{try{const v=new Date().toISOString().split("T")[0],w=new Date(v),C=bae(w),k=new Date().toISOString(),S=Object.entries(i).map(([A,E])=>({Semana:C,Fecha:v,Tanque:A.toString(),Nivel:E,Llenado:E===100,Timestamp:k})),{error:_}=await Zf.from("TanquesNutricion").insert(S);if(_)throw _;or.success("Niveles actualizados"),x(),s({})}catch(v){console.error("Error saving levels:",v),or.error("Error al guardar niveles")}};if(l)return o.jsx("div",{children:"Cargando..."});const g=[...new Set(f.map(v=>v.Fecha))].sort((v,w)=>new Date(w).getTime()-new Date(v).getTime()).map(v=>{const w={Fecha:v};return f.filter(C=>C.Fecha===v).forEach(C=>{var _;const k=parseInt(C.Tanque),S=((_=TA.find(A=>A.id===k))==null?void 0:_.name)||`Tanque ${k}`;w[S]="X"}),w});return o.jsxs("div",{className:"p-8 bg-gray-900 text-white overflow-hidden",children:[o.jsx(M0,{}),o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-3xl",children:"Tanques de Nutricin"}),o.jsx("button",{onClick:()=>{m(),d(!0)},className:"bg-green-500 px-4 py-2 rounded text-white",children:"Bitacora llenado"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 overflow-hidden",children:TA.map(v=>{const w=t[v.id]||0,C=n[v.id]||"Sin fecha",k=v.product.split(`
`);return o.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex flex-col",children:[o.jsxs("h2",{className:"text-xl mb-4",children:[v.name," ",v.nutrient?`(${v.nutrient})`:""]}),o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-1",children:o.jsx(yae,{level:w,capacity:v.capacity,tankId:v.id})}),o.jsxs("div",{className:"flex-1 pl-4",children:[o.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["ltimo registro: ",C]}),k.map((S,_)=>o.jsx("p",{className:"text-sm",children:S},_))]})]}),o.jsx("input",{type:"number",min:"0",max:"100",value:i[v.id]||"",placeholder:"Porcentaje restante",className:"mt-4 p-2 bg-gray-700 text-white rounded w-full",onChange:S=>y(v.id,S.target.value),onWheel:S=>S.currentTarget.blur()})]},v.id)})}),o.jsx("button",{onClick:j,className:"mt-8 bg-blue-500 px-6 py-2 rounded",children:"Guardar Niveles Diarios"}),u&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg w-[95vw] h-[90vh] overflow-auto",children:[o.jsx("h2",{className:"text-2xl mb-4",children:"Bitcora de Llenado"}),o.jsxs("table",{className:"w-full text-left border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-700",children:[o.jsx("th",{className:"p-2 border-b",children:"Fecha"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 1"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 2"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 3"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 4"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 5"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 6"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 7"}),o.jsx("th",{className:"p-2 border-b",children:"Tanque 8"}),o.jsx("th",{className:"p-2 border-b",children:"cido"})]})}),o.jsxs("tbody",{children:[g.map((v,w)=>o.jsxs("tr",{className:"hover:bg-gray-700",children:[o.jsx("td",{className:"p-2 border-b",children:v.Fecha}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 1"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 2"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 3"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 4"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 5"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 6"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 7"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v["Tanque 8"]||""}),o.jsx("td",{className:"p-2 border-b text-center",children:v.cido||""})]},w)),g.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:10,className:"p-2 text-center",children:"No hay registros de llenado"})})]})]}),o.jsx("button",{onClick:()=>d(!1),className:"mt-4 bg-red-500 px-4 py-2 rounded",children:"Cerrar"})]})})]})},Ee={bg:"#0f0f17",surface:"#1a1a28",card:"#1e1e2e",cardHover:"#252538",input:"#282840",inputBorder:"#3a3a52",inputFocus:"#4f6bf6",border:"#2a2a3e",text:"#f0f0f5",textSecondary:"#9999b0",textMuted:"#666680",accent:"#4f6bf6",accentLight:"#6b83f7",accentDim:"rgba(79,107,246,0.15)"},Ud={"Materiales de Empaque":{icon:"",label:"Materiales de Empaque",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Agroqumicos:{icon:"",label:"Agroqumicos",hasReorderPoint:!1,hasStockAlerts:!1,allowSubcategories:!0,subcategoriesLocked:!0,fixedSubcategories:["Fungicidas","Insecticidas","Bioestimulantes","Coadyuvantes"]},Fertilizantes:{icon:"",label:"Fertilizantes",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1,protectedSubcategories:["Macronutrientes","Micronutrientes"]},Riego:{icon:"",label:"Riego",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Fumigacin:{icon:"",label:"Fumigacin",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Herramientas:{icon:"",label:"Herramientas y Equipo",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Combustibles:{icon:"",label:"Combustibles",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!1,subcategoriesLocked:!0}},Jx=Object.keys(Ud),wae=[{value:"pza",label:"Pieza (pza)"},{value:"kg",label:"Kilogramo (kg)"},{value:"L",label:"Litro (L)"},{value:"m",label:"Metro (m)"},{value:"rollo",label:"Rollo"},{value:"caja",label:"Caja"},{value:"par",label:"Par"},{value:"bolsa",label:"Bolsa"},{value:"paq",label:"Paquete"}];function Kp(){const e=new Intl.DateTimeFormat("en-CA",{timeZone:"America/Mexico_City",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(new Date),t=r=>{var n;return((n=e.find(a=>a.type===r))==null?void 0:n.value)||"00"};return`${t("year")}-${t("month")}-${t("day")}T${t("hour")}:${t("minute")}:${t("second")}`}const Zx=({children:e,style:t={}})=>o.jsx("div",{style:{background:Ee.card,borderRadius:14,border:`1px solid ${Ee.border}`,padding:22,...t},children:e}),ta=({children:e,onClick:t,variant:r="primary",style:n={},disabled:a=!1})=>{const i={padding:"10px 20px",borderRadius:10,border:"none",fontSize:14,fontWeight:600,cursor:a?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:7,transition:"all 0.15s",opacity:a?.4:1},s={primary:{...i,background:Ee.accent,color:"#fff"},secondary:{...i,background:Ee.surface,color:Ee.textSecondary,border:`1.5px solid ${Ee.border}`},danger:{...i,background:"rgba(248,113,113,0.1)",color:"#f87171",border:"1.5px solid rgba(248,113,113,0.25)"},ghost:{...i,background:"transparent",color:Ee.textMuted,padding:"6px 10px"}};return o.jsx("button",{onClick:t,disabled:a,style:{...s[r],...n},children:e})},xl=({type:e="text",value:t,onChange:r,placeholder:n,style:a={},...i})=>o.jsx("input",{type:e,value:t,onChange:s=>r(s.target.value),placeholder:n,style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${Ee.inputBorder}`,fontSize:14,outline:"none",boxSizing:"border-box",background:Ee.input,color:Ee.text,...a},...i}),LA=({value:e,onChange:t,options:r,placeholder:n,style:a={}})=>o.jsxs("select",{value:e,onChange:i=>t(i.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${Ee.inputBorder}`,fontSize:14,background:Ee.input,color:e?Ee.text:Ee.textMuted,outline:"none",...a},children:[o.jsx("option",{value:"",children:n||"Seleccionar..."}),r.map(i=>o.jsx("option",{value:i.value,children:i.label},i.value))]}),es=({children:e})=>o.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:Ee.textSecondary,marginBottom:6,textTransform:"uppercase",letterSpacing:.6},children:e}),Qf=({children:e,color:t,bg:r})=>o.jsx("span",{style:{display:"inline-block",padding:"2px 10px",borderRadius:12,fontSize:11,fontWeight:700,background:r,color:t},children:e}),Sae=`
  * { box-sizing: border-box; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .inv-fade { animation: fadeIn 0.25s ease-out; }
  select:focus, input:focus { border-color: ${Ee.inputFocus} !important; box-shadow: 0 0 0 3px rgba(79,107,246,0.2) !important; }
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: ${Ee.bg}; }
  ::-webkit-scrollbar-thumb { background: ${Ee.inputBorder}; border-radius: 3px; }
  table { border-collapse: collapse; width: 100%; }
  th { text-align: left; padding: 11px 14px; font-size: 11px; font-weight: 700; color: ${Ee.textMuted}; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid ${Ee.border}; background: ${Ee.surface}; }
  td { padding: 11px 14px; font-size: 13px; color: ${Ee.textSecondary}; border-bottom: 1px solid ${Ee.border}; }
  tr:hover td { background: ${Ee.cardHover}; }
  option { background: ${Ee.card}; color: ${Ee.text}; }
`;function kae({embedded:e=!1,almacenId:t,almacenNombre:r}={}){const[n,a]=h.useState([]),[i,s]=h.useState([]),[l,c]=h.useState(!0),u=h.useCallback(async()=>{c(!0);try{let d=se.from("inventario_items").select("*").order("categoria").order("subcategoria").order("nombre");t&&(d=d.eq("almacen_id",t));let f=se.from("inventario_movimientos").select("id, item_id").limit(5e3);t&&(f=f.eq("almacen_id",t));const[p,x]=await Promise.all([d,f]);if(p.error)throw p.error;a(p.data||[]),s(x.data||[])}catch(d){console.error(d)}finally{c(!1)}},[t]);return h.useEffect(()=>{u()},[u]),o.jsxs("div",{style:{fontFamily:"'DM Sans', sans-serif",background:Ee.bg,minHeight:e?"unset":"100vh",color:Ee.text},children:[o.jsx("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap",rel:"stylesheet"}),o.jsx("style",{children:Sae}),o.jsx("div",{style:{padding:24,maxWidth:1280,margin:"0 auto"},children:o.jsx(Cae,{items:n,loading:l,onRefresh:u,movements:i,almacenId:t,almacenNombre:r})})]})}function Cae({items:e,loading:t,onRefresh:r,movements:n,almacenId:a,almacenNombre:i}){const[s,l]=h.useState(Jx[0]),[c,u]=h.useState(null),[d,f]=h.useState(""),[p,x]=h.useState(""),[m,y]=h.useState(null),j=p?e.filter(k=>k.nombre.toLowerCase().includes(p.toLowerCase())||k.codigo.toLowerCase().includes(p.toLowerCase())):[],b=h.useCallback(k=>n.some(S=>S.item_id===k),[n]),g=(k,S)=>{const _=Ud[k];f(k),u({categoria:k,subcategoria:S||null,nombre:"",codigo:"",unidad:"pza",punto_reorden:_.hasReorderPoint?10:null,stock_minimo:(_.hasReorderPoint,0),activo:!0})},v=async k=>{const S=!k.activo;try{const{error:_}=await se.from("inventario_items").update({activo:S,updated_at:new Date().toISOString()}).eq("id",k.id);if(_)throw _;await se.from("inventario_audit").insert({registro_id:k.id,campo:"activo",valor_anterior:String(k.activo),valor_nuevo:String(S),accion:S?"reactivar":"desactivar",usuario:"admin",fecha_hora:Kp()}),oe.success(S?`${k.nombre} reactivado`:`${k.nombre} desactivado`),r()}catch{oe.error("Error al cambiar estado")}},w=async k=>{if(k.protegido){oe.error("Item protegido  no se puede eliminar");return}if(b(k.id)){oe.error("Tiene movimientos  solo puede desactivar");return}try{const{error:S}=await se.from("inventario_items").delete().eq("id",k.id);if(S)throw S;await se.from("inventario_audit").insert({registro_id:k.id,campo:"registro",valor_anterior:k.nombre,valor_nuevo:null,accion:"eliminar",usuario:"admin",fecha_hora:Kp()}),oe.success(`${k.nombre} eliminado`),y(null),r()}catch{oe.error("Error al eliminar")}},C=(k,S)=>k.length===0?o.jsx("p",{style:{color:Ee.textMuted,fontSize:13,margin:"8px 0"},children:"Sin items registrados."}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Nombre"}),o.jsx("th",{children:"Cdigo"}),o.jsx("th",{children:"Unidad"}),S.hasReorderPoint&&o.jsx("th",{children:"Reorden"}),S.hasReorderPoint&&o.jsx("th",{children:"Stk. Mn."}),o.jsx("th",{children:"Stock"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{children:"Acciones"})]})}),o.jsx("tbody",{children:k.map(_=>o.jsxs("tr",{style:{opacity:_.activo?1:.45},children:[o.jsxs("td",{style:{fontWeight:600,color:_.activo?Ee.text:Ee.textMuted},children:[_.nombre," ",_.protegido&&o.jsx("span",{title:"Protegido",style:{fontSize:11},children:""})]}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12},children:_.codigo}),o.jsx("td",{children:_.unidad}),S.hasReorderPoint&&o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:_.punto_reorden??""}),S.hasReorderPoint&&o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:_.stock_minimo??0}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontWeight:700,color:Ee.text},children:_.stock_actual}),o.jsx("td",{children:o.jsx("button",{onClick:()=>{_.protegido||v(_)},style:{padding:"3px 10px",borderRadius:20,fontSize:11,fontWeight:700,border:"none",cursor:_.protegido?"not-allowed":"pointer",background:_.activo?"rgba(52,211,153,0.12)":"rgba(248,113,113,0.12)",color:_.activo?"#34d399":"#f87171"},disabled:_.protegido,children:_.activo?"Activo":"Inactivo"})}),o.jsx("td",{children:o.jsxs("div",{style:{display:"flex",gap:4},children:[o.jsx(ta,{variant:"ghost",onClick:()=>{f(_.categoria),u({..._})},style:{fontSize:12},children:""}),m===_.id?o.jsx(ta,{variant:"danger",style:{fontSize:11,padding:"4px 10px"},onClick:()=>w(_),children:"Confirmar?"}):o.jsx(ta,{variant:"ghost",onClick:()=>{if(_.protegido){oe.error("Item protegido");return}if(b(_.id)){oe.error("Tiene movimientos  use desactivar");return}y(_.id),setTimeout(()=>y(null),3e3)},style:{fontSize:12,color:"#f87171"},children:""})]})})]},_.id))})]})});return t?o.jsx(Zx,{children:o.jsx("div",{style:{textAlign:"center",padding:40,color:Ee.textMuted},children:"Cargando configuracin de inventario..."})}):o.jsxs("div",{className:"inv-fade",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,flexWrap:"wrap",gap:12},children:[o.jsxs("div",{children:[o.jsxs("h2",{style:{margin:0,fontSize:22,fontWeight:700},children:[" Inventario General",i&&o.jsxs("span",{style:{fontSize:15,fontWeight:500,color:Ee.textMuted,marginLeft:10},children:[" ",i]})]}),o.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:Ee.textMuted},children:"Gestionar categoras, items, puntos de reorden y stock mnimo"})]}),o.jsx(xl,{value:p,onChange:x,placeholder:" Buscar item por nombre o cdigo...",style:{width:320}})]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:24},children:[{label:"Total Items",value:e.length,color:Ee.accent},{label:"Activos",value:e.filter(k=>k.activo).length,color:"#34d399"},{label:"Inactivos",value:e.filter(k=>!k.activo).length,color:"#f87171"},{label:"Categoras",value:Jx.length,color:Ee.accentLight}].map((k,S)=>o.jsxs(Zx,{style:{padding:16},children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,color:Ee.textMuted,textTransform:"uppercase",letterSpacing:.5},children:k.label}),o.jsx("div",{style:{fontSize:28,fontWeight:700,color:k.color,fontFamily:"'DM Mono', monospace",lineHeight:1,marginTop:4},children:k.value})]},S))}),p&&o.jsxs(Zx,{style:{marginBottom:16},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[o.jsxs("h3",{style:{margin:0,fontSize:15,fontWeight:700,color:Ee.text},children:['Resultados: "',p,'" ',o.jsxs("span",{style:{color:Ee.textMuted,fontWeight:500},children:["(",j.length,")"]})]}),o.jsx(ta,{variant:"ghost",onClick:()=>x(""),children:" Limpiar"})]}),j.length===0?o.jsx("p",{style:{color:Ee.textMuted},children:"No se encontraron items."}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Nombre"}),o.jsx("th",{children:"Cdigo"}),o.jsx("th",{children:"Categora"}),o.jsx("th",{children:"Subcat."}),o.jsx("th",{children:"Unidad"}),o.jsx("th",{children:"Reorden"}),o.jsx("th",{children:"Estado"}),o.jsx("th",{})]})}),o.jsx("tbody",{children:j.map(k=>{const S=Ud[k.categoria];return o.jsxs("tr",{children:[o.jsxs("td",{style:{fontWeight:600,color:k.activo?Ee.text:Ee.textMuted},children:[k.nombre," ",k.protegido&&""]}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12},children:k.codigo}),o.jsxs("td",{children:[S==null?void 0:S.icon," ",k.categoria]}),o.jsx("td",{children:k.subcategoria||""}),o.jsx("td",{children:k.unidad}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace"},children:k.punto_reorden??""}),o.jsx("td",{children:o.jsx("span",{style:{color:k.activo?"#34d399":"#f87171",fontWeight:600,fontSize:12},children:k.activo?"Activo":"Inactivo"})}),o.jsx("td",{children:o.jsx(ta,{variant:"ghost",onClick:()=>{f(k.categoria),u({...k})},children:""})})]},k.id)})})]})})]}),!p&&Jx.map(k=>{const S=Ud[k],_=e.filter(T=>T.categoria===k),A=_.filter(T=>T.activo).length,E=_.filter(T=>!T.activo).length,N=S.hasStockAlerts?_.filter(T=>T.activo&&T.punto_reorden!==null&&T.stock_actual<T.punto_reorden).length:0,$=s===k,z=[...new Set(_.map(T=>T.subcategoria).filter(Boolean))];return o.jsxs("div",{style:{marginBottom:8},children:[o.jsxs("button",{onClick:()=>l($?null:k),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 20px",background:$?Ee.card:Ee.surface,border:`1px solid ${$?Ee.accent+"40":Ee.border}`,borderRadius:$?"14px 14px 0 0":14,cursor:"pointer",transition:"all 0.15s"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[o.jsx("span",{style:{fontSize:20},children:S.icon}),o.jsx("span",{style:{fontSize:15,fontWeight:700,color:Ee.text},children:S.label}),o.jsx(Qf,{color:Ee.accentLight,bg:Ee.accentDim,children:A}),E>0&&o.jsxs(Qf,{color:"#f87171",bg:"rgba(248,113,113,0.1)",children:[E," inactivos"]}),N>0&&o.jsxs(Qf,{color:"#fbbf24",bg:"rgba(251,191,36,0.15)",children:[" ",N]}),!S.hasReorderPoint&&o.jsx(Qf,{color:Ee.textMuted,bg:"rgba(153,153,176,0.1)",children:"Sin reorden"}),S.subcategoriesLocked&&o.jsx("span",{title:"Subcategoras bloqueadas",style:{fontSize:12,opacity:.4},children:""})]}),o.jsx("span",{style:{color:Ee.textMuted,fontSize:18,transition:"transform 0.2s",transform:$?"rotate(180deg)":"rotate(0)"},children:""})]}),$&&o.jsxs("div",{style:{background:Ee.card,border:`1px solid ${Ee.accent}40`,borderTop:"none",borderRadius:"0 0 14px 14px",padding:20},className:"inv-fade",children:[!S.hasReorderPoint&&o.jsx("div",{style:{background:"rgba(153,153,176,0.06)",padding:12,borderRadius:10,border:`1px solid ${Ee.border}`,marginBottom:16},children:o.jsxs("p",{style:{margin:0,fontSize:13,color:Ee.textMuted},children:[" ",o.jsx("strong",{children:S.label})," no utiliza punto de reorden ni alertas de stock."]})}),S.allowSubcategories&&z.length>0?z.map(T=>{var D;const I=_.filter(O=>O.subcategoria===T),L=((D=S.protectedSubcategories)==null?void 0:D.includes(T))||S.subcategoriesLocked;return o.jsxs("div",{style:{marginBottom:20},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:700,color:Ee.text},children:T}),L&&o.jsx("span",{title:"Subcategora protegida",style:{fontSize:12,opacity:.5},children:""}),o.jsxs("span",{style:{fontSize:11,color:Ee.textMuted},children:["(",I.length,")"]})]}),o.jsx(ta,{variant:"ghost",style:{fontSize:12},onClick:()=>g(k,T),children:"+ Agregar item"})]}),C(I,S)]},T)}):C(_,S),o.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:o.jsx(ta,{variant:"primary",style:{fontSize:13},onClick:()=>g(k),children:"+ Agregar Item"})})]})]},k)}),c&&o.jsx(_ae,{item:c,category:d,allItems:e,almacenId:a,onClose:()=>u(null),onSaved:()=>{u(null),r()}})]})}function _ae({item:e,category:t,allItems:r,almacenId:n,onClose:a,onSaved:i}){const s=Ud[t],l=!e.id,[c,u]=h.useState({...e}),[d,f]=h.useState(!1),p=(b,g)=>u(v=>({...v,[b]:g})),x=!l&&e.stock_actual>0;h.useEffect(()=>{if(l&&c.nombre&&c.nombre.length>=2){const b=t.substring(0,3).toUpperCase().replace(/[^A-Z]/g,""),g=(c.subcategoria||"GEN").substring(0,4).toUpperCase().replace(/[^A-Z]/g,""),v=c.nombre.replace(/[^a-zA-Z0-9]/g,"").substring(0,6).toUpperCase();p("codigo",`${b}-${g}-${v}`)}},[c.nombre,c.subcategoria,t,l]);const m=s.fixedSubcategories?s.fixedSubcategories.map(b=>({value:b,label:b})):[...new Set(r.filter(b=>b.categoria===t).map(b=>b.subcategoria).filter(Boolean))].map(b=>({value:b,label:b})),y=()=>{if(!c.nombre||c.nombre.length<3)return oe.error("Nombre mnimo 3 caracteres"),!1;if(!c.codigo)return oe.error("Cdigo requerido"),!1;if(!c.unidad)return oe.error("Seleccione unidad"),!1;const b=r.find(v=>v.codigo===c.codigo&&v.id!==c.id);return b?(oe.error(`Cdigo "${c.codigo}" ya existe en ${b.nombre}`),!1):r.find(v=>v.nombre.toLowerCase()===c.nombre.toLowerCase()&&v.subcategoria===c.subcategoria&&v.categoria===t&&v.id!==c.id)?(oe.error(`"${c.nombre}" ya existe en esta subcategora`),!1):s.hasReorderPoint&&c.punto_reorden!==null&&c.stock_minimo>c.punto_reorden?(oe.error("Stock mnimo no puede superar punto de reorden"),!1):!0},j=async()=>{if(y()){f(!0);try{const b={categoria:t,subcategoria:c.subcategoria||null,nombre:c.nombre,codigo:c.codigo,unidad:c.unidad,punto_reorden:s.hasReorderPoint?parseInt(c.punto_reorden)||10:null,stock_minimo:s.hasReorderPoint&&parseInt(c.stock_minimo)||0,activo:c.activo!==!1,updated_at:new Date().toISOString()};if(l){b.stock_actual=0,b.protegido=!1,n&&(b.almacen_id=n);const{data:g,error:v}=await se.from("inventario_items").insert(b).select().single();if(v)throw v;await se.from("inventario_audit").insert({registro_id:g.id,campo:"registro",valor_anterior:null,valor_nuevo:c.nombre,accion:"crear",usuario:"admin",fecha_hora:Kp()}),oe.success(`${c.nombre} creado`)}else{const g=[];e.nombre!==c.nombre&&g.push({campo:"nombre",antes:e.nombre,despues:c.nombre}),e.codigo!==c.codigo&&g.push({campo:"codigo",antes:e.codigo,despues:c.codigo}),e.unidad!==c.unidad&&g.push({campo:"unidad",antes:e.unidad,despues:c.unidad}),String(e.punto_reorden)!==String(b.punto_reorden)&&g.push({campo:"punto_reorden",antes:String(e.punto_reorden),despues:String(b.punto_reorden)}),String(e.stock_minimo??0)!==String(b.stock_minimo)&&g.push({campo:"stock_minimo",antes:String(e.stock_minimo??0),despues:String(b.stock_minimo)});const{error:v}=await se.from("inventario_items").update(b).eq("id",e.id);if(v)throw v;for(const w of g)await se.from("inventario_audit").insert({registro_id:e.id,campo:w.campo,valor_anterior:w.antes,valor_nuevo:w.despues,accion:"editar",usuario:"admin",fecha_hora:Kp()});oe.success(`${c.nombre} actualizado`)}i()}catch(b){console.error(b),oe.error("Error: "+(b.message||"ver consola"))}finally{f(!1)}}};return o.jsx("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:a,children:o.jsxs("div",{style:{background:Ee.card,borderRadius:16,border:`1px solid ${Ee.border}`,padding:28,width:560,maxHeight:"90vh",overflowY:"auto"},onClick:b=>b.stopPropagation(),className:"inv-fade",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:20},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:700},children:l?"Agregar Item":"Editar Item"}),o.jsxs("p",{style:{margin:"4px 0 0",fontSize:13,color:Ee.textMuted},children:[s.icon," ",s.label,c.subcategoria?` > ${c.subcategoria}`:""]})]}),o.jsx("button",{onClick:a,style:{background:"none",border:"none",color:Ee.textMuted,fontSize:20,cursor:"pointer"},children:""})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:16},children:[o.jsxs("div",{children:[o.jsx(es,{children:"Categora"}),o.jsxs("div",{style:{padding:"10px 14px",borderRadius:10,background:Ee.surface,border:`1px solid ${Ee.border}`,fontSize:14,color:Ee.textMuted},children:[s.icon," ",t]})]}),s.allowSubcategories&&o.jsxs("div",{children:[o.jsx(es,{children:"Subcategora"}),s.subcategoriesLocked?o.jsx(LA,{value:c.subcategoria||"",onChange:b=>p("subcategoria",b),options:m,placeholder:"Seleccionar..."}):o.jsx(xl,{value:c.subcategoria||"",onChange:b=>p("subcategoria",b),placeholder:"Subcategora...",list:"subcatList"}),!s.subcategoriesLocked&&o.jsx("datalist",{id:"subcatList",children:m.map(b=>o.jsx("option",{value:b.value},b.value))})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:16},children:[o.jsxs("div",{children:[o.jsx(es,{children:"Nombre del producto"}),o.jsx(xl,{value:c.nombre,onChange:b=>p("nombre",b),placeholder:"Nombre..."})]}),o.jsxs("div",{children:[o.jsx(es,{children:"Cdigo nico"}),o.jsx(xl,{value:c.codigo,onChange:b=>p("codigo",b.toUpperCase()),placeholder:"AUTO-GENERADO"})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsxs(es,{children:["Unidad de medida ",x&&o.jsx("span",{style:{color:"#fb923c",fontSize:10},children:"( bloqueada  tiene stock)"})]}),o.jsx(LA,{value:c.unidad,onChange:b=>{x||p("unidad",b)},options:wae,placeholder:"Seleccionar...",style:x?{opacity:.5,pointerEvents:"none"}:{}})]}),s.hasReorderPoint&&o.jsxs("div",{style:{background:Ee.surface,padding:16,borderRadius:12,border:`1px solid ${Ee.border}`,marginBottom:16},children:[o.jsx("h4",{style:{margin:"0 0 12px",fontSize:13,fontWeight:700,color:Ee.text},children:" Control de Stock"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[o.jsxs("div",{children:[o.jsx(es,{children:"Punto de reorden"}),o.jsx(xl,{type:"number",value:c.punto_reorden??"",onChange:b=>p("punto_reorden",b),placeholder:"10",min:"1"}),o.jsx("p",{style:{margin:"4px 0 0",fontSize:11,color:Ee.textMuted},children:"Alerta cuando stock baja de este nivel"})]}),o.jsxs("div",{children:[o.jsx(es,{children:"Stock mnimo"}),o.jsx(xl,{type:"number",value:c.stock_minimo??"",onChange:b=>p("stock_minimo",b),placeholder:"0",min:"0"}),o.jsx("p",{style:{margin:"4px 0 0",fontSize:11,color:Ee.textMuted},children:"Nivel crtico (alerta roja)"})]})]})]}),!s.hasReorderPoint&&o.jsx("div",{style:{background:"rgba(153,153,176,0.06)",padding:14,borderRadius:12,border:`1px solid ${Ee.border}`,marginBottom:16},children:o.jsxs("p",{style:{margin:0,fontSize:13,color:Ee.textMuted},children:[" ",o.jsx("strong",{children:s.label})," no utiliza punto de reorden ni alertas de stock."]})}),o.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[o.jsx(ta,{variant:"secondary",onClick:a,children:"Cancelar"}),o.jsx(ta,{onClick:j,disabled:d||!c.nombre||!c.unidad,style:{padding:"12px 28px"},children:d?"Guardando...":l?" Crear Item":" Guardar Cambios"})]})]})})}const ye={bg:"#0f0f17",surface:"#1a1a28",card:"#1e1e2e",cardHover:"#252538",input:"#282840",inputBorder:"#3a3a52",inputFocus:"#4f6bf6",border:"#2a2a3e",text:"#f0f0f5",textSecondary:"#9999b0",textMuted:"#666680",accent:"#4f6bf6"},_u={"Materiales de Empaque":{icon:"",label:"Materiales de Empaque",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Agroqumicos:{icon:"",label:"Agroqumicos",hasReorderPoint:!1,hasStockAlerts:!1,allowSubcategories:!0,subcategoriesLocked:!0,fixedSubcategories:["Fungicidas","Insecticidas","Bioestimulantes","Coadyuvantes"]},Fertilizantes:{icon:"",label:"Fertilizantes",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1,protectedSubcategories:["Macronutrientes","Micronutrientes"]},Riego:{icon:"",label:"Riego",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Fumigacin:{icon:"",label:"Fumigacin",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Herramientas:{icon:"",label:"Herramientas y Equipo",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!0,subcategoriesLocked:!1},Combustibles:{icon:"",label:"Combustibles",hasReorderPoint:!0,hasStockAlerts:!0,allowSubcategories:!1,subcategoriesLocked:!0}},Qx=Object.keys(_u),Gp=[{value:"entrada",label:"Entrada",color:"#34d399",icon:""},{value:"salida",label:"Salida",color:"#f87171",icon:""},{value:"ajuste_positivo",label:"Ajuste (+)",color:"#60a5fa",icon:""},{value:"ajuste_negativo",label:"Ajuste ()",color:"#fb923c",icon:""}],Aae={entrada:["Compra","Donacin","Transferencia","Devolucin","Otro"],salida:["Uso en campo","Embarque","Transferencia","Prstamo","Otro"],ajuste_positivo:["Conteo fsico","Correccin de error","Producto encontrado","Otro"],ajuste_negativo:["Merma","Caducidad","Dao","Robo/Extravo","Correccin de error","Otro"]},Eae={moray:"inventario.rancho.moray",mojave:"inventario.rancho.mojave",la_pena:"inventario.rancho.lapena"};function Nae(){const e=new Intl.DateTimeFormat("en-CA",{timeZone:"America/Mexico_City",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(new Date),t=r=>{var n;return((n=e.find(a=>a.type===r))==null?void 0:n.value)||"00"};return`${t("year")}-${t("month")}-${t("day")}T${t("hour")}:${t("minute")}:${t("second")}`}function DA(){return new Date().toLocaleDateString("en-CA",{timeZone:"America/Mexico_City"})}function Pae(){return new Date().toLocaleTimeString("en-US",{timeZone:"America/Mexico_City",hour:"2-digit",minute:"2-digit",hour12:!0})}function Qj(e,t){return t===null?{label:"Sin control",color:ye.textMuted,bg:ye.surface,border:ye.border}:e===0?{label:"Agotado",color:"#f87171",bg:"rgba(248,113,113,0.12)",border:"rgba(248,113,113,0.3)"}:e<t*.5?{label:"Crtico",color:"#fb923c",bg:"rgba(251,146,60,0.12)",border:"rgba(251,146,60,0.3)"}:e<t?{label:"Bajo",color:"#fbbf24",bg:"rgba(251,191,36,0.12)",border:"rgba(251,191,36,0.3)"}:{label:"Normal",color:"#34d399",bg:"rgba(52,211,153,0.12)",border:"rgba(52,211,153,0.3)"}}const Ul=({children:e,style:t={},onClick:r})=>o.jsx("div",{onClick:r,style:{background:ye.card,borderRadius:14,border:`1px solid ${ye.border}`,padding:22,...t},children:e}),Vn=({children:e,onClick:t,variant:r="primary",style:n={},disabled:a=!1})=>{const i={padding:"10px 20px",borderRadius:10,border:"none",fontSize:14,fontWeight:600,cursor:a?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:7,transition:"all 0.15s",opacity:a?.4:1},s={primary:{...i,background:ye.accent,color:"#fff"},secondary:{...i,background:ye.surface,color:ye.textSecondary,border:`1.5px solid ${ye.border}`},danger:{...i,background:"rgba(248,113,113,0.1)",color:"#f87171",border:"1.5px solid rgba(248,113,113,0.25)"},ghost:{...i,background:"transparent",color:ye.textMuted,padding:"6px 10px"},success:{...i,background:"rgba(52,211,153,0.15)",color:"#34d399",border:"1.5px solid rgba(52,211,153,0.3)"},warning:{...i,background:"rgba(251,191,36,0.15)",color:"#fbbf24",border:"1.5px solid rgba(251,191,36,0.3)"}};return o.jsx("button",{onClick:t,disabled:a,style:{...s[r],...n},children:e})},eh=({type:e="text",value:t,onChange:r,placeholder:n,style:a={},...i})=>o.jsx("input",{type:e,value:t,onChange:s=>r(s.target.value),placeholder:n,style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${ye.inputBorder}`,fontSize:14,outline:"none",boxSizing:"border-box",background:ye.input,color:ye.text,...a},...i}),AI=({value:e,onChange:t,options:r,placeholder:n,style:a={}})=>o.jsxs("select",{value:e,onChange:i=>t(i.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:10,border:`1.5px solid ${ye.inputBorder}`,fontSize:14,background:ye.input,color:e?ye.text:ye.textMuted,outline:"none",...a},children:[o.jsx("option",{value:"",children:n||"Seleccionar..."}),r.map(i=>o.jsx("option",{value:i.value,children:i.label},i.value))]}),sa=({children:e})=>o.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:ye.textSecondary,marginBottom:6,textTransform:"uppercase",letterSpacing:.6},children:e}),Mae=({stock:e,reorden:t})=>{const r=Qj(e,t);return o.jsx("span",{style:{display:"inline-block",padding:"3px 10px",borderRadius:20,fontSize:11,fontWeight:700,background:r.bg,color:r.color,border:`1.5px solid ${r.border}`,textTransform:"uppercase",letterSpacing:.4},children:r.label})},Oae=`
  * { box-sizing: border-box; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .inv-fade { animation: fadeIn 0.25s ease-out; }
  select:focus, input:focus { border-color: ${ye.inputFocus} !important; box-shadow: 0 0 0 3px rgba(79,107,246,0.2) !important; }
  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: ${ye.bg}; }
  ::-webkit-scrollbar-thumb { background: ${ye.inputBorder}; border-radius: 3px; }
  table { border-collapse: collapse; width: 100%; }
  th { text-align: left; padding: 11px 14px; font-size: 11px; font-weight: 700; color: ${ye.textMuted}; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid ${ye.border}; background: ${ye.surface}; }
  td { padding: 11px 14px; font-size: 13px; color: ${ye.textSecondary}; border-bottom: 1px solid ${ye.border}; }
  tr:hover td { background: ${ye.cardHover}; }
  option { background: ${ye.card}; color: ${ye.text}; }
  input[type="number"]::-webkit-inner-spin-button { opacity: 1; }
`;function Tae(){var H;const[e,t]=h.useState([]),[r,n]=h.useState([]),[a,i]=h.useState(!0),[s,l]=h.useState(Qx[0]),[c,u]=h.useState("stock"),[d,f]=h.useState(null),[p,x]=h.useState(null),[m,y]=h.useState("all"),[j,b]=h.useState([]),[g,v]=h.useState(null),[w,C]=h.useState(!0),{canView:k,isAdmin:S}=_c(),_={"Materiales de Empaque":"inventario.cat.empaque",Agroqumicos:"inventario.cat.agroquimicos",Fertilizantes:"inventario.cat.fertilizantes",Riego:"inventario.cat.riego",Fumigacin:"inventario.cat.fumigacion",Herramientas:"inventario.cat.herramientas",Combustibles:"inventario.cat.combustibles"},A=Qx.filter(B=>k(_[B]??""));h.useEffect(()=>{(async()=>{C(!0);try{const{data:K,error:Z}=await se.from("almacenes").select("*").eq("activo",!0).order("nombre");if(Z)throw Z;const he=K||[],re=S?he:he.filter(X=>k(Eae[X.slug]??""));b(re),re.length>0&&v(re[0])}catch(K){console.error(K)}finally{C(!1)}})()},[S]);const E=h.useCallback(async()=>{if(g){i(!0);try{const{data:B,error:K}=await se.from("inventario_items").select("*").eq("activo",!0).eq("almacen_id",g.id).order("categoria").order("subcategoria").order("nombre");if(K)throw K;t(B||[])}catch(B){console.error(B)}finally{i(!1)}}},[g]),N=h.useCallback(async B=>{if(g)try{let K=se.from("inventario_movimientos").select("*, inventario_items(nombre, unidad, categoria)").eq("almacen_id",g.id).order("fecha_hora",{ascending:!1}).limit(500);if(B!=null&&B.itemId)K=K.eq("item_id",B.itemId);else if(B!=null&&B.category){const{data:re}=await se.from("inventario_items").select("id").eq("categoria",B.category).eq("almacen_id",g.id),X=(re||[]).map(V=>V.id);if(X.length>0)K=K.in("item_id",X);else{n([]);return}}const{data:Z,error:he}=await K;if(he)throw he;n(Z||[])}catch(K){console.error(K)}},[g]);h.useEffect(()=>{E()},[E]),h.useEffect(()=>{N(c==="history"?p?{itemId:p.id}:{category:s}:{category:s})},[c,s,p,N]);const $=B=>{v(B),u("stock"),x(null),y("all"),l(Qx[0])},z=e.filter(B=>B.categoria===s),T=e.length,I=e.filter(B=>B.punto_reorden!==null&&B.stock_actual<B.punto_reorden).length,L=e.filter(B=>B.stock_actual===0&&B.punto_reorden!==null).length,D=r.filter(B=>{var K;return((K=B.fecha_hora)==null?void 0:K.substring(0,10))===DA()}).length,O=m==="low"?z.filter(B=>B.punto_reorden!==null&&B.stock_actual<B.punto_reorden&&B.stock_actual>0):m==="critical"?z.filter(B=>B.stock_actual===0&&B.punto_reorden!==null):z,F=[...new Set(O.map(B=>B.subcategoria).filter(Boolean))],q=B=>{u("stock"),x(null),y(K=>K===B?"all":B)};if(w)return o.jsx("div",{style:{fontFamily:"'DM Sans', sans-serif",background:ye.bg,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:ye.textMuted},children:"Cargando inventario..."});if(!g)return o.jsx("div",{style:{fontFamily:"'DM Sans', sans-serif",background:ye.bg,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:o.jsxs("div",{style:{textAlign:"center",color:ye.textMuted},children:[o.jsx("div",{style:{fontSize:40,marginBottom:12},children:""}),o.jsx("div",{style:{fontSize:16,fontWeight:600,color:ye.textSecondary},children:"Sin acceso al inventario"}),o.jsx("div",{style:{fontSize:13,marginTop:6},children:"Contacta al administrador para solicitar permisos."})]})});const te=j.length>1;return o.jsxs("div",{style:{fontFamily:"'DM Sans', sans-serif",background:ye.bg,minHeight:"100vh",color:ye.text},children:[o.jsx("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap",rel:"stylesheet"}),o.jsx("style",{children:Oae}),o.jsxs("div",{style:{background:ye.surface,borderBottom:`1px solid ${ye.border}`,padding:"16px 24px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("span",{style:{fontSize:24},children:""}),o.jsxs("div",{children:[o.jsxs("h1",{style:{margin:0,fontSize:20,fontWeight:700},children:["Inventario General",te&&o.jsxs("span",{style:{marginLeft:10,fontSize:14,fontWeight:500,color:ye.textMuted},children:[" ",g.nombre]})]}),o.jsxs("p",{style:{margin:0,fontSize:12,color:ye.textMuted},children:[DA(),"  ",Pae()]})]})]}),o.jsxs("div",{style:{display:"flex",gap:8},children:[k("inventario.stock")&&o.jsx(Vn,{variant:c==="stock"?"primary":"secondary",onClick:()=>{u("stock"),x(null),y("all")},children:" Stock"}),k("inventario.historial")&&o.jsx(Vn,{variant:c==="history"?"primary":"secondary",onClick:()=>{u("history"),x(null)},children:" Historial"}),(S||k("inventario.configuracion"))&&o.jsx(Vn,{variant:c==="config"?"primary":"secondary",onClick:()=>u("config"),children:" Configuracin"})]})]}),te&&o.jsx("div",{style:{display:"flex",gap:0,marginTop:12,borderTop:`1px solid ${ye.border}`,paddingTop:12},children:j.map(B=>o.jsx("button",{onClick:()=>$(B),style:{padding:"8px 20px",border:"none",background:"none",cursor:"pointer",fontSize:13,fontWeight:g.id===B.id?700:500,color:g.id===B.id?ye.accent:ye.textMuted,borderBottom:g.id===B.id?`2.5px solid ${ye.accent}`:"2.5px solid transparent",transition:"all 0.15s",whiteSpace:"nowrap"},children:B.nombre},B.id))})]}),o.jsxs("main",{style:{padding:24,maxWidth:1280,margin:"0 auto"},children:[o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:24},children:[{label:"Items Registrados",value:T,color:ye.accent,filter:"all"},{label:"Alertas Stock Bajo",value:I,color:I>0?"#fbbf24":"#34d399",filter:"low"},{label:"Items Agotados",value:L,color:L>0?"#f87171":"#34d399",filter:"critical"},{label:"Movimientos Hoy",value:D,color:ye.accent,filter:null}].map((B,K)=>o.jsxs(Ul,{onClick:B.filter!==null?()=>q(B.filter):void 0,style:{cursor:B.filter!==null?"pointer":"default",transition:"all 0.15s",border:m===B.filter&&B.filter!=="all"?`2px solid ${B.color}`:`1px solid ${ye.border}`,transform:m===B.filter&&B.filter!=="all"?"scale(1.02)":"scale(1)"},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:ye.textMuted,textTransform:"uppercase",letterSpacing:.6},children:B.label}),o.jsx("div",{style:{fontSize:36,fontWeight:700,color:B.color,marginTop:6,fontFamily:"'DM Mono', monospace",lineHeight:1},children:a?"...":B.value}),m===B.filter&&B.filter!=="all"&&o.jsx("div",{style:{fontSize:10,color:B.color,marginTop:6,fontWeight:600},children:"FILTRO ACTIVO  click para quitar"})]},K))}),o.jsx("div",{style:{display:"flex",gap:0,marginBottom:20,overflowX:"auto",background:ye.surface,borderRadius:12,border:`1px solid ${ye.border}`},children:A.map(B=>{const K=_u[B];return o.jsxs("button",{onClick:()=>{l(B),x(null),y("all")},style:{display:"flex",alignItems:"center",gap:6,padding:"12px 18px",border:"none",background:"none",fontSize:13,fontWeight:s===B?700:500,cursor:"pointer",whiteSpace:"nowrap",color:s===B?ye.accent:ye.textMuted,transition:"all 0.15s",borderBottom:s===B?`2.5px solid ${ye.accent}`:"2.5px solid transparent"},children:[o.jsx("span",{children:K.icon})," ",K.label]},B)})}),m!=="all"&&c==="stock"&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:16,padding:"8px 14px",background:ye.surface,borderRadius:10,border:`1px solid ${ye.border}`},children:[o.jsxs("span",{style:{fontSize:13,color:ye.textSecondary},children:["Mostrando: ",o.jsx("strong",{style:{color:ye.text},children:m==="low"?"Stock bajo":"Agotados"})," en ",(H=_u[s])==null?void 0:H.icon," ",s,O.length===0&&"  sin resultados"]}),o.jsx(Vn,{variant:"ghost",style:{fontSize:11,marginLeft:"auto"},onClick:()=>y("all"),children:" Quitar filtro"})]}),c==="stock"&&k("inventario.stock")&&o.jsx(Lae,{items:O,subcategories:F,loading:a,category:s,onRegisterMovement:B=>f(B),onViewHistory:B=>{x(B),u("history")}}),c==="history"&&k("inventario.historial")&&o.jsx(Dae,{movements:r,historyItem:p,activeCategory:s,loading:a,onBack:()=>{u("stock"),x(null)},onClearFilter:()=>x(null)}),c==="config"&&(S||k("inventario.configuracion"))&&o.jsx(kae,{embedded:!0,almacenId:g.id,almacenNombre:g.nombre}),c==="config"&&!S&&!k("inventario.configuracion")&&o.jsx("div",{style:{padding:48,textAlign:"center",color:"#666680"},children:" Sin acceso a configuracin"})]}),d&&o.jsx(Iae,{item:d,almacenId:g.id,onClose:()=>f(null),onSaved:()=>{f(null),E(),N({category:s})}})]})}function Lae({items:e,subcategories:t,loading:r,category:n,onRegisterMovement:a,onViewHistory:i}){const s=_u[n];if(r)return o.jsx(Ul,{children:o.jsx("div",{style:{textAlign:"center",padding:40,color:ye.textMuted},children:"Cargando inventario..."})});if(e.length===0)return o.jsx(Ul,{children:o.jsx("div",{style:{textAlign:"center",padding:40,color:ye.textMuted},children:"No hay items que coincidan con el filtro."})});const l=["Nombre","Cdigo","Stock"];s.hasReorderPoint&&l.push("Reorden"),s.hasStockAlerts&&l.push("Estado"),l.push("Acciones");const c=d=>{const f=d.punto_reorden?Math.min(d.stock_actual/d.punto_reorden*100,100):100,p=Qj(d.stock_actual,d.punto_reorden);return o.jsxs("tr",{children:[o.jsx("td",{style:{fontWeight:600,color:ye.text},children:d.nombre}),o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:ye.textMuted},children:d.codigo}),o.jsx("td",{children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx("span",{style:{fontWeight:700,fontFamily:"'DM Mono', monospace",color:ye.text,fontSize:16,minWidth:50,textAlign:"right"},children:d.stock_actual}),o.jsx("span",{style:{fontSize:11,color:ye.textMuted},children:d.unidad})]})}),s.hasReorderPoint&&o.jsx("td",{children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{width:60,height:6,background:ye.input,borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{width:`${f}%`,height:"100%",background:p.color,borderRadius:3}})}),o.jsx("span",{style:{fontSize:11,fontFamily:"'DM Mono', monospace",color:ye.textMuted},children:d.punto_reorden})]})}),s.hasStockAlerts&&o.jsx("td",{children:o.jsx(Mae,{stock:d.stock_actual,reorden:d.punto_reorden})}),o.jsx("td",{children:o.jsxs("div",{style:{display:"flex",gap:4},children:[o.jsx(Vn,{variant:"success",style:{padding:"6px 12px",fontSize:12},onClick:()=>a(d),children:" Movimiento"}),o.jsx(Vn,{variant:"ghost",style:{padding:"6px 8px"},onClick:()=>i(d),children:""})]})})]},d.id)},u=(d,f)=>o.jsxs(Ul,{style:{marginBottom:16},children:[f&&o.jsxs("h3",{style:{margin:"0 0 14px",fontSize:15,fontWeight:700,color:ye.text},children:[f," ",o.jsxs("span",{style:{fontSize:12,fontWeight:500,color:ye.textMuted},children:["(",d.length," items)"]})]}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsx("tr",{children:l.map(p=>o.jsx("th",{children:p},p))})}),o.jsx("tbody",{children:d.map(c)})]})})]},f||"all");return o.jsx("div",{className:"inv-fade",children:t.length>0?t.map(d=>u(e.filter(f=>f.subcategoria===d),d)):u(e,`${s.icon} ${s.label}`)})}function Dae({movements:e,historyItem:t,activeCategory:r,loading:n,onBack:a,onClearFilter:i}){const[s,l]=h.useState(""),[c,u]=h.useState(""),[d,f]=h.useState(""),[p,x]=h.useState(""),m=_u[r],y=[...new Set(e.map(v=>v.usuario).filter(Boolean))],j=e.filter(v=>{var w,C;if(s&&v.tipo!==s||p&&v.usuario!==p)return!1;if(c){const k=(w=v.fecha_hora)==null?void 0:w.substring(0,10);if(k&&k<c)return!1}if(d){const k=(C=v.fecha_hora)==null?void 0:C.substring(0,10);if(k&&k>d)return!1}return!0}),b=()=>{l(""),u(""),f(""),x("")},g=s||c||d||p;return o.jsxs("div",{className:"inv-fade",children:[o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx(Vn,{variant:"secondary",onClick:a,children:" Stock"}),t?o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:14,fontWeight:700,color:ye.text},children:t.nombre}),o.jsxs("span",{style:{fontSize:12,color:ye.textMuted},children:["(",t.codigo,")"]}),o.jsx(Vn,{variant:"ghost",onClick:i,style:{fontSize:11},children:" Ver categora"})]}):o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsxs("span",{style:{fontSize:14,fontWeight:600,color:ye.accent},children:[m==null?void 0:m.icon," ",m==null?void 0:m.label]}),o.jsxs("span",{style:{fontSize:12,color:ye.textMuted},children:["(",j.length," movimientos)"]})]})]})}),o.jsx(Ul,{style:{marginBottom:16,padding:16},children:o.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"end"},children:[o.jsxs("div",{style:{minWidth:130},children:[o.jsx(sa,{children:"Tipo"}),o.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[{value:"",label:"Todos"},...Gp.map(v=>({value:v.value,label:v.label}))].map(v=>o.jsx(Vn,{variant:s===v.value?"primary":"secondary",onClick:()=>l(v.value),style:{padding:"5px 10px",fontSize:11},children:v.label},v.value))})]}),o.jsxs("div",{style:{minWidth:140},children:[o.jsx(sa,{children:"Desde"}),o.jsx("input",{type:"date",value:c,onChange:v=>u(v.target.value),style:{padding:"8px 10px",borderRadius:8,border:`1.5px solid ${ye.inputBorder}`,background:ye.input,color:ye.text,fontSize:13,outline:"none"}})]}),o.jsxs("div",{style:{minWidth:140},children:[o.jsx(sa,{children:"Hasta"}),o.jsx("input",{type:"date",value:d,onChange:v=>f(v.target.value),style:{padding:"8px 10px",borderRadius:8,border:`1.5px solid ${ye.inputBorder}`,background:ye.input,color:ye.text,fontSize:13,outline:"none"}})]}),y.length>1&&o.jsxs("div",{style:{minWidth:140},children:[o.jsx(sa,{children:"Usuario"}),o.jsx(AI,{value:p,onChange:x,options:y.map(v=>({value:v,label:v})),placeholder:"Todos",style:{padding:"8px 10px",fontSize:13}})]}),g&&o.jsx(Vn,{variant:"ghost",onClick:b,style:{fontSize:11,alignSelf:"end",marginBottom:2},children:" Limpiar filtros"})]})}),o.jsx(Ul,{children:n?o.jsx("div",{style:{textAlign:"center",padding:40,color:ye.textMuted},children:"Cargando..."}):j.length===0?o.jsxs("div",{style:{textAlign:"center",padding:40,color:ye.textMuted},children:[" No hay movimientos",g?" con los filtros seleccionados":"","."]}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Fecha/Hora"}),o.jsx("th",{children:"Item"}),o.jsx("th",{children:"Tipo"}),o.jsx("th",{children:"Cant."}),o.jsx("th",{children:"Motivo"}),o.jsx("th",{children:"Usuario"}),o.jsx("th",{children:"Notas"})]})}),o.jsx("tbody",{children:j.map(v=>{var S,_;const w=Gp.find(A=>A.value===v.tipo),C=v.tipo==="salida"||v.tipo==="ajuste_negativo",k=v.fecha_hora?new Date(v.fecha_hora).toLocaleString("es-MX",{timeZone:"America/Mexico_City",day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return o.jsxs("tr",{children:[o.jsx("td",{style:{fontFamily:"'DM Mono', monospace",fontSize:12,color:ye.textMuted,whiteSpace:"nowrap"},children:k}),o.jsx("td",{style:{fontWeight:600,color:ye.text},children:((S=v.inventario_items)==null?void 0:S.nombre)||""}),o.jsx("td",{children:o.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"3px 10px",borderRadius:8,fontSize:11,fontWeight:700,background:`${w==null?void 0:w.color}18`,color:w==null?void 0:w.color},children:[w==null?void 0:w.icon," ",w==null?void 0:w.label]})}),o.jsxs("td",{style:{fontFamily:"'DM Mono', monospace",fontWeight:700,color:C?"#f87171":"#34d399",fontSize:15},children:[C?"":"+",v.cantidad," ",o.jsx("span",{style:{fontSize:11,fontWeight:400,color:ye.textMuted},children:(_=v.inventario_items)==null?void 0:_.unidad})]}),o.jsx("td",{children:v.motivo}),o.jsx("td",{style:{fontSize:12,color:ye.textMuted},children:v.usuario}),o.jsx("td",{style:{fontSize:12,color:ye.textMuted,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:v.notas||""})]},v.id)})})]})})})]})}function Iae({item:e,almacenId:t,onClose:r,onSaved:n}){var _;const[a,i]=h.useState("entrada"),[s,l]=h.useState(""),[c,u]=h.useState(""),[d,f]=h.useState(""),[p,x]=h.useState(""),[m,y]=h.useState(""),[j,b]=h.useState(!1),g=Qj(e.stock_actual,e.punto_reorden),v=a==="salida"||a==="ajuste_negativo",w=parseInt(s)||0,C=v&&w>e.stock_actual,k=c==="Otro"?d:c,S=async()=>{if(!s||w<=0){oe.error("Ingrese cantidad vlida");return}if(!k||k.length<3){oe.error("Ingrese motivo vlido");return}if(C){oe.error(`Stock insuficiente (${e.stock_actual} ${e.unidad})`);return}b(!0);try{const{error:A}=await se.from("inventario_movimientos").insert({item_id:e.id,tipo:a,cantidad:w,motivo:k,usuario:p||"operador",notas:m||null,fecha_hora:Nae(),almacen_id:t});if(A)throw A;oe.success(`${v?"":"+"}${w} ${e.unidad} de ${e.nombre}`),n()}catch{oe.error("Error al registrar")}finally{b(!1)}};return o.jsx("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)"},onClick:r,children:o.jsxs("div",{style:{background:ye.card,borderRadius:16,border:`1px solid ${ye.border}`,padding:28,width:520,maxHeight:"90vh",overflowY:"auto"},onClick:A=>A.stopPropagation(),className:"inv-fade",children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:20},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:700},children:"Registrar Movimiento"}),o.jsxs("p",{style:{margin:"4px 0 0",fontSize:13,color:ye.textMuted},children:[e.nombre," (",e.codigo,")"]})]}),o.jsx("button",{onClick:r,style:{background:"none",border:"none",color:ye.textMuted,fontSize:20,cursor:"pointer"},children:""})]}),o.jsxs("div",{style:{background:ye.surface,padding:14,borderRadius:10,border:`1px solid ${ye.border}`,marginBottom:18,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:ye.textMuted,textTransform:"uppercase"},children:"Stock Actual"}),o.jsxs("div",{style:{fontSize:28,fontWeight:700,color:ye.text,fontFamily:"'DM Mono', monospace"},children:[e.stock_actual," ",o.jsx("span",{style:{fontSize:14,color:ye.textMuted,fontWeight:400},children:e.unidad})]})]}),o.jsx("span",{style:{padding:"4px 12px",borderRadius:20,fontSize:11,fontWeight:700,background:g.bg,color:g.color,border:`1.5px solid ${g.border}`,textTransform:"uppercase"},children:g.label})]}),o.jsx(sa,{children:"Tipo de Movimiento"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8,marginBottom:16},children:Gp.map(A=>o.jsxs("button",{onClick:()=>{i(A.value),u("")},style:{padding:"10px 8px",borderRadius:10,border:`1.5px solid ${a===A.value?A.color:ye.border}`,background:a===A.value?`${A.color}18`:ye.surface,cursor:"pointer",textAlign:"center",color:a===A.value?A.color:ye.textMuted,fontSize:12,fontWeight:600},children:[o.jsx("div",{style:{fontSize:18},children:A.icon}),A.label]},A.value))}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsxs(sa,{children:["Cantidad (",e.unidad,")"]}),o.jsx(eh,{type:"number",value:s,onChange:l,placeholder:"0",min:"1",style:C?{borderColor:"#f87171",background:"rgba(248,113,113,0.05)"}:{}}),C&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:"#f87171"},children:[" Stock insuficiente (",e.stock_actual," ",e.unidad,")"]}),w>0&&!C&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:ye.textMuted},children:["Resultante: ",o.jsxs("strong",{style:{color:ye.text},children:[v?e.stock_actual-w:e.stock_actual+w," ",e.unidad]})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx(sa,{children:"Motivo"}),o.jsx(AI,{value:c,onChange:u,options:(Aae[a]||[]).map(A=>({value:A,label:A})),placeholder:"Seleccionar motivo..."}),c==="Otro"&&o.jsx(eh,{value:d,onChange:f,placeholder:"Describa el motivo...",style:{marginTop:8}})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx(sa,{children:"Registrado por"}),o.jsx(eh,{value:p,onChange:x,placeholder:"Nombre del operador..."})]}),o.jsxs("div",{style:{marginBottom:20},children:[o.jsx(sa,{children:"Notas (opcional)"}),o.jsx(eh,{value:m,onChange:y,placeholder:"Observaciones..."})]}),o.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[o.jsx(Vn,{variant:"secondary",onClick:r,children:"Cancelar"}),o.jsx(Vn,{onClick:S,disabled:j||!s||w<=0||!k||C,style:{padding:"12px 28px"},children:j?"Guardando...":` Registrar ${(_=Gp.find(A=>A.value===a))==null?void 0:_.label}`})]})]})})}function $ae(){const{pathname:e}=Go(),{isAdmin:t}=_c();if(e==="/app/configuracion")return o.jsx(ho,{to:"/app/configuracion/usuarios",replace:!0});const r=[{to:"/app/configuracion/usuarios",label:"Usuarios",icon:"",adminOnly:!1},{to:"/app/configuracion/roles",label:"Roles",icon:"",adminOnly:!1},{to:"/app/configuracion/solicitudes",label:"Solicitudes",icon:"",adminOnly:!0}].filter(n=>!n.adminOnly||t);return o.jsxs("div",{children:[o.jsx("div",{className:"border-b border-[#2a2a3e] bg-[#111118]",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("nav",{className:"flex gap-0","aria-label":"Configuracin tabs",children:r.map(n=>{const a=e.startsWith(n.to);return o.jsxs(CP,{to:n.to,className:`
                    flex items-center gap-2 px-6 py-3 text-sm font-semibold transition-all
                    border-b-[2.5px] whitespace-nowrap
                    ${a?"border-blue-500 text-white":"border-transparent text-[#666680] hover:text-[#9999b0] hover:border-[#3a3a52]"}
                  `,children:[o.jsx("span",{children:n.icon}),n.label]},n.to)})})})}),o.jsx(_0,{})]})}const Rae=[{to:"/app/operacion/cosecha/registro",label:"Registro de Cosecha",icon:""},{to:"/app/operacion/cosecha/reportes",label:"Reportes de Cosecha",icon:""}];function Fae(){const{pathname:e}=Go();return e==="/app/operacion/cosecha"?o.jsx(ho,{to:"/app/operacion/cosecha/registro",replace:!0}):o.jsxs("div",{children:[o.jsx("div",{className:"border-b border-[#2a2a3e] bg-[#111118]",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("nav",{className:"flex gap-0","aria-label":"Cosecha tabs",children:Rae.map(t=>{const r=e.startsWith(t.to);return o.jsxs(CP,{to:t.to,className:`
                    flex items-center gap-2 px-6 py-3 text-sm font-semibold transition-all
                    border-b-[2.5px] whitespace-nowrap
                    ${r?"border-blue-500 text-white":"border-transparent text-[#666680] hover:text-[#9999b0] hover:border-[#3a3a52]"}
                  `,children:[o.jsx("span",{children:t.icon}),t.label]},t.to)})})})}),o.jsx(_0,{})]})}function EI(){const[e,t]=h.useState([]),[r,n]=h.useState(!0),[a,i]=h.useState(null);h.useEffect(()=>{let c=!1;return(async()=>{const{data:u,error:d}=await se.from("sectores_variedad").select("*").eq("activo",!0).order("sector");c||(d?i(d.message):u&&t(u),n(!1))})(),()=>{c=!0}},[]);const s=c=>e.find(u=>u.sector===c);return{sectores:e,loading:r,error:a,getSector:s,getTunnelRange:c=>{const u=s(c);return u?Array.from({length:u.tunel_final-u.tunel_inicio+1},(d,f)=>u.tunel_inicio+f):[]}}}function zae(e){const t=new Date(Date.UTC(parseInt(e.slice(0,4)),parseInt(e.slice(5,7))-1,parseInt(e.slice(8,10)))),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}function Bae(){const[e,t]=h.useState(!1);return{submit:async({fecha:n,cortes:a,mermas:i})=>{t(!0);try{const s=a.filter(d=>d.sector&&d.tunelInicio!==""&&d.tunelFinal!==""&&d.cubetas!=="").map(d=>({fecha:n,Semana:zae(n),sector:d.sector,variedad:d.variedad,tunel_inicio:Number(d.tunelInicio),tunel_final:Number(d.tunelFinal),cubetas_cosechadas:Number(d.cubetas),kg_cosechados:Math.round(Number(d.cubetas)*2.65*100)/100,observaciones:d.observaciones||null}));if(s.length===0)return oe.error("Agrega al menos un corte vlido"),t(!1),!1;const{data:l,error:c}=await se.from("cosecha_corte_dia").insert(s).select("id, sector");if(c)throw c;const u=[];if(i.forEach(d=>{if(!d.sector)return;const f=l==null?void 0:l.find(p=>p.sector===d.sector);Object.entries(d.detalles).forEach(([p,x])=>{const m=Number(x);m>0&&u.push({corte_id:(f==null?void 0:f.id)||null,fecha:n,sector:d.sector,tipo_merma:p,kg_merma:m})})}),u.length>0){const{error:d}=await se.from("cosecha_merma").insert(u);if(d)throw d}return oe.success(`Cosecha guardada: ${s.length} corte(s) y ${u.length} registro(s) de merma`),t(!1),!0}catch(s){return console.error("Error guardando cosecha:",s),oe.error(s.message||"Error al guardar cosecha"),t(!1),!1}},isSubmitting:e}}const fd=(e=!1)=>`w-full bg-[#1F1F1F] border ${e?"border-red-500":"border-[#2A2A2A]"} text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 ${e?"focus:ring-red-500":"focus:ring-blue-500"} transition-colors`;function Uae({entries:e,sectores:t,onAdd:r,onRemove:n,onChange:a,getSector:i,getTunnelRange:s}){return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-5 bg-blue-500 rounded-full"}),"Corte del Da"]}),e.map((l,c)=>{const u=l.sector?s(l.sector):[],d=l.sector?i(l.sector):void 0;return o.jsxs("div",{className:"bg-[#1A1A1A] p-5 rounded-xl border border-[#2A2A2A]",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("span",{className:"text-sm font-medium text-[#A3A3A3]",children:["Entrada ",c+1]}),e.length>1&&o.jsx("button",{type:"button",onClick:()=>n(l.uid),className:"text-[#666] hover:text-red-400 transition-colors",children:o.jsx(Cm,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Sector"}),o.jsxs("select",{value:l.sector,onChange:f=>a(l.uid,"sector",f.target.value),className:fd((!l.sector&&c===0,!1)),children:[o.jsx("option",{value:"",children:"Seleccionar"}),t.map(f=>o.jsx("option",{value:f.sector,children:f.sector},f.sector))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Variedad"}),o.jsx("div",{className:"w-full bg-[#161616] border border-[#2A2A2A] text-[#8B8B8B] rounded-xl px-4 py-3 text-sm",children:(d==null?void 0:d.variedad)||""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Tnel Inicio"}),o.jsxs("select",{value:l.tunelInicio,onChange:f=>a(l.uid,"tunelInicio",f.target.value?Number(f.target.value):""),disabled:!l.sector,className:fd(),children:[o.jsx("option",{value:"",children:"Seleccionar"}),u.map(f=>o.jsx("option",{value:f,children:f},f))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Tnel Final"}),o.jsxs("select",{value:l.tunelFinal,onChange:f=>a(l.uid,"tunelFinal",f.target.value?Number(f.target.value):""),disabled:!l.sector,className:fd(),children:[o.jsx("option",{value:"",children:"Seleccionar"}),u.filter(f=>l.tunelInicio===""||f>=Number(l.tunelInicio)).map(f=>o.jsx("option",{value:f,children:f},f))]})]})]}),o.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:["Cubetas Cosechadas",o.jsx("span",{className:"ml-1.5 text-[#555] font-normal text-xs",children:"( 2.65 kg)"})]}),o.jsx("input",{type:"number",value:l.cubetas,onChange:f=>{const p=f.target.value?Number(f.target.value):"",x=p!==""?Math.round(p*2.65*100)/100:"";a(l.uid,"cubetas",p),a(l.uid,"kgCosechados",x)},onWheel:f=>f.currentTarget.blur(),min:"0",step:"1",placeholder:"0",className:fd()})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Kg Calculados"}),o.jsx("div",{className:`w-full bg-[#161616] border ${l.cubetas!==""?"border-blue-500/40 text-white":"border-[#2A2A2A] text-[#555]"} rounded-xl px-4 py-3 text-sm font-mono transition-colors`,children:l.cubetas!==""?`${(Number(l.cubetas)*2.65).toFixed(2)} kg`:""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Observaciones"}),o.jsx("input",{type:"text",value:l.observaciones,onChange:f=>a(l.uid,"observaciones",f.target.value),placeholder:"Opcional",className:fd()})]})]})]},l.uid)}),o.jsxs("button",{type:"button",onClick:r,className:"w-full bg-[#1F1F1F] border border-dashed border-[#333] text-[#A3A3A3] rounded-xl py-3 flex items-center justify-center gap-2 hover:bg-[#2A2A2A] hover:text-white transition-colors",children:[o.jsx(Js,{className:"w-4 h-4"}),"Aadir otro sector"]})]})}const NI=["Insecto / Larva","Picada de pjaro","Pudricin","Deshidratacin","Blanda","Rasgada","Fruta roja","Cicatriz","Pednculo","Pequea (<11mm)","Resto floral"];let Wae=0;const PI=()=>`_${++Wae}_${Date.now()}`,ev=()=>({uid:PI(),sector:"",variedad:"",tunelInicio:"",tunelFinal:"",cubetas:"",kgCosechados:"",observaciones:""}),tv=()=>({uid:PI(),sector:"",detalles:Object.fromEntries(NI.map(e=>[e,""]))});function qae({entries:e,sectores:t,onAdd:r,onRemove:n,onChange:a,onDetailChange:i,totalKgBySector:s}){const l=u=>Object.values(u.detalles).reduce((d,f)=>d+(Number(f)||0),0),c=u=>{const d=s[u.sector]||0,f=l(u);return d<=0||f<=0?"0.0":(f/d*100).toFixed(1)};return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-5 bg-amber-500 rounded-full"}),"Merma de Campo",o.jsx("span",{className:"text-xs text-[#666] font-normal",children:"(opcional)"})]}),e.map((u,d)=>o.jsxs("div",{className:"bg-[#1A1A1A] p-5 rounded-xl border border-[#2A2A2A]",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-[#666] mb-1",children:"Sector"}),o.jsxs("select",{value:u.sector,onChange:f=>a(u.uid,f.target.value),className:"bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[o.jsx("option",{value:"",children:"Seleccionar"}),t.map(f=>o.jsx("option",{value:f.sector,children:f.sector},f.sector))]})]}),u.sector&&o.jsxs("div",{className:"flex gap-4 text-sm",children:[o.jsxs("span",{className:"text-[#A3A3A3]",children:["Total: ",o.jsxs("span",{className:"text-white font-medium",children:[l(u).toFixed(2)," kg"]})]}),o.jsxs("span",{className:"text-[#A3A3A3]",children:["% Merma: ",o.jsxs("span",{className:`font-medium ${Number(c(u))>5?"text-red-400":"text-emerald-400"}`,children:[c(u),"%"]})]})]})]}),e.length>1&&o.jsx("button",{type:"button",onClick:()=>n(u.uid),className:"text-[#666] hover:text-red-400 transition-colors",children:o.jsx(Cm,{className:"w-4 h-4"})})]}),u.sector&&o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:NI.map(f=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-[#888] mb-1 truncate",title:f,children:f}),o.jsx("input",{type:"number",value:u.detalles[f],onChange:p=>i(u.uid,f,p.target.value?Number(p.target.value):""),onWheel:p=>p.currentTarget.blur(),min:"0",step:"0.001",placeholder:"0",className:"w-full bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-amber-500 focus:outline-none"})]},f))})]},u.uid)),o.jsxs("button",{type:"button",onClick:r,className:"w-full bg-[#1F1F1F] border border-dashed border-[#333] text-[#A3A3A3] rounded-xl py-3 flex items-center justify-center gap-2 hover:bg-[#2A2A2A] hover:text-white transition-colors",children:[o.jsx(Js,{className:"w-4 h-4"}),"Aadir merma de otro sector"]})]})}const Kae=[{key:"kg",label:"Total Kg",color:"text-blue-400",format:e=>e.toLocaleString("es-MX",{maximumFractionDigits:1})},{key:"sectores",label:"Sectores",color:"text-emerald-400",format:e=>e.toString()},{key:"tuneles",label:"Tneles",color:"text-purple-400",format:e=>e.toString()},{key:"mermaKg",label:"Merma Kg",color:"text-amber-400",format:e=>e.toLocaleString("es-MX",{maximumFractionDigits:2})},{key:"mermaPct",label:"% Merma",color:"text-red-400",format:e=>`${e.toFixed(1)}%`}];function Gae({totalKg:e,sectoresCount:t,tunelesCount:r,totalMermaKg:n,mermaPercent:a}){const i={kg:e,sectores:t,tuneles:r,mermaKg:n,mermaPct:a};return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-5 bg-emerald-500 rounded-full"}),"Resumen del Da"]}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:Kae.map(s=>o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888] mb-1",children:s.label}),o.jsx("p",{className:`text-xl font-bold ${s.color}`,children:s.format(i[s.key])})]},s.key))})]})}function Vae(){const{sectores:e,loading:t,getSector:r,getTunnelRange:n}=EI(),{submit:a,isSubmitting:i}=Bae(),[s,l]=h.useState(new Date().toISOString().split("T")[0]),[c,u]=h.useState([ev()]),[d,f]=h.useState([tv()]),p=(k,S,_)=>{u(A=>A.map(E=>{if(E.uid!==k)return E;const N={...E,[S]:_};if(S==="sector"){const $=r(_);N.variedad=($==null?void 0:$.variedad)||"",N.tunelInicio="",N.tunelFinal=""}return N}))},x=()=>u(k=>[...k,ev()]),m=k=>u(S=>S.length>1?S.filter(_=>_.uid!==k):S),y=(k,S)=>{f(_=>_.map(A=>A.uid===k?{...A,sector:S}:A))},j=(k,S,_)=>{f(A=>A.map(E=>E.uid!==k?E:{...E,detalles:{...E.detalles,[S]:_}}))},b=()=>f(k=>[...k,tv()]),g=k=>f(S=>S.length>1?S.filter(_=>_.uid!==k):S),v=h.useMemo(()=>{const k=c.filter($=>$.sector&&$.kgCosechados!==""),S=k.reduce(($,z)=>$+Number(z.kgCosechados),0),_=new Set(k.map($=>$.sector)),A=k.reduce(($,z)=>{const T=Number(z.tunelInicio)||0,I=Number(z.tunelFinal)||0;return $+Math.max(I-T+1,0)},0);let E=0;d.forEach($=>{Object.values($.detalles).forEach(z=>{E+=Number(z)||0})});const N=S>0?E/S*100:0;return{totalKg:S,sectoresCount:_.size,tunelesCount:A,totalMermaKg:E,mermaPercent:N}},[c,d]),w=h.useMemo(()=>{const k={};return c.forEach(S=>{S.sector&&S.kgCosechados!==""&&(k[S.sector]=(k[S.sector]||0)+Number(S.kgCosechados))}),k},[c]),C=async k=>{k.preventDefault(),await a({fecha:s,cortes:c,mermas:d})&&(u([ev()]),f([tv()]))};return t?o.jsxs("div",{className:"flex items-center justify-center py-20 text-[#A3A3A3]",children:[o.jsx(ir,{className:"w-6 h-6 animate-spin mr-2"})," Cargando catlogo de sectores"]}):o.jsx("div",{className:"min-h-screen bg-[#0D0D0D] text-white p-4 sm:p-8",children:o.jsxs("div",{className:"max-w-5xl mx-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold mb-1",children:"Registro de Cosecha"}),o.jsx("p",{className:"text-[#A3A3A3]",children:"Capture el corte del da, kilogramos y merma de campo"})]}),o.jsxs("form",{onSubmit:C,className:"space-y-6",children:[o.jsxs("div",{className:"bg-[#1A1A1A] p-5 rounded-xl border border-[#2A2A2A]",children:[o.jsx("label",{className:"block text-sm font-medium text-[#A3A3A3] mb-1.5",children:"Fecha de Cosecha"}),o.jsx("input",{type:"date",value:s,onChange:k=>l(k.target.value),max:new Date().toISOString().split("T")[0],className:"w-full sm:w-64 bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsx(Uae,{entries:c,sectores:e,onAdd:x,onRemove:m,onChange:p,getSector:r,getTunnelRange:n}),o.jsx(qae,{entries:d,sectores:e,onAdd:b,onRemove:g,onChange:y,onDetailChange:j,totalKgBySector:w}),o.jsx(Gae,{...v}),o.jsxs("button",{type:"submit",disabled:i,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-xl py-4 flex items-center justify-center gap-2 font-semibold transition-colors",children:[i?o.jsx(ir,{className:"w-5 h-5 animate-spin"}):o.jsx(Bi,{className:"w-5 h-5"}),i?"Guardando":"Guardar Registro de Cosecha"]})]})]})})}function Hae(){const[e,t]=h.useState(!1),r=h.useCallback(async(u,d)=>{t(!0);const{data:f,error:p}=await se.rpc("rpt_merma_por_sector_tipo",{p_fecha_inicio:u.desde,p_fecha_fin:u.hasta,p_sector:d||null});if(t(!1),p)throw p;return f||[]},[]),n=h.useCallback(async u=>{t(!0);const{data:d,error:f}=await se.rpc("rpt_kg_por_cosechador",{p_fecha_inicio:u.desde,p_fecha_fin:u.hasta});if(t(!1),f)throw f;return d||[]},[]),a=h.useCallback(async u=>{t(!0);const{data:d,error:f}=await se.rpc("rpt_kg_por_sector",{p_fecha_inicio:u.desde,p_fecha_fin:u.hasta});if(t(!1),f)throw f;return d||[]},[]),i=h.useCallback(async(u=12)=>{t(!0);const{data:d,error:f}=await se.rpc("rpt_tendencia_semanal",{p_semanas:u});if(t(!1),f)throw f;return d||[]},[]),s=h.useCallback(async u=>{t(!0);const{data:d,error:f}=await se.rpc("rpt_produccion_por_variedad",{p_fecha_inicio:u.desde,p_fecha_fin:u.hasta});if(t(!1),f)throw f;return d||[]},[]),l=h.useCallback(async()=>{t(!0);const{data:u,error:d}=await se.rpc("rpt_comparativo_semanal");if(t(!1),d)throw d;return u||[]},[]),c=h.useCallback(async u=>{t(!0);const{data:d,error:f}=await se.rpc("rpt_merma_vs_produccion",{p_fecha_inicio:u.desde,p_fecha_fin:u.hasta});if(t(!1),f)throw f;return d||[]},[]);return{loading:e,fetchMerma:r,fetchKgCosechador:n,fetchKgSector:a,fetchTendencia:i,fetchVariedad:s,fetchComparativo:l,fetchMermaVsProduccion:c}}const rv="bg-[#1F1F1F] border border-[#2A2A2A] text-white rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none";function Xae({desde:e,hasta:t,sector:r,sectores:n,onDesdeChange:a,onHastaChange:i,onSectorChange:s,onApply:l,loading:c}){return o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] flex flex-wrap items-end gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-[#888] mb-1",children:"Desde"}),o.jsx("input",{type:"date",value:e,onChange:u=>a(u.target.value),className:rv})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-[#888] mb-1",children:"Hasta"}),o.jsx("input",{type:"date",value:t,onChange:u=>i(u.target.value),className:rv})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-[#888] mb-1",children:"Sector"}),o.jsxs("select",{value:r,onChange:u=>s(u.target.value),className:rv,children:[o.jsx("option",{value:"",children:"Todos"}),n.map(u=>o.jsx("option",{value:u.sector,children:u.sector},u.sector))]})]}),o.jsxs("button",{onClick:l,disabled:c,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded-lg px-4 py-2 text-sm font-medium flex items-center gap-1.5 transition-colors",children:[o.jsx(Fl,{className:"w-4 h-4"}),"Aplicar"]})]})}const IA=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#8b5cf6","#ec4899","#64748b","#14b8a6","#f43f5e","#a855f7"];function Yae({data:e}){var i;if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos de merma para el rango seleccionado."});const t={};e.forEach(s=>{t[s.tipo_merma]=(t[s.tipo_merma]||0)+s.total_kg});const r=Object.entries(t).map(([s,l])=>({name:s,value:Number(l.toFixed(2))})).sort((s,l)=>l.value-s.value),n=r.reduce((s,l)=>s+l.value,0),a=[...new Set(e.map(s=>s.sector))].sort();return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Total Merma"}),o.jsxs("p",{className:"text-xl font-bold text-red-400",children:[n.toLocaleString("es-MX",{maximumFractionDigits:1})," kg"]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Tipo Principal"}),o.jsx("p",{className:"text-xl font-bold text-amber-400",children:((i=r[0])==null?void 0:i.name)||""})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Sectores Afectados"}),o.jsx("p",{className:"text-xl font-bold text-blue-400",children:a.length})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Merma por Tipo (kg)"}),o.jsx(Jn,{width:"100%",height:300,children:o.jsxs(Fc,{data:r,layout:"vertical",margin:{left:120},children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{type:"number",tick:{fill:"#888",fontSize:12}}),o.jsx(Cn,{dataKey:"name",type:"category",tick:{fill:"#ccc",fontSize:11},width:110}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},labelStyle:{color:"#fff"},formatter:s=>[`${s} kg`,"Merma"]}),o.jsx(Ea,{dataKey:"value",radius:[0,4,4,0],children:r.map((s,l)=>o.jsx(Gi,{fill:IA[l%IA.length]},l))})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Sector"}),o.jsx("th",{className:"px-4 py-3 text-left",children:"Tipo Merma"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"% del Sector"})]})}),o.jsx("tbody",{children:e.map((s,l)=>o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsx("td",{className:"px-4 py-2 text-white font-medium",children:s.sector}),o.jsx("td",{className:"px-4 py-2 text-[#ccc]",children:s.tipo_merma}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(s.total_kg).toFixed(2)}),o.jsxs("td",{className:"px-4 py-2 text-right text-[#A3A3A3]",children:[s.porcentaje_del_sector,"%"]})]},l))})]})})]})}function Jae({data:e}){if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos de cosechadores para el rango seleccionado."});const t=e.reduce((a,i)=>a+Number(i.total_kg),0),r=e.reduce((a,i)=>a+Number(i.total_cubetas),0),n=e.slice(0,20).map(a=>({name:a.cosechador_nombre.length>15?a.cosechador_nombre.slice(0,15)+"":a.cosechador_nombre,kg:Number(Number(a.total_kg).toFixed(1))}));return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Total Kg"}),o.jsx("p",{className:"text-xl font-bold text-blue-400",children:t.toLocaleString("es-MX",{maximumFractionDigits:1})})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Total Cubetas"}),o.jsx("p",{className:"text-xl font-bold text-emerald-400",children:r.toLocaleString()})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Cosechadores"}),o.jsx("p",{className:"text-xl font-bold text-purple-400",children:e.length})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Top Cosechadores (kg)"}),o.jsx(Jn,{width:"100%",height:Math.max(300,n.length*30),children:o.jsxs(Fc,{data:n,layout:"vertical",margin:{left:110},children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{type:"number",tick:{fill:"#888",fontSize:12}}),o.jsx(Cn,{dataKey:"name",type:"category",tick:{fill:"#ccc",fontSize:11},width:100}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},formatter:a=>[`${a} kg`,"Produccin"]}),o.jsx(Ea,{dataKey:"kg",fill:"#3b82f6",radius:[0,4,4,0]})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"#"}),o.jsx("th",{className:"px-4 py-3 text-left",children:"Cosechador"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Cubetas"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Das"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg/Da"})]})}),o.jsx("tbody",{children:e.map((a,i)=>o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsx("td",{className:"px-4 py-2 text-[#666]",children:i+1}),o.jsx("td",{className:"px-4 py-2 text-white font-medium",children:a.cosechador_nombre}),o.jsx("td",{className:"px-4 py-2 text-right text-[#ccc]",children:Number(a.total_cubetas).toLocaleString()}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(a.total_kg).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-[#A3A3A3]",children:a.dias_trabajados}),o.jsx("td",{className:"px-4 py-2 text-right text-blue-400",children:a.dias_trabajados>0?(Number(a.total_kg)/Number(a.dias_trabajados)).toFixed(1):""})]},a.cosechador_id))})]})})]})}function Zae({data:e}){if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos para el rango seleccionado."});const t=e.reduce((n,a)=>n+Number(a.total_kg),0),r=e.map(n=>({name:n.sector,kg:Number(Number(n.total_kg).toFixed(1))}));return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Total Kg"}),o.jsx("p",{className:"text-xl font-bold text-blue-400",children:t.toLocaleString("es-MX",{maximumFractionDigits:1})})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Sectores Activos"}),o.jsx("p",{className:"text-xl font-bold text-emerald-400",children:e.length})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Kg por Sector"}),o.jsx(Jn,{width:"100%",height:350,children:o.jsxs(Fc,{data:r,margin:{bottom:20},children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{dataKey:"name",tick:{fill:"#ccc",fontSize:11},angle:-45,textAnchor:"end",height:60}),o.jsx(Cn,{tick:{fill:"#888",fontSize:12}}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},formatter:n=>[`${n} kg`]}),o.jsx(Ea,{dataKey:"kg",fill:"#22c55e",radius:[4,4,0,0]})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Sector"}),o.jsx("th",{className:"px-4 py-3 text-left",children:"Variedad"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg Total"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Cortes"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"% del Total"})]})}),o.jsx("tbody",{children:e.map(n=>o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsx("td",{className:"px-4 py-2 text-white font-medium",children:n.sector}),o.jsx("td",{className:"px-4 py-2 text-[#A3A3A3]",children:n.variedad}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(n.total_kg).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-[#ccc]",children:n.num_cortes}),o.jsxs("td",{className:"px-4 py-2 text-right text-blue-400",children:[(Number(n.total_kg)/t*100).toFixed(1),"%"]})]},n.sector))})]})})]})}function Qae({data:e}){if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos de tendencia."});const t=e.map(r=>({label:`S${r.semana}`,kg:Number(Number(r.total_kg).toFixed(1)),merma:Number(Number(r.total_merma_kg).toFixed(1)),pctMerma:Number(r.porcentaje_merma)}));return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Produccin y Merma por Semana (kg)"}),o.jsx(Jn,{width:"100%",height:300,children:o.jsxs(Bd,{data:t,children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{dataKey:"label",tick:{fill:"#ccc",fontSize:12}}),o.jsx(Cn,{tick:{fill:"#888",fontSize:12}}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8}}),o.jsx(ki,{}),o.jsx(Ai,{type:"monotone",dataKey:"kg",stroke:"#3b82f6",strokeWidth:2,name:"Kg Cosechados",dot:{r:3}}),o.jsx(Ai,{type:"monotone",dataKey:"merma",stroke:"#ef4444",strokeWidth:2,name:"Kg Merma",dot:{r:3}})]})})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"% Merma por Semana"}),o.jsx(Jn,{width:"100%",height:200,children:o.jsxs(Bd,{data:t,children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{dataKey:"label",tick:{fill:"#ccc",fontSize:12}}),o.jsx(Cn,{tick:{fill:"#888",fontSize:12},unit:"%"}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},formatter:r=>[`${r}%`]}),o.jsx(Ai,{type:"monotone",dataKey:"pctMerma",stroke:"#eab308",strokeWidth:2,name:"% Merma",dot:{r:3}})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Semana"}),o.jsx("th",{className:"px-4 py-3 text-left",children:"Inicio"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg Cosechados"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg Merma"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"% Merma"})]})}),o.jsx("tbody",{children:e.map((r,n)=>o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsxs("td",{className:"px-4 py-2 text-white font-medium",children:["S",r.semana," / ",r.anio]}),o.jsx("td",{className:"px-4 py-2 text-[#A3A3A3]",children:r.fecha_inicio}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(r.total_kg).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-red-400",children:Number(r.total_merma_kg).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsxs("td",{className:"px-4 py-2 text-right text-amber-400",children:[r.porcentaje_merma??0,"%"]})]},n))})]})})]})}const th=["#3b82f6","#22c55e","#eab308","#ef4444","#8b5cf6","#06b6d4","#f97316","#ec4899","#14b8a6"];function eie({data:e}){if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos por variedad."});const t=e.reduce((n,a)=>n+Number(a.total_kg),0),r=e.map(n=>({name:n.variedad,value:Number(Number(n.total_kg).toFixed(1))}));return o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Distribucin por Variedad"}),o.jsx(Jn,{width:"100%",height:300,children:o.jsxs(Foe,{children:[o.jsx(zj,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:({name:n,percent:a})=>`${n} ${(a*100).toFixed(0)}%`,children:r.map((n,a)=>o.jsx(Gi,{fill:th[a%th.length]},a))}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},formatter:n=>[`${n} kg`]})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Variedad"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Sectores"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Prom Kg/Sector"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"%"})]})}),o.jsx("tbody",{children:e.map((n,a)=>o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsxs("td",{className:"px-4 py-2 text-white font-medium flex items-center gap-2",children:[o.jsx("span",{className:"w-3 h-3 rounded-full inline-block",style:{backgroundColor:th[a%th.length]}}),n.variedad]}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(n.total_kg).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-[#ccc]",children:n.num_sectores}),o.jsx("td",{className:"px-4 py-2 text-right text-[#A3A3A3]",children:Number(n.promedio_kg_sector).toFixed(1)}),o.jsxs("td",{className:"px-4 py-2 text-right text-blue-400",children:[(Number(n.total_kg)/t*100).toFixed(1),"%"]})]},n.variedad))})]})})]})})}function tie({data:e}){if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos comparativos."});const t=e.map(i=>({name:i.sector,actual:Number(Number(i.kg_semana_actual).toFixed(1)),anterior:Number(Number(i.kg_semana_anterior).toFixed(1))})),r=e.reduce((i,s)=>i+Number(s.kg_semana_actual),0),n=e.reduce((i,s)=>i+Number(s.kg_semana_anterior),0),a=n>0?(r-n)/n*100:0;return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Semana Actual"}),o.jsxs("p",{className:"text-xl font-bold text-blue-400",children:[r.toLocaleString("es-MX",{maximumFractionDigits:0})," kg"]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Semana Anterior"}),o.jsxs("p",{className:"text-xl font-bold text-[#A3A3A3]",children:[n.toLocaleString("es-MX",{maximumFractionDigits:0})," kg"]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Cambio Global"}),o.jsxs("p",{className:`text-xl font-bold ${a>=0?"text-emerald-400":"text-red-400"}`,children:[a>=0?"+":"",a.toFixed(1),"%"]})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Comparativo por Sector"}),o.jsx(Jn,{width:"100%",height:350,children:o.jsxs(Fc,{data:t,margin:{bottom:20},children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{dataKey:"name",tick:{fill:"#ccc",fontSize:11},angle:-45,textAnchor:"end",height:60}),o.jsx(Cn,{tick:{fill:"#888",fontSize:12}}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8}}),o.jsx(ki,{}),o.jsx(Ea,{dataKey:"actual",fill:"#3b82f6",name:"Semana Actual",radius:[4,4,0,0]}),o.jsx(Ea,{dataKey:"anterior",fill:"#4b5563",name:"Semana Anterior",radius:[4,4,0,0]})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Sector"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Sem. Actual (kg)"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Sem. Anterior (kg)"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Diferencia"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"% Cambio"})]})}),o.jsx("tbody",{children:e.map(i=>{const s=Number(i.diferencia),l=i.porcentaje_cambio;return o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsx("td",{className:"px-4 py-2 text-white font-medium",children:i.sector}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(i.kg_semana_actual).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-[#A3A3A3]",children:Number(i.kg_semana_anterior).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right",children:o.jsxs("span",{className:`inline-flex items-center gap-1 ${s>0?"text-emerald-400":s<0?"text-red-400":"text-[#666]"}`,children:[s>0?o.jsx(Q8,{className:"w-3 h-3"}):s<0?o.jsx(Z8,{className:"w-3 h-3"}):o.jsx(Ns,{className:"w-3 h-3"}),s>0?"+":"",s.toFixed(1)]})}),o.jsx("td",{className:"px-4 py-2 text-right",children:o.jsx("span",{className:l!==null?Number(l)>=0?"text-emerald-400":"text-red-400":"text-[#666]",children:l!==null?`${Number(l)>=0?"+":""}${l}%`:""})})]},i.sector)})})]})})]})}function rie({data:e}){var a,i;if(e.length===0)return o.jsx("p",{className:"text-[#666] text-center py-10",children:"Sin datos para el rango seleccionado."});const t=e.map(s=>({name:s.sector,pct:Number(s.porcentaje_merma)||0})),r=e.length>0?e.reduce((s,l)=>s+(Number(l.porcentaje_merma)||0),0)/e.length:0,n=s=>s>5?"#ef4444":s>3?"#eab308":"#22c55e";return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Promedio % Merma"}),o.jsxs("p",{className:`text-xl font-bold ${r>5?"text-red-400":r>3?"text-amber-400":"text-emerald-400"}`,children:[r.toFixed(1),"%"]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A] text-center",children:[o.jsx("p",{className:"text-xs text-[#888]",children:"Peor Sector"}),o.jsxs("p",{className:"text-xl font-bold text-red-400",children:[((a=e[0])==null?void 0:a.sector)||""," (",((i=e[0])==null?void 0:i.porcentaje_merma)||0,"%)"]})]})]}),o.jsxs("div",{className:"bg-[#1A1A1A] rounded-xl p-4 border border-[#2A2A2A]",children:[o.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"% Merma por Sector"}),o.jsx(Jn,{width:"100%",height:350,children:o.jsxs(Fc,{data:t,margin:{bottom:20},children:[o.jsx(ko,{strokeDasharray:"3 3",stroke:"#2A2A2A"}),o.jsx(kn,{dataKey:"name",tick:{fill:"#ccc",fontSize:11},angle:-45,textAnchor:"end",height:60}),o.jsx(Cn,{tick:{fill:"#888",fontSize:12},unit:"%"}),o.jsx(Yn,{contentStyle:{backgroundColor:"#1A1A1A",border:"1px solid #333",borderRadius:8},formatter:s=>[`${s}%`]}),o.jsx(Ea,{dataKey:"pct",radius:[4,4,0,0],children:t.map((s,l)=>o.jsx(Gi,{fill:n(s.pct)},l))})]})})]}),o.jsx("div",{className:"bg-[#1A1A1A] rounded-xl border border-[#2A2A2A] overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-[#2A2A2A] text-[#888]",children:[o.jsx("th",{className:"px-4 py-3 text-left",children:"Sector"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg Cosechados"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Kg Merma"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"% Merma"}),o.jsx("th",{className:"px-4 py-3 text-center",children:"Estado"})]})}),o.jsx("tbody",{children:e.map(s=>{const l=Number(s.porcentaje_merma)||0;return o.jsxs("tr",{className:"border-b border-[#1F1F1F] hover:bg-[#1F1F1F]",children:[o.jsx("td",{className:"px-4 py-2 text-white font-medium",children:s.sector}),o.jsx("td",{className:"px-4 py-2 text-right text-white",children:Number(s.kg_cosechados).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsx("td",{className:"px-4 py-2 text-right text-red-400",children:Number(s.kg_merma).toLocaleString("es-MX",{maximumFractionDigits:1})}),o.jsxs("td",{className:"px-4 py-2 text-right font-medium",style:{color:n(l)},children:[l.toFixed(1),"%"]}),o.jsx("td",{className:"px-4 py-2 text-center",children:o.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:n(l)+"22",color:n(l)},children:l>5?"Crtico":l>3?"Alerta":"Normal"})})]},s.sector)})})]})})]})}const nie=[{id:"merma",label:"Merma",icon:""},{id:"cosechador",label:"Kg / Cosechador",icon:""},{id:"sector",label:"Kg / Sector",icon:""},{id:"tendencia",label:"Tendencia Semanal",icon:""},{id:"variedad",label:"Por Variedad",icon:""},{id:"comparativo",label:"Comparativo",icon:""},{id:"mermaVsProd",label:"% Merma vs Prod.",icon:""}],oie=new Date().toISOString().split("T")[0],aie=new Date(Date.now()-30*864e5).toISOString().split("T")[0];function iie(){const{sectores:e}=EI(),t=Hae(),[r,n]=h.useState("merma"),[a,i]=h.useState(aie),[s,l]=h.useState(oie),[c,u]=h.useState(""),[d,f]=h.useState([]),[p,x]=h.useState(!1),m=h.useCallback(async()=>{try{let g=[];const v={desde:a,hasta:s};switch(r){case"merma":g=await t.fetchMerma(v,c||void 0);break;case"cosechador":g=await t.fetchKgCosechador(v);break;case"sector":g=await t.fetchKgSector(v);break;case"tendencia":g=await t.fetchTendencia(12);break;case"variedad":g=await t.fetchVariedad(v);break;case"comparativo":g=await t.fetchComparativo();break;case"mermaVsProd":g=await t.fetchMermaVsProduccion(v);break}f(g),x(!0)}catch(g){console.error("Error fetching report:",g),f([])}},[r,a,s,c,t]),y=g=>{n(g),f([]),x(!1)},j=()=>{if(d.length===0)return;const g=Object.keys(d[0]).join(","),v=d.map(_=>Object.values(_).join(",")),w=[g,...v].join(`
`),C=new Blob([w],{type:"text/csv"}),k=URL.createObjectURL(C),S=document.createElement("a");S.href=k,S.download=`reporte_${r}_${a}_${s}.csv`,S.click(),URL.revokeObjectURL(k)},b=r==="tendencia"||r==="comparativo";return o.jsx("div",{className:"min-h-screen bg-[#0D0D0D] text-white p-4 sm:p-8",children:o.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold mb-1",children:"Reportes de Cosecha"}),o.jsx("p",{className:"text-[#A3A3A3]",children:"Seleccione un reporte, configure filtros y presione Aplicar"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:nie.map(g=>o.jsxs("button",{onClick:()=>y(g.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-1.5 ${r===g.id?"bg-blue-600 text-white":"bg-[#1A1A1A] text-[#A3A3A3] hover:bg-[#222] border border-[#2A2A2A]"}`,children:[o.jsx("span",{children:g.icon}),g.label]},g.id))}),!b&&o.jsx(Xae,{desde:a,hasta:s,sector:c,sectores:e,onDesdeChange:i,onHastaChange:l,onSectorChange:u,onApply:m,loading:t.loading}),b&&o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:m,disabled:t.loading,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded-lg px-5 py-2.5 text-sm font-medium transition-colors",children:t.loading?o.jsx(ir,{className:"w-4 h-4 animate-spin"}):"Cargar Reporte"}),r==="tendencia"&&o.jsx("span",{className:"text-[#666] text-sm self-center",children:"ltimas 12 semanas"}),r==="comparativo"&&o.jsx("span",{className:"text-[#666] text-sm self-center",children:"Semana actual vs. anterior"})]}),t.loading&&o.jsxs("div",{className:"flex items-center justify-center py-10 text-[#A3A3A3]",children:[o.jsx(ir,{className:"w-5 h-5 animate-spin mr-2"})," Cargando reporte"]}),!t.loading&&p&&o.jsxs(o.Fragment,{children:[d.length>0&&o.jsx("div",{className:"flex justify-end",children:o.jsxs("button",{onClick:j,className:"bg-[#1A1A1A] border border-[#2A2A2A] text-[#A3A3A3] hover:text-white rounded-lg px-4 py-2 text-sm flex items-center gap-1.5 transition-colors",children:[o.jsx(K8,{className:"w-4 h-4"}),"Exportar CSV"]})}),r==="merma"&&o.jsx(Yae,{data:d}),r==="cosechador"&&o.jsx(Jae,{data:d}),r==="sector"&&o.jsx(Zae,{data:d}),r==="tendencia"&&o.jsx(Qae,{data:d}),r==="variedad"&&o.jsx(eie,{data:d}),r==="comparativo"&&o.jsx(tie,{data:d}),r==="mermaVsProd"&&o.jsx(rie,{data:d})]}),!t.loading&&!p&&o.jsx("div",{className:"text-center py-16 text-[#555]",children:o.jsx("p",{className:"text-lg",children:'Presione "Aplicar" o "Cargar Reporte" para ver los resultados'})})]})})}function MI(){return _c()}function sie({action_key:e,context_id:t,context_data:r,title:n,description:a,onClose:i,onApproved:s,onRequested:l}){const{checkApproval:c,requestApproval:u}=SI(),[d,f]=h.useState(!0),[p,x]=h.useState(!1),m=wI[e],y=n??(m==null?void 0:m.label)??e,j=a??(m==null?void 0:m.description)??"";h.useEffect(()=>{let g=!1;return(async()=>{const v=await c(e,t);g||(f(!1),v==="allowed"&&s())})(),()=>{g=!0}},[]);const b=async()=>{x(!0);try{const v=await u({action_key:e,context_id:t,context_data:r});l(v)}catch{}finally{x(!1)}};return d?o.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-[#1A1A1A] rounded-2xl p-8 flex items-center gap-3 shadow-2xl",children:[o.jsx(ir,{className:"w-5 h-5 animate-spin text-[#555]"}),o.jsx("span",{className:"text-[#999] text-sm",children:"Verificando permisos"})]})}):o.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:g=>g.target===g.currentTarget&&i(),children:o.jsxs("div",{className:"bg-[#1A1A1A] border border-[#333] rounded-2xl shadow-2xl w-full max-w-md",children:[o.jsxs("div",{className:"flex items-start gap-4 p-6 border-b border-[#222]",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#F59E0B15] border border-[#F59E0B30] flex items-center justify-center flex-shrink-0",children:o.jsx(J8,{className:"w-5 h-5 text-[#F59E0B]"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-semibold text-base",children:"Accin requiere autorizacin"}),o.jsx("p",{className:"text-[#555] text-xs mt-0.5",children:y})]})]}),o.jsxs("div",{className:"p-6 space-y-4",children:[j&&o.jsx("p",{className:"text-[#999] text-sm leading-relaxed",children:j}),r&&Object.keys(r).length>0&&o.jsxs("div",{className:"bg-[#111] rounded-xl px-4 py-3 space-y-2 border border-[#222]",children:[o.jsx("p",{className:"text-[11px] text-[#555] font-semibold uppercase tracking-wider",children:"Detalles de la solicitud"}),Object.entries(r).map(([g,v])=>o.jsxs("div",{className:"flex justify-between items-center gap-4",children:[o.jsx("span",{className:"text-[#555] text-xs capitalize",children:String(g).replace(/_/g," ")}),o.jsx("span",{className:"text-[#ccc] text-xs font-medium text-right",children:String(v)})]},g))]}),o.jsx("div",{className:"bg-[#3B82F615] border border-[#3B82F630] rounded-xl p-3",children:o.jsxs("p",{className:"text-[#3B82F6] text-xs leading-relaxed",children:["Al solicitar autorizacin, el administrador recibir una notificacin. Una vez aprobada, tendrs ",o.jsx("strong",{children:"4 horas"})," para ejecutar la accin."]})})]}),o.jsxs("div",{className:"flex gap-3 p-6 pt-0 justify-end",children:[o.jsx("button",{onClick:i,disabled:p,className:"text-sm text-[#666] hover:text-white transition-colors px-4 py-2 rounded-lg hover:bg-[#222]",children:"Cancelar"}),o.jsxs("button",{onClick:b,disabled:p,className:"flex items-center gap-2 text-sm bg-[#3B82F6] hover:bg-[#2563EB] disabled:opacity-50 text-white px-5 py-2 rounded-lg transition-colors",children:[p?o.jsx(ir,{className:"w-4 h-4 animate-spin"}):o.jsx(Y8,{className:"w-4 h-4"}),p?"Enviando":"Solicitar autorizacin"]})]})]})})}const M={bg:"#060b12",surface:"#09111c",card:"#0c1825",cardHov:"#101f30",border:"#162035",borderLt:"#1e2f47",teal:"#00c9a7",amber:"#f5a623",blue:"#4d9fff",orange:"#ff7940",green:"#22d07a",red:"#ff4d6d",purple:"#a78bfa",txt1:"#dde6f0",txt2:"#7a97b8",txt3:"#3d5470",mono:"'Courier New','Lucida Console',monospace"},Wl=[{id:"cooler",name:"Cooler / Docs",icon:"",color:M.teal},{id:"cruce",name:"Cruce Frontera",icon:"",color:M.orange},{id:"transito",name:"Trnsito US",icon:"",color:M.blue},{id:"entregado",name:"Entregado",icon:"",color:M.green}],ew={documentacion:"cooler"},Ei={cooler:[{key:"factura_xml",label:"Factura CFDI (.xml)",req:!0,icon:""},{key:"factura_pdf",label:"Factura CFDI (.pdf)",req:!0,icon:""},{key:"carta_porte",label:"Carta Porte 3.1",req:!0,icon:""},{key:"packing_list",label:"Packing List",req:!0,icon:""},{key:"fda_prior_notice",label:"FDA Prior Notice",req:!0,icon:""},{key:"carta_instrucciones",label:"Carta de Instrucciones al Agente",req:!0,icon:""},{key:"tmec",label:"Cert. de Origen T-MEC (Forma 434)",req:!1,icon:""}],cruce:[{key:"pedimento",label:"Pedimento de Exportacin A1",req:!0,icon:""},{key:"manifiesto",label:"Manifiesto de Exportacin (CBP 7533)",req:!0,icon:""},{key:"entry_summary",label:"Entry Summary (CBP Form 7501)",req:!0,icon:""}],transito:[{key:"bill_of_lading",label:"Bill of Lading",req:!0,icon:""},{key:"shipping_register",label:"Shipping Register",req:!0,icon:""}],entregado:[{key:"pod",label:"Proof of Delivery (POD)",req:!0,icon:""}]},OI=Object.values(Ei).flat(),Wd=[{id:"aviso_salida",nombre:" Aviso de Salida del Embarque",asunto:"{{codigo}}  {{fecha_larga}}",roles:["interno","trafico","agente_mx","agente_us","cliente","warehouse"],adjuntos_sugeridos:[],body:`Hola, buen da. Comparto informacin de la salida de hoy.


RESUMEN DEL EMBARQUE

Cajas:             {{cajas_total}}
Presentacin:      {{presentacion}}
Cajas por Pallet:  {{cajas_por_pallet}}
KG Neto:           {{kg_total}} kg
Pallets:           {{num_pallets}}


DESTINATARIO

{{destinatario_nombre}}
{{destinatario_direccion}}
Tel: {{destinatario_telefono}}
Tax ID: {{destinatario_tax_id}}


TRANSPORTE

Tracto: {{tracto_marca}} / Placa {{tracto_placa}}
Remolque: {{remolque_marca}} / Placa {{remolque_placa}}
Thermo: {{thermo}}
Operador: {{operador}} | CAAT: {{caat}} | Alpha: {{alpha}}

Horario de salida: {{hora_salida}} hs

En un momento envo la factura.

Saludos`},{id:"anexo_factura",nombre:" Anexo Factura",asunto:"Anexo Factura  {{codigo}} {{fecha_larga}}",roles:["interno","trafico","agente_mx","agente_us","cliente"],adjuntos_sugeridos:["factura_xml","factura_pdf"],body:`Buen da, adjunto la factura del embarque {{codigo}}.

Fecha: {{fecha_salida}}
Pallets: {{num_pallets}} | Cajas: {{cajas_total}} | KG: {{kg_total}} kg

Saludos`},{id:"docs_agente_mx",nombre:" Documentos para Agente Aduanal MX",asunto:"Docs Exportacin  {{codigo}}  Cruce {{fecha_salida}}",roles:["agente_mx","interno"],adjuntos_sugeridos:["factura_xml","factura_pdf","packing_list","carta_instrucciones","fitosanitario","tmec"],body:`Buen da, adjunto documentacin para despacho de exportacin.

Embarque: {{codigo}}
Fecha de cruce estimada: {{fecha_salida}}
Pallets: {{num_pallets}} | KG: {{kg_total}} kg

Destino final: {{destinatario_nombre}}, {{destinatario_direccion}}

Por favor confirmar recepcin y avisar cualquier observacin.

Saludos`},{id:"aviso_cruce",nombre:" Aviso de Cruce a Agente US",asunto:"Cruce en Camino  {{codigo}}  {{fecha_salida}}",roles:["agente_us","trafico","interno"],adjuntos_sugeridos:["factura_pdf","packing_list","pedimento"],body:`Buen da, el embarque {{codigo}} est en camino a frontera.

Fecha de cruce estimada: {{fecha_salida}}
Pallets: {{num_pallets}} | Cajas: {{cajas_total}}
Tracto: {{tracto_placa}} | Operador: {{operador}}

Destino: {{destinatario_nombre}}
{{destinatario_direccion}}

Por favor confirmar proceso de entrada y avisar nmero de pedimento US.

Saludos`},{id:"alerta_incidencia",nombre:" Alerta de Incidencia",asunto:" INCIDENCIA  {{codigo}}  {{fecha_salida}}",roles:["interno","trafico","cliente","agente_mx","agente_us"],adjuntos_sugeridos:[],body:`Alerta: se ha detectado una incidencia en el embarque {{codigo}}.

Embarque: {{codigo}}
Fecha: {{fecha_salida}}
Pallets: {{num_pallets}}

DESCRIPCIN DE LA INCIDENCIA:
[Detallar aqu el problema detectado]

ACCIN REQUERIDA:
[Detallar aqu qu se necesita]

Favor de responder a la brevedad.

Saludos`}],tw=["LARGE","JUMBO","SMALL"],rw=["RIVER RUN","TWIN RIVER","AZRA","STANDARD","PREMIUM"],nw=["8X18","12X18","6X18","11X18"],ow={"8X18":4.2,"12X18":6.3,"6X18":2.1,"11X18":3.8},lie=["Biloxi","Snowchaser","Emerald","Star","O'Neal","Legacy"],kb={agente_mx:"Agente MX",agente_us:"Agente US",transportista:"Transportista",cliente:"Cliente",warehouse:"Warehouse",trafico:"Trfico",interno:"Interno"},kd={agente_mx:M.orange,agente_us:M.blue,transportista:M.purple,cliente:M.teal,warehouse:M.green,trafico:M.amber,interno:M.txt2};Array.from({length:12},(e,t)=>({id:`p${10+t}`,tag:`236310${t}`,lote:"AM26002RB",presentacion:"8X18",label:"RIVER RUN",calibre:"LARGE",fecha:"2026-02-13",cajas:144,kg_neto:607.2,kg_bruto:615,temp_carga:.9,variedad:"Biloxi"})),Object.fromEntries(OI.map(e=>[e.key,{status:"subido",nombre:`${e.key}_AM26003RB.pdf`,size:"95 KB",fecha:"2026-02-14"}]));const cie=[{id:"cat1",nombre:"Rio Bravo Packing & Logistics",direccion:"5316 S Stewart Rd",ciudad:"San Juan",estado:"TX",cp:"78589",telefono:"(956) 843-6200",tax_id:"",email:"shippingsj@riobravopl.com"},{id:"cat2",nombre:"Five Brothers Jalisco Produce, Co. Inc",direccion:"9000 Seguin Dr",ciudad:"Pharr",estado:"TX",cp:"78577",telefono:"(956) 781-8700",tax_id:"222849235",email:""},{id:"cat3",nombre:"Twin River South LLC",direccion:"525 SW 6th Ave",ciudad:"Portland",estado:"OR",cp:"97204",telefono:"",tax_id:"",email:""}],die=[{id:"c1",nombre:"Exportacin Moray",empresa:"Agricola Moray",rol:"interno",email:"exportacion@agricolamoray.com",es_fijo:!0,activo:!0},{id:"c2",nombre:"Trfico Moray",empresa:"Agricola Moray",rol:"trafico",email:"trafico@agricolamoray.com",es_fijo:!0,activo:!0},{id:"c3",nombre:"AGSA Logistics",empresa:"AGSA",rol:"agente_mx",email:"trafico@agsalogistics.com",es_fijo:!0,activo:!0},{id:"c4",nombre:"Adolfo",empresa:"Agricola Moray",rol:"interno",email:"adolfo@agricolamoray.com",es_fijo:!1,activo:!0},{id:"c5",nombre:"Jos Carmona",empresa:"Rio Bravo",rol:"agente_us",email:"jose.carmona@riobravopl.com",es_fijo:!1,activo:!0},{id:"c6",nombre:"Shipping SJ",empresa:"Rio Bravo",rol:"warehouse",email:"shippingsj@riobravopl.com",es_fijo:!1,activo:!0},{id:"c7",nombre:"Patricio Ramrez",empresa:"Rio Bravo",rol:"agente_us",email:"patricio.ramirez@riobravopl.com",es_fijo:!1,activo:!0}],TI=e=>e?e>1048576?(e/1048576).toFixed(1)+" MB":(e/1024).toFixed(0)+" KB":"";function LI(e){return{id:e.id,codigo:e.codigo,fecha_salida:e.fecha_salida,hora_salida:e.hora_salida?e.hora_salida.slice(0,5):"00:00",status:e.status,tracto_marca:e.tracto_marca||"",tracto_placa:e.tracto_placa||"",remolque_marca:e.remolque_marca||"",remolque_placa:e.remolque_placa||"",thermo:e.thermo||"",operador:e.operador||"",caat:e.caat||"",alpha:e.alpha||"",sello:e.sello_numero||"",notas:e.notas||"",destinos:(e.destinos||[]).sort((t,r)=>t.orden-r.orden).map(t=>({id:t.id,orden:t.orden,cliente:t.cliente,cust_po:t.cust_po||"",warehouse:t.warehouse_nombre||"",direccion:t.direccion||"",telefono:t.telefono||"",tax_id:t.tax_id||"",fecha_entrega_est:t.fecha_entrega_est||"",fecha_entrega_real:t.fecha_entrega_real||null})),pallets:(e.pallets||[]).map(t=>({id:t.id,tag:t.tag_numero||"",lote:t.lote||"",variedad:t.variedad||"",presentacion:t.presentacion||"",label:t.label||"",calibre:t.calibre||"",fecha:t.fecha_cosecha||"",cajas:t.cajas||0,kg_neto:parseFloat(t.kg_neto)||0,kg_bruto:parseFloat(t.kg_bruto)||0,temp_carga:t.temp_carga!=null?parseFloat(t.temp_carga):null})),documentos:Object.fromEntries((e.documentos||[]).map(t=>[t.tipo,{status:t.status,nombre:t.nombre_archivo||t.tipo,size:TI(t.file_size_bytes),fecha:t.uploaded_at?t.uploaded_at.slice(0,10):"",url:t.storage_url||null,path:t.storage_path||null}])),correos:(e.correos||[]).map(t=>({id:t.id,plantilla_id:t.plantilla_id||"",asunto:t.asunto,body:t.cuerpo_html,destinatarios:Array.isArray(t.destinatarios)?t.destinatarios:[],adjuntos:Array.isArray(t.adjuntos)?t.adjuntos:[],enviado_at:t.enviado_at?t.enviado_at.slice(0,16).replace("T"," "):"",enviado_por:"Usuario",status:t.status})),tracking:(e.tracking||[]).map(t=>({id:t.id,etapa:t.etapa_nueva,fecha:t.created_at?t.created_at.slice(0,16).replace("T"," "):"",usuario:"Usuario",temp:t.temperatura!=null?parseFloat(t.temperatura):null,notas:t.notas||""})).sort((t,r)=>t.fecha.localeCompare(r.fecha))}}async function Vp(e){const{data:t}=await se.from("embarques").select("*, destinos:embarque_destinos(*), pallets:embarque_pallets(*), documentos:embarque_documentos(*), correos:embarque_correos(*), tracking:embarque_tracking(*)").eq("id",e).single();return t?LI(t):null}const Kr=()=>Math.random().toString(36).slice(2,9),Dr=e=>{const t=ew[e]||e;return Wl.find(r=>r.id===t)||Wl[0]},aw=e=>{const t=ew[e]||e,r=Wl.findIndex(n=>n.id===t);return r<Wl.length-1?Wl[r+1].id:t},xc=e=>e?new Date(e+"T00:00:00").toLocaleDateString("es-MX",{day:"2-digit",month:"short",year:"numeric"}):"",uie=e=>e?new Date(e+"T00:00:00").toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"",iw=e=>e.pallets.length,zc=e=>e.pallets.reduce((t,r)=>t+r.cajas,0),vc=e=>e.pallets.reduce((t,r)=>t+(r.kg_neto||0),0).toFixed(1),sw=e=>{const t=ew[e.status]||e.status;return aw(e.status)===t?[]:(Ei[t]||[]).filter(n=>{var a;return n.req&&((a=e.documentos[n.key])==null?void 0:a.status)!=="subido"})},$A=(e,t)=>{var n,a,i,s,l,c;const r={codigo:t.codigo,fecha_salida:xc(t.fecha_salida),fecha_larga:uie(t.fecha_salida),hora_salida:t.hora_salida,cajas_total:zc(t),presentacion:((n=t.pallets[0])==null?void 0:n.presentacion)||"",cajas_por_pallet:((a=t.pallets[0])==null?void 0:a.cajas)||"",kg_total:vc(t),num_pallets:iw(t),destinatario_nombre:((i=t.destinos[0])==null?void 0:i.cliente)||"",destinatario_direccion:((s=t.destinos[0])==null?void 0:s.direccion)||"",destinatario_telefono:((l=t.destinos[0])==null?void 0:l.telefono)||"",destinatario_tax_id:((c=t.destinos[0])==null?void 0:c.tax_id)||"",tracto_marca:t.tracto_marca,tracto_placa:t.tracto_placa,remolque_marca:t.remolque_marca,remolque_placa:t.remolque_placa,thermo:t.thermo,operador:t.operador,caat:t.caat,alpha:t.alpha};return e.replace(/\{\{(\w+)\}\}/g,(u,d)=>r[d]??`{{${d}}}`)},fie=(e,t)=>{const r=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n=e.split(`
`);let a="";for(let i=0;i<n.length;i++){const s=n[i],l=r(s);if(/^{5,}/.test(s)){a+='<hr style="border:none;border-top:1px solid #2a3f5a;margin:14px 0;">';continue}if(/^[A-Z\s]{4,}$/.test(s.trim())&&s.trim().length>3&&s.trim().length<40){a+=`<div style="font-size:11px;font-weight:800;color:#7a97b8;letter-spacing:2px;text-transform:uppercase;margin:6px 0 4px;">${l}</div>`;continue}if(/^[A-Za-z\s\/]+:\s+.+/.test(s)){const c=s.indexOf(":"),u=r(s.slice(0,c)),d=r(s.slice(c+1).trim());a+=`<div style="display:flex;gap:8px;padding:3px 0;border-bottom:1px solid #0d1e2e;">
        <span style="color:#4d6a85;font-size:12px;min-width:160px;font-weight:600;">${u}:</span>
        <span style="color:#dde6f0;font-size:12px;font-weight:700;">${d}</span>
      </div>`;continue}if(s.trim()===""){a+='<div style="height:10px;"></div>';continue}a+=`<div style="color:#b0c4d8;font-size:13px;line-height:1.6;">${l}</div>`}return`<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"></head>
<body style="margin:0;padding:0;background:#060b12;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Arial,sans-serif;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background:#060b12;padding:32px 16px;">
    <tr><td align="center">
      <table width="600" cellpadding="0" cellspacing="0" style="max-width:600px;width:100%;">

        <!-- Header -->
        <tr><td style="background:#0c1825;border:1px solid #162035;border-radius:12px 12px 0 0;padding:20px 28px;border-bottom:2px solid #00c9a7;">
          <div style="font-size:11px;color:#7a97b8;letter-spacing:2px;text-transform:uppercase;margin-bottom:4px;">Agrcola Moray  Exportacin</div>
          <div style="font-size:20px;font-weight:800;color:#dde6f0;">${r(t)}</div>
        </td></tr>

        <!-- Body -->
        <tr><td style="background:#09111c;border:1px solid #162035;border-top:none;padding:24px 28px;">
          ${a}
        </td></tr>

        <!-- Footer -->
        <tr><td style="background:#060b12;border:1px solid #162035;border-top:none;border-radius:0 0 12px 12px;padding:14px 28px;text-align:center;">
          <div style="font-size:10px;color:#3d5470;">Este correo fue generado automticamente por el sistema de exportacin de Agrcola Moray.</div>
        </td></tr>

      </table>
    </td></tr>
  </table>
</body>
</html>`},Re={btn:(e=M.teal)=>({background:e+"18",border:`1px solid ${e}50`,color:e,borderRadius:8,padding:"7px 16px",fontSize:12,fontWeight:700,cursor:"pointer",letterSpacing:.3}),btnPrimary:{background:M.teal,border:"none",color:"#05120e",borderRadius:8,padding:"9px 20px",fontSize:12,fontWeight:800,cursor:"pointer",letterSpacing:.5},btnDanger:{background:M.red+"18",border:`1px solid ${M.red}50`,color:M.red,borderRadius:8,padding:"7px 14px",fontSize:12,fontWeight:700,cursor:"pointer"},input:{background:M.surface,border:`1px solid ${M.border}`,borderRadius:8,padding:"8px 12px",color:M.txt1,fontSize:13,outline:"none",width:"100%",boxSizing:"border-box",colorScheme:"dark"},label:{fontSize:11,fontWeight:700,color:M.txt3,textTransform:"uppercase",letterSpacing:1,display:"block",marginBottom:5},textarea:{background:M.surface,border:`1px solid ${M.border}`,borderRadius:8,padding:"10px 12px",color:M.txt1,fontSize:12,outline:"none",width:"100%",boxSizing:"border-box",resize:"vertical",fontFamily:M.mono,lineHeight:1.7,colorScheme:"dark"}},hie=`
  input[type="date"]::-webkit-calendar-picker-indicator,
  input[type="time"]::-webkit-calendar-picker-indicator {
    filter: invert(1) brightness(2);
    cursor: pointer;
    opacity: 0.7;
  }
  input[type="date"], input[type="time"] { color-scheme: dark; }
  @keyframes spin { to { transform: rotate(360deg); } }
  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50%       { opacity: 0.4; transform: scale(0.85); }
  }
`;function Wt({text:e,color:t,dot:r}){return o.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,fontSize:10,fontWeight:700,padding:"2px 8px",background:t+"18",border:`1px solid ${t}40`,borderRadius:20,color:t,letterSpacing:.3,whiteSpace:"nowrap"},children:[r&&o.jsx("span",{style:{width:5,height:5,borderRadius:"50%",background:t,display:"inline-block"}}),e]})}function pie({stageId:e}){const t=Dr(e);return o.jsx(Wt,{text:`${t.icon} ${t.name}`,color:t.color,dot:!0})}function Cb({children:e,style:t={},onClick:r}){return o.jsx("div",{onClick:r,style:{background:M.card,border:`1px solid ${M.border}`,borderRadius:12,padding:"14px 16px",cursor:r?"pointer":"default",...t},onMouseEnter:n=>{r&&(n.currentTarget.style.borderColor=M.borderLt,n.currentTarget.style.background=M.cardHov)},onMouseLeave:n=>{r&&(n.currentTarget.style.borderColor=M.border,n.currentTarget.style.background=M.card)},children:e})}function qo({children:e,onClose:t,title:r,width:n=720}){return o.jsx("div",{style:{position:"fixed",inset:0,background:"#000b",zIndex:1e3,display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:"32px 16px"},onClick:a=>a.target===a.currentTarget&&t(),children:o.jsxs("div",{style:{background:M.surface,border:`1px solid ${M.borderLt}`,borderRadius:16,width:"100%",maxWidth:n,boxShadow:"0 30px 80px #000d"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:`1px solid ${M.border}`},children:[o.jsx("div",{style:{fontSize:15,fontWeight:800,color:M.txt1},children:r}),o.jsx("button",{onClick:t,style:{background:"none",border:"none",color:M.txt3,fontSize:20,cursor:"pointer",padding:"0 4px"},children:""})]}),o.jsx("div",{style:{padding:"20px"},children:e})]})})}function Ae({label:e,children:t}){return o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("label",{style:Re.label,children:e}),t]})}function Ie({value:e,onChange:t,placeholder:r,type:n="text",style:a={}}){return o.jsx("input",{type:n,value:e,onChange:i=>t(i.target.value),placeholder:r,style:{...Re.input,...a}})}function Hn({value:e,onChange:t,options:r,placeholder:n}){return o.jsxs("select",{value:e,onChange:a=>t(a.target.value),style:{...Re.input,appearance:"none"},children:[n&&o.jsx("option",{value:"",children:n}),r.map(a=>o.jsx("option",{value:typeof a=="string"?a:a.value,children:typeof a=="string"?a:a.label},typeof a=="string"?a:a.value))]})}function Ls({label:e}){return o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,margin:"18px 0 12px"},children:[o.jsx("div",{style:{flex:1,height:1,background:M.border}}),e&&o.jsx("span",{style:{fontSize:10,fontWeight:800,color:M.txt2,textTransform:"uppercase",letterSpacing:1.5},children:e}),o.jsx("div",{style:{flex:1,height:1,background:M.border}})]})}function RA({value:e,total:t,color:r}){const n=t>0?e/t*100:0;return o.jsx("div",{style:{flex:1,height:4,background:M.border,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${n}%`,height:"100%",background:n===100?M.green:r,borderRadius:4,transition:"width .3s"}})})}function mie({embarque:e,onConfirm:t,onCancel:r}){const n=sw(e),a=Dr(aw(e.status)),i=Dr(e.status),s=n.length===0;return o.jsx(qo,{title:s?"Confirmar Avance de Etapa":"Documentos Faltantes",onClose:r,width:500,children:s?o.jsxs("div",{children:[o.jsxs("div",{style:{textAlign:"center",padding:"10px 0 20px"},children:[o.jsx("div",{style:{fontSize:40,marginBottom:10},children:""}),o.jsx("div",{style:{fontSize:14,fontWeight:700,color:M.txt1,marginBottom:6},children:"Documentos completos!"}),o.jsxs("div",{style:{fontSize:13,color:M.txt2},children:["El embarque ",o.jsx("span",{style:{color:i.color,fontFamily:M.mono,fontWeight:700},children:e.codigo})," est listo para avanzar de ",o.jsx("span",{style:{color:i.color,fontWeight:700},children:i.name})," a ",o.jsxs("span",{style:{color:a.color,fontWeight:700},children:[a.icon," ",a.name]}),"."]})]}),o.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",borderTop:`1px solid ${M.border}`,paddingTop:16},children:[o.jsx("button",{onClick:r,style:Re.btn(M.txt3),children:"Cancelar"}),o.jsxs("button",{onClick:t,style:{...Re.btnPrimary,background:a.color,color:"#04130c"},children:["Avanzar a ",a.name," ",a.icon]})]})]}):o.jsxs("div",{children:[o.jsxs("div",{style:{background:M.red+"0a",border:`1px solid ${M.red}30`,borderRadius:10,padding:"12px 16px",marginBottom:16},children:[o.jsxs("div",{style:{fontSize:13,fontWeight:700,color:M.red,marginBottom:6},children:[" Faltan ",n.length," documento",n.length>1?"s":""," obligatorio",n.length>1?"s":""]}),o.jsxs("div",{style:{fontSize:12,color:M.txt2},children:["Para avanzar a ",o.jsxs("span",{style:{color:a.color,fontWeight:700},children:[a.icon," ",a.name]})," necesitas subir:"]})]}),o.jsx("div",{style:{display:"grid",gap:6,marginBottom:18},children:n.map(l=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",background:M.surface,borderRadius:8,border:`1px solid ${M.border}`},children:[o.jsx("span",{style:{fontSize:16},children:l.icon}),o.jsx("span",{style:{fontSize:12,color:M.txt2},children:l.label}),o.jsx(Wt,{text:"Pendiente",color:M.red})]},l.key))}),o.jsxs("div",{style:{fontSize:12,color:M.txt3,marginBottom:16},children:["Ve a la pestaa ",o.jsx("span",{style:{color:M.amber},children:" Documentos"})," para subir los archivos faltantes."]}),o.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"space-between",borderTop:`1px solid ${M.border}`,paddingTop:16},children:[o.jsx("button",{onClick:t,style:{...Re.btn(M.amber),fontSize:11,border:`1px solid ${M.amber}40`},children:" Solicitar autorizacin al admin "}),o.jsx("button",{onClick:r,style:Re.btnPrimary,children:"Entendido  subir docs"})]})]})})}function gie({doc:e,info:t,embarqueId:r,onUpload:n,onDelete:a,onPreview:i}){const s=h.useRef(),l=(t==null?void 0:t.status)==="subido",[c,u]=h.useState(!1),[d,f]=h.useState(!1),[p,x]=h.useState(null),m=h.useCallback(async j=>{if(!(!j||!r)){f(!0),x(null);try{const b=`${r}/${e.key}/${Date.now()}_${j.name}`,{error:g}=await se.storage.from("export-docs").upload(b,j,{upsert:!0});if(g)throw g;const{data:v,error:w}=await se.storage.from("export-docs").createSignedUrl(b,7200);if(w)throw w;const{error:C}=await se.from("embarque_documentos").upsert({embarque_id:r,tipo:e.key,status:"subido",nombre_archivo:j.name,storage_path:b,storage_url:v.signedUrl,file_size_bytes:j.size,uploaded_at:new Date().toISOString()},{onConflict:"embarque_id,tipo"});if(C)throw C;n(e.key,{status:"subido",nombre:j.name,size:TI(j.size),fecha:new Date().toISOString().slice(0,10),url:v.signedUrl,path:b})}catch(b){console.error("Upload:",b),x(b.message||"Error al subir")}finally{f(!1)}}},[e.key,r,n]),y=async()=>{t!=null&&t.path&&(await se.storage.from("export-docs").remove([t.path]).catch(()=>{}),await se.from("embarque_documentos").delete().match({embarque_id:r,tipo:e.key}).catch(()=>{})),a(e.key)};return o.jsxs("div",{onDragOver:j=>{j.preventDefault(),u(!0)},onDragLeave:()=>u(!1),onDrop:j=>{j.preventDefault(),u(!1),m(j.dataTransfer.files[0])},style:{display:"flex",alignItems:"center",gap:12,padding:"10px 14px",borderRadius:9,background:c?M.teal+"0a":l?M.green+"06":M.surface,border:`1px solid ${c?M.teal:l?M.green+"40":M.border}`,transition:"all .15s"},children:[o.jsx("input",{ref:s,type:"file",style:{display:"none"},onChange:j=>m(j.target.files[0])}),o.jsx("div",{style:{width:20,height:20,borderRadius:5,background:l?M.green:"transparent",border:`2px solid ${l?M.green:M.txt3}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,cursor:"pointer",fontSize:11,color:"#fff"},onClick:()=>l?y():s.current.click(),children:d?"":l?"":""}),o.jsx("span",{style:{fontSize:15,flexShrink:0},children:e.icon}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,color:l?M.txt1:M.txt2},children:e.label}),l?o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.nombre,"  ",t.size,"  ",t.fecha]}):o.jsx("div",{style:{fontSize:10,color:p?M.red:M.txt3,marginTop:1},children:d?"Subiendo archivo":p||'Arrastra un archivo aqu o haz clic en "Subir"'})]}),o.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexShrink:0},children:[!e.req&&o.jsx(Wt,{text:"Opcional",color:M.txt3}),d?o.jsx("span",{style:{fontSize:11,color:M.teal},children:"Subiendo"}):l?o.jsxs(o.Fragment,{children:[o.jsx(Wt,{text:" Subido",color:M.green}),o.jsx("button",{onClick:()=>i(e,t),style:{...Re.btn(M.blue),padding:"4px 10px",fontSize:10},children:" Ver"}),o.jsx("button",{onClick:y,style:{...Re.btn(M.red),padding:"4px 8px",fontSize:10},children:""})]}):o.jsx("button",{onClick:()=>s.current.click(),style:{...Re.btn(M.teal),padding:"4px 12px",fontSize:10},children:" Subir"})]})]})}function xie({embarque:e,onUpdate:t}){const[r,n]=h.useState(null),a=["cooler","cruce","transito","entregado"],i=h.useCallback((d,f)=>{t({...e,documentos:{...e.documentos,[d]:f}})},[e,t]),s=h.useCallback(d=>{const f={...e.documentos};delete f[d],t({...e,documentos:f})},[e,t]),l=async(d,f)=>{if(f!=null&&f.path){const{data:p}=await se.storage.from("export-docs").createSignedUrl(f.path,7200);if(p!=null&&p.signedUrl){window.open(p.signedUrl,"_blank");return}}if(f!=null&&f.url){window.open(f.url,"_blank");return}n({doc:d,info:f})},c=a.reduce((d,f)=>d+(Ei[f]||[]).filter(p=>p.req).length,0),u=a.reduce((d,f)=>d+(Ei[f]||[]).filter(p=>{var x;return p.req&&((x=e.documentos[p.key])==null?void 0:x.status)==="subido"}).length,0);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:M.surface,borderRadius:10,padding:"12px 16px",marginBottom:20,border:`1px solid ${M.border}`},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[o.jsx("span",{style:{fontSize:12,fontWeight:700,color:M.txt1},children:"Progreso General de Documentacin"}),o.jsxs("span",{style:{fontSize:12,fontWeight:800,color:u===c?M.green:M.amber},children:[u,"/",c," obligatorios"]})]}),o.jsx(RA,{value:u,total:c,color:M.amber})]}),u===c?o.jsx(Wt,{text:" Completo",color:M.green}):o.jsx(Wt,{text:`${c-u} pendientes`,color:M.red})]}),a.map(d=>{const f=Dr(d),p=Ei[d]||[],x=p.filter(y=>y.req),m=x.filter(y=>{var j;return((j=e.documentos[y.key])==null?void 0:j.status)==="subido"}).length;return o.jsxs("div",{style:{marginBottom:22},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[o.jsx("span",{style:{fontSize:16},children:f.icon}),o.jsx("span",{style:{fontSize:13,fontWeight:800,color:f.color},children:f.name}),o.jsx(RA,{value:m,total:x.length,color:f.color}),o.jsxs("span",{style:{fontSize:11,fontWeight:700,color:m===x.length?M.green:M.txt3,whiteSpace:"nowrap"},children:[m,"/",x.length]})]}),o.jsx("div",{style:{display:"grid",gap:6},children:p.map(y=>o.jsx(gie,{doc:y,info:e.documentos[y.key],embarqueId:e.id,onUpload:i,onDelete:s,onPreview:l},y.key))})]},d)}),r&&o.jsx(qo,{title:"Vista Previa de Documento",onClose:()=>n(null),width:480,children:o.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[o.jsx("div",{style:{fontSize:48,marginBottom:12},children:r.info.nombre.endsWith(".xml")?"":""}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:M.txt1,marginBottom:4},children:r.doc.label}),o.jsx("div",{style:{fontSize:13,color:M.txt2,fontFamily:M.mono,marginBottom:16},children:r.info.nombre}),o.jsx("div",{style:{display:"flex",gap:10,justifyContent:"center",flexWrap:"wrap"},children:[{l:"Tamao",v:r.info.size,c:M.blue},{l:"Fecha",v:r.info.fecha,c:M.teal},{l:"Estado",v:"Subido ",c:M.green}].map(d=>o.jsxs("div",{style:{background:d.c+"0c",border:`1px solid ${d.c}25`,borderRadius:8,padding:"8px 16px",minWidth:100},children:[o.jsx("div",{style:{fontSize:9,color:M.txt3,textTransform:"uppercase",letterSpacing:1},children:d.l}),o.jsx("div",{style:{fontSize:13,fontWeight:700,color:d.c,marginTop:3},children:d.v})]},d.l))}),o.jsx("div",{style:{marginTop:20,padding:"10px 16px",background:M.surface,borderRadius:8,border:`1px solid ${M.border}`,fontSize:12,color:M.txt3},children:"La previsualizacin completa de PDFs y XMLs estar disponible al conectar con Supabase Storage."})]})})]})}function vie({embarque:e,contactos:t,onSend:r,onClose:n}){const[a,i]=h.useState("compose"),[s,l]=h.useState(""),[c,u]=h.useState(""),[d,f]=h.useState(""),[p,x]=h.useState({}),[m,y]=h.useState({}),j=Wd.find(E=>E.id===s),b=E=>{const N=Wd.find(T=>T.id===E);if(!N)return;l(E),u($A(N.asunto,e)),f($A(N.body,e));const $={};t.forEach(T=>{(T.es_fijo||N.roles.includes(T.rol))&&($[T.id]=!0)}),x($);const z={};N.adjuntos_sugeridos.forEach(T=>{var I;((I=e.documentos[T])==null?void 0:I.status)==="subido"&&(z[T]=!0)}),y(z)},g=E=>x(N=>({...N,[E]:!N[E]})),v=E=>y(N=>({...N,[E]:!N[E]})),w=t.filter(E=>p[E.id]).map(E=>E.email),C=Object.keys(m).filter(E=>m[E]),k=OI.filter(E=>{var N;return((N=e.documentos[E.key])==null?void 0:N.status)==="subido"}),[S,_]=h.useState(!1),A=async()=>{if(!w.length){alert("Selecciona al menos un destinatario");return}if(!c){alert("El asunto es requerido");return}_(!0);try{const{data:E,error:N}=await se.functions.invoke("send-email",{body:{embarque_id:e.id,plantilla_id:s||null,asunto:c,cuerpo_html:fie(d,c),destinatarios:w,adjuntos:C}});if(N)throw new Error(N.message);if(!(E!=null&&E.success))throw new Error((E==null?void 0:E.error)||"Error desconocido al enviar");r({id:E.correo_id||Kr(),plantilla_id:s,asunto:c,body:d,destinatarios:w,adjuntos:C,enviado_at:new Date().toLocaleString("es-MX",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),enviado_por:E.remitente||"Sistema",status:"enviado"}),n()}catch(E){alert(`Error al enviar correo:
`+(E.message||E))}finally{_(!1)}};return o.jsxs(qo,{title:"Compositor de Correo",onClose:n,width:820,children:[a==="compose"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs("div",{children:[o.jsx(Ae,{label:"Plantilla",children:o.jsx(Hn,{value:s,onChange:b,placeholder:" Seleccionar plantilla ",options:Wd.map(E=>({value:E.id,label:E.nombre}))})}),o.jsx(Ae,{label:"Asunto",children:o.jsx(Ie,{value:c,onChange:u,placeholder:"Asunto del correo"})}),o.jsx(Ae,{label:"Cuerpo del correo",children:o.jsx("textarea",{value:d,onChange:E=>f(E.target.value),rows:12,style:Re.textarea,placeholder:"Selecciona una plantilla para comenzar..."})})]}),o.jsxs("div",{children:[o.jsx(Ae,{label:`Destinatarios (${w.length} seleccionados)`,children:o.jsx("div",{style:{border:`1px solid ${M.border}`,borderRadius:8,overflow:"hidden",maxHeight:220,overflowY:"auto"},children:t.map(E=>{const N=!!p[E.id];return o.jsxs("div",{onClick:()=>g(E.id),style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",cursor:"pointer",background:N?M.teal+"0a":"transparent",borderBottom:`1px solid ${M.border}30`,transition:"background .1s"},children:[o.jsx("div",{style:{width:16,height:16,borderRadius:4,background:N?M.teal:"transparent",border:`2px solid ${N?M.teal:M.txt3}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,color:"#fff",flexShrink:0},children:N?"":""}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("span",{style:{fontSize:12,fontWeight:600,color:M.txt1},children:E.nombre}),E.es_fijo&&o.jsx(Wt,{text:"Fijo",color:M.teal})]}),o.jsx("div",{style:{fontSize:10,color:M.txt3,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E.email})]}),o.jsx(Wt,{text:kb[E.rol]||E.rol,color:kd[E.rol]||M.txt2})]},E.id)})})}),o.jsx(Ae,{label:`Adjuntos (${C.length} seleccionados)`,children:k.length===0?o.jsx("div",{style:{padding:"12px",background:M.surface,borderRadius:8,fontSize:12,color:M.txt3,border:`1px solid ${M.border}`},children:"No hay documentos subidos an"}):o.jsx("div",{style:{border:`1px solid ${M.border}`,borderRadius:8,overflow:"hidden",maxHeight:200,overflowY:"auto"},children:k.map(E=>{const N=!!m[E.key],$=e.documentos[E.key];return o.jsxs("div",{onClick:()=>v(E.key),style:{display:"flex",alignItems:"center",gap:10,padding:"7px 12px",cursor:"pointer",background:N?M.blue+"0a":"transparent",borderBottom:`1px solid ${M.border}30`,transition:"background .1s"},children:[o.jsx("div",{style:{width:16,height:16,borderRadius:4,background:N?M.blue:"transparent",border:`2px solid ${N?M.blue:M.txt3}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,color:"#fff",flexShrink:0},children:N?"":""}),o.jsx("span",{style:{fontSize:13},children:E.icon}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:11,fontWeight:500,color:M.txt1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:$.nombre}),o.jsx("div",{style:{fontSize:9,color:M.txt3},children:$.size})]})]},E.key)})})})]})]}),a==="preview"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 280px",gap:20},children:[o.jsx("div",{children:o.jsxs("div",{style:{background:M.bg,border:`1px solid ${M.border}`,borderRadius:10,overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:`1px solid ${M.border}`,background:M.surface},children:[o.jsxs("div",{style:{fontSize:11,color:M.txt3,marginBottom:2},children:["Para: ",o.jsx("span",{style:{color:M.txt2},children:w.join(", ")||"(sin destinatarios)"})]}),o.jsxs("div",{style:{fontSize:13,fontWeight:700,color:M.txt1},children:["Asunto: ",c]}),C.length>0&&o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:4},children:[" ",C.length," adjunto",C.length>1?"s":"",": ",C.map(E=>{var N;return(N=e.documentos[E])==null?void 0:N.nombre}).join(", ")]})]}),o.jsx("pre",{style:{padding:"16px",fontSize:12,color:M.txt2,whiteSpace:"pre-wrap",margin:0,fontFamily:M.mono,lineHeight:1.8,maxHeight:380,overflowY:"auto"},children:d})]})}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[o.jsxs("div",{style:{background:M.surface,borderRadius:10,padding:14,border:`1px solid ${M.border}`},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:M.txt3,textTransform:"uppercase",letterSpacing:1,marginBottom:8},children:"Resumen"}),[{l:"Plantilla",v:(j==null?void 0:j.nombre)||""},{l:"Destinatarios",v:w.length},{l:"Adjuntos",v:C.length}].map(E=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 0",borderBottom:`1px solid ${M.border}30`},children:[o.jsx("span",{style:{fontSize:11,color:M.txt3},children:E.l}),o.jsx("span",{style:{fontSize:12,fontWeight:700,color:M.txt1},children:E.v})]},E.l))]}),w.length===0&&o.jsx("div",{style:{background:M.red+"0a",border:`1px solid ${M.red}30`,borderRadius:8,padding:"10px 12px",fontSize:11,color:M.red},children:" No hay destinatarios seleccionados."}),w.length>0&&o.jsx("div",{style:{background:M.green+"0a",border:`1px solid ${M.green}30`,borderRadius:8,padding:"10px 12px",fontSize:11,color:M.green},children:" Listo para enviar"})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:20,borderTop:`1px solid ${M.border}`,paddingTop:16},children:[o.jsx("button",{onClick:a==="compose"?n:()=>i("compose"),style:Re.btn(M.txt3),children:a==="compose"?"Cancelar":" Editar"}),o.jsxs("div",{style:{display:"flex",gap:10},children:[a==="compose"&&o.jsx("button",{onClick:()=>i("preview"),disabled:!s||!d,style:{...Re.btnPrimary,opacity:!s||!d?.4:1},children:"Vista Previa "}),a==="preview"&&o.jsx("button",{onClick:A,disabled:w.length===0||S,style:{...Re.btnPrimary,background:M.green,color:"#03110a",opacity:w.length===0||S?.4:1},children:S?"Guardando":" Registrar Correo"})]})]})]})}function yie({correo:e}){var a,i,s;const[t,r]=h.useState(!1),n=Wd.find(l=>l.id===e.plantilla_id);return o.jsxs("div",{style:{border:`1px solid ${M.border}`,borderRadius:10,overflow:"hidden",marginBottom:8},children:[o.jsxs("div",{onClick:()=>r(!t),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 14px",background:M.surface,cursor:"pointer"},children:[o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:M.txt1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.asunto}),o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:2},children:[e.enviado_at,"  por ",e.enviado_por,"  ",e.destinatarios.length," destinatario",e.destinatarios.length!==1?"s":""]})]}),o.jsx(Wt,{text:((a=n==null?void 0:n.nombre)==null?void 0:a.split(" ").slice(1,3).join(" "))||"Correo",color:M.blue}),((i=e.adjuntos)==null?void 0:i.length)>0&&o.jsx(Wt,{text:` ${e.adjuntos.length}`,color:M.purple}),o.jsx(Wt,{text:" Enviado",color:M.green}),o.jsx("span",{style:{color:M.txt3,fontSize:12},children:t?"":""})]}),t&&o.jsxs("div",{style:{padding:"14px",background:M.bg,borderTop:`1px solid ${M.border}`},children:[o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginBottom:6},children:["Para: ",o.jsx("span",{style:{color:M.txt2},children:e.destinatarios.join(", ")})]}),((s=e.adjuntos)==null?void 0:s.length)>0&&o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginBottom:10},children:["Adjuntos: ",o.jsx("span",{style:{color:M.purple},children:e.adjuntos.join(", ")})]}),o.jsx("pre",{style:{fontSize:11,color:M.txt2,whiteSpace:"pre-wrap",margin:0,fontFamily:M.mono,lineHeight:1.7,maxHeight:220,overflowY:"auto"},children:e.body})]})]})}function bie({embarque:e,onUpdate:t,contactos:r}){const[n,a]=h.useState(!1),i=s=>{t({...e,correos:[...e.correos,s]})};return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:M.txt1},children:"Correos del Embarque"}),o.jsxs("div",{style:{fontSize:11,color:M.txt3,marginTop:2},children:[e.correos.length," correo",e.correos.length!==1?"s":""," enviado",e.correos.length!==1?"s":""]})]}),o.jsx("button",{onClick:()=>a(!0),style:Re.btnPrimary,children:" Nuevo Correo"})]}),o.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:20},children:Wd.map(s=>o.jsxs("button",{onClick:()=>a(!0),style:{...Re.btn(M.blue),fontSize:11,padding:"5px 12px"},children:[s.nombre.split(" ")[0]," ",s.nombre.split(" ").slice(1,3).join(" ")]},s.id))}),e.correos.length===0?o.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",border:`1px dashed ${M.border}`,borderRadius:12,color:M.txt3,fontSize:13},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),"Sin correos enviados an.",o.jsx("br",{}),'Usa el botn "Nuevo Correo" para enviar el aviso de salida.']}):o.jsx("div",{children:e.correos.slice().reverse().map(s=>o.jsx(yie,{correo:s},s.id))}),n&&o.jsx(vie,{embarque:e,contactos:r,onSend:i,onClose:()=>a(!1)})]})}function jie({embarque:e,onUpdate:t,onEditEmbarque:r}){const[n,a]=h.useState(!1),[i,s]=h.useState(!1),[l,c]=h.useState({tag:"",lote:"",presentacion:"8X18",label:"RIVER RUN",calibre:"LARGE",fecha:"",cajas:144,kg_neto:"",kg_bruto:"",temp_carga:"",variedad:"Biloxi"}),u=(m,y)=>{const j=ow[m];return j?(Number(y)*j).toFixed(1):""},d=async()=>{if(!l.tag||!l.lote)return;s(!0);const m=u(l.presentacion,l.cajas);try{const{data:y,error:j}=await se.from("embarque_pallets").insert({embarque_id:e.id,tag_numero:l.tag,lote:l.lote,variedad:l.variedad,presentacion:l.presentacion,label:l.label,calibre:l.calibre,fecha_cosecha:l.fecha||null,cajas:Number(l.cajas),kg_neto:Number(m)||null,kg_bruto:Number(l.kg_bruto)||null,temp_carga:Number(l.temp_carga)||null}).select().single();if(j)throw j;const b={id:y.id,tag:y.tag_numero,lote:y.lote,variedad:y.variedad||"",presentacion:y.presentacion||"",label:y.label||"",calibre:y.calibre||"",fecha:y.fecha_cosecha||"",cajas:y.cajas,kg_neto:parseFloat(y.kg_neto)||0,kg_bruto:parseFloat(y.kg_bruto)||0,temp_carga:y.temp_carga!=null?parseFloat(y.temp_carga):null};t({...e,pallets:[...e.pallets,b]}),c(g=>({...g,tag:"",kg_bruto:"",temp_carga:""})),a(!1)}catch(y){alert("Error al guardar pallet: "+y.message)}finally{s(!1)}},f=async m=>{if(window.confirm("Eliminar este pallet?"))try{await se.from("embarque_pallets").delete().eq("id",m),t({...e,pallets:e.pallets.filter(y=>y.id!==m)})}catch(y){alert("Error: "+y.message)}},p=zc(e),x=vc(e);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:10,marginBottom:16,flexWrap:"wrap"},children:[[{l:"Pallets",v:e.pallets.length,c:M.teal},{l:"Cajas",v:p,c:M.green},{l:"KG Neto",v:x,c:M.amber}].map(m=>o.jsxs("div",{style:{flex:1,minWidth:90,background:m.c+"0c",border:`1px solid ${m.c}25`,borderRadius:10,padding:"8px 14px"},children:[o.jsx("div",{style:{fontSize:10,color:M.txt3,textTransform:"uppercase",letterSpacing:1},children:m.l}),o.jsx("div",{style:{fontSize:20,fontWeight:900,color:m.c},children:m.v})]},m.l)),o.jsx("button",{onClick:()=>r&&r(),style:{...Re.btnPrimary,alignSelf:"stretch",padding:"0 20px"},children:" Editar Embarque"})]}),o.jsx("div",{style:{overflowX:"auto",borderRadius:10,border:`1px solid ${M.border}`},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[o.jsx("thead",{children:o.jsx("tr",{style:{background:M.surface},children:["N TAG","Lote","Presentacin","Label","Calibre","Fecha","Cajas","KG Neto","C",""].map(m=>o.jsx("th",{style:{padding:"9px 12px",textAlign:"left",color:M.txt3,fontWeight:700,fontSize:10,textTransform:"uppercase",letterSpacing:.5,whiteSpace:"nowrap",borderBottom:`1px solid ${M.border}`},children:m},m))})}),o.jsxs("tbody",{children:[e.pallets.map((m,y)=>o.jsxs("tr",{style:{borderBottom:`1px solid ${M.border}30`,background:y%2===1?M.surface+"60":"transparent"},children:[o.jsx("td",{style:{padding:"8px 12px",fontFamily:M.mono,fontWeight:700,color:M.teal},children:m.tag}),o.jsx("td",{style:{padding:"8px 12px",fontFamily:M.mono,color:M.purple},children:m.lote}),o.jsx("td",{style:{padding:"8px 12px",color:M.txt1},children:m.presentacion}),o.jsx("td",{style:{padding:"8px 12px",color:M.txt2},children:m.label}),o.jsx("td",{style:{padding:"8px 12px"},children:o.jsx(Wt,{text:m.calibre,color:M.green})}),o.jsx("td",{style:{padding:"8px 12px",color:M.txt2,whiteSpace:"nowrap"},children:xc(m.fecha)}),o.jsx("td",{style:{padding:"8px 12px",color:M.txt1,textAlign:"right"},children:m.cajas}),o.jsx("td",{style:{padding:"8px 12px",color:M.amber,textAlign:"right"},children:m.kg_neto}),o.jsx("td",{style:{padding:"8px 12px",color:m.temp_carga>4?M.red:m.temp_carga>2?M.amber:M.blue,textAlign:"right"},children:m.temp_carga??"-"}),o.jsx("td",{style:{padding:"8px 12px"},children:o.jsx("button",{onClick:()=>f(m.id),style:{background:"none",border:"none",color:M.txt3,cursor:"pointer",fontSize:14},children:""})})]},m.id)),o.jsxs("tr",{style:{background:M.surface,borderTop:`2px solid ${M.borderLt}`},children:[o.jsx("td",{colSpan:6,style:{padding:"8px 12px",fontWeight:700,color:M.txt3,fontSize:11},children:"TOTAL"}),o.jsx("td",{style:{padding:"8px 12px",fontWeight:800,color:M.green,textAlign:"right"},children:p}),o.jsx("td",{style:{padding:"8px 12px",fontWeight:800,color:M.amber,textAlign:"right"},children:x}),o.jsx("td",{colSpan:2})]})]})]})}),n&&o.jsxs(qo,{title:"Agregar Pallet",onClose:()=>a(!1),width:640,children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"N TAG *",children:o.jsx(Ie,{value:l.tag,onChange:m=>c({...l,tag:m}),placeholder:"ej: 2363298"})}),o.jsx(Ae,{label:"Lote *",children:o.jsx(Ie,{value:l.lote,onChange:m=>c({...l,lote:m}),placeholder:"ej: AM26004RB"})}),o.jsx(Ae,{label:"Presentacin",children:o.jsx(Hn,{value:l.presentacion,onChange:m=>c({...l,presentacion:m,kg_neto:u(m,l.cajas)}),options:nw})}),o.jsx(Ae,{label:"Label",children:o.jsx(Hn,{value:l.label,onChange:m=>c({...l,label:m}),options:rw})}),o.jsx(Ae,{label:"Calibre",children:o.jsx(Hn,{value:l.calibre,onChange:m=>c({...l,calibre:m}),options:tw})}),o.jsx(Ae,{label:"Variedad",children:o.jsx(Hn,{value:l.variedad,onChange:m=>c({...l,variedad:m}),options:lie})}),o.jsx(Ae,{label:"Fecha Cosecha",children:o.jsx(Ie,{type:"date",value:l.fecha,onChange:m=>c({...l,fecha:m})})}),o.jsx(Ae,{label:"Cajas/Pallet",children:o.jsx(Ie,{type:"number",value:l.cajas,onChange:m=>c({...l,cajas:m,kg_neto:u(l.presentacion,m)})})}),o.jsx(Ae,{label:"KG Neto (auto)",children:o.jsx("div",{style:{...Re.input,background:M.bg,color:M.amber,fontWeight:700,cursor:"default",display:"flex",alignItems:"center"},children:u(l.presentacion,l.cajas)||""})}),o.jsx(Ae,{label:"KG Bruto",children:o.jsx(Ie,{type:"number",value:l.kg_bruto,onChange:m=>c({...l,kg_bruto:m})})}),o.jsx(Ae,{label:"Temp. Carga (C)",children:o.jsx(Ie,{type:"number",value:l.temp_carga,onChange:m=>c({...l,temp_carga:m}),placeholder:"1.2"})})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:18},children:[o.jsx("button",{onClick:()=>a(!1),style:Re.btn(M.txt3),children:"Cancelar"}),o.jsx("button",{onClick:d,disabled:i,style:{...Re.btnPrimary,opacity:i?.5:1},children:i?"Guardando":"Agregar Pallet"})]})]})]})}function wie({embarque:e}){return o.jsx("div",{style:{maxWidth:560},children:e.tracking.map((t,r)=>{const n=Dr(t.etapa),a=r===e.tracking.length-1;return o.jsxs("div",{style:{display:"flex",gap:16,position:"relative"},children:[!a&&o.jsx("div",{style:{position:"absolute",left:16,top:36,bottom:0,width:2,background:M.border}}),o.jsx("div",{style:{width:34,height:34,borderRadius:"50%",background:a?n.color+"25":M.surface,border:`2px solid ${n.color}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,flexShrink:0,zIndex:1},children:n.icon}),o.jsxs("div",{style:{paddingBottom:20,flex:1},children:[o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:700,color:n.color},children:n.name}),o.jsx("span",{style:{fontSize:10,color:M.txt3},children:t.fecha}),t.temp!=null&&o.jsx(Wt,{text:`${t.temp}C`,color:t.temp>4?M.red:t.temp>2?M.amber:M.blue})]}),o.jsx("div",{style:{fontSize:12,color:M.txt2,marginTop:4,lineHeight:1.6},children:t.notas}),o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:3},children:["por ",t.usuario]})]})]},t.id)})})}function Sie({embarque:e,onBack:t,onUpdate:r,contactos:n,onRequestApproval:a,catalogoDestinos:i}){var w;const[s,l]=h.useState("pallets"),[c,u]=h.useState(!1),[d,f]=h.useState(!1),[p,x]=h.useState(!1),m=Dr(e.status),y=aw(e.status),j=async()=>{f(!0);try{const{error:C}=await se.from("embarques").update({status:y,updated_at:new Date().toISOString()}).eq("id",e.id);if(C)throw C;const{data:k}=await se.from("embarque_tracking").insert({embarque_id:e.id,etapa_anterior:e.status,etapa_nueva:y,notas:`Avanzado a ${Dr(y).name}`}).select().single(),S={id:(k==null?void 0:k.id)||Kr(),etapa:y,fecha:new Date().toLocaleString("es-MX"),usuario:"Usuario",temp:null,notas:`Avanzado a ${Dr(y).name}`};r({...e,status:y,tracking:[...e.tracking,S]}),u(!1)}catch(C){alert("Error al avanzar: "+C.message)}finally{f(!1)}},b=()=>{var k;const C=sw(e);if(C.length===0){j();return}a?(u(!1),a({action_key:"exportacion.kanban.advance_without_docs",context_id:e.id,context_data:{embarque:e.codigo,destino:((k=e.destinos[0])==null?void 0:k.cliente)??"",etapa_destino:Dr(y).name,next_status:y,docs_faltantes:C.map(S=>S.label).join(", ")},title:"Avanzar sin documentos completos",description:`El embarque ${e.codigo} tiene ${C.length} documento${C.length>1?"s":""} obligatorio${C.length>1?"s":""} pendiente${C.length>1?"s":""}. Para avanzar a ${Dr(y).name} sin ellos necesitas autorizacin del administrador.`,onApproved:()=>j()})):j()},g=(()=>{const C=(Ei[e.status]||[]).filter(S=>S.req),k=C.filter(S=>{var _;return((_=e.documentos[S.key])==null?void 0:_.status)==="subido"}).length;return{total:C.length,ok:k}})(),v=[{id:"pallets",label:" Pallets"},{id:"documentos",label:" Documentos",badge:g.total>0&&g.ok<g.total?`${g.total-g.ok} `:null},{id:"tracking",label:" Tracking"},{id:"correos",label:" Correos",badge:e.correos.length>0?e.correos.length:null}];return o.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[o.jsxs("div",{style:{padding:"14px 20px",borderBottom:`1px solid ${M.border}`,flexShrink:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:10},children:[o.jsx("button",{onClick:t,style:{background:"none",border:"none",color:M.txt3,cursor:"pointer",fontSize:20,padding:0},children:""}),o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx("span",{style:{fontFamily:M.mono,fontSize:20,fontWeight:900,color:m.color},children:e.codigo}),o.jsx(pie,{stageId:e.status})]}),o.jsxs("div",{style:{fontSize:12,color:M.txt3,marginTop:2},children:[(w=e.destinos[0])==null?void 0:w.cliente,"  ",xc(e.fecha_salida),"  ",e.hora_salida," hs"]})]}),e.status!=="entregado"&&o.jsx("button",{onClick:()=>u(!0),disabled:d,style:{...Re.btnPrimary,marginLeft:"auto",opacity:d?.5:1},children:d?"Guardando":`Avanzar a ${Dr(y).name} ${Dr(y).icon}`})]}),o.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[{l:"Pallets",v:iw(e),c:M.teal},{l:"Cajas",v:zc(e),c:M.amber},{l:"KG",v:vc(e),c:M.blue},{l:"Destinos",v:e.destinos.length,c:M.purple},{l:"Placa",v:e.tracto_placa,c:M.txt2},{l:"Op.",v:e.operador,c:M.txt2}].map(C=>o.jsxs("div",{style:{background:C.c+"10",border:`1px solid ${C.c}25`,borderRadius:8,padding:"5px 12px"},children:[o.jsx("div",{style:{fontSize:9,color:M.txt3,textTransform:"uppercase",letterSpacing:1},children:C.l}),o.jsx("div",{style:{fontSize:13,fontWeight:700,color:C.c},children:C.v})]},C.l))})]}),o.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${M.border}`,flexShrink:0},children:v.map(C=>o.jsxs("button",{onClick:()=>l(C.id),style:{background:"none",border:"none",borderBottom:s===C.id?`2px solid ${M.teal}`:"2px solid transparent",color:s===C.id?M.teal:M.txt3,padding:"10px 16px",fontSize:12,fontWeight:700,cursor:"pointer",marginBottom:-1,display:"flex",alignItems:"center",gap:6},children:[C.label,C.badge&&o.jsx("span",{style:{fontSize:9,background:M.red+"30",color:M.red,border:`1px solid ${M.red}40`,borderRadius:10,padding:"1px 5px",fontWeight:700},children:C.badge})]},C.id))}),o.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px 20px"},children:[s==="pallets"&&o.jsx(jie,{embarque:e,onUpdate:r,onEditEmbarque:()=>x(!0)}),s==="documentos"&&o.jsx(xie,{embarque:e,onUpdate:r}),s==="tracking"&&o.jsx(wie,{embarque:e}),s==="correos"&&o.jsx(bie,{embarque:e,onUpdate:r,contactos:n})]}),c&&o.jsx(mie,{embarque:e,onConfirm:b,onCancel:()=>u(!1)}),p&&o.jsx(Mie,{embarque:e,onClose:()=>x(!1),onSaved:C=>{r(C),x(!1)},onRequestApproval:a,catalogoDestinos:i||[]})]})}const rh=[{id:"prep",ids:["cooler","documentacion"],name:"Cooler / Docs",icon:"",color:M.teal},{id:"cruce",ids:["cruce"],name:"Cruce Frontera",icon:"",color:M.orange},{id:"transito",ids:["transito"],name:"Trnsito US",icon:"",color:M.blue},{id:"entregado",ids:["entregado"],name:"Entregado",icon:"",color:M.green}];function kie({embarques:e,onSelect:t,onNuevo:r,onRefresh:n,refreshing:a}){const i={};return rh.forEach(s=>{i[s.id]=[]}),e.forEach(s=>{const l=rh.find(c=>c.ids.includes(s.status));l&&i[l.id].push(s)}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:`1px solid ${M.border}`,flexShrink:0},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:18,fontWeight:800,color:M.txt1},children:"Pipeline de Embarques"}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:2},children:[o.jsxs("span",{style:{fontSize:12,color:M.txt3},children:[e.length," embarques activos"]}),o.jsxs("span",{style:{fontSize:10,color:M.txt3,background:M.teal+"15",border:`1px solid ${M.teal}30`,borderRadius:20,padding:"1px 8px",display:"flex",alignItems:"center",gap:4},children:[o.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:M.teal,display:"inline-block",animation:"pulse 2s ease-in-out infinite"}}),"Sincronizado en tiempo real"]})]})]}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsxs("button",{onClick:n,disabled:a,title:"Recargar todos los embarques desde la base de datos",style:{padding:"8px 14px",borderRadius:8,cursor:a?"not-allowed":"pointer",background:"transparent",border:`1px solid ${M.border}`,color:a?M.txt3:M.txt2,fontSize:12,fontWeight:600,display:"flex",alignItems:"center",gap:6,transition:"all .15s",opacity:a?.6:1},onMouseEnter:s=>{a||(s.currentTarget.style.borderColor=M.teal,s.currentTarget.style.color=M.teal)},onMouseLeave:s=>{s.currentTarget.style.borderColor=M.border,s.currentTarget.style.color=M.txt2},children:[o.jsx("span",{style:{display:"inline-block",animation:a?"spin .7s linear infinite":"none"},children:""}),a?"Actualizando":"Actualizar"]}),o.jsx("button",{style:Re.btnPrimary,onClick:r,children:"+ Nuevo Embarque"})]})]}),o.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${M.border}`,flexShrink:0},children:rh.map(s=>{const l=i[s.id].length;return o.jsxs("div",{style:{flex:1,padding:"10px 14px",borderRight:`1px solid ${M.border}`,textAlign:"center"},children:[o.jsxs("div",{style:{fontSize:10,color:s.color,fontWeight:700,textTransform:"uppercase",letterSpacing:1},children:[s.icon," ",s.name]}),o.jsx("div",{style:{fontSize:22,fontWeight:900,color:l>0?s.color:M.txt3,marginTop:2},children:l})]},s.id)})}),o.jsx("div",{style:{flex:1,overflowX:"auto",display:"flex",gap:0},children:rh.map(s=>o.jsxs("div",{style:{minWidth:280,width:"25%",borderRight:`1px solid ${M.border}`,display:"flex",flexDirection:"column"},children:[o.jsxs("div",{style:{padding:"10px 14px",background:s.color+"08",borderBottom:`2px solid ${s.color}40`,display:"flex",alignItems:"center",gap:8,flexShrink:0},children:[o.jsx("span",{style:{fontSize:14},children:s.icon}),o.jsx("span",{style:{fontSize:12,fontWeight:800,color:s.color,textTransform:"uppercase",letterSpacing:.5},children:s.name}),o.jsx("span",{style:{marginLeft:"auto",fontSize:11,fontWeight:700,color:s.color,background:s.color+"20",borderRadius:20,padding:"1px 8px"},children:i[s.id].length})]}),o.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"10px 8px",display:"flex",flexDirection:"column",gap:8},children:[i[s.id].map(l=>{var d,f,p,x;const c=sw(l).length,u=Dr(l.status);return o.jsxs("div",{onClick:()=>t(l),style:{background:M.card,border:`1px solid ${M.border}`,borderLeft:`3px solid ${u.color}`,borderRadius:"0 10px 10px 0",padding:"10px 12px",cursor:"pointer",transition:"all .12s"},onMouseEnter:m=>{m.currentTarget.style.background=M.cardHov},onMouseLeave:m=>{m.currentTarget.style.background=M.card},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontFamily:M.mono,fontSize:12,fontWeight:700,color:u.color},children:l.codigo}),o.jsxs("span",{style:{marginLeft:6,fontSize:9,background:u.color+"18",color:u.color,border:`1px solid ${u.color}40`,borderRadius:4,padding:"1px 5px"},children:[u.icon," ",u.name]})]}),c>0&&o.jsxs("span",{style:{fontSize:9,background:M.amber+"20",color:M.amber,border:`1px solid ${M.amber}40`,borderRadius:4,padding:"1px 5px",fontWeight:700},children:[" ",c]})]}),o.jsx("div",{style:{fontSize:11,color:M.txt2,marginTop:4},children:((f=(d=l.destinos[0])==null?void 0:d.cliente)==null?void 0:f.split(" ").slice(0,3).join(" "))||""}),o.jsx("div",{style:{fontSize:10,color:M.txt3,marginTop:1},children:(x=(p=l.destinos[0])==null?void 0:p.warehouse)==null?void 0:x.split(" ").slice(0,3).join(" ")}),o.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[o.jsxs("span",{style:{fontSize:10,color:M.txt3},children:[" ",o.jsx("b",{style:{color:M.txt2},children:iw(l)})," pallets"]}),o.jsxs("span",{style:{fontSize:10,color:M.txt3},children:[" ",o.jsx("b",{style:{color:M.txt2},children:zc(l)})]})]}),o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:4},children:[" ",xc(l.fecha_salida)]})]},l.id)}),i[s.id].length===0&&o.jsx("div",{style:{textAlign:"center",padding:"24px 12px",color:M.txt3,fontSize:11,border:`1px dashed ${M.border}`,borderRadius:10,marginTop:4},children:"Sin embarques"})]})]},s.id))})]})}const Cie={codigo:"",fecha_salida:"",hora_salida:"00:30",tracto_marca:"",tracto_placa:"",remolque_marca:"",remolque_placa:"",thermo:"",operador:"",caat:"",alpha:"",sello:"",notas:""},Hp={id:"",orden:1,cliente:"",warehouse:"",direccion:"",telefono:"",tax_id:"",fecha_entrega_est:"",fecha_entrega_real:null},DI={tag:"",lote:"",presentacion:"8X18",label:"RIVER RUN",calibre:"LARGE",fecha:"",cajas:144,kg_neto:"",kg_bruto:"",temp_carga:"",variedad:"Biloxi"};function _ie({onClose:e,onCreate:t,catalogoDestinos:r}){const[n,a]=h.useState(1),[i,s]=h.useState({...Cie,id:Kr()}),[l,c]=h.useState([{...Hp,id:Kr(),orden:1}]),[u,d]=h.useState([]),[f,p]=h.useState({...DI,id:Kr()}),x=(S,_)=>s(A=>({...A,[S]:_})),m=(S,_,A)=>{const E=[...l];E[S]={...E[S],[_]:A},c(E)},y=(S,_)=>{const A=r.find(N=>N.id===_);if(!A)return;const E=[...l];E[S]={...E[S],cliente:A.nombre,warehouse:A.nombre,direccion:`${A.direccion||""}, ${A.ciudad||""}, ${A.estado||""} ${A.cp||""}`.replace(/^,\s*/,"").trim(),telefono:A.telefono||"",tax_id:A.tax_id||""},c(E)},j=(S,_)=>{const A=ow[S];return A?(Number(_)*A).toFixed(1):""},b=()=>{if(!f.tag)return;const S=j(f.presentacion,f.cajas);d(_=>[..._,{...f,id:Kr(),cajas:Number(f.cajas),kg_neto:Number(S)||0,kg_bruto:Number(f.kg_bruto)||0,temp_carga:Number(f.temp_carga)||null}]),p(_=>({..._,id:Kr(),tag:"",kg_bruto:"",temp_carga:""}))},[g,v]=h.useState(!1),w=async()=>{if(!i.codigo||!i.fecha_salida){alert("Cdigo y fecha son requeridos");return}v(!0);try{const{data:S,error:_}=await se.from("embarques").insert({codigo:i.codigo,fecha_salida:i.fecha_salida,hora_salida:i.hora_salida||null,status:"cooler",tracto_marca:i.tracto_marca,tracto_placa:i.tracto_placa,remolque_marca:i.remolque_marca,remolque_placa:i.remolque_placa,thermo:i.thermo,operador:i.operador,caat:i.caat,alpha:i.alpha,sello_numero:i.sello,notas:i.notas}).select().single();if(_)throw _;if(l.length>0){const{error:E}=await se.from("embarque_destinos").insert(l.map((N,$)=>({embarque_id:S.id,orden:$+1,cliente:N.cliente,cust_po:N.cust_po,warehouse_nombre:N.warehouse,direccion:N.direccion,telefono:N.telefono,tax_id:N.tax_id,fecha_entrega_est:N.fecha_entrega_est||null})));if(E)throw E}if(u.length>0){const{error:E}=await se.from("embarque_pallets").insert(u.map(N=>({embarque_id:S.id,tag_numero:N.tag,lote:N.lote,variedad:N.variedad,presentacion:N.presentacion,label:N.label,calibre:N.calibre,fecha_cosecha:N.fecha||null,cajas:N.cajas,kg_neto:N.kg_neto||null,kg_bruto:N.kg_bruto||null,temp_carga:N.temp_carga||null})));if(E)throw E}await se.from("embarque_tracking").insert({embarque_id:S.id,etapa_nueva:"cooler",notas:"Embarque creado."});const A=await Vp(S.id);A&&t(A),e()}catch(S){alert("Error al crear embarque: "+S.message)}finally{v(!1)}},C=u.reduce((S,_)=>S+_.cajas,0),k=u.reduce((S,_)=>S+_.kg_neto,0).toFixed(1);return o.jsxs(qo,{title:"Nuevo Embarque",onClose:e,width:760,children:[o.jsx("div",{style:{display:"flex",gap:0,marginBottom:22,borderRadius:8,overflow:"hidden",border:`1px solid ${M.border}`},children:["1. Datos del Camin","2. Destino(s)","3. Pallets + Confirmar"].map((S,_)=>o.jsx("div",{style:{flex:1,padding:"9px 14px",textAlign:"center",background:_+1===n?M.teal+"18":_+1<n?M.teal+"08":M.surface,borderRight:_<2?`1px solid ${M.border}`:"none"},children:o.jsxs("div",{style:{fontSize:10,fontWeight:700,color:_+1<=n?M.teal:M.txt3,textTransform:"uppercase",letterSpacing:1},children:[_+1<n?" ":"",S]})},_))}),n===1&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Cdigo de Embarque *",children:o.jsx(Ie,{value:i.codigo,onChange:S=>x("codigo",S),placeholder:"ej: AM26006RB"})}),o.jsx(Ae,{label:"Fecha de Salida *",children:o.jsx(Ie,{type:"date",value:i.fecha_salida,onChange:S=>x("fecha_salida",S)})}),o.jsx(Ae,{label:"Hora de Salida",children:o.jsx(Ie,{type:"time",value:i.hora_salida,onChange:S=>x("hora_salida",S)})}),o.jsx(Ae,{label:"N Sello",children:o.jsx(Ie,{value:i.sello,onChange:S=>x("sello",S),placeholder:"ej: 4421-B"})})]}),o.jsx(Ls,{label:"Tracto"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Marca",children:o.jsx(Ie,{value:i.tracto_marca,onChange:S=>x("tracto_marca",S),placeholder:"ej: Marca Internacional"})}),o.jsx(Ae,{label:"Placa *",children:o.jsx(Ie,{value:i.tracto_placa,onChange:S=>x("tracto_placa",S),placeholder:"ej: 90-BG-1X"})})]}),o.jsx(Ls,{label:"Remolque / Reefer"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Marca",children:o.jsx(Ie,{value:i.remolque_marca,onChange:S=>x("remolque_marca",S),placeholder:"ej: Utility"})}),o.jsx(Ae,{label:"Placa *",children:o.jsx(Ie,{value:i.remolque_placa,onChange:S=>x("remolque_placa",S),placeholder:"ej: 13-UW-1E"})}),o.jsx(Ae,{label:"Thermo N",children:o.jsx(Ie,{value:i.thermo,onChange:S=>x("thermo",S),placeholder:"ej: 412"})})]}),o.jsx(Ls,{label:"Operador"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Nombre *",children:o.jsx(Ie,{value:i.operador,onChange:S=>x("operador",S),placeholder:"ej: Antonio valos"})}),o.jsx(Ae,{label:"CAAT",children:o.jsx(Ie,{value:i.caat,onChange:S=>x("caat",S),placeholder:"ej: 36ZN"})}),o.jsx(Ae,{label:"Alpha",children:o.jsx(Ie,{value:i.alpha,onChange:S=>x("alpha",S),placeholder:"ej: TEPA"})})]})]}),n===2&&o.jsxs("div",{children:[l.map((S,_)=>o.jsxs("div",{style:{marginBottom:16,padding:14,background:M.surface,borderRadius:10,border:`1px solid ${M.border}`},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:10},children:[o.jsxs("span",{style:{fontSize:13,fontWeight:700,color:M.teal},children:["Destino ",_+1]}),_>0&&o.jsx("button",{onClick:()=>c(A=>A.filter((E,N)=>N!==_)),style:{background:"none",border:"none",color:M.red,cursor:"pointer"},children:" Quitar"})]}),o.jsx(Ae,{label:"Autocompletar desde catlogo",children:o.jsxs("select",{onChange:A=>y(_,A.target.value),style:{...Re.input,marginBottom:10,appearance:"none"},children:[o.jsx("option",{value:"",children:" Seleccionar warehouse guardado "}),r.map(A=>o.jsxs("option",{value:A.id,children:[A.nombre,"  ",A.ciudad,", ",A.estado]},A.id))]})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx(Ae,{label:"Cliente / Comprador *",children:o.jsx(Ie,{value:S.cliente,onChange:A=>m(_,"cliente",A),placeholder:"ej: Family Tree Farms..."})}),o.jsx(Ae,{label:"Warehouse *",children:o.jsx(Ie,{value:S.warehouse,onChange:A=>m(_,"warehouse",A)})}),o.jsx(Ae,{label:"Direccin",children:o.jsx(Ie,{value:S.direccion,onChange:A=>m(_,"direccion",A)})}),o.jsx(Ae,{label:"Telfono",children:o.jsx(Ie,{value:S.telefono,onChange:A=>m(_,"telefono",A)})}),o.jsx(Ae,{label:"Tax ID",children:o.jsx(Ie,{value:S.tax_id,onChange:A=>m(_,"tax_id",A)})}),o.jsx(Ae,{label:"Fecha Entrega Est.",children:o.jsx(Ie,{type:"date",value:S.fecha_entrega_est,onChange:A=>m(_,"fecha_entrega_est",A)})})]})]},S.id)),l.length<3&&o.jsxs("button",{onClick:()=>c(S=>[...S,{...Hp,id:Kr(),orden:S.length+1}]),style:{...Re.btn(),width:"100%",textAlign:"center"},children:["+ Agregar Destino (",l.length,"/3)"]})]}),n===3&&o.jsxs("div",{children:[o.jsx("div",{style:{display:"flex",gap:10,marginBottom:14,flexWrap:"wrap"},children:[{l:"Embarque",v:i.codigo||"",c:M.teal},{l:"Pallets",v:u.length,c:M.purple},{l:"Cajas",v:C,c:M.green},{l:"KG",v:k,c:M.amber}].map(S=>o.jsxs("div",{style:{flex:1,minWidth:80,background:S.c+"0c",border:`1px solid ${S.c}25`,borderRadius:8,padding:"6px 12px"},children:[o.jsx("div",{style:{fontSize:9,color:M.txt3,textTransform:"uppercase",letterSpacing:1},children:S.l}),o.jsx("div",{style:{fontSize:15,fontWeight:800,color:S.c,fontFamily:M.mono},children:S.v})]},S.l))}),o.jsxs("div",{style:{background:M.surface,borderRadius:10,padding:12,marginBottom:12,border:`1px solid ${M.border}`},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:M.txt1,marginBottom:10},children:"+ Agregar Pallet"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8},children:[o.jsx(Ae,{label:"N TAG *",children:o.jsx(Ie,{value:f.tag,onChange:S=>p({...f,tag:S}),placeholder:"2363298"})}),o.jsx(Ae,{label:"Lote *",children:o.jsx(Ie,{value:f.lote,onChange:S=>p({...f,lote:S}),placeholder:"AM26004RB"})}),o.jsx(Ae,{label:"Presentacin",children:o.jsx(Hn,{value:f.presentacion,onChange:S=>{const _=j(S,f.cajas);p({...f,presentacion:S,kg_neto:_})},options:nw})}),o.jsx(Ae,{label:"Label",children:o.jsx(Hn,{value:f.label,onChange:S=>p({...f,label:S}),options:rw})}),o.jsx(Ae,{label:"Calibre",children:o.jsx(Hn,{value:f.calibre,onChange:S=>p({...f,calibre:S}),options:tw})}),o.jsx(Ae,{label:"Fecha",children:o.jsx(Ie,{type:"date",value:f.fecha,onChange:S=>p({...f,fecha:S})})}),o.jsx(Ae,{label:"Cajas/Pallet",children:o.jsx(Ie,{type:"number",value:f.cajas,onChange:S=>{const _=j(f.presentacion,S);p({...f,cajas:S,kg_neto:_})}})}),o.jsx(Ae,{label:"KG Neto (auto)",children:o.jsx("div",{style:{...Re.input,background:M.bg,color:M.amber,fontWeight:700,cursor:"default",display:"flex",alignItems:"center"},children:f.kg_neto||j(f.presentacion,f.cajas)||""})})]}),o.jsx("button",{onClick:b,style:{...Re.btn(M.teal),marginTop:6,fontSize:11},children:"+ Agregar a la lista"})]}),u.length>0&&o.jsx("div",{style:{overflowX:"auto",borderRadius:8,border:`1px solid ${M.border}`},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[o.jsx("thead",{children:o.jsx("tr",{style:{background:M.surface},children:["TAG","Lote","Present.","Label","Calibre","Fecha","Cajas","KG",""].map(S=>o.jsx("th",{style:{padding:"6px 10px",textAlign:"left",color:M.txt3,fontWeight:700,fontSize:9,textTransform:"uppercase",borderBottom:`1px solid ${M.border}`},children:S},S))})}),o.jsx("tbody",{children:u.map(S=>o.jsxs("tr",{style:{borderBottom:`1px solid ${M.border}30`},children:[o.jsx("td",{style:{padding:"6px 10px",fontFamily:M.mono,color:M.teal,fontWeight:700},children:S.tag}),o.jsx("td",{style:{padding:"6px 10px",fontFamily:M.mono,color:M.purple},children:S.lote}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt1},children:S.presentacion}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt2},children:S.label}),o.jsx("td",{style:{padding:"6px 10px",color:M.green},children:S.calibre}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt2},children:S.fecha||""}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt1},children:S.cajas}),o.jsx("td",{style:{padding:"6px 10px",color:M.amber},children:S.kg_neto}),o.jsx("td",{children:o.jsx("button",{onClick:()=>d(_=>_.filter(A=>A.id!==S.id)),style:{background:"none",border:"none",color:M.txt3,cursor:"pointer"},children:""})})]},S.id))})]})})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:20,borderTop:`1px solid ${M.border}`,paddingTop:16},children:[o.jsx("button",{onClick:n===1?e:()=>a(S=>S-1),style:Re.btn(M.txt3),children:n===1?"Cancelar":" Atrs"}),n<3?o.jsx("button",{onClick:()=>a(S=>S+1),style:Re.btnPrimary,children:"Siguiente "}):o.jsx("button",{onClick:w,disabled:g,style:{...Re.btnPrimary,background:M.green,color:"#03110a",opacity:g?.5:1},children:g?"Guardando":" Crear Embarque"})]})]})}function Aie(){const[e,t]=h.useState([]),[r,n]=h.useState(!0),[a,i]=h.useState(!1),[s,l]=h.useState(null),[c,u]=h.useState({nombre_display:"",email:"",gmail_client_id:"",gmail_client_secret:"",gmail_refresh_token:"",notas:""}),[d,f]=h.useState(!1),[p,x]=h.useState(null),[m,y]=h.useState(!1);h.useEffect(()=>{j()},[]);const j=async()=>{n(!0);const{data:S,error:_}=await se.from("configuracion_remitente").select("*").order("created_at");_&&(console.error("Error cargando remitentes:",_),alert(`Error al cargar remitentes:
`+_.message+`

Asegrate de ejecutar el SQL 'fix_rls_remitentes.sql' en Supabase.`)),S&&t(S),n(!1)},b=()=>{u({nombre_display:"",email:"",gmail_client_id:"",gmail_client_secret:"",gmail_refresh_token:"",notas:""}),l(null),i(!0)},g=S=>{u({nombre_display:S.nombre_display,email:S.email,gmail_client_id:S.gmail_client_id||"",gmail_client_secret:S.gmail_client_secret||"",gmail_refresh_token:S.gmail_refresh_token||"",notas:S.notas||""}),l(S),i(!0)},v=async()=>{if(!c.nombre_display||!c.email){alert("Nombre y email son requeridos");return}f(!0);try{s?await se.from("configuracion_remitente").update({...c,updated_at:new Date().toISOString()}).eq("id",s.id):await se.from("configuracion_remitente").insert({...c,activo:!1,verificado:!1}),i(!1),await j()}catch(S){alert("Error: "+S.message)}finally{f(!1)}},w=async S=>{await se.from("configuracion_remitente").update({activo:!1}).neq("id","00000000-0000-0000-0000-000000000000"),S.activo||await se.from("configuracion_remitente").update({activo:!0}).eq("id",S.id),await j()},C=async S=>{window.confirm("Eliminar este remitente?")&&(await se.from("configuracion_remitente").delete().eq("id",S),await j())},k=async S=>{if(!S.gmail_refresh_token){alert("Primero configura el Refresh Token");return}x(S.id);try{const{data:_,error:A}=await se.functions.invoke("send-email",{body:{embarque_id:"00000000-0000-0000-0000-000000000001",asunto:" Prueba de conexin Gmail  Moray",cuerpo_html:`<p>Si recibes este correo, la conexin Gmail est funcionando correctamente.</p><p>Remitente configurado: <b>${S.email}</b></p><p>Fecha: ${new Date().toLocaleString("es-MX")}</p>`,destinatarios:[S.email],adjuntos:[]}});if(A||!(_!=null&&_.success))throw new Error((_==null?void 0:_.error)||(A==null?void 0:A.message)||"Error desconocido");await se.from("configuracion_remitente").update({verificado:!0}).eq("id",S.id),alert(` Conexin exitosa. Se envi un correo de prueba a ${S.email}`),await j()}catch(_){alert(` Error de conexin:
`+_.message)}finally{x(null)}};return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:13,fontWeight:700,color:M.txt1},children:"Cuentas Gmail Remitentes"}),o.jsx("div",{style:{fontSize:11,color:M.txt3,marginTop:2},children:"Solo la cuenta activa enviar los correos de los embarques"})]}),o.jsxs("div",{style:{display:"flex",gap:8},children:[o.jsx("button",{onClick:()=>y(!m),style:{...Re.btn(M.blue),fontSize:11},children:" Gua de configuracin"}),o.jsx("button",{onClick:b,style:Re.btnPrimary,children:"+ Agregar remitente"})]})]}),m&&o.jsxs("div",{style:{background:M.card,border:`1px solid ${M.teal}30`,borderLeft:`3px solid ${M.teal}`,borderRadius:10,padding:18,marginBottom:16},children:[o.jsx("div",{style:{fontSize:13,fontWeight:800,color:M.teal,marginBottom:10},children:" Cmo conectar una cuenta Gmail  Paso a paso"}),[["1","Google Cloud Console","Ve a console.cloud.google.com  Nuevo proyecto  llmalo 'Moray Exportacion'"],["2","Habilitar Gmail API","APIs y servicios  Biblioteca  busca 'Gmail API'  Habilitar"],["3","Crear credenciales OAuth","APIs y servicios  Credenciales  Crear credenciales  ID de cliente OAuth  Tipo: Aplicacin web"],["4","URIs de redireccin","Agrega: https://developers.google.com/oauthplayground como URI autorizado"],["5","Copiar Client ID y Secret","Antalos. Los pegars en el formulario de abajo."],["6","Obtener Refresh Token","Ve a developers.google.com/oauthplayground    marca 'Use your own OAuth credentials'  pega Client ID y Secret  en el buscador escribe 'Gmail API v1'  selecciona https://mail.google.com/  Authorize APIs  inicia sesin con el Gmail que enviar  Exchange auth code for tokens  copia el Refresh Token"],["7","Llenar el formulario","Pega Client ID, Client Secret y Refresh Token en 'Agregar remitente' abajo."],["8","Probar conexin","Haz clic en 'Probar conexin' para verificar que funciona."]].map(([S,_,A])=>o.jsxs("div",{style:{display:"flex",gap:12,marginBottom:10,alignItems:"flex-start"},children:[o.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:M.teal+"20",border:`1px solid ${M.teal}50`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:800,color:M.teal,flexShrink:0},children:S}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:M.txt1},children:_}),o.jsx("div",{style:{fontSize:11,color:M.txt2,marginTop:2},children:A})]})]},S)),o.jsxs("div",{style:{marginTop:12,padding:"10px 14px",background:M.amber+"10",border:`1px solid ${M.amber}30`,borderRadius:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:M.amber,marginBottom:4},children:" Importante sobre seguridad"}),o.jsx("div",{style:{fontSize:11,color:M.txt2},children:'El Refresh Token da acceso permanente a enviar correos desde esa cuenta. sala con una cuenta de correo dedicada (no personal) y revoca el acceso desde Google si dejas de usar la app. En Google Cloud, deja el proyecto en modo "Testing" con tu correo como usuario de prueba.'})]})]}),r?o.jsx("div",{style:{textAlign:"center",padding:"30px",color:M.txt3},children:"Cargando"}):o.jsxs("div",{style:{display:"grid",gap:10},children:[e.map(S=>o.jsx(Cb,{style:{borderLeft:`3px solid ${S.activo?M.green:M.border}`},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("span",{style:{fontSize:13,fontWeight:700,color:M.txt1},children:S.nombre_display}),S.activo&&o.jsx(Wt,{text:" Activo",color:M.green}),S.verificado&&o.jsx(Wt,{text:"Verificado",color:M.teal}),!S.gmail_refresh_token&&o.jsx(Wt,{text:" Sin configurar",color:M.amber})]}),o.jsxs("div",{style:{fontSize:12,color:M.txt2},children:[" ",S.email]}),S.notas&&o.jsx("div",{style:{fontSize:11,color:M.txt3,marginTop:2},children:S.notas}),S.gmail_client_id&&o.jsxs("div",{style:{fontSize:10,color:M.txt3,marginTop:4,fontFamily:M.mono},children:["Client ID: ",S.gmail_client_id.slice(0,20),"",S.gmail_refresh_token?"  Refresh Token: ":"  Refresh Token: "]})]}),o.jsxs("div",{style:{display:"flex",gap:6,flexShrink:0,flexWrap:"wrap",justifyContent:"flex-end"},children:[o.jsx("button",{onClick:()=>w(S),style:{...Re.btn(S.activo?M.txt3:M.green),fontSize:11,padding:"4px 10px"},children:S.activo?"Desactivar":"Activar"}),o.jsx("button",{onClick:()=>k(S),disabled:p===S.id||!S.gmail_refresh_token,style:{...Re.btn(M.blue),fontSize:11,padding:"4px 10px",opacity:S.gmail_refresh_token?1:.4},children:p===S.id?"Probando":" Probar"}),o.jsx("button",{onClick:()=>g(S),style:{...Re.btn(M.teal),fontSize:11,padding:"4px 10px"},children:" Editar"}),o.jsx("button",{onClick:()=>C(S.id),style:{background:"none",border:"none",color:M.txt3,cursor:"pointer",fontSize:16},children:""})]})]})},S.id)),e.length===0&&o.jsxs("div",{style:{textAlign:"center",padding:"40px",color:M.txt3,border:`1px dashed ${M.border}`,borderRadius:12},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:13,marginBottom:4},children:"Sin cuentas remitentes configuradas"}),o.jsx("div",{style:{fontSize:11},children:"Agrega una cuenta Gmail para poder enviar correos desde los embarques"})]})]}),a&&o.jsxs(qo,{title:s?"Editar Remitente Gmail":"Nuevo Remitente Gmail",onClose:()=>i(!1),width:680,children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Nombre para mostrar *",children:o.jsx(Ie,{value:c.nombre_display,onChange:S=>u(_=>({..._,nombre_display:S})),placeholder:"ej: Exportaciones Moray"})}),o.jsx(Ae,{label:"Correo Gmail *",children:o.jsx(Ie,{value:c.email,onChange:S=>u(_=>({..._,email:S})),placeholder:"ej: exportacion@agricolamoray.com"})})]}),o.jsx(Ls,{label:"Credenciales OAuth  Google Cloud Console"}),o.jsx("div",{style:{marginBottom:12,padding:"10px 14px",background:M.card,borderRadius:8,border:`1px solid ${M.border}`},children:o.jsxs("div",{style:{fontSize:11,color:M.txt3},children:["Obtn estas credenciales en ",o.jsx("span",{style:{color:M.teal,fontWeight:700},children:"console.cloud.google.com"}),'  Credenciales  OAuth 2.0. Haz clic en " Gua de configuracin" arriba para el paso a paso.']})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Client ID",children:o.jsx(Ie,{value:c.gmail_client_id,onChange:S=>u(_=>({..._,gmail_client_id:S})),placeholder:"xxxxx.apps.googleusercontent.com"})}),o.jsx(Ae,{label:"Client Secret",children:o.jsx(Ie,{value:c.gmail_client_secret,onChange:S=>u(_=>({..._,gmail_client_secret:S})),placeholder:"GOCSPX-..."})})]}),o.jsx("div",{style:{marginTop:12},children:o.jsx(Ae,{label:"Refresh Token (de OAuth Playground)",children:o.jsx("textarea",{value:c.gmail_refresh_token,onChange:S=>u(_=>({..._,gmail_refresh_token:S.target.value})),placeholder:"1//0g... (obtenido de developers.google.com/oauthplayground)",style:{...Re.textarea,minHeight:80,fontSize:12}})})}),o.jsx("div",{style:{marginTop:12},children:o.jsx(Ae,{label:"Notas internas",children:o.jsx(Ie,{value:c.notas,onChange:S=>u(_=>({..._,notas:S})),placeholder:"ej: Cuenta principal de exportacin, usada para aviso de salida"})})}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:20},children:[o.jsx("button",{onClick:()=>i(!1),style:Re.btn(M.txt3),children:"Cancelar"}),o.jsx("button",{onClick:v,disabled:d,style:{...Re.btnPrimary,opacity:d?.5:1},children:d?"Guardando":s?"Guardar Cambios":"Crear Remitente"})]})]})]})}function Eie({destinos:e,contactos:t,onUpdateDestinos:r,onUpdateContactos:n}){const[a,i]=h.useState("destinos"),[s,l]=h.useState(!1),[c,u]=h.useState(!1),[d,f]=h.useState(null),[p,x]=h.useState(null),[m,y]=h.useState({nombre:"",direccion:"",ciudad:"",estado:"",cp:"",telefono:"",tax_id:"",email:""}),[j,b]=h.useState({nombre:"",empresa:"",rol:"cliente",email:"",es_fijo:!1,activo:!0}),g=["agente_mx","agente_us","transportista","cliente","warehouse","trafico","interno"],v=()=>{d?(r(e.map(A=>A.id===d.id?{...d,...m}:A)),f(null)):r([...e,{...m,id:Kr()}]),l(!1),y({nombre:"",direccion:"",ciudad:"",estado:"",cp:"",telefono:"",tax_id:"",email:""})},w=A=>{y({nombre:A.nombre,direccion:A.direccion,ciudad:A.ciudad,estado:A.estado,cp:A.cp||"",telefono:A.telefono||"",tax_id:A.tax_id||"",email:A.email||""}),f(A),l(!0)},C=()=>{p?(n(t.map(A=>A.id===p.id?{...p,...j}:A)),x(null)):n([...t,{...j,id:Kr()}]),u(!1),b({nombre:"",empresa:"",rol:"cliente",email:"",es_fijo:!1,activo:!0})},k=A=>{b({nombre:A.nombre,empresa:A.empresa||"",rol:A.rol,email:A.email,es_fijo:A.es_fijo,activo:A.activo}),x(A),u(!0)},S=()=>{l(!1),f(null),y({nombre:"",direccion:"",ciudad:"",estado:"",cp:"",telefono:"",tax_id:"",email:""})},_=()=>{u(!1),x(null),b({nombre:"",empresa:"",rol:"cliente",email:"",es_fijo:!1,activo:!0})};return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",borderBottom:`1px solid ${M.border}`},children:[o.jsx("div",{style:{fontSize:18,fontWeight:800,color:M.txt1},children:"Catlogos"}),a!=="remitentes"&&o.jsxs("button",{onClick:()=>a==="destinos"?l(!0):u(!0),style:Re.btnPrimary,children:["+ Nuevo ",a==="destinos"?"Destino":"Contacto"]})]}),o.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${M.border}`},children:[["destinos"," Warehouses"],["contactos"," Contactos"],["remitentes"," Remitentes"]].map(([A,E])=>o.jsx("button",{onClick:()=>i(A),style:{background:"none",border:"none",borderBottom:a===A?`2px solid ${M.teal}`:"2px solid transparent",color:a===A?M.teal:M.txt3,padding:"10px 20px",fontSize:12,fontWeight:700,cursor:"pointer"},children:E},A))}),o.jsxs("div",{style:{padding:"16px 20px"},children:[a==="remitentes"&&o.jsx(Aie,{}),a==="destinos"&&o.jsxs("div",{style:{display:"grid",gap:10},children:[e.map(A=>o.jsx(Cb,{children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:M.txt1},children:A.nombre}),o.jsxs("div",{style:{fontSize:12,color:M.txt2,marginTop:4},children:[A.direccion,A.ciudad?`, ${A.ciudad}`:"",A.estado?`, ${A.estado}`:"",A.cp?` ${A.cp}`:""]}),o.jsxs("div",{style:{fontSize:11,color:M.txt3,marginTop:2},children:[" ",A.telefono||"","  Tax ID: ",A.tax_id||"","  ",A.email||""]})]}),o.jsxs("div",{style:{display:"flex",gap:6,flexShrink:0,marginLeft:12},children:[o.jsx("button",{onClick:()=>w(A),style:{...Re.btn(M.blue),padding:"4px 10px",fontSize:11},children:" Editar"}),o.jsx("button",{onClick:()=>r(e.filter(E=>E.id!==A.id)),style:{background:"none",border:"none",color:M.txt3,cursor:"pointer",fontSize:16},children:""})]})]})},A.id)),e.length===0&&o.jsx("div",{style:{textAlign:"center",padding:"40px",color:M.txt3,fontSize:13,border:`1px dashed ${M.border}`,borderRadius:12},children:"Sin warehouses registrados"})]}),a==="contactos"&&o.jsxs("div",{style:{display:"grid",gap:10},children:[t.map(A=>o.jsx(Cb,{children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[o.jsx("div",{style:{width:36,height:36,borderRadius:"50%",background:(kd[A.rol]||M.txt2)+"20",border:`2px solid ${kd[A.rol]||M.txt2}50`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:800,color:kd[A.rol]||M.txt2},children:A.nombre.charAt(0)}),o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:13,fontWeight:700,color:M.txt1},children:[A.nombre," ",o.jsxs("span",{style:{fontSize:11,color:M.txt3},children:[" ",A.empresa]})]}),o.jsx("div",{style:{fontSize:11,color:M.txt2},children:A.email})]})]}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx(Wt,{text:kb[A.rol]||A.rol,color:kd[A.rol]||M.txt2}),A.es_fijo&&o.jsx(Wt,{text:"Fijo",color:M.teal}),o.jsx("button",{onClick:()=>k(A),style:{...Re.btn(M.blue),padding:"4px 10px",fontSize:11},children:" Editar"}),o.jsx("button",{onClick:()=>n(t.filter(E=>E.id!==A.id)),style:{background:"none",border:"none",color:M.txt3,cursor:"pointer",fontSize:16},children:""})]})]})},A.id)),t.length===0&&o.jsx("div",{style:{textAlign:"center",padding:"40px",color:M.txt3,fontSize:13,border:`1px dashed ${M.border}`,borderRadius:12},children:"Sin contactos registrados"})]})]}),s&&o.jsxs(qo,{title:d?"Editar Destino / Warehouse":"Nuevo Destino / Warehouse",onClose:S,children:[o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[["nombre","Nombre *","ej: Rio Bravo Packing..."],["direccion","Direccin","5316 S Stewart Rd"],["ciudad","Ciudad","San Juan"],["estado","Estado","TX"],["cp","Cdigo Postal","78589"],["telefono","Telfono","(956) 843-6200"],["tax_id","Tax ID",""],["email","Email",""]].map(([A,E,N])=>o.jsx(Ae,{label:E,children:o.jsx(Ie,{value:m[A],onChange:$=>y(z=>({...z,[A]:$})),placeholder:N||""})},A))}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:18},children:[o.jsx("button",{onClick:S,style:Re.btn(M.txt3),children:"Cancelar"}),o.jsx("button",{onClick:v,style:Re.btnPrimary,children:d?"Guardar Cambios":"Crear Warehouse"})]})]}),c&&o.jsxs(qo,{title:p?"Editar Contacto":"Nuevo Contacto",onClose:_,children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Nombre *",children:o.jsx(Ie,{value:j.nombre,onChange:A=>b(E=>({...E,nombre:A}))})}),o.jsx(Ae,{label:"Empresa",children:o.jsx(Ie,{value:j.empresa,onChange:A=>b(E=>({...E,empresa:A}))})}),o.jsx(Ae,{label:"Rol",children:o.jsx(Hn,{value:j.rol,onChange:A=>b(E=>({...E,rol:A})),options:g.map(A=>({value:A,label:kb[A]||A}))})}),o.jsx(Ae,{label:"Email *",children:o.jsx(Ie,{value:j.email,onChange:A=>b(E=>({...E,email:A}))})}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,gridColumn:"1/-1"},children:[o.jsx("input",{type:"checkbox",checked:j.es_fijo,onChange:A=>b(E=>({...E,es_fijo:A.target.checked})),id:"fijo"}),o.jsx("label",{htmlFor:"fijo",style:{...Re.label,margin:0,cursor:"pointer",textTransform:"none",fontSize:12},children:"Contacto fijo (pre-seleccionado en todos los correos)"})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:18},children:[o.jsx("button",{onClick:_,style:Re.btn(M.txt3),children:"Cancelar"}),o.jsx("button",{onClick:C,style:Re.btnPrimary,children:p?"Guardar Cambios":"Crear Contacto"})]})]})]})}function Nie({embarque:e,onClose:t}){const r=zc(e),n=vc(e),a=e.pallets.reduce((l,c)=>l+(c.kg_bruto||0),0).toFixed(1),i=e.destinos[0]||{};return o.jsxs(qo,{title:"Packing List",onClose:t,width:860,children:[o.jsx("style",{children:`
    @media print {
      body * { visibility: hidden; }
      #pl-print, #pl-print * { visibility: visible; }
      #pl-print { position: fixed; top: 0; left: 0; width: 100%; font-family: Arial, sans-serif; font-size: 11px; color: #000; background: #fff; }
      .no-print { display: none !important; }
    }
  `}),o.jsxs("div",{className:"no-print",style:{display:"flex",gap:10,marginBottom:16,justifyContent:"flex-end"},children:[o.jsx("button",{onClick:()=>window.print(),style:{...Re.btnPrimary,background:M.blue},children:" Imprimir / Guardar PDF"}),o.jsx("button",{onClick:t,style:Re.btn(M.txt3),children:"Cerrar"})]}),o.jsxs("div",{id:"pl-print",style:{background:"#fff",color:"#111",padding:"20px 24px",borderRadius:10,border:`1px solid ${M.border}`,fontSize:12,lineHeight:1.6},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16,borderBottom:"2px solid #111",paddingBottom:12},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:22,fontWeight:900,letterSpacing:-1},children:"PACKING LIST"}),o.jsx("div",{style:{fontSize:12,color:"#555",marginTop:2},children:"Agricola Moray  Exportacin de Berries"})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("div",{style:{fontSize:16,fontWeight:800},children:e.codigo}),o.jsxs("div",{style:{fontSize:11,color:"#555"},children:["Fecha: ",xc(e.fecha_salida)]}),o.jsxs("div",{style:{fontSize:11,color:"#555"},children:["Salida: ",e.hora_salida," hs"]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:16},children:[o.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:6,padding:"10px 14px"},children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"#555",marginBottom:6},children:"Shipper / Exportador"}),o.jsx("div",{style:{fontWeight:700},children:"Agricola Moray"}),o.jsx("div",{children:"Exportacin de Arndanos"}),o.jsx("div",{children:"Mxico"})]}),o.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:6,padding:"10px 14px"},children:[o.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"#555",marginBottom:6},children:"Consignee / Destinatario"}),o.jsx("div",{style:{fontWeight:700},children:i.cliente||""}),o.jsx("div",{children:i.direccion||""}),i.telefono&&o.jsxs("div",{children:["Tel: ",i.telefono]}),i.tax_id&&o.jsxs("div",{children:["Tax ID: ",i.tax_id]})]})]}),o.jsx("div",{style:{border:"1px solid #ccc",borderRadius:6,padding:"10px 14px",marginBottom:16,display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:10},children:[{l:"Tracto / Placa",v:`${e.tracto_marca} / ${e.tracto_placa}`},{l:"Remolque / Placa",v:`${e.remolque_marca} / ${e.remolque_placa}`},{l:"Thermo",v:e.thermo},{l:"Operador",v:e.operador},{l:"CAAT",v:e.caat},{l:"Alpha",v:e.alpha},{l:"Sello",v:e.sello||""},{l:"Cust PO",v:i.cust_po||""}].map(l=>o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:9,textTransform:"uppercase",letterSpacing:1,color:"#777"},children:l.l}),o.jsx("div",{style:{fontWeight:600},children:l.v||""})]},l.l))}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:10,marginBottom:14},children:[{l:"Total Pallets",v:e.pallets.length,bold:!0},{l:"Total Cajas",v:r,bold:!0},{l:"KG Neto",v:`${n} kg`,bold:!0},{l:"KG Bruto",v:`${a} kg`,bold:!0}].map(l=>o.jsxs("div",{style:{background:"#f4f6f9",borderRadius:6,padding:"8px 12px",textAlign:"center"},children:[o.jsx("div",{style:{fontSize:9,textTransform:"uppercase",letterSpacing:1,color:"#777"},children:l.l}),o.jsx("div",{style:{fontSize:18,fontWeight:900},children:l.v})]},l.l))}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[o.jsx("thead",{children:o.jsx("tr",{style:{background:"#1a2a3a",color:"#fff"},children:["#","N TAG","Lote","Variedad","Presentacin","Label","Calibre","Fecha Cosecha","Cajas/Pallet","KG Neto","KG Bruto"].map(l=>o.jsx("th",{style:{padding:"7px 10px",textAlign:"left",fontWeight:700,fontSize:9,textTransform:"uppercase",letterSpacing:.5,whiteSpace:"nowrap"},children:l},l))})}),o.jsxs("tbody",{children:[e.pallets.map((l,c)=>o.jsxs("tr",{style:{borderBottom:"1px solid #e0e5ec",background:c%2===1?"#f8fafc":"#fff"},children:[o.jsx("td",{style:{padding:"6px 10px",color:"#888",fontWeight:600},children:c+1}),o.jsx("td",{style:{padding:"6px 10px",fontFamily:"monospace",fontWeight:700,color:"#1a4a7a"},children:l.tag}),o.jsx("td",{style:{padding:"6px 10px",fontFamily:"monospace",color:"#555"},children:l.lote}),o.jsx("td",{style:{padding:"6px 10px"},children:l.variedad||""}),o.jsx("td",{style:{padding:"6px 10px",fontWeight:600},children:l.presentacion}),o.jsx("td",{style:{padding:"6px 10px"},children:l.label}),o.jsx("td",{style:{padding:"6px 10px",fontWeight:600},children:l.calibre}),o.jsx("td",{style:{padding:"6px 10px"},children:xc(l.fecha)}),o.jsx("td",{style:{padding:"6px 10px",textAlign:"right",fontWeight:700},children:l.cajas}),o.jsx("td",{style:{padding:"6px 10px",textAlign:"right",fontWeight:700},children:l.kg_neto||""}),o.jsx("td",{style:{padding:"6px 10px",textAlign:"right"},children:l.kg_bruto||""})]},l.id)),o.jsxs("tr",{style:{background:"#1a2a3a",color:"#fff",fontWeight:800},children:[o.jsx("td",{colSpan:8,style:{padding:"8px 10px",fontSize:11,textAlign:"right"},children:"TOTAL"}),o.jsx("td",{style:{padding:"8px 10px",textAlign:"right",fontSize:13},children:r}),o.jsx("td",{style:{padding:"8px 10px",textAlign:"right",fontSize:13},children:n}),o.jsx("td",{style:{padding:"8px 10px",textAlign:"right",fontSize:13},children:a})]})]})]}),o.jsx("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:20,paddingTop:16,borderTop:"1px solid #ddd"},children:["Preparado por","Revisado por","Recibido en destino"].map(l=>o.jsxs("div",{style:{borderTop:"1px solid #999",paddingTop:4},children:[o.jsx("div",{style:{fontSize:9,color:"#888",textTransform:"uppercase",letterSpacing:1},children:l}),o.jsx("div",{style:{height:32}}),o.jsx("div",{style:{fontSize:9,color:"#aaa"},children:"Firma / Fecha"})]},l))}),o.jsxs("div",{style:{marginTop:12,fontSize:9,color:"#aaa",textAlign:"center"},children:["Generado: ",new Date().toLocaleString("es-MX"),"  Agricola Moray  Mdulo de Exportacin"]})]})]})}function Pie({embarques:e,onSelectEmbarque:t}){const r=h.useMemo(()=>e.filter(y=>y.status!=="entregado"),[e]),n=h.useMemo(()=>e.filter(y=>y.status==="entregado"),[e]),a=h.useMemo(()=>e.filter(y=>y.status==="transito"),[e]),i=h.useMemo(()=>n.reduce((y,j)=>y+parseFloat(vc(j)),0).toFixed(0),[n]);h.useMemo(()=>{const y=new Date;return y.setDate(y.getDate()-7),e.filter(j=>j.status==="entregado"&&new Date(j.fecha_salida)>=y).reduce((j,b)=>j+zc(b),0)},[e]);const s=h.useMemo(()=>e.reduce((y,j)=>y+j.correos.length,0),[e]),l=h.useMemo(()=>e.reduce((y,j)=>y+Object.keys(j.documentos).length,0),[e]),c=h.useMemo(()=>Wl.map(y=>({name:y.name,icon:y.icon,count:e.filter(j=>j.status===y.id).length,color:y.color})),[e]),u=h.useMemo(()=>{const y=Date.now();return r.filter(j=>{if(j.tracking.length===0)return!0;const b=new Date(j.tracking[j.tracking.length-1].fecha.replace(" ","T")).getTime();return(y-b)/36e5>12})},[r]),d=h.useMemo(()=>e.flatMap(j=>j.tracking.map(b=>({...b,embarque_codigo:j.codigo,embarque_id:j.id,embarque_status:j.status}))).sort((j,b)=>new Date(b.fecha.replace(" ","T"))-new Date(j.fecha.replace(" ","T"))).slice(0,12),[e]),f=h.useMemo(()=>r.map(y=>{const b=Object.values(Ei).flat().filter(g=>g.req).filter(g=>{var v;return((v=y.documentos[g.key])==null?void 0:v.status)!=="subido"});return{...y,faltantes:b.length}}).filter(y=>y.faltantes>0).sort((y,j)=>j.faltantes-y.faltantes),[r]),p=h.useMemo(()=>{const y={};return e.forEach(j=>{var v;const b=((v=j.destinos[0])==null?void 0:v.cliente)||"Sin cliente",g=parseFloat(vc(j));y[b]||(y[b]={cliente:b,kg:0,embarques:0}),y[b].kg+=g,y[b].embarques++}),Object.values(y).sort((j,b)=>b.kg-j.kg).slice(0,5)},[e]),x=({label:y,value:j,sub:b,color:g,icon:v})=>o.jsx("div",{style:{background:M.card,border:`1px solid ${g}30`,borderRadius:14,padding:"16px 20px",borderLeft:`4px solid ${g}`},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:M.txt3,textTransform:"uppercase",letterSpacing:1,fontWeight:700},children:y}),o.jsx("div",{style:{fontSize:32,fontWeight:900,color:g,marginTop:4,lineHeight:1},children:j}),b&&o.jsx("div",{style:{fontSize:11,color:M.txt2,marginTop:4},children:b})]}),o.jsx("span",{style:{fontSize:28,opacity:.6},children:v})]})}),m=({title:y,sub:j})=>o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:14,fontWeight:800,color:M.txt1},children:y}),j&&o.jsx("div",{style:{fontSize:11,color:M.txt3,marginTop:2},children:j})]});return o.jsxs("div",{style:{overflowY:"auto",height:"100%",padding:"20px 24px"},children:[o.jsxs("div",{style:{marginBottom:22},children:[o.jsx("div",{style:{fontSize:20,fontWeight:900,color:M.txt1},children:"Dashboard de Exportacin"}),o.jsx("div",{style:{fontSize:12,color:M.txt3,marginTop:3},children:new Date().toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:24},children:[o.jsx(x,{label:"Activos",value:r.length,sub:`${a.length} en trnsito`,color:M.teal,icon:""}),o.jsx(x,{label:"Entregados",value:n.length,sub:"histrico total",color:M.green,icon:""}),o.jsx(x,{label:"KG Exportados",value:`${(parseFloat(i)/1e3).toFixed(1)}t`,sub:"histrico total",color:M.amber,icon:""}),o.jsx(x,{label:"Correos Enviados",value:s,sub:`${l} documentos subidos`,color:M.purple,icon:""})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[o.jsxs("div",{style:{background:M.card,border:`1px solid ${M.border}`,borderRadius:14,padding:"16px 18px"},children:[o.jsx(m,{title:"Distribucin por Etapa",sub:"Embarques activos + entregados"}),o.jsx("div",{style:{height:180},children:o.jsx(Jn,{width:"100%",height:"100%",children:o.jsxs(Fc,{data:c,margin:{top:4,right:8,bottom:0,left:-24},children:[o.jsx(kn,{dataKey:"name",tick:{fill:M.txt3,fontSize:10},axisLine:!1,tickLine:!1}),o.jsx(Cn,{tick:{fill:M.txt3,fontSize:10},axisLine:!1,tickLine:!1,allowDecimals:!1}),o.jsx(Yn,{contentStyle:{background:M.surface,border:`1px solid ${M.border}`,borderRadius:8,fontSize:12,color:M.txt1},cursor:{fill:M.teal+"15"},formatter:(y,j,b)=>[`${y} embarques`,b.payload.icon+" "+b.payload.name]}),o.jsx(Ea,{dataKey:"count",radius:[6,6,0,0],children:c.map((y,j)=>o.jsx(Gi,{fill:y.color},j))})]})})}),o.jsx("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:8},children:c.map(y=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:y.color,display:"inline-block"}}),o.jsxs("span",{style:{fontSize:10,color:M.txt3},children:[y.icon," ",y.count]})]},y.name))})]}),o.jsxs("div",{style:{background:M.card,border:`1px solid ${u.length>0?M.red+"40":M.border}`,borderRadius:14,padding:"16px 18px"},children:[o.jsx(m,{title:u.length>0?` ${u.length} Alerta${u.length>1?"s":""}`:" Sin Alertas",sub:"Embarques sin movimiento >12 horas"}),u.length===0?o.jsxs("div",{style:{textAlign:"center",padding:"28px 0",color:M.txt3,fontSize:13},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),"Todos los embarques activos tienen actividad reciente."]}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,maxHeight:220,overflowY:"auto"},children:u.map(y=>{var v,w;const j=Dr(y.status),b=y.tracking[y.tracking.length-1],g=b?Math.round((Date.now()-new Date(b.fecha.replace(" ","T")).getTime())/36e5):"??";return o.jsxs("div",{onClick:()=>t(y),style:{display:"flex",alignItems:"center",gap:10,padding:"10px 12px",borderRadius:9,cursor:"pointer",background:M.red+"08",border:`1px solid ${M.red}30`,transition:"border-color .15s"},onMouseEnter:C=>C.currentTarget.style.borderColor=M.red+"70",onMouseLeave:C=>C.currentTarget.style.borderColor=M.red+"30",children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontFamily:M.mono,fontWeight:700,color:M.red,fontSize:12},children:y.codigo}),o.jsx(Wt,{text:`${j.icon} ${j.name}`,color:j.color})]}),o.jsx("div",{style:{fontSize:10,color:M.txt3,marginTop:2},children:(w=(v=y.destinos[0])==null?void 0:v.cliente)==null?void 0:w.split(" ").slice(0,3).join(" ")})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("div",{style:{fontSize:13,fontWeight:800,color:M.red},children:[g,"h"]}),o.jsx("div",{style:{fontSize:9,color:M.txt3},children:"sin avance"})]}),o.jsx("span",{style:{fontSize:14,color:M.txt3},children:""})]},y.id)})})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:24},children:[o.jsxs("div",{style:{background:M.card,border:`1px solid ${M.border}`,borderRadius:14,padding:"16px 18px"},children:[o.jsx(m,{title:" Documentos Pendientes",sub:"Embarques activos con docs faltantes"}),f.length===0?o.jsxs("div",{style:{textAlign:"center",padding:"28px 0",color:M.txt3,fontSize:13},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),"Sin documentos pendientes en embarques activos."]}):o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:7,maxHeight:220,overflowY:"auto"},children:f.map(y=>{const j=Dr(y.status),b=Math.round((1-y.faltantes/Object.values(Ei).flat().filter(g=>g.req).length)*100);return o.jsxs("div",{onClick:()=>t(y),style:{padding:"9px 12px",borderRadius:9,cursor:"pointer",background:M.surface,border:`1px solid ${M.border}`},onMouseEnter:g=>g.currentTarget.style.borderColor=M.amber+"60",onMouseLeave:g=>g.currentTarget.style.borderColor=M.border,children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:5},children:[o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontFamily:M.mono,fontWeight:700,color:M.amber,fontSize:12},children:y.codigo}),o.jsx(Wt,{text:`${j.icon} ${j.name}`,color:j.color})]}),o.jsx(Wt,{text:` ${y.faltantes} faltan`,color:M.amber})]}),o.jsx("div",{style:{height:4,background:M.border,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${b}%`,height:"100%",background:b>75?M.green:b>40?M.amber:M.red,borderRadius:4}})})]},y.id)})})]}),o.jsxs("div",{style:{background:M.card,border:`1px solid ${M.border}`,borderRadius:14,padding:"16px 18px"},children:[o.jsx(m,{title:" Top Clientes",sub:"Por KG exportados (histrico)"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:p.map((y,j)=>{var v;const b=((v=p[0])==null?void 0:v.kg)||1,g=y.kg/b*100;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsxs("span",{style:{fontSize:13,fontWeight:800,color:j===0?M.amber:M.txt3},children:["#",j+1]}),o.jsx("span",{style:{fontSize:12,color:M.txt1,fontWeight:j===0?700:400},children:y.cliente.split(" ").slice(0,3).join(" ")})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("span",{style:{fontSize:12,fontWeight:700,color:M.teal},children:[y.kg.toFixed(0)," kg"]}),o.jsxs("span",{style:{fontSize:10,color:M.txt3,marginLeft:6},children:[y.embarques," emb."]})]})]}),o.jsx("div",{style:{height:4,background:M.border,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${g}%`,height:"100%",background:j===0?M.amber:M.teal,borderRadius:4}})})]},y.cliente)})})]})]}),o.jsxs("div",{style:{background:M.card,border:`1px solid ${M.border}`,borderRadius:14,padding:"16px 18px"},children:[o.jsx(m,{title:" Actividad Reciente",sub:"ltimos eventos de tracking de todos los embarques"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8},children:d.map(y=>{const j=Dr(y.etapa);return o.jsxs("div",{onClick:()=>{const b=e.find(g=>g.id===y.embarque_id);b&&t(b)},style:{display:"flex",gap:10,alignItems:"flex-start",padding:"9px 12px",borderRadius:8,cursor:"pointer",background:M.surface,border:`1px solid ${M.border}`,transition:"border-color .15s"},onMouseEnter:b=>b.currentTarget.style.borderColor=j.color+"50",onMouseLeave:b=>b.currentTarget.style.borderColor=M.border,children:[o.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:j.color+"20",border:`2px solid ${j.color}50`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,flexShrink:0},children:j.icon}),o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[o.jsx("span",{style:{fontFamily:M.mono,fontSize:11,fontWeight:700,color:j.color},children:y.embarque_codigo}),o.jsx("span",{style:{fontSize:11,fontWeight:600,color:j.color},children:j.name}),y.temp!=null&&o.jsx(Wt,{text:`${y.temp}C`,color:y.temp>4?M.red:y.temp>2?M.amber:M.blue})]}),o.jsx("div",{style:{fontSize:11,color:M.txt2,marginTop:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.notas}),o.jsxs("div",{style:{fontSize:9,color:M.txt3,marginTop:1},children:[y.fecha,"  ",y.usuario]})]})]},y.id)})})]})]})}function Mie({embarque:e,onClose:t,onSaved:r,onRequestApproval:n,catalogoDestinos:a}){const{canExecute:i}=MI(),[s,l]=h.useState(1),[c,u]=h.useState({codigo:e.codigo,fecha_salida:e.fecha_salida,hora_salida:e.hora_salida||"00:30",tracto_marca:e.tracto_marca||"",tracto_placa:e.tracto_placa||"",remolque_marca:e.remolque_marca||"",remolque_placa:e.remolque_placa||"",thermo:e.thermo||"",operador:e.operador||"",caat:e.caat||"",alpha:e.alpha||"",sello:e.sello||"",notas:e.notas||""}),[d,f]=h.useState(e.destinos.length>0?e.destinos.map(T=>({id:T.id,orden:T.orden,cliente:T.cliente,cust_po:T.cust_po||"",warehouse:T.warehouse||"",direccion:T.direccion||"",telefono:T.telefono||"",tax_id:T.tax_id||"",fecha_entrega_est:T.fecha_entrega_est||""})):[{...Hp,id:Kr(),orden:1}]),[p,x]=h.useState(e.pallets.map(T=>({...T}))),[m,y]=h.useState({...DI,id:Kr()}),[j,b]=h.useState(!1),[g,v]=h.useState(!1),w=(T,I)=>{const L=ow[T];return L?(Number(I)*L).toFixed(1):""},C=()=>{if(!m.tag)return;const T=w(m.presentacion,m.cajas);x(I=>[...I,{...m,id:Kr(),cajas:Number(m.cajas),kg_neto:Number(T)||0,kg_bruto:Number(m.kg_bruto)||0,temp_carga:Number(m.temp_carga)||null}]),y(I=>({...I,id:Kr(),tag:"",kg_bruto:"",temp_carga:""}))},k=T=>x(I=>I.filter(L=>L.id!==T)),S=p.reduce((T,I)=>T+I.cajas,0),_=p.reduce((T,I)=>T+(I.kg_neto||0),0).toFixed(1),A=(T,I)=>u(L=>({...L,[T]:I})),E=(T,I,L)=>{const D=[...d];D[T]={...D[T],[I]:L},f(D)},N=(T,I)=>{const L=a.find(O=>O.id===I);if(!L)return;const D=[...d];D[T]={...D[T],cliente:L.nombre,warehouse:L.nombre,direccion:`${L.direccion||""}, ${L.ciudad||""}, ${L.estado||""} ${L.cp||""}`.replace(/^,\s*/,"").trim(),telefono:L.telefono||"",tax_id:L.tax_id||""},f(D)},$=async()=>{if(!c.fecha_salida){alert("Fecha de salida requerida");return}v(!0);try{const{error:T}=await se.from("embarques").update({fecha_salida:c.fecha_salida,hora_salida:c.hora_salida||null,tracto_marca:c.tracto_marca,tracto_placa:c.tracto_placa,remolque_marca:c.remolque_marca,remolque_placa:c.remolque_placa,thermo:c.thermo,operador:c.operador,caat:c.caat,alpha:c.alpha,sello_numero:c.sello,notas:c.notas,updated_at:new Date().toISOString()}).eq("id",e.id);if(T)throw T;if(await se.from("embarque_destinos").delete().eq("embarque_id",e.id),d.length>0){const{error:L}=await se.from("embarque_destinos").insert(d.map((D,O)=>({embarque_id:e.id,orden:O+1,cliente:D.cliente,cust_po:D.cust_po,warehouse_nombre:D.warehouse,direccion:D.direccion,telefono:D.telefono,tax_id:D.tax_id,fecha_entrega_est:D.fecha_entrega_est||null})));if(L)throw L}if(await se.from("embarque_pallets").delete().eq("embarque_id",e.id),p.length>0){const{error:L}=await se.from("embarque_pallets").insert(p.map(D=>({embarque_id:e.id,tag_numero:D.tag,lote:D.lote,variedad:D.variedad,presentacion:D.presentacion,label:D.label,calibre:D.calibre,fecha_cosecha:D.fecha||null,cajas:D.cajas,kg_neto:D.kg_neto||null,kg_bruto:D.kg_bruto||null,temp_carga:D.temp_carga||null})));if(L)throw L}await se.from("embarque_tracking").insert({embarque_id:e.id,etapa_nueva:e.status,notas:`Embarque editado: ${p.length} pallet${p.length!==1?"s":""}.`});const I=await Vp(e.id);I&&r(I)}catch(T){alert("Error al guardar: "+T.message)}finally{v(!1)}},z=()=>{var I;if(i("exportacion.embarque.edit")==="needs_approval"){n&&(n({action_key:"exportacion.embarque.edit",context_id:e.id,context_data:{embarque:e.codigo,destino:((I=d[0])==null?void 0:I.cliente)||"",campos_editados:"Datos del camin y destinos"},title:"Editar embarque",description:`La edicin del embarque ${e.codigo} requiere autorizacin del administrador.`,onApproved:()=>$()}),t());return}$()};return o.jsxs(qo,{title:" Editar Embarque",onClose:t,width:760,children:[o.jsx("div",{style:{display:"flex",gap:0,marginBottom:22,borderRadius:8,overflow:"hidden",border:`1px solid ${M.border}`},children:["1. Datos del Camin","2. Destino(s)","3. Pallets","4. Confirmar"].map((T,I)=>o.jsx("div",{style:{flex:1,padding:"9px 14px",textAlign:"center",background:I+1===s?M.teal+"18":I+1<s?M.teal+"08":M.surface,borderRight:I<3?`1px solid ${M.border}`:"none"},children:o.jsxs("div",{style:{fontSize:10,fontWeight:700,color:I+1<=s?M.teal:M.txt3,textTransform:"uppercase",letterSpacing:1},children:[I+1<s?" ":"",T]})},I))}),s===1&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Cdigo de Embarque",children:o.jsx("div",{style:{...Re.input,background:M.bg,color:M.txt3,cursor:"default",display:"flex",alignItems:"center"},children:c.codigo})}),o.jsx(Ae,{label:"Fecha de Salida *",children:o.jsx(Ie,{type:"date",value:c.fecha_salida,onChange:T=>A("fecha_salida",T)})}),o.jsx(Ae,{label:"Hora de Salida",children:o.jsx(Ie,{type:"time",value:c.hora_salida,onChange:T=>A("hora_salida",T)})}),o.jsx(Ae,{label:"N Sello",children:o.jsx(Ie,{value:c.sello,onChange:T=>A("sello",T),placeholder:"ej: 4421-B"})})]}),o.jsx(Ls,{label:"Tracto"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Marca",children:o.jsx(Ie,{value:c.tracto_marca,onChange:T=>A("tracto_marca",T)})}),o.jsx(Ae,{label:"Placa *",children:o.jsx(Ie,{value:c.tracto_placa,onChange:T=>A("tracto_placa",T)})})]}),o.jsx(Ls,{label:"Remolque / Reefer"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Marca",children:o.jsx(Ie,{value:c.remolque_marca,onChange:T=>A("remolque_marca",T)})}),o.jsx(Ae,{label:"Placa *",children:o.jsx(Ie,{value:c.remolque_placa,onChange:T=>A("remolque_placa",T)})}),o.jsx(Ae,{label:"Thermo N",children:o.jsx(Ie,{value:c.thermo,onChange:T=>A("thermo",T)})})]}),o.jsx(Ls,{label:"Operador"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsx(Ae,{label:"Nombre *",children:o.jsx(Ie,{value:c.operador,onChange:T=>A("operador",T)})}),o.jsx(Ae,{label:"CAAT",children:o.jsx(Ie,{value:c.caat,onChange:T=>A("caat",T)})}),o.jsx(Ae,{label:"Alpha",children:o.jsx(Ie,{value:c.alpha,onChange:T=>A("alpha",T)})})]})]}),s===2&&o.jsxs("div",{children:[d.map((T,I)=>o.jsxs("div",{style:{marginBottom:16,padding:14,background:M.surface,borderRadius:10,border:`1px solid ${M.border}`},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:10},children:[o.jsxs("span",{style:{fontSize:13,fontWeight:700,color:M.teal},children:["Destino ",I+1]}),I>0&&o.jsx("button",{onClick:()=>f(L=>L.filter((D,O)=>O!==I)),style:{background:"none",border:"none",color:M.red,cursor:"pointer"},children:" Quitar"})]}),o.jsx(Ae,{label:"Autocompletar desde catlogo",children:o.jsxs("select",{onChange:L=>N(I,L.target.value),style:{...Re.input,marginBottom:10,appearance:"none"},children:[o.jsx("option",{value:"",children:" Seleccionar warehouse guardado "}),a.map(L=>o.jsxs("option",{value:L.id,children:[L.nombre,"  ",L.ciudad,", ",L.estado]},L.id))]})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx(Ae,{label:"Cliente / Comprador *",children:o.jsx(Ie,{value:T.cliente,onChange:L=>E(I,"cliente",L)})}),o.jsx(Ae,{label:"Warehouse *",children:o.jsx(Ie,{value:T.warehouse,onChange:L=>E(I,"warehouse",L)})}),o.jsx(Ae,{label:"Direccin",children:o.jsx(Ie,{value:T.direccion,onChange:L=>E(I,"direccion",L)})}),o.jsx(Ae,{label:"Telfono",children:o.jsx(Ie,{value:T.telefono,onChange:L=>E(I,"telefono",L)})}),o.jsx(Ae,{label:"Tax ID",children:o.jsx(Ie,{value:T.tax_id,onChange:L=>E(I,"tax_id",L)})}),o.jsx(Ae,{label:"Fecha Entrega Est.",children:o.jsx(Ie,{type:"date",value:T.fecha_entrega_est,onChange:L=>E(I,"fecha_entrega_est",L)})})]})]},T.id||I)),d.length<3&&o.jsxs("button",{onClick:()=>f(T=>[...T,{...Hp,id:Kr(),orden:T.length+1}]),style:{...Re.btn(),width:"100%",textAlign:"center"},children:["+ Agregar Destino (",d.length,"/3)"]})]}),s===3&&o.jsxs("div",{children:[o.jsx("div",{style:{display:"flex",gap:10,marginBottom:14,flexWrap:"wrap"},children:[{l:"Pallets",v:p.length,c:M.purple},{l:"Cajas",v:S,c:M.green},{l:"KG Neto",v:_,c:M.amber}].map(T=>o.jsxs("div",{style:{flex:1,minWidth:80,background:T.c+"0c",border:`1px solid ${T.c}25`,borderRadius:8,padding:"6px 12px"},children:[o.jsx("div",{style:{fontSize:9,color:M.txt3,textTransform:"uppercase",letterSpacing:1},children:T.l}),o.jsx("div",{style:{fontSize:15,fontWeight:800,color:T.c,fontFamily:M.mono},children:T.v})]},T.l))}),o.jsxs("div",{style:{background:M.surface,borderRadius:10,padding:12,marginBottom:12,border:`1px solid ${M.border}`},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:M.txt1,marginBottom:10},children:"+ Agregar Pallet"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8},children:[o.jsx(Ae,{label:"N TAG *",children:o.jsx(Ie,{value:m.tag,onChange:T=>y({...m,tag:T}),placeholder:"323"})}),o.jsx(Ae,{label:"Lote *",children:o.jsx(Ie,{value:m.lote,onChange:T=>y({...m,lote:T}),placeholder:"AM26004RB"})}),o.jsx(Ae,{label:"Presentacin",children:o.jsx(Hn,{value:m.presentacion,onChange:T=>{const I=w(T,m.cajas);y({...m,presentacion:T,kg_neto:I})},options:nw})}),o.jsx(Ae,{label:"Label",children:o.jsx(Hn,{value:m.label,onChange:T=>y({...m,label:T}),options:rw})}),o.jsx(Ae,{label:"Calibre",children:o.jsx(Hn,{value:m.calibre,onChange:T=>y({...m,calibre:T}),options:tw})}),o.jsx(Ae,{label:"Fecha",children:o.jsx(Ie,{type:"date",value:m.fecha,onChange:T=>y({...m,fecha:T})})}),o.jsx(Ae,{label:"Cajas/Pallet",children:o.jsx(Ie,{type:"number",value:m.cajas,onChange:T=>{const I=w(m.presentacion,T);y({...m,cajas:T,kg_neto:I})}})}),o.jsx(Ae,{label:"KG Neto (auto)",children:o.jsx("div",{style:{...Re.input,background:M.bg,color:M.amber,fontWeight:700,cursor:"default",display:"flex",alignItems:"center"},children:m.kg_neto||w(m.presentacion,m.cajas)||""})})]}),o.jsx("button",{onClick:C,style:{...Re.btn(M.teal),marginTop:6,fontSize:11},children:"+ Agregar a la lista"})]}),p.length>0&&o.jsx("div",{style:{overflowX:"auto",borderRadius:8,border:`1px solid ${M.border}`},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[o.jsx("thead",{children:o.jsx("tr",{style:{background:M.surface},children:["TAG","Lote","Present.","Label","Calibre","Fecha","Cajas","KG",""].map(T=>o.jsx("th",{style:{padding:"6px 10px",textAlign:"left",color:M.txt3,fontWeight:700,fontSize:9,textTransform:"uppercase",borderBottom:`1px solid ${M.border}`},children:T},T))})}),o.jsx("tbody",{children:p.map(T=>o.jsxs("tr",{style:{borderBottom:`1px solid ${M.border}30`},children:[o.jsx("td",{style:{padding:"6px 10px",fontFamily:M.mono,color:M.teal,fontWeight:700},children:T.tag}),o.jsx("td",{style:{padding:"6px 10px",fontFamily:M.mono,color:M.purple},children:T.lote}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt1},children:T.presentacion}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt2},children:T.label}),o.jsx("td",{style:{padding:"6px 10px",color:M.green},children:T.calibre}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt2},children:T.fecha||""}),o.jsx("td",{style:{padding:"6px 10px",color:M.txt1,textAlign:"right"},children:T.cajas}),o.jsx("td",{style:{padding:"6px 10px",color:M.amber,textAlign:"right"},children:T.kg_neto}),o.jsx("td",{style:{padding:"6px 10px"},children:o.jsx("button",{onClick:()=>k(T.id),style:{background:"none",border:"none",color:M.red,cursor:"pointer",fontSize:14},children:""})})]},T.id))})]})}),p.length===0&&o.jsx("div",{style:{textAlign:"center",padding:"24px",color:M.txt3,fontSize:12,border:`1px dashed ${M.border}`,borderRadius:8},children:"Sin pallets  agrega al menos uno antes de continuar"})]}),s===4&&o.jsxs("div",{children:[o.jsxs("div",{style:{background:M.surface,borderRadius:10,padding:16,border:`1px solid ${M.border}`,marginBottom:12},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:M.txt3,textTransform:"uppercase",letterSpacing:1,marginBottom:10},children:"Resumen de cambios"}),[{l:"Embarque",v:c.codigo},{l:"Fecha salida",v:c.fecha_salida},{l:"Hora",v:c.hora_salida},{l:"Tracto placa",v:c.tracto_placa},{l:"Remolque placa",v:c.remolque_placa},{l:"Thermo",v:c.thermo},{l:"Operador",v:c.operador},{l:"Sello",v:c.sello}].map(T=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${M.border}30`,padding:"5px 0",fontSize:12},children:[o.jsx("span",{style:{color:M.txt3},children:T.l}),o.jsx("span",{style:{color:M.txt1,fontWeight:600},children:T.v||""})]},T.l)),d.map((T,I)=>o.jsx("div",{style:{marginTop:10},children:o.jsxs("div",{style:{fontSize:11,color:M.teal,fontWeight:700,marginBottom:4},children:["Destino ",I+1,": ",T.cliente||""]})},I))]}),o.jsx("div",{style:{background:M.amber+"10",border:`1px solid ${M.amber}30`,borderRadius:10,padding:12},children:o.jsx("p",{style:{margin:0,fontSize:12,color:M.amber},children:" La edicin del embarque requiere autorizacin del administrador. Se enviar una solicitud al admin y los cambios se aplicarn una vez aprobada."})})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:20,borderTop:`1px solid ${M.border}`,paddingTop:16},children:[o.jsx("button",{onClick:s===1?t:()=>l(T=>T-1),style:Re.btn(M.txt3),children:s===1?"Cancelar":" Atrs"}),s<4?o.jsx("button",{onClick:()=>l(T=>T+1),style:Re.btnPrimary,children:"Siguiente "}):o.jsx("button",{onClick:z,disabled:g,style:{...Re.btnPrimary,background:M.amber,color:"#1a0f00",opacity:g?.5:1},children:g?"Guardando":" Solicitar edicin"})]})]})}function Oie(){const{canView:e,canExecute:t}=MI(),[r,n]=h.useState("dashboard"),[a,i]=h.useState([]),[s,l]=h.useState(!0),[c,u]=h.useState(null),[d,f]=h.useState(!1),[p,x]=h.useState(!1),[m,y]=h.useState(cie),[j,b]=h.useState(die),[g,v]=h.useState(null),w=h.useCallback(async(D=!1)=>{D||l(!0);try{const{data:O}=await se.from("embarques").select("*, destinos:embarque_destinos(*), pallets:embarque_pallets(*), documentos:embarque_documentos(*), correos:embarque_correos(*), tracking:embarque_tracking(*)").order("created_at",{ascending:!1});O&&i(O.map(LI));const{data:F}=await se.from("catalogos_destino").select("*").eq("activo",!0).order("nombre");F&&F.length>0&&y(F.map(te=>({id:te.id,nombre:te.nombre,direccion:te.direccion||"",ciudad:te.ciudad||"",estado:te.estado||"",cp:te.codigo_postal||"",telefono:te.telefono||"",tax_id:te.tax_id||"",email:te.email||""})));const{data:q}=await se.from("contactos_exportacion").select("*").eq("activo",!0).order("nombre");q&&q.length>0&&b(q.map(te=>({id:te.id,nombre:te.nombre,empresa:te.empresa||"",rol:te.rol,email:te.email,es_fijo:te.es_fijo,activo:te.activo})))}catch(O){console.error("Error loading data:",O)}finally{D||l(!1)}},[]);h.useEffect(()=>{w()},[w]),h.useEffect(()=>{const D=se.channel("embarques_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"embarques"},async O=>{const F=await Vp(O.new.id);F&&i(q=>q.find(te=>te.id===F.id)?q:[F,...q])}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"embarques"},async O=>{const F=await Vp(O.new.id);F&&(i(q=>q.map(te=>te.id===F.id?F:te)),u(q=>(q==null?void 0:q.id)===F.id?F:q))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"embarques"},O=>{i(F=>F.filter(q=>q.id!==O.old.id)),u(F=>(F==null?void 0:F.id)===O.old.id?null:F)}).subscribe();return()=>{se.removeChannel(D)}},[]);const C=D=>{i(O=>O.map(F=>F.id===D.id?D:F)),(c==null?void 0:c.id)===D.id&&u(D)},k=D=>i(O=>O.find(F=>F.id===D.id)?O:[D,...O]),S=D=>{u(D),n("detalle")},[_,A]=h.useState(!1),E=async()=>{A(!0),await w(!0),A(!1)},N=async D=>{const O=D.length<m.length,F=D.length===m.length;if((O||F)&&t("exportacion.catalogos.edit")==="needs_approval"){v({action_key:"exportacion.catalogos.edit",context_data:{tipo:O?"Eliminar destino":"Editar destino"},title:O?"Eliminar destino del catlogo":"Editar destino del catlogo",description:"Los cambios en catlogos de exportacin requieren autorizacin del administrador.",onApproved:()=>$(D)});return}await $(D)},$=async D=>{if(D.length===m.length){const O=D.find(F=>{const q=m.find(te=>te.id===F.id);return q&&JSON.stringify(q)!==JSON.stringify(F)});O&&await se.from("catalogos_destino").update({nombre:O.nombre,direccion:O.direccion,ciudad:O.ciudad,estado:O.estado,codigo_postal:O.cp,telefono:O.telefono,tax_id:O.tax_id,email:O.email}).eq("id",O.id)}else if(D.length>m.length){const O=D.find(F=>!m.find(q=>q.id===F.id));if(O){const{data:F}=await se.from("catalogos_destino").insert({nombre:O.nombre,direccion:O.direccion,ciudad:O.ciudad,estado:O.estado,codigo_postal:O.cp,telefono:O.telefono,tax_id:O.tax_id,email:O.email}).select().single();F&&(D=D.map(q=>q.id===O.id?{...q,id:F.id}:q))}}else{const O=m.find(F=>!D.find(q=>q.id===F.id));O&&await se.from("catalogos_destino").delete().eq("id",O.id)}y(D)},z=async D=>{const O=D.length<j.length,F=D.length===j.length;if((O||F)&&t("exportacion.catalogos.edit")==="needs_approval"){v({action_key:"exportacion.catalogos.edit",context_data:{tipo:O?"Eliminar contacto":"Editar contacto"},title:O?"Eliminar contacto del catlogo":"Editar contacto del catlogo",description:"Los cambios en catlogos de exportacin requieren autorizacin del administrador.",onApproved:()=>T(D)});return}await T(D)},T=async D=>{if(D.length===j.length){const O=D.find(F=>{const q=j.find(te=>te.id===F.id);return q&&JSON.stringify(q)!==JSON.stringify(F)});O&&await se.from("contactos_exportacion").update({nombre:O.nombre,empresa:O.empresa,rol:O.rol,email:O.email,es_fijo:O.es_fijo}).eq("id",O.id)}else if(D.length>j.length){const O=D.find(F=>!j.find(q=>q.id===F.id));if(O){const{data:F}=await se.from("contactos_exportacion").insert({nombre:O.nombre,empresa:O.empresa,rol:O.rol,email:O.email,es_fijo:O.es_fijo}).select().single();F&&(D=D.map(q=>q.id===O.id?{...q,id:F.id}:q))}}else{const O=j.find(F=>!D.find(q=>q.id===F.id));O&&await se.from("contactos_exportacion").delete().eq("id",O.id)}b(D)},I=[{id:"dashboard",icon:"",label:"Dashboard",navKey:"exportacion.dashboard"},{id:"kanban",icon:"",label:"Pipeline",navKey:"exportacion.pipeline"},{id:"catalogos",icon:"",label:"Catlogos",navKey:"exportacion.catalogos"}].filter(D=>e(D.navKey)),L={dashboard:"Dashboard",kanban:"Pipeline",detalle:(c==null?void 0:c.codigo)||"Embarque",catalogos:"Catlogos"};return s?o.jsxs("div",{style:{display:"flex",height:"100vh",background:M.bg,alignItems:"center",justifyContent:"center",flexDirection:"column",gap:16},children:[o.jsx("div",{style:{fontSize:40},children:""}),o.jsx("div",{style:{width:40,height:40,border:`3px solid ${M.border}`,borderTopColor:M.teal,borderRadius:"50%",animation:"spin .8s linear infinite"}}),o.jsx("div",{style:{fontSize:13,color:M.txt3},children:"Cargando embarques"})]}):o.jsxs("div",{style:{display:"flex",height:"100vh",background:M.bg,color:M.txt1,fontFamily:"'Segoe UI','IBM Plex Sans',system-ui,sans-serif",overflow:"hidden"},children:[o.jsx("style",{children:hie}),o.jsxs("div",{style:{width:64,background:M.surface,borderRight:`1px solid ${M.border}`,display:"flex",flexDirection:"column",alignItems:"center",padding:"12px 0",gap:4,flexShrink:0},children:[o.jsx("div",{style:{width:40,height:40,borderRadius:12,background:M.teal+"20",border:`2px solid ${M.teal}40`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,marginBottom:12},children:""}),I.map(D=>o.jsx("button",{onClick:()=>n(D.id),title:D.label,style:{width:44,height:44,borderRadius:10,background:r===D.id?M.teal+"20":"transparent",border:`1px solid ${r===D.id?M.teal+"50":"transparent"}`,color:r===D.id?M.teal:M.txt3,cursor:"pointer",fontSize:20,display:"flex",alignItems:"center",justifyContent:"center",transition:"all .15s"},children:D.icon},D.id)),o.jsx("div",{style:{width:32,height:1,background:M.border,margin:"8px 0"}}),o.jsx("button",{onClick:()=>f(!0),title:"Nuevo Embarque",style:{width:44,height:44,borderRadius:10,background:"transparent",border:"1px solid transparent",color:M.txt3,cursor:"pointer",fontSize:20,display:"flex",alignItems:"center",justifyContent:"center",transition:"all .15s"},onMouseEnter:D=>{D.currentTarget.style.background=M.green+"15",D.currentTarget.style.color=M.green},onMouseLeave:D=>{D.currentTarget.style.background="transparent",D.currentTarget.style.color=M.txt3},children:""})]}),o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"7px 16px",borderBottom:`1px solid ${M.border}`,fontSize:11,color:M.txt3,display:"flex",alignItems:"center",gap:6,flexShrink:0,background:M.surface},children:[o.jsx("span",{children:" Operacin"}),o.jsx("span",{children:""}),o.jsx("span",{style:{color:M.teal},children:"Exportacin"}),r!=="kanban"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{style:{color:M.txt2},children:L[r]||r})]}),r==="detalle"&&c&&o.jsx("button",{onClick:()=>x(!0),style:{...Re.btn(M.blue),marginLeft:"auto",padding:"4px 12px",fontSize:10},children:" Packing List"})]}),o.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[r==="dashboard"&&e("exportacion.dashboard")&&o.jsx(Pie,{embarques:a,onSelectEmbarque:D=>{u(D),n("detalle")}}),r==="kanban"&&e("exportacion.pipeline")&&o.jsx(kie,{embarques:a,onSelect:S,onNuevo:()=>f(!0),onRefresh:E,refreshing:_}),r==="detalle"&&c&&e("exportacion.pipeline")&&o.jsx(Sie,{embarque:c,onBack:()=>n("kanban"),onUpdate:C,contactos:j,onRequestApproval:v,catalogoDestinos:m}),r==="catalogos"&&e("exportacion.catalogos")&&o.jsx(Eie,{destinos:m,contactos:j,onUpdateDestinos:N,onUpdateContactos:z}),!e("exportacion."+r)&&r!=="detalle"&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:12,color:M.txt3},children:[o.jsx("span",{style:{fontSize:36},children:""}),o.jsx("span",{style:{fontSize:13},children:"Sin acceso a esta seccin"})]})]})]}),d&&o.jsx(_ie,{onClose:()=>f(!1),onCreate:k,catalogoDestinos:m}),p&&c&&o.jsx(Nie,{embarque:c,onClose:()=>x(!1)}),g&&o.jsx(sie,{action_key:g.action_key,context_id:g.context_id,context_data:g.context_data,title:g.title,description:g.description,onClose:()=>v(null),onApproved:()=>{var D;v(null),(D=g.onApproved)==null||D.call(g)},onRequested:()=>v(null)})]})}const P={bg:"#0b0b12",surface:"#13131f",card:"#1a1a2a",input:"#20202e",inputBorder:"#2e2e44",border:"#252535",text:"#eeeef5",textSecondary:"#8888a8",textMuted:"#55556a",accent:"#4f6bf6",accentLight:"#7b91f8",accentDim:"rgba(79,107,246,0.14)",green:"#34d399",greenDim:"rgba(52,211,153,0.12)",greenBorder:"rgba(52,211,153,0.25)",yellow:"#fbbf24",yellowDim:"rgba(251,191,36,0.12)",yellowBorder:"rgba(251,191,36,0.25)",red:"#f87171",redDim:"rgba(248,113,113,0.12)",redBorder:"rgba(248,113,113,0.25)",orange:"#fb923c",orangeDim:"rgba(251,146,60,0.12)",orangeBorder:"rgba(251,146,60,0.25)",purple:"#c084fc",purpleDim:"rgba(192,132,252,0.12)"},Au={"12x18":6.3,"8x18":4.2,Jumbo:3.45,"6oz":1.77,PNT:3.25,"12x18oz":6.3,"8x18oz":4.2,JMB:3.45},II=Object.keys(Au),Tie=["TwinRiver","RiverRun","Hortifrut","BerryLovers"],Lie={comision_pct:10,warehousing:.28,quality_control:.15,fees_importacion:.6,materiales:3,agente_aduanal_us:.016,agente_aduanal_mx:.0016,material_palletizado:.006,servicio_frio:.214,servicio_flete:.049},Ks=["Nmina Cosecha","Nmina Empaque","Insumos Campo","Materiales Empaque","Logstica / Exportacin","Overhead"],Die={"Nmina Cosecha":["Personal Permanente","Personal Eventual","Prestaciones","Bonos / Incentivos"],"Nmina Empaque":["Personal Planta","Personal Eventual","Horas Extra","Prestaciones"],"Insumos Campo":["Fertilizantes","Agroqumicos","Agua / Riego","Material Vivero","Otros"],"Materiales Empaque":["Cajas / Envases","Bolsas / Film","Etiquetas","Pallets","Consumibles"],"Logstica / Exportacin":["Flete Nacional","Flete Internacional","Maniobras","Seguros","Aduanas / Gestin"],Overhead:["Renta / Instalaciones","Servicios Bsicos","Mantenimiento","Administrativo","Otros"]},Eu={"Nmina Cosecha":"#34d399","Nmina Empaque":"#4f6bf6","Insumos Campo":"#fbbf24","Materiales Empaque":"#fb923c","Logstica / Exportacin":"#c084fc",Overhead:"#f87171"},$I=h.createContext({semanasPrecio:[],cuadres:[],gastosOp:[],configMap:{},loading:!1,reload:()=>{},tipoCambio:17.5,diasCredito:21});function so(){return h.useContext($I)}function Iie({children:e}){const[t,r]=h.useState([]),[n,a]=h.useState([]),[i,s]=h.useState([]),[l,c]=h.useState({}),[u,d]=h.useState(!1),f=h.useCallback(async()=>{d(!0);try{const[{data:p},{data:x},{data:m},{data:y}]=await Promise.all([se.from("finanzas_semana_precio").select("*").order("year",{ascending:!1}).order("semana",{ascending:!1}).limit(200),se.from("cuadre_diario").select("*").order("fecha",{ascending:!1}).limit(100),se.from("gastos_operativos").select("*").order("fecha",{ascending:!1}).limit(500),se.from("finanzas_config").select("clave,valor")]);p&&r(p),x&&a(x),m&&s(m),y&&c(Object.fromEntries(y.map(j=>[j.clave,j.valor])))}catch{}d(!1)},[]);return h.useEffect(()=>{f()},[f]),o.jsx($I.Provider,{value:{semanasPrecio:t,cuadres:n,gastosOp:i,configMap:l,loading:u,reload:f,tipoCambio:parseFloat(l.tipo_cambio_mxn??"17.5"),diasCredito:parseInt(l.dias_credito??"21")},children:e})}function Ra(){return new Date().toLocaleDateString("en-CA",{timeZone:"America/Mexico_City"})}function Nu(){return parseInt(Ra().slice(0,4))}function Ko(e){const t=new Date(e+"T12:00:00"),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));const n=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-n.getTime())/864e5+1)/7)}function lw(e){const t=new Date(e+"T12:00:00"),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));return r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7)),r.getUTCFullYear()}function $ie(e,t){const r=new Date(e+"T12:00:00");return r.setDate(r.getDate()+t),r.toLocaleDateString("en-CA")}function Cd(e,t){return Math.round((new Date(t+"T12:00:00").getTime()-new Date(e+"T12:00:00").getTime())/864e5)}function jr(e){return e.toFixed(2)}function ze(e){return`$${e.toFixed(2)}`}function pr(e){return e>=1e3?`$${(e/1e3).toFixed(1)}k`:ze(e)}function Ga(e){return Math.abs(e)<=2?P.green:Math.abs(e)<=5?P.yellow:P.red}function RI(e,t,r){const n=new Date(t,0,4),a=n.getDay()||7,i=new Date(n.getTime()-(a-1)*864e5),s=new Date(i.getTime()+(e-1)*7*864e5);return $ie(s.toLocaleDateString("en-CA"),r)}const Io={precio_recibido:{label:"Precio recibido",color:P.accentLight,bg:P.accentDim,border:"rgba(123,145,248,0.25)",emoji:""},en_transito:{label:"En trnsito",color:P.yellow,bg:P.yellowDim,border:P.yellowBorder,emoji:""},pendiente_liquidacion:{label:"Pend. liquidacin",color:P.orange,bg:P.orangeDim,border:P.orangeBorder,emoji:""},anticipado:{label:"Anticipo recibido",color:P.purple,bg:P.purpleDim,border:"rgba(192,132,252,0.25)",emoji:""},liquidado:{label:"Liquidado",color:P.green,bg:P.greenDim,border:P.greenBorder,emoji:""}},tt=({children:e,style:t={}})=>o.jsx("div",{style:{background:P.card,border:`1px solid ${P.border}`,borderRadius:14,padding:"20px 22px",...t},children:e}),At=({label:e,value:t,sub:r,color:n=P.accent,emoji:a})=>o.jsxs(tt,{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.6,marginBottom:8},children:[a&&o.jsx("span",{style:{marginRight:5},children:a}),e]}),o.jsx("div",{style:{fontSize:24,fontWeight:800,color:n,fontFamily:"'DM Mono', monospace"},children:t}),r&&o.jsx("div",{style:{fontSize:12,color:P.textMuted,marginTop:4},children:r})]}),ft=({label:e,value:t,onChange:r,type:n="number",placeholder:a="0",step:i="0.01",readOnly:s=!1,note:l=""})=>o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,color:P.textSecondary,marginBottom:4},children:e}),l&&o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginBottom:3},children:l}),o.jsx("input",{type:n,value:t,onChange:r,step:i,placeholder:a,readOnly:s,style:{width:"100%",padding:"9px 12px",borderRadius:9,outline:"none",background:s?P.surface:P.input,border:`1.5px solid ${s?P.border:P.inputBorder}`,color:s?P.textSecondary:P.text,fontSize:13,fontFamily:s?"'DM Mono', monospace":"inherit",boxSizing:"border-box"}})]}),va=({label:e,value:t,onChange:r,options:n})=>o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,color:P.textSecondary,marginBottom:4},children:e}),o.jsx("select",{value:t,onChange:r,style:{width:"100%",padding:"9px 12px",borderRadius:9,outline:"none",background:P.input,border:`1.5px solid ${P.inputBorder}`,color:P.text,fontSize:13},children:n.map(a=>o.jsx("option",{value:a.value,children:a.label},a.value))})]}),Zn=({children:e,onClick:t,variant:r="primary",disabled:n=!1})=>{const a=r==="primary"?P.accent:r==="success"?"#059669":r==="danger"?"#dc2626":P.surface;return o.jsx("button",{onClick:t,disabled:n,style:{padding:"9px 18px",borderRadius:9,border:`1.5px solid ${n?P.border:a}`,background:n?P.surface:a,color:n?P.textMuted:"#fff",fontSize:13,fontWeight:600,cursor:n?"not-allowed":"pointer",opacity:n?.6:1},children:e})},kg=({text:e,color:t,bg:r,border:n})=>o.jsx("span",{style:{padding:"3px 9px",borderRadius:20,background:r,color:t,border:`1px solid ${n}`,fontSize:11,fontWeight:700,whiteSpace:"nowrap"},children:e}),Cg=({tabs:e,active:t,onSelect:r})=>o.jsx("div",{style:{display:"flex",gap:4,background:P.surface,padding:"5px",borderRadius:12,border:`1px solid ${P.border}`,marginBottom:24,flexWrap:"wrap"},children:e.map(n=>o.jsxs("button",{onClick:()=>r(n.key),style:{padding:"7px 16px",borderRadius:9,fontSize:13,fontWeight:600,cursor:"pointer",border:"none",background:t===n.key?P.accent:"transparent",color:t===n.key?"#fff":P.textSecondary},children:[n.emoji," ",n.label]},n.key))}),Pu=({value:e,max:t,color:r})=>o.jsx("div",{style:{flex:1,height:7,background:P.surface,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${Math.max(2,e/Math.max(t,1)*100)}%`,height:"100%",background:r,borderRadius:4,transition:"width .4s"}})});function Rie(){const{semanasPrecio:e,reload:t}=so(),[r,n]=h.useState(Ra()),[a,i]=h.useState([]),[s,l]=h.useState([]),[c,u]=h.useState([]),[d,f]=h.useState(!1),[p,x]=h.useState(""),[m,y]=h.useState(!1),j=h.useMemo(()=>Ko(r),[r]),b=h.useMemo(()=>lw(r),[r]),g=h.useMemo(()=>e.find(O=>O.semana===j&&O.year===b),[e,j,b]),v=h.useCallback(async()=>{f(!0);const[{data:O},{data:F},{data:q}]=await Promise.all([se.from("cosecha_corte_dia").select("*").eq("fecha",r),se.from("Muestreos Empaque").select("*").eq("Fecha",r),se.from("Calidad Empaque").select("kg_merma_total,FechaHora").eq("tipo","merma").gte("FechaHora",r+"T00:00:00").lte("FechaHora",r+"T23:59:59")]);i(O||[]),l(F||[]),u(q||[]),f(!1)},[r]);h.useEffect(()=>{v()},[v]);const w=h.useMemo(()=>a.reduce((O,F)=>O+(Number(F.kg_cosechados)||0),0),[a]),C=h.useMemo(()=>a.reduce((O,F)=>O+(Number(F.cubetas_cosechadas)||0),0),[a]),k=h.useMemo(()=>s.reduce((O,F)=>O+(Number(F.Cantidad_cajas)||0)*(Au[F.Tipo_embalaje]??0),0),[s]),S=h.useMemo(()=>s.reduce((O,F)=>O+(Number(F.Cantidad_cajas)||0),0),[s]),_=h.useMemo(()=>c.reduce((O,F)=>O+(Number(F.kg_merma_total)||0),0),[c]),A=h.useMemo(()=>{const O={};return s.forEach(F=>{const q=F.Tipo_embalaje??"Sin tipo",te=Number(F.Cantidad_cajas)||0,H=Au[q],B=H===void 0,K=te*(H??0);O[q]||(O[q]={cajas:0,kgCaja:H??0,kgTotal:0,sinFactor:B}),O[q].cajas+=te,O[q].kgTotal+=K}),Object.entries(O).map(([F,q])=>({tipo:F,...q})).sort((F,q)=>q.kgTotal-F.kgTotal)},[s]),E=k+_,N=w-E,$=w>0?E/w:1,z=w>0?N/w*100:0,T=Math.abs(z)<=2?{t:"OK",e:""}:Math.abs(z)<=5?{t:"Alerta",e:""}:{t:"Crtico",e:""},I=h.useMemo(()=>{const O={};return a.forEach(F=>{O[F.sector]||(O[F.sector]={kg:0,cub:0}),O[F.sector].kg+=Number(F.kg_cosechados)||0,O[F.sector].cub+=Number(F.cubetas_cosechadas)||0}),Object.entries(O).map(([F,q])=>({sector:F,kgBruto:q.kg,kgAjustado:q.kg*$,cubetas:q.cub})).sort((F,q)=>q.kgBruto-F.kgBruto)},[a,$]),L=async()=>{if(w===0&&k===0){oe.error("Sin datos para esta fecha");return}y(!0);try{const O=Math.abs(z)<=2?"ok":Math.abs(z)<=5?"alerta":"critico",{error:F}=await se.from("cuadre_diario").upsert({fecha:r,semana_iso:j,year_iso:b,kg_cosechados:w,cubetas_totales:C,kg_empacados:k,cajas_totales:S,kg_merma:_,diferencia:N,factor_ajuste:$,status:O,notas:p||null},{onConflict:"fecha"});if(F)throw F;oe.success("Cuadre cerrado "),t()}catch(O){oe.error(O.message)}y(!1)},D=w>0||k>0;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:16,marginBottom:20,flexWrap:"wrap"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5,marginBottom:5},children:"Fecha"}),o.jsx("input",{type:"date",value:r,onChange:O=>n(O.target.value),style:{padding:"9px 14px",borderRadius:9,background:P.input,border:`1.5px solid ${P.inputBorder}`,color:P.text,fontSize:13}})]}),o.jsxs("div",{style:{padding:"9px 14px",background:P.surface,borderRadius:9,border:`1px solid ${P.border}`,fontSize:13,color:P.textSecondary},children:[" Semana ",o.jsx("strong",{style:{color:P.accentLight},children:j}),"  ",b]}),o.jsx(Zn,{onClick:v,disabled:d,children:d?"Cargando":" Actualizar"}),D&&o.jsx(Zn,{onClick:L,disabled:m,variant:"success",children:m?"Guardando":" Cerrar Cuadre"})]}),g&&o.jsxs("div",{style:{marginBottom:16,padding:"11px 16px",background:P.accentDim,borderRadius:10,border:`1px solid ${P.accentLight}33`,display:"flex",alignItems:"center",gap:10},children:[o.jsx("span",{children:""}),o.jsxs("span",{style:{fontSize:13,color:P.accentLight},children:["Sem. ",j," tiene precio: ",o.jsxs("strong",{children:[g.cliente,"  ",g.presentacion]})," "," $",g.precio_estimado_min,"$",g.precio_estimado_max," USD/caja"," ",o.jsx(kg,{text:Io[g.status].emoji+" "+Io[g.status].label,color:Io[g.status].color,bg:Io[g.status].bg,border:Io[g.status].border})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(190px, 1fr))",gap:14,marginBottom:20},children:[o.jsx(At,{emoji:"",label:"Cosechado",value:`${jr(w)} kg`,sub:`${C} cubetas`,color:P.green}),o.jsx(At,{emoji:"",label:"Empacado",value:`${jr(k)} kg`,sub:`${S} cajas`,color:P.accentLight}),o.jsx(At,{emoji:"",label:"Merma",value:`${jr(_)} kg`,sub:`${c.length} registros`,color:P.orange}),o.jsx(At,{emoji:"",label:"Diferencia",value:`${N>=0?"+":""}${jr(N)} kg`,sub:`${jr(Math.abs(z))}%  ${T.e} ${T.t}`,color:Ga(z)})]}),D&&o.jsxs(tt,{style:{marginBottom:20,border:`1.5px solid ${Ga(z)}44`},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:24,flexWrap:"wrap"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"Factor Ajuste"}),o.jsx("div",{style:{fontSize:32,fontWeight:900,color:P.text,fontFamily:"'DM Mono', monospace",marginTop:4},children:$.toFixed(4)}),o.jsx("div",{style:{fontSize:12,color:P.textMuted},children:"kg real / kg cosechado"})]}),o.jsx("div",{style:{width:1,height:60,background:P.border}}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5},children:"Kg Real"}),o.jsxs("div",{style:{fontSize:22,fontWeight:700,color:P.text,fontFamily:"'DM Mono', monospace",marginTop:4},children:[jr(E)," kg"]}),o.jsxs("div",{style:{fontSize:12,color:P.textMuted},children:[jr(k)," emp + ",jr(_)," merma"]})]}),o.jsx("div",{style:{marginLeft:"auto"},children:o.jsxs("div",{style:{padding:"14px 20px",borderRadius:12,background:Ga(z)+"22",border:`1.5px solid ${Ga(z)}44`,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:26},children:T.e}),o.jsx("div",{style:{fontSize:15,fontWeight:700,color:Ga(z)},children:T.t})]})})]}),Math.abs(z)>2&&o.jsx("div",{style:{marginTop:14,padding:"10px 14px",borderRadius:8,background:Ga(z)+"18",fontSize:13,color:Ga(z)},children:Math.abs(z)>10?" Diferencia crtica (>10%)  revisar antes de cerrar":"  Diferencia 210%  verificar merma de campo o empaque"})]}),A.length>0&&o.jsxs(tt,{style:{marginBottom:20,border:`1px solid ${P.accentLight}33`},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text},children:" Desglose de Empacado  Cmo se calculan los kg"}),o.jsxs("div",{style:{fontSize:13,fontFamily:"'DM Mono', monospace",color:P.green,fontWeight:700},children:["= ",jr(k)," kg total"]})]}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Presentacin","Cajas","","kg / caja","=","kg total","%"].map(O=>o.jsx("th",{style:{textAlign:O===""||O==="="?"center":"left",padding:"7px 12px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.4},children:O},O))})}),o.jsx("tbody",{children:A.map(O=>{const F=k>0?O.kgTotal/k*100:0;return o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`,background:O.sinFactor?P.redDim:"transparent"},children:[o.jsxs("td",{style:{padding:"10px 12px",fontWeight:700,color:O.sinFactor?P.red:P.accentLight},children:[O.tipo,O.sinFactor&&o.jsx("span",{style:{fontSize:10,color:P.red,marginLeft:6},children:" sin factor"})]}),o.jsx("td",{style:{padding:"10px 12px",fontFamily:"'DM Mono', monospace",fontSize:14,fontWeight:700,color:P.text},children:O.cajas}),o.jsx("td",{style:{padding:"10px 12px",textAlign:"center",color:P.textMuted},children:""}),o.jsx("td",{style:{padding:"10px 12px",fontFamily:"'DM Mono', monospace",fontSize:14,color:O.sinFactor?P.red:P.yellow,fontWeight:600},children:O.sinFactor?"":`${O.kgCaja.toFixed(2)} kg`}),o.jsx("td",{style:{padding:"10px 12px",textAlign:"center",color:P.textMuted},children:"="}),o.jsx("td",{style:{padding:"10px 12px",fontFamily:"'DM Mono', monospace",fontSize:15,fontWeight:800,color:O.sinFactor?P.red:P.green},children:O.sinFactor?"0.00 kg ":`${jr(O.kgTotal)} kg`}),o.jsx("td",{style:{padding:"10px 12px"},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{flex:1,minWidth:60,height:6,background:P.surface,borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{width:`${F}%`,height:"100%",background:P.accentLight,borderRadius:3}})}),o.jsxs("span",{style:{fontSize:11,color:P.textMuted,minWidth:32,textAlign:"right"},children:[F.toFixed(0),"%"]})]})})]},O.tipo)})}),o.jsx("tfoot",{children:o.jsxs("tr",{style:{borderTop:`2px solid ${P.border}`,background:P.surface},children:[o.jsx("td",{style:{padding:"10px 12px",fontWeight:700,color:P.textSecondary},children:"TOTAL"}),o.jsxs("td",{style:{padding:"10px 12px",fontFamily:"'DM Mono', monospace",fontWeight:700},children:[S," cajas"]}),o.jsx("td",{}),o.jsx("td",{}),o.jsx("td",{}),o.jsxs("td",{style:{padding:"10px 12px",fontFamily:"'DM Mono', monospace",fontSize:16,fontWeight:900,color:P.green},children:[jr(k)," kg"]}),o.jsx("td",{})]})})]})}),A.some(O=>O.sinFactor)&&o.jsxs("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:8,background:P.redDim,border:`1px solid ${P.redBorder}`,fontSize:13,color:P.red},children:[" Hay presentaciones sin factor de peso  agregar su clave a ",o.jsx("code",{children:"KG_POR_PRESENTACION"})," para que se calculen correctamente."]})]}),I.length>0&&o.jsxs(tt,{style:{marginBottom:20},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:14},children:" Distribucin por Sector"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Sector","Cubetas","Kg Bruto","Factor","Kg Ajustado"," kg"].map(O=>o.jsx("th",{style:{textAlign:"left",padding:"7px 11px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase"},children:O},O))})}),o.jsxs("tbody",{children:[I.map(O=>o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`},children:[o.jsx("td",{style:{padding:"9px 11px",fontWeight:700,color:P.accentLight},children:O.sector}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace"},children:O.cubetas}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace"},children:jr(O.kgBruto)}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",color:P.textSecondary,fontSize:12},children:$.toFixed(4)}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontWeight:700,color:P.green},children:jr(O.kgAjustado)}),o.jsxs("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontSize:12,color:O.kgAjustado-O.kgBruto<0?P.red:P.textMuted},children:[O.kgAjustado-O.kgBruto>=0?"+":"",jr(O.kgAjustado-O.kgBruto)]})]},O.sector)),o.jsxs("tr",{style:{borderTop:`2px solid ${P.border}`,background:P.surface},children:[o.jsx("td",{style:{padding:"9px 11px",fontWeight:700},children:"TOTAL"}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontWeight:700},children:C}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontWeight:700},children:jr(w)}),o.jsx("td",{}),o.jsx("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontWeight:700,color:P.green},children:jr(E)}),o.jsxs("td",{style:{padding:"9px 11px",fontFamily:"'DM Mono', monospace",fontWeight:700,color:Ga(z)},children:[N>=0?"+":"",jr(N)]})]})]})]})})]}),D&&o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:600,color:P.text,marginBottom:10},children:"Notas del Cuadre"}),o.jsx("textarea",{value:p,onChange:O=>x(O.target.value),rows:3,placeholder:"Observaciones, justificacin de diferencias, incidencias del da",style:{width:"100%",padding:"10px 14px",borderRadius:9,background:P.input,border:`1.5px solid ${P.inputBorder}`,color:P.text,fontSize:13,resize:"vertical",outline:"none",boxSizing:"border-box"}}),o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:o.jsx(Zn,{onClick:L,disabled:m,variant:"success",children:m?"Guardando":" Cerrar Cuadre del Da"})})]}),!D&&!d&&o.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:P.textMuted},children:["Sin datos para el ",r]})]})}function Fie(){const[e,t]=h.useState("12x18oz"),[r,n]=h.useState(Ko(Ra())),[a,i]=h.useState(70),[s,l]=h.useState(Au["12x18oz"]),[c,u]=h.useState({...Lie}),d=(v,w)=>u(C=>({...C,[v]:w})),f=a*(c.comision_pct/100),p=f+c.warehousing+c.quality_control+c.fees_importacion+c.materiales,x=a-p,m=s>0?x/s:0,y=c.agente_aduanal_us+c.agente_aduanal_mx+c.material_palletizado+c.servicio_frio+c.servicio_flete,j=m-y,b=j*s,g=({label:v,value:w,highlight:C=!1,sep:k=!1})=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 14px",background:C?P.accentDim:"transparent",borderTop:k?`1px solid ${P.border}`:void 0,borderRadius:C?7:0,marginTop:k?3:0},children:[o.jsx("span",{style:{fontSize:13,color:C?P.text:P.textSecondary},children:v}),o.jsx("span",{style:{fontSize:C?14:13,fontWeight:C?700:500,color:C?P.accentLight:P.text,fontFamily:"'DM Mono', monospace"},children:ze(w)})]});return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,alignItems:"start"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[o.jsxs(tt,{children:[o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:[" Parmetros Sem. ",r]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Semana",type:"number",step:"1",value:r,onChange:v=>n(Number(v.target.value))}),o.jsx(va,{label:"Presentacin",value:e,onChange:v=>{t(v.target.value),l(Au[v.target.value]??4.08)},options:II.map(v=>({value:v,label:v}))}),o.jsx(ft,{label:"Precio FOB Bruto (USD/caja)",value:a,onChange:v=>i(Number(v.target.value)),step:"0.5"}),o.jsx(ft,{label:"Kg netos / caja",value:s,onChange:v=>l(Number(v.target.value))})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Deducciones / Caja (USD)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:`Comisin (${c.comision_pct}%)`,value:c.comision_pct,onChange:v=>d("comision_pct",Number(v.target.value)),step:"0.5"}),o.jsx(ft,{label:"Warehousing",value:c.warehousing,onChange:v=>d("warehousing",Number(v.target.value))}),o.jsx(ft,{label:"Quality Control",value:c.quality_control,onChange:v=>d("quality_control",Number(v.target.value))}),o.jsx(ft,{label:"Fees importacin",value:c.fees_importacion,onChange:v=>d("fees_importacion",Number(v.target.value))}),o.jsx(ft,{label:"Materiales",value:c.materiales,onChange:v=>d("materiales",Number(v.target.value))})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Deducciones / Kg (USD)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Agente Aduanal US",value:c.agente_aduanal_us,onChange:v=>d("agente_aduanal_us",Number(v.target.value))}),o.jsx(ft,{label:"Agente Aduanal MX",value:c.agente_aduanal_mx,onChange:v=>d("agente_aduanal_mx",Number(v.target.value))}),o.jsx(ft,{label:"Material Paletizado",value:c.material_palletizado,onChange:v=>d("material_palletizado",Number(v.target.value))}),o.jsx(ft,{label:"Servicio de Fro",value:c.servicio_frio,onChange:v=>d("servicio_frio",Number(v.target.value))}),o.jsx(ft,{label:"Servicio de Flete",value:c.servicio_flete,onChange:v=>d("servicio_flete",Number(v.target.value))})]})]})]}),o.jsx("div",{style:{position:"sticky",top:20,display:"flex",flexDirection:"column",gap:16},children:o.jsxs(tt,{style:{border:`1.5px solid ${P.accentDim}`},children:[o.jsxs("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:14},children:[" Sem. ",r,"  ",e]}),o.jsxs("div",{style:{background:P.surface,borderRadius:10,overflow:"hidden",border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{padding:"6px 14px",background:P.border+"66",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase"},children:"Precio base"}),o.jsx(g,{label:"Precio FOB Bruto",value:a}),o.jsx("div",{style:{padding:"6px 14px",background:P.border+"66",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",marginTop:3},children:" Deducciones / caja"}),o.jsx(g,{label:`Comisin (${c.comision_pct}%)`,value:-f}),o.jsx(g,{label:"Warehousing",value:-c.warehousing}),o.jsx(g,{label:"Quality Control",value:-c.quality_control}),o.jsx(g,{label:"Fees importacin",value:-c.fees_importacion}),o.jsx(g,{label:"Materiales",value:-c.materiales}),o.jsx(g,{label:"= Precio Caja FOB",value:x,highlight:!0,sep:!0}),o.jsx(g,{label:`= Precio kg FOB  ${s}kg`,value:m,highlight:!0}),o.jsx("div",{style:{padding:"6px 14px",background:P.border+"66",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",marginTop:3},children:" Deducciones / kg"}),o.jsx(g,{label:"Agente Aduanal US",value:-c.agente_aduanal_us}),o.jsx(g,{label:"Agente Aduanal MX",value:-c.agente_aduanal_mx}),o.jsx(g,{label:"Material Paletizado",value:-c.material_palletizado}),o.jsx(g,{label:"Servicio de Fro",value:-c.servicio_frio}),o.jsx(g,{label:"Servicio de Flete",value:-c.servicio_flete})]}),o.jsxs("div",{style:{marginTop:16,padding:"18px",background:P.greenDim,borderRadius:12,border:`2px solid ${P.greenBorder}`,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:P.green,textTransform:"uppercase",letterSpacing:.5,marginBottom:8},children:" Precio Retorno Productor"}),o.jsxs("div",{style:{fontSize:36,fontWeight:900,color:P.green,fontFamily:"'DM Mono', monospace"},children:[ze(j),o.jsx("span",{style:{fontSize:15,fontWeight:400,color:P.textMuted},children:" /kg"})]}),o.jsxs("div",{style:{fontSize:20,fontWeight:700,color:P.green,marginTop:4,fontFamily:"'DM Mono', monospace"},children:[ze(b),o.jsx("span",{style:{fontSize:13,fontWeight:400,color:P.textMuted},children:" /caja"})]})]})]})})]})}function zie(){const{semanasPrecio:e,reload:t,diasCredito:r}=so(),[n,a]=h.useState(!1),[i,s]=h.useState(null),l=Ra(),c=e.filter(m=>m.status==="pendiente_liquidacion"&&m.fecha_vencimiento&&Cd(m.fecha_vencimiento,l)>0),u=e.filter(m=>m.status!=="liquidado").reduce((m,y)=>m+(y.ingreso_estimado_min_usd??0),0),d=e.filter(m=>m.status!=="liquidado").reduce((m,y)=>m+(y.ingreso_estimado_max_usd??0),0),f=e.filter(m=>m.status==="liquidado").reduce((m,y)=>m+(y.ingreso_real_usd??0),0),p=()=>({semana:Ko(l),year:Nu(),presentacion:"12x18oz",cliente:"TwinRiver",precio_estimado_min:65,precio_estimado_max:75,precio_real:null,status:"precio_recibido",anticipo_usd:null,fecha_pago_real:null,notas:null,cajas_vendidas:null,tipo_cambio_mxn:null,ingreso_estimado_min_usd:null,ingreso_estimado_max_usd:null,ingreso_real_usd:null,dias_credito:r,fecha_vencimiento:null}),x=async m=>{try{const y=m.cajas_vendidas??0,j={...m,ingreso_estimado_min_usd:y?y*m.precio_estimado_min:null,ingreso_estimado_max_usd:y?y*m.precio_estimado_max:null,ingreso_real_usd:y&&m.precio_real?y*m.precio_real:null,fecha_vencimiento:m.fecha_vencimiento??RI(m.semana,m.year,m.dias_credito??r)};if(m.id){const{error:b}=await se.from("finanzas_semana_precio").update(j).eq("id",m.id);if(b)throw b}else{const{error:b}=await se.from("finanzas_semana_precio").insert(j);if(b)throw b}oe.success(m.id?"Actualizado ":"Creado "),a(!1),s(null),t()}catch(y){oe.error(y.message)}};return n&&i?o.jsx(Bie,{row:i,onChange:s,onSave:()=>x(i),onCancel:()=>{a(!1),s(null)}}):o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(175px, 1fr))",gap:14,marginBottom:20},children:[o.jsx(At,{emoji:"",label:"Esperado pendiente",value:`${pr(u)}${pr(d)}`,sub:"por liquidar",color:P.accentLight}),o.jsx(At,{emoji:"",label:"Cobrado confirmado",value:pr(f),sub:"liquidaciones reales",color:P.green}),o.jsx(At,{emoji:"",label:"Pendientes",value:e.filter(m=>m.status==="pendiente_liquidacion").length,color:P.orange}),o.jsx(At,{emoji:"",label:"Vencidos",value:c.length,sub:c.length>0?"Requieren accin":"Sin vencidos",color:c.length>0?P.red:P.green})]}),c.length>0&&o.jsxs("div",{style:{marginBottom:16,padding:"12px 16px",background:P.redDim,borderRadius:10,border:`1px solid ${P.redBorder}`},children:[o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:P.red,marginBottom:6},children:[" ",c.length," cobro(s) vencido(s)  plazo de crdito superado"]}),c.map(m=>o.jsxs("div",{style:{fontSize:13,color:P.red,opacity:.85},children:[" Sem. ",m.semana,"/",m.year,"  ",m.cliente,"  ",m.presentacion,"  venci ",m.fecha_vencimiento," (",Cd(m.fecha_vencimiento,l)," das)"]},m.id))]}),o.jsx("div",{style:{display:"flex",gap:6,marginBottom:20,overflowX:"auto"},children:Object.entries(Io).map(([m,y])=>{const j=e.filter(g=>g.status===m),b=j.reduce((g,v)=>g+(v.ingreso_estimado_min_usd??0),0);return o.jsxs("div",{style:{flex:"0 0 auto",minWidth:140,padding:"12px 14px",background:y.bg,border:`1.5px solid ${y.border}`,borderRadius:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:18},children:y.emoji}),o.jsx("div",{style:{fontSize:11,fontWeight:700,color:y.color,marginTop:4},children:y.label}),o.jsx("div",{style:{fontSize:22,fontWeight:800,color:y.color,fontFamily:"'DM Mono', monospace"},children:j.length}),b>0&&o.jsx("div",{style:{fontSize:11,color:y.color,opacity:.7},children:pr(b)})]},m)})}),o.jsxs(tt,{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text},children:"Registros de Cobranza"}),o.jsx(Zn,{onClick:()=>{s(p()),a(!0)},children:"+ Nueva Semana"})]}),e.length===0?o.jsx("div",{style:{textAlign:"center",padding:40,color:P.textMuted},children:'Sin registros. Presiona "+ Nueva Semana".'}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Sem.","Pres.","Cliente","Cajas","Rango USD","Ing. Estimado","Precio Real","Estado","Venc.",""].map(m=>o.jsx("th",{style:{textAlign:"left",padding:"7px 10px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5},children:m},m))})}),o.jsx("tbody",{children:e.map(m=>{const y=Io[m.status],j=m.fecha_vencimiento&&m.status==="pendiente_liquidacion"&&Cd(m.fecha_vencimiento,l)>0,b=m.fecha_vencimiento&&m.status!=="liquidado"?Cd(l,m.fecha_vencimiento):null;return o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`,cursor:"pointer",background:j?P.redDim:"transparent"},onClick:()=>{s({...m}),a(!0)},children:[o.jsxs("td",{style:{padding:"9px 10px",fontWeight:700,color:P.text},children:[m.semana,o.jsxs("span",{style:{fontSize:10,color:P.textMuted},children:["/",m.year]})]}),o.jsx("td",{style:{padding:"9px 10px",color:P.accentLight,fontSize:12},children:m.presentacion}),o.jsx("td",{style:{padding:"9px 10px",color:P.textSecondary,fontSize:12},children:m.cliente}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12},children:m.cajas_vendidas??o.jsx("span",{style:{color:P.textMuted},children:""})}),o.jsxs("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12},children:["$",m.precio_estimado_min,"$",m.precio_estimado_max]}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.accentLight},children:m.ingreso_estimado_min_usd?`${pr(m.ingreso_estimado_min_usd)}${pr(m.ingreso_estimado_max_usd)}`:o.jsx("span",{style:{color:P.textMuted},children:""})}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontWeight:700,color:m.precio_real?P.green:P.textMuted,fontSize:12},children:m.precio_real?`$${m.precio_real}`:""}),o.jsx("td",{style:{padding:"9px 10px"},children:o.jsx(kg,{text:`${y.emoji} ${y.label}`,color:y.color,bg:y.bg,border:y.border})}),o.jsx("td",{style:{padding:"9px 10px",fontSize:11,color:b!==null?b<0?P.red:b<=5?P.yellow:P.textMuted:P.textMuted,fontWeight:b!==null&&b<=5?700:400},children:b!==null?b<0?`+${Math.abs(b)}d vencido`:b===0?" Hoy":`${b}d`:""}),o.jsx("td",{style:{padding:"9px 10px",fontSize:11,color:P.accent},children:"Editar"})]},m.id)})})]})})]})]})}function Bie({row:e,onChange:t,onSave:r,onCancel:n}){const{diasCredito:a}=so(),i=(f,p)=>t(x=>({...x,[f]:p})),s=h.useMemo(()=>RI(e.semana,e.year,e.dias_credito??a),[e.semana,e.year,e.dias_credito,a]),l=e.cajas_vendidas??0,c=l*e.precio_estimado_min,u=l*e.precio_estimado_max,d=l&&e.precio_real?l*e.precio_real:null;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},children:[o.jsx("button",{onClick:n,style:{background:"none",border:"none",color:P.textSecondary,cursor:"pointer",fontSize:13},children:" Volver"}),o.jsx("h2",{style:{margin:0,fontSize:17,fontWeight:700,color:P.text},children:e.id?`Editar Sem. ${e.semana}/${e.year}`:"Nueva Semana de Precio"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:"Identificacin"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Semana ISO",type:"number",step:"1",value:e.semana,onChange:f=>i("semana",Number(f.target.value))}),o.jsx(ft,{label:"Ao",type:"number",step:"1",value:e.year,onChange:f=>i("year",Number(f.target.value))}),o.jsx(va,{label:"Presentacin",value:e.presentacion,onChange:f=>i("presentacion",f.target.value),options:II.map(f=>({value:f,label:f}))}),o.jsx(va,{label:"Cliente",value:e.cliente,onChange:f=>i("cliente",f.target.value),options:Tie.map(f=>({value:f,label:f}))})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Volumen y Tipo de Cambio"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Cajas vendidas",type:"number",step:"1",value:e.cajas_vendidas??"",onChange:f=>i("cajas_vendidas",f.target.value?Number(f.target.value):null),placeholder:"Capturar o dejar vaco",note:"Necesario para calcular ingreso estimado"}),o.jsx(ft,{label:"Tipo cambio MXN/USD",value:e.tipo_cambio_mxn??"",onChange:f=>i("tipo_cambio_mxn",f.target.value?Number(f.target.value):null),placeholder:"ej. 17.50",note:"Para conversin en P&L (Fase 4)"})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Precios"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Estimado mn (USD/caja)",value:e.precio_estimado_min,onChange:f=>i("precio_estimado_min",Number(f.target.value)),step:"0.5"}),o.jsx(ft,{label:"Estimado mx (USD/caja)",value:e.precio_estimado_max,onChange:f=>i("precio_estimado_max",Number(f.target.value)),step:"0.5"}),o.jsx(ft,{label:"Precio real (USD/caja)",value:e.precio_real??"",onChange:f=>i("precio_real",f.target.value?Number(f.target.value):null),placeholder:"Al liquidar",note:"Llenar cuando se recibe la liquidacin"})]}),l>0&&o.jsxs("div",{style:{marginTop:14,padding:"12px 14px",background:P.accentDim,borderRadius:9,border:`1px solid ${P.accentLight}33`},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5,marginBottom:6},children:["Preview Ingreso  ",l," cajas"]}),o.jsxs("div",{style:{display:"flex",gap:20},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"Mn"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:P.accentLight,fontFamily:"'DM Mono', monospace"},children:ze(c)})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"Mx"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:P.accentLight,fontFamily:"'DM Mono', monospace"},children:ze(u)})]}),d&&o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"Real"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:P.green,fontFamily:"'DM Mono', monospace"},children:ze(d)})]})]})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Cobro y Vencimiento"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(va,{label:"Estado",value:e.status,onChange:f=>i("status",f.target.value),options:Object.entries(Io).map(([f,p])=>({value:f,label:`${p.emoji} ${p.label}`}))}),o.jsx(ft,{label:"Das de crdito",type:"number",step:"1",value:e.dias_credito??a,onChange:f=>i("dias_credito",Number(f.target.value)),note:"Default global: 21 das"}),o.jsx(ft,{label:"Fecha vencimiento",value:e.fecha_vencimiento??s,onChange:f=>i("fecha_vencimiento",f.target.value),type:"date",note:"Auto-calculada o editar manual"}),o.jsx(ft,{label:"Anticipo (USD)",value:e.anticipo_usd??"",onChange:f=>i("anticipo_usd",f.target.value?Number(f.target.value):null),placeholder:"Opcional"}),o.jsx(ft,{label:"Fecha pago real",type:"date",value:e.fecha_pago_real??"",onChange:f=>i("fecha_pago_real",f.target.value||null)})]})]}),o.jsxs(tt,{style:{gridColumn:"1 / -1"},children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:10},children:" Notas"}),o.jsx("textarea",{value:e.notas??"",onChange:f=>i("notas",f.target.value||null),rows:3,placeholder:"Ajustes por calidad, diferencias de precio vs estimado, condiciones especiales",style:{width:"100%",padding:"10px 14px",borderRadius:9,background:P.input,border:`1.5px solid ${P.inputBorder}`,color:P.text,fontSize:13,resize:"vertical",outline:"none",boxSizing:"border-box"}})]})]}),o.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:20},children:[o.jsx(Zn,{onClick:n,variant:"ghost",children:"Cancelar"}),o.jsx(Zn,{onClick:r,variant:"success",children:" Guardar"})]})]})}function Uie(){const{semanasPrecio:e,cuadres:t}=so(),r=Ra(),n=Ko(r),a=Nu(),i=h.useMemo(()=>Array.from({length:8},(d,f)=>{let p=n-4+f,x=a;return p<=0&&(p+=52,x-=1),p>52&&(p-=52,x+=1),{semana:p,year:x,isCurrent:f===4,isFuture:f>4}}),[n,a]),s=h.useMemo(()=>i.map(d=>{const f=e.filter(w=>w.semana===d.semana&&w.year===d.year),p=t.find(w=>w.semana_iso===d.semana&&w.year_iso===d.year),x=f.reduce((w,C)=>w+(C.ingreso_estimado_min_usd??0),0),m=f.reduce((w,C)=>w+(C.ingreso_estimado_max_usd??0),0),y=f.filter(w=>w.status==="liquidado").reduce((w,C)=>w+(C.ingreso_real_usd??0),0),j=f.filter(w=>w.status==="anticipado").reduce((w,C)=>w+(C.anticipo_usd??0),0),b=f.reduce((w,C)=>w+(C.cajas_vendidas??0),0),g=f.some(w=>w.status==="pendiente_liquidacion"&&w.fecha_vencimiento&&Cd(w.fecha_vencimiento,r)>0),v=f.length>0?f[0].status:null;return{...d,regs:f,cuadre:p,estMin:x,estMax:m,real:y,anticipo:j,cajas:b,hasVencido:g,mainStatus:v}}),[i,e,t,r]),l=Math.max(...s.map(d=>Math.max(d.estMax,d.real)),1),c=s.filter(d=>d.isFuture||d.isCurrent).reduce((d,f)=>d+f.estMin,0),u=s.filter(d=>!d.isFuture).reduce((d,f)=>d+f.real,0);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:14,marginBottom:24},children:[o.jsx(At,{emoji:"",label:"Ventana",value:"8 semanas",sub:"4 pasadas + actual + 3 futuras",color:P.accentLight}),o.jsx(At,{emoji:"",label:"Esperado prx. semanas",value:pr(c),sub:"precio estimado mn",color:P.yellow}),o.jsx(At,{emoji:"",label:"Cobrado en ventana",value:pr(u),sub:"liquidaciones confirmadas",color:P.green})]}),o.jsxs(tt,{style:{marginBottom:20},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:20},children:" Flujo de Ingresos  8 Semanas"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:s.map(d=>o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("div",{style:{minWidth:76},children:[o.jsxs("div",{style:{fontSize:13,fontWeight:d.isCurrent?800:600,color:d.isCurrent?P.accentLight:P.text},children:["Sem. ",d.semana]}),o.jsx("div",{style:{fontSize:10,color:P.textMuted},children:d.year})]}),o.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:4},children:[d.estMin>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:7},children:[o.jsx("div",{style:{fontSize:10,color:P.textMuted,minWidth:42},children:"Est."}),o.jsx("div",{style:{flex:1,height:8,background:P.surface,borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{width:`${d.estMax/l*100}%`,height:"100%",background:P.accentDim,position:"relative",borderRadius:4},children:o.jsx("div",{style:{width:`${d.estMin/d.estMax*100}%`,height:"100%",background:P.accent+"66",borderRadius:4}})})}),o.jsxs("span",{style:{fontSize:11,color:P.textSecondary,fontFamily:"'DM Mono', monospace",minWidth:100,textAlign:"right"},children:[pr(d.estMin),"",pr(d.estMax)]})]}),d.real>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:7},children:[o.jsx("div",{style:{fontSize:10,color:P.textMuted,minWidth:42},children:"Real"}),o.jsx(Pu,{value:d.real,max:l,color:P.green}),o.jsxs("span",{style:{fontSize:11,fontWeight:700,color:P.green,fontFamily:"'DM Mono', monospace",minWidth:100,textAlign:"right"},children:[pr(d.real)," "]})]}),d.anticipo>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:7},children:[o.jsx("div",{style:{fontSize:10,color:P.textMuted,minWidth:42},children:"Anticipo"}),o.jsx(Pu,{value:d.anticipo,max:l,color:P.purple}),o.jsxs("span",{style:{fontSize:11,color:P.purple,fontFamily:"'DM Mono', monospace",minWidth:100,textAlign:"right"},children:[pr(d.anticipo)," "]})]}),d.estMin===0&&d.real===0&&o.jsx("div",{style:{fontSize:12,color:P.textMuted,fontStyle:"italic"},children:"Sin registro de precio"})]}),o.jsxs("div",{style:{minWidth:90,textAlign:"right",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:3},children:[d.cajas>0&&o.jsxs("span",{style:{fontSize:11,color:P.textMuted},children:[d.cajas," cajas"]}),d.cuadre&&o.jsxs("span",{style:{fontSize:10,color:d.cuadre.status==="ok"?P.green:d.cuadre.status==="alerta"?P.yellow:P.red},children:[" ",d.cuadre.status]}),d.hasVencido&&o.jsx("span",{style:{fontSize:10,color:P.red,fontWeight:700},children:" Vencido"}),d.isCurrent&&o.jsx("span",{style:{fontSize:10,color:P.accentLight,fontWeight:700},children:" Hoy"})]})]}),d.isCurrent&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,margin:"8px 0 0"},children:[o.jsx("div",{style:{flex:1,height:1,background:P.accentLight+"33"}}),o.jsx("span",{style:{fontSize:11,color:P.accentLight,fontWeight:700},children:" PROYECCIN"}),o.jsx("div",{style:{flex:1,height:1,background:P.accentLight+"33"}})]})]},`${d.semana}-${d.year}`))})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:14},children:" Resumen Semanal"}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Semana","Cajas","Est. Mn","Est. Mx","Real","Estado","Vencimiento","Cuadre"].map(d=>o.jsx("th",{style:{textAlign:"left",padding:"7px 10px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase"},children:d},d))})}),o.jsx("tbody",{children:s.map(d=>{var p;const f=d.mainStatus?Io[d.mainStatus]:null;return o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`,background:d.isCurrent?P.accentDim:"transparent"},children:[o.jsxs("td",{style:{padding:"9px 10px",fontWeight:700,color:d.isCurrent?P.accentLight:P.text},children:["Sem. ",d.semana,"/",d.year,d.isCurrent&&o.jsx("span",{style:{fontSize:10,marginLeft:4,color:P.accentLight},children:""})]}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12},children:d.cajas||""}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.accentLight},children:d.estMin>0?ze(d.estMin):""}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.accentLight},children:d.estMax>0?ze(d.estMax):""}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,fontWeight:700,color:d.real>0?P.green:P.textMuted},children:d.real>0?ze(d.real):""}),o.jsx("td",{style:{padding:"9px 10px"},children:f?o.jsx(kg,{text:`${f.emoji} ${f.label}`,color:f.color,bg:f.bg,border:f.border}):o.jsx("span",{style:{color:P.textMuted,fontSize:12},children:"Sin registro"})}),o.jsxs("td",{style:{padding:"9px 10px",fontSize:11,color:d.hasVencido?P.red:P.textMuted},children:[((p=d.regs[0])==null?void 0:p.fecha_vencimiento)??"",d.hasVencido&&" "]}),o.jsx("td",{style:{padding:"9px 10px",fontSize:11},children:d.cuadre?o.jsxs("span",{style:{color:d.cuadre.status==="ok"?P.green:d.cuadre.status==="alerta"?P.yellow:P.red},children:[d.cuadre.status==="ok"?"":d.cuadre.status==="alerta"?"":""," ",d.cuadre.status]}):o.jsx("span",{style:{color:P.textMuted},children:""})})]},`${d.semana}-${d.year}`)})})]})})]})]})}function Wie(){const[e,t]=h.useState("tabulador");return o.jsxs("div",{children:[o.jsx(Cg,{tabs:[{key:"tabulador",emoji:"",label:"Tabulador FOB"},{key:"semanas",emoji:"",label:"Semanas / Cobranza"},{key:"flujo",emoji:"",label:"Flujo de Caja"}],active:e,onSelect:t}),e==="tabulador"&&o.jsx(Fie,{}),e==="semanas"&&o.jsx(zie,{}),e==="flujo"&&o.jsx(Uie,{})]})}function qie(e,t){const r={};return Ks.forEach(n=>{r[n]={categoria:n,totalMXN:0,totalUSD:0,count:0}}),e.forEach(n=>{const a=n.monto_mxn??(n.monto_usd??0)*(n.tipo_cambio??t),i=n.monto_usd??(n.monto_mxn??0)/(n.tipo_cambio??t);r[n.categoria]&&(r[n.categoria].totalMXN+=a,r[n.categoria].totalUSD+=i,r[n.categoria].count+=1)}),Ks.map(n=>r[n])}const FI={semana_actual:"Esta semana",mes_actual:"Este mes",ultimas_4:"ltimas 4 semanas",ultimas_12:"ltimas 12 semanas",todo:"Toda la temporada"};function na(e,t){return`${e}-${String(t).padStart(2,"0")}`}function Kie(e,t,r){if(t==="todo")return e;const n=parseInt(r.slice(0,4)),a=parseInt(r.slice(5,7)),i=Ko(r);return e.filter(s=>{const l=s.year_iso??s.year??n,c=s.semana_iso??s.semana??i;if(t==="semana_actual")return l===n&&c===i;if(t==="mes_actual")return l===n&&parseInt((s.fecha??r).slice(5,7))===a;if(t==="ultimas_4"){const u=na(l,c),d=na(n,Math.max(1,i-3));return u>=d&&u<=na(n,i)}if(t==="ultimas_12"){const u=na(l,c),d=na(n,Math.max(1,i-11));return u>=d&&u<=na(n,i)}return!0})}function Gie(e,t,r,n){const a={},i=(s,l,c)=>(a[s]||(a[s]={key:s,year:l,semana:c,kgCosechados:0,kgEmpacados:0,kgMerma:0,cajasEmpaque:0,mermaPct:0,factorConversion:0,cuadresCount:0,cajasVendidas:0,ingEstMin:0,ingEstMax:0,ingReal:0,precioPromReal:null,precioPromEst:0,tieneVentas:!1,costoMXN:0,costoUSD:0,costoNominaMXN:0,costoInsumosMXN:0,costoLogisticaMXN:0,margenUSD:0,margenPct:null,costoKg:null,costoCaja:null,precioVsCosto:null}),a[s]);return t.forEach(s=>{if(!s.semana_iso||!s.year_iso)return;const l=i(na(s.year_iso,s.semana_iso),s.year_iso,s.semana_iso);l.kgCosechados+=s.kg_cosechados,l.kgEmpacados+=s.kg_empacados,l.kgMerma+=s.kg_merma,l.cajasEmpaque+=s.cajas_totales,l.cuadresCount++}),e.forEach(s=>{const l=i(na(s.year,s.semana),s.year,s.semana);l.cajasVendidas+=s.cajas_vendidas??0,l.ingEstMin+=s.ingreso_estimado_min_usd??0,l.ingEstMax+=s.ingreso_estimado_max_usd??0,l.ingReal+=s.status==="liquidado"?s.ingreso_real_usd??0:0,l.tieneVentas=!0}),r.forEach(s=>{const l=i(na(s.year_iso,s.semana_iso),s.year_iso,s.semana_iso),c=s.monto_mxn??(s.monto_usd??0)*(s.tipo_cambio??n),u=c/n;l.costoMXN+=c,l.costoUSD+=u,s.categoria==="Nmina Cosecha"||s.categoria==="Nmina Empaque"?l.costoNominaMXN+=c:s.categoria==="Insumos Campo"||s.categoria==="Materiales Empaque"?l.costoInsumosMXN+=c:l.costoLogisticaMXN+=c}),Object.values(a).forEach(s=>{const l=s.kgEmpacados+s.kgMerma;s.mermaPct=l>0?s.kgMerma/l*100:0,s.factorConversion=s.kgCosechados>0?l/s.kgCosechados:0;const c=s.ingReal>0?s.ingReal:s.ingEstMin;s.margenUSD=c-s.costoUSD,s.margenPct=c>0?s.margenUSD/c*100:null,s.costoKg=s.kgCosechados>0?s.costoMXN/s.kgCosechados:null,s.costoCaja=s.cajasVendidas>0?s.costoUSD/s.cajasVendidas:s.cajasEmpaque>0?s.costoUSD/s.cajasEmpaque:null;const u=e.filter(f=>f.semana===s.semana&&f.year===s.year&&f.status==="liquidado"&&f.precio_real);if(u.length>0){const f=u.reduce((p,x)=>p+(x.cajas_vendidas??0),0);s.precioPromReal=f>0?u.reduce((p,x)=>p+x.precio_real*(x.cajas_vendidas??0),0)/f:u[0].precio_real}const d=e.filter(f=>f.semana===s.semana&&f.year===s.year);if(d.length>0){const f=d.reduce((p,x)=>p+(x.cajas_vendidas??0),0);s.precioPromEst=f>0?d.reduce((p,x)=>p+x.precio_estimado_min*(x.cajas_vendidas??0),0)/f:d[0].precio_estimado_min}s.precioPromReal!=null&&s.costoCaja!=null&&(s.precioVsCosto=s.precioPromReal-s.costoCaja)}),Object.values(a).sort((s,l)=>s.key.localeCompare(l.key))}function Vie(e,t,r){const a=[["Semana","Ao","Kg Cosechados","Kg Empacados","Kg Merma","Merma %","Cajas Empaque","Cajas Vendidas","Ingreso Est. Min USD","Ingreso Est. Max USD","Ingreso Real USD","Precio Prom. Real USD","Precio Prom. Est. USD","Costo Total MXN","Costo Total USD","Costo Nmina MXN","Costo Insumos MXN","Costo Logstica MXN","Costo/kg MXN","Costo/caja USD","Margen USD","Margen %","TC Usado"].join(",")];e.forEach(c=>{var u,d,f,p;a.push([c.semana,c.year,c.kgCosechados.toFixed(2),c.kgEmpacados.toFixed(2),c.kgMerma.toFixed(2),c.mermaPct.toFixed(2),c.cajasEmpaque,c.cajasVendidas,c.ingEstMin.toFixed(2),c.ingEstMax.toFixed(2),c.ingReal.toFixed(2),((u=c.precioPromReal)==null?void 0:u.toFixed(2))??"",c.precioPromEst.toFixed(2),c.costoMXN.toFixed(2),c.costoUSD.toFixed(2),c.costoNominaMXN.toFixed(2),c.costoInsumosMXN.toFixed(2),c.costoLogisticaMXN.toFixed(2),((d=c.costoKg)==null?void 0:d.toFixed(2))??"",((f=c.costoCaja)==null?void 0:f.toFixed(2))??"",c.margenUSD.toFixed(2),((p=c.margenPct)==null?void 0:p.toFixed(2))??"",t.toFixed(2)].join(","))});const i=new Blob(["\uFEFF"+a.join(`
`)],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=`moray_resultados_${r}_${new Date().toISOString().slice(0,10)}.csv`,l.click(),URL.revokeObjectURL(s)}function Hie({gasto:e,onChange:t,onSave:r,onCancel:n,onDelete:a}){const{tipoCambio:i}=so(),s=(p,x)=>t({...e,[p]:x}),l=p=>{const x=p?Number(p):null,m=e.tipo_cambio??i;t({...e,monto_mxn:x,monto_usd:x!=null?parseFloat((x/m).toFixed(4)):null})},c=p=>{const x=p?Number(p):null,m=e.tipo_cambio??i;t({...e,monto_usd:x,monto_mxn:x!=null?parseFloat((x*m).toFixed(2)):null})},u=p=>{const x=p?Number(p):i,m=e.monto_usd;t({...e,tipo_cambio:x,monto_mxn:m!=null?parseFloat((m*x).toFixed(2)):e.monto_mxn})},d=Die[e.categoria]??[],f=!!e.id;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},children:[o.jsx("button",{onClick:n,style:{background:"none",border:"none",color:P.textSecondary,cursor:"pointer",fontSize:13},children:" Volver"}),o.jsx("h2",{style:{margin:0,fontSize:17,fontWeight:700,color:P.text},children:f?"Editar Gasto":"Nuevo Gasto"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Cundo y Qu"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Fecha",type:"date",value:e.fecha,onChange:p=>{const x=p.target.value;t({...e,fecha:x,semana_iso:Ko(x),year_iso:lw(x)})},step:"1"}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,color:P.textSecondary,marginBottom:4},children:"Semana (auto)"}),o.jsxs("div",{style:{padding:"9px 12px",borderRadius:9,background:P.surface,border:`1.5px solid ${P.border}`,fontSize:13,fontFamily:"'DM Mono', monospace",color:P.textSecondary},children:["Sem. ",e.semana_iso," / ",e.year_iso]})]}),o.jsx(va,{label:"Categora",value:e.categoria,onChange:p=>t({...e,categoria:p.target.value,subcategoria:null}),options:Ks.map(p=>({value:p,label:p}))}),o.jsx(va,{label:"Subcategora",value:e.subcategoria??"",onChange:p=>s("subcategoria",p.target.value||null),options:[{value:"",label:" General "},...d.map(p=>({value:p,label:p}))]})]}),o.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:12},children:[o.jsx(ft,{label:"Descripcin",type:"text",value:e.descripcion,step:"1",placeholder:"Concepto del gasto",onChange:p=>s("descripcion",p.target.value)}),o.jsx(ft,{label:"Proveedor / Pagado a",type:"text",value:e.proveedor??"",step:"1",placeholder:"Nombre proveedor (opcional)",onChange:p=>s("proveedor",p.target.value||null)})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Monto"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsx(ft,{label:"Monto MXN ($)",value:e.monto_mxn??"",step:"0.01",placeholder:"0.00",onChange:p=>l(p.target.value),note:"Llenar uno  el otro se auto-calcula"}),o.jsx(ft,{label:"Monto USD ($)",value:e.monto_usd??"",step:"0.01",placeholder:"0.00",onChange:p=>c(p.target.value)}),o.jsx(ft,{label:"Tipo de cambio usado",value:e.tipo_cambio??i,step:"0.01",onChange:p=>u(p.target.value),note:`Default global: ${i.toFixed(2)}`})]}),(e.monto_mxn||e.monto_usd)&&o.jsxs("div",{style:{marginTop:14,padding:"12px 14px",background:P.orangeDim,borderRadius:9,border:`1px solid ${P.orangeBorder}`},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5,marginBottom:6},children:[" Gasto  ",Ks.includes(e.categoria)?e.categoria:""]}),o.jsxs("div",{style:{display:"flex",gap:24},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"MXN"}),o.jsxs("div",{style:{fontSize:22,fontWeight:800,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["$",(e.monto_mxn??0).toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"USD"}),o.jsx("div",{style:{fontSize:22,fontWeight:800,color:P.yellow,fontFamily:"'DM Mono', monospace"},children:ze(e.monto_usd??0)})]})]}),o.jsxs("div",{style:{fontSize:11,color:P.textMuted,marginTop:6},children:["TC: ",(e.tipo_cambio??i).toFixed(2),"  Sem. ",e.semana_iso,"/",e.year_iso]})]}),o.jsxs("div",{style:{marginTop:14},children:[o.jsx("div",{style:{fontSize:12,fontWeight:600,color:P.textSecondary,marginBottom:4},children:"Notas"}),o.jsx("textarea",{value:e.notas??"",onChange:p=>s("notas",p.target.value||null),rows:3,placeholder:"Comprobante #, observaciones",style:{width:"100%",padding:"9px 12px",borderRadius:9,background:P.input,border:`1.5px solid ${P.inputBorder}`,color:P.text,fontSize:13,resize:"vertical",outline:"none",boxSizing:"border-box"}})]})]})]}),o.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"space-between",alignItems:"center",marginTop:20},children:[o.jsx("div",{children:f&&a&&o.jsx(Zn,{onClick:a,variant:"danger",children:" Eliminar"})}),o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx(Zn,{onClick:n,variant:"ghost",children:"Cancelar"}),o.jsx(Zn,{onClick:r,variant:"success",children:" Guardar"})]})]})]})}function Xie(){const{gastosOp:e,reload:t,tipoCambio:r}=so(),[n,a]=h.useState(!1),[i,s]=h.useState(null),[l,c]=h.useState(!1),[u,d]=h.useState("todas"),[f,p]=h.useState(""),x=Ra(),m=()=>({fecha:x,semana_iso:Ko(x),year_iso:lw(x),categoria:"Nmina Cosecha",subcategoria:null,proveedor:null,descripcion:"",monto_mxn:null,monto_usd:null,tipo_cambio:r,notas:null}),y=h.useMemo(()=>e.reduce((k,S)=>k+(S.monto_mxn??(S.monto_usd??0)*(S.tipo_cambio??r)),0),[e,r]),j=h.useMemo(()=>e.reduce((k,S)=>k+(S.monto_usd??(S.monto_mxn??0)/(S.tipo_cambio??r)),0),[e,r]),b=h.useMemo(()=>{const k=new Set;return e.forEach(S=>{S.year_iso&&S.semana_iso&&k.add(`${S.year_iso}-${String(S.semana_iso).padStart(2,"0")}`)}),Array.from(k).sort().reverse()},[e]),g=h.useMemo(()=>e.filter(k=>!(u!=="todas"&&k.categoria!==u||f&&`${k.year_iso}-${String(k.semana_iso).padStart(2,"0")}`!==f)),[e,u,f]),v=h.useMemo(()=>g.reduce((k,S)=>k+(S.monto_mxn??(S.monto_usd??0)*(S.tipo_cambio??r)),0),[g,r]),w=async()=>{if(i){if(!i.descripcion.trim()){oe.error("Descripcin requerida");return}if(!i.monto_mxn&&!i.monto_usd){oe.error("Ingresa al menos un monto");return}c(!0);try{const k={...i};if(i.id){const{error:S}=await se.from("gastos_operativos").update(k).eq("id",i.id);if(S)throw S;oe.success("Gasto actualizado ")}else{delete k.id;const{error:S}=await se.from("gastos_operativos").insert(k);if(S)throw S;oe.success("Gasto registrado ")}a(!1),s(null),t()}catch(k){oe.error(k.message)}c(!1)}},C=async()=>{if(i!=null&&i.id&&window.confirm("Eliminar este gasto?"))try{const{error:k}=await se.from("gastos_operativos").delete().eq("id",i.id);if(k)throw k;oe.success("Eliminado "),a(!1),s(null),t()}catch(k){oe.error(k.message)}};return n&&i?o.jsx(Hie,{gasto:i,onChange:s,onSave:w,onCancel:()=>{a(!1),s(null)},onDelete:i.id?C:void 0}):o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(175px, 1fr))",gap:14,marginBottom:20},children:[o.jsx(At,{emoji:"",label:"Total gastado",value:`$${(y/1e3).toFixed(1)}k`,sub:"MXN  todos los registros",color:P.orange}),o.jsx(At,{emoji:"",label:"Total en USD",value:ze(j),sub:"equivalente",color:P.yellow}),o.jsx(At,{emoji:"",label:"Registros",value:e.length,sub:`${b.length} semanas`,color:P.accentLight}),f&&o.jsx(At,{emoji:"",label:"Filtrado",value:`$${(v/1e3).toFixed(1)}k MXN`,sub:`${g.length} registros`,color:P.purple})]}),o.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16,flexWrap:"wrap",alignItems:"flex-end"},children:[o.jsx(va,{label:"Categora",value:u,onChange:k=>d(k.target.value),options:[{value:"todas",label:"Todas las categoras"},...Ks.map(k=>({value:k,label:k}))]}),o.jsx(va,{label:"Semana",value:f,onChange:k=>p(k.target.value),options:[{value:"",label:"Todas las semanas"},...b.map(k=>({value:k,label:`Sem. ${k.split("-")[1]}/${k.split("-")[0]}`}))]}),(u!=="todas"||f)&&o.jsx(Zn,{onClick:()=>{d("todas"),p("")},variant:"ghost",children:" Limpiar"}),o.jsx("div",{style:{marginLeft:"auto"},children:o.jsx(Zn,{onClick:()=>{s(m()),a(!0)},children:"+ Nuevo Gasto"})})]}),o.jsx(tt,{children:g.length===0?o.jsx("div",{style:{textAlign:"center",padding:"40px",color:P.textMuted},children:e.length===0?'Sin gastos registrados. Presiona "+ Nuevo Gasto".':"Sin resultados con los filtros aplicados."}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Fecha","Sem.","Categora","Subcateg.","Descripcin","Proveedor","MXN","USD",""].map(k=>o.jsx("th",{style:{textAlign:"left",padding:"7px 10px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase",letterSpacing:.5},children:k},k))})}),o.jsx("tbody",{children:g.map(k=>{const S=k.monto_mxn??(k.monto_usd??0)*(k.tipo_cambio??r),_=k.monto_usd??(k.monto_mxn??0)/(k.tipo_cambio??r),A=Eu[k.categoria]??P.textSecondary;return o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`,cursor:"pointer"},onClick:()=>{s({...k}),a(!0)},children:[o.jsx("td",{style:{padding:"9px 10px",fontSize:12,color:P.textSecondary,whiteSpace:"nowrap"},children:k.fecha}),o.jsxs("td",{style:{padding:"9px 10px",fontSize:12,fontFamily:"'DM Mono', monospace",color:P.textMuted},children:[k.semana_iso,o.jsxs("span",{style:{fontSize:10},children:["/",k.year_iso]})]}),o.jsx("td",{style:{padding:"9px 10px"},children:o.jsx("span",{style:{fontSize:11,fontWeight:700,color:A,background:A+"20",padding:"2px 8px",borderRadius:20},children:k.categoria})}),o.jsx("td",{style:{padding:"9px 10px",fontSize:12,color:P.textMuted},children:k.subcategoria??""}),o.jsx("td",{style:{padding:"9px 10px",fontSize:13,color:P.text,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:k.descripcion}),o.jsx("td",{style:{padding:"9px 10px",fontSize:12,color:P.textMuted},children:k.proveedor??""}),o.jsxs("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,fontWeight:700,color:P.orange,whiteSpace:"nowrap"},children:["$",S.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.yellow,whiteSpace:"nowrap"},children:ze(_)}),o.jsx("td",{style:{padding:"9px 10px",fontSize:11,color:P.accent},children:"Editar"})]},k.id)})}),o.jsx("tfoot",{children:o.jsxs("tr",{style:{borderTop:`2px solid ${P.border}`,background:P.surface},children:[o.jsxs("td",{colSpan:6,style:{padding:"9px 10px",fontSize:12,fontWeight:700,color:P.textSecondary},children:["TOTAL (",g.length," registros)"]}),o.jsxs("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:13,fontWeight:800,color:P.orange,whiteSpace:"nowrap"},children:["$",v.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:13,fontWeight:800,color:P.yellow,whiteSpace:"nowrap"},children:ze(g.reduce((k,S)=>k+(S.monto_usd??(S.monto_mxn??0)/(S.tipo_cambio??r)),0))}),o.jsx("td",{})]})})]})})})]})}function Yie(){const{gastosOp:e,cuadres:t,semanasPrecio:r,tipoCambio:n}=so(),a=Ra(),[i,s]=h.useState(()=>{const N=Ko(a);return`${Nu()}-${String(N).padStart(2,"0")}`}),l=h.useMemo(()=>{const N=new Set;e.forEach(T=>{T.year_iso&&T.semana_iso&&N.add(`${T.year_iso}-${String(T.semana_iso).padStart(2,"0")}`)}),t.forEach(T=>{T.year_iso&&T.semana_iso&&N.add(`${T.year_iso}-${String(T.semana_iso).padStart(2,"0")}`)}),r.forEach(T=>N.add(`${T.year}-${String(T.semana).padStart(2,"0")}`));const $=Ko(a),z=Nu();return N.add(`${z}-${String($).padStart(2,"0")}`),Array.from(N).sort().reverse()},[e,t,r,a]),[c,u]=h.useMemo(()=>{const N=i.split("-");return[parseInt(N[0]),parseInt(N[1])]},[i]),d=h.useMemo(()=>e.filter(N=>N.semana_iso===u&&N.year_iso===c),[e,u,c]),f=h.useMemo(()=>{const N={};return d.forEach($=>{const z=$.monto_mxn??($.monto_usd??0)*($.tipo_cambio??n);N[$.categoria]=(N[$.categoria]??0)+z}),Ks.map($=>({cat:$,mxn:N[$]??0})).filter($=>$.mxn>0)},[d,n]),p=f.reduce((N,$)=>N+$.mxn,0),x=p/n,m=h.useMemo(()=>t.filter(N=>N.semana_iso===u&&N.year_iso===c),[t,u,c]),y=m.reduce((N,$)=>N+$.kg_cosechados,0),j=m.reduce((N,$)=>N+$.kg_empacados,0),b=m.reduce((N,$)=>N+$.cajas_totales,0),g=h.useMemo(()=>r.filter(N=>N.semana===u&&N.year===c),[r,u,c]),v=g.reduce((N,$)=>N+($.ingreso_estimado_min_usd??0),0),w=g.reduce((N,$)=>N+($.ingreso_estimado_max_usd??0),0),C=g.reduce((N,$)=>N+($.ingreso_real_usd??0),0),k=y>0?p/y:null,S=b>0?x/b:null,_=v>0?v-x:null,A=v>0&&x>0?_/v*100:null,E=Math.max(...f.map(N=>N.mxn),1);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:14,marginBottom:20,flexWrap:"wrap"},children:[o.jsx(va,{label:"Semana",value:i,onChange:N=>s(N.target.value),options:l.map(N=>{const[$,z]=N.split("-");return{value:N,label:`Sem. ${parseInt(z)} / ${$}`}})}),o.jsxs("div",{style:{padding:"9px 14px",background:P.surface,borderRadius:9,border:`1px solid ${P.border}`,fontSize:13,color:P.textSecondary},children:[" Semana ",o.jsx("strong",{style:{color:P.accentLight},children:u})," de ",c,"  ",m.length," cuadre(s) cerrado(s)"]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(175px, 1fr))",gap:14,marginBottom:20},children:[o.jsx(At,{emoji:"",label:"Gasto semana",value:p>0?`$${(p/1e3).toFixed(1)}k`:"",sub:x>0?`${ze(x)} USD`:"Sin registros an",color:P.orange}),o.jsx(At,{emoji:"",label:"Costo / kg",value:k?`$${k.toFixed(2)}`:"",sub:y>0?`${y.toFixed(0)} kg cosechados`:"Sin cuadre cerrado",color:P.yellow}),o.jsx(At,{emoji:"",label:"Costo / caja",value:S?ze(S):"",sub:b>0?`${b} cajas empacadas`:"Sin cuadre cerrado",color:P.yellow}),_!==null?o.jsx(At,{emoji:_>=0?"":"",label:"Margen estimado",value:_>=0?`+${ze(_)}`:ze(_),sub:A!=null?`${A.toFixed(1)}% sobre ingreso mn`:"",color:_>=0?P.green:P.red}):o.jsx(At,{emoji:"",label:"Ingreso estimado",value:v>0?`${pr(v)}${pr(w)}`:"",sub:"de semanas de precio",color:P.accentLight})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:18},children:" Gastos por Categora"}),f.length===0?o.jsx("div",{style:{textAlign:"center",padding:"30px",color:P.textMuted},children:"Sin gastos esta semana"}):o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[f.map(({cat:N,mxn:$})=>{const z=Eu[N]??P.textSecondary,T=$/p*100;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5},children:[o.jsx("span",{style:{fontSize:13,fontWeight:600,color:z},children:N}),o.jsxs("span",{style:{fontSize:13,fontFamily:"'DM Mono', monospace",color:P.text},children:["$",$.toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0}),o.jsxs("span",{style:{fontSize:11,color:P.textMuted,marginLeft:6},children:[T.toFixed(1),"%"]})]})]}),o.jsx(Pu,{value:$,max:E,color:z})]},N)}),o.jsxs("div",{style:{borderTop:`1px solid ${P.border}`,paddingTop:12,display:"flex",justifyContent:"space-between"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:700,color:P.text},children:"Total MXN"}),o.jsxs("span",{style:{fontSize:14,fontWeight:800,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["$",p.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[o.jsxs(tt,{children:[o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:[" Produccin Sem. ",u," (Cuadre)"]}),m.length===0?o.jsx("div",{style:{fontSize:13,color:P.textMuted},children:"Sin cuadres cerrados para esta semana"}):o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[[" Kg Cosechados",y.toFixed(0)+" kg",P.green],[" Kg Empacados",j.toFixed(0)+" kg",P.accentLight],[" Cajas",b+" cajas",P.accentLight],[" Das cuadre",m.length+" da(s)",P.textSecondary]].map(([N,$,z])=>o.jsxs("div",{style:{padding:"10px 12px",background:P.surface,borderRadius:9,border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:N}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:z,fontFamily:"'DM Mono', monospace",marginTop:3},children:$})]},N))})]}),o.jsxs(tt,{children:[o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:[" Ingresos Sem. ",u," (Ventas)"]}),g.length===0?o.jsx("div",{style:{fontSize:13,color:P.textMuted},children:"Sin precios registrados para esta semana"}):o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[g.map(N=>{const $=Io[N.status],z=v>0&&x>0?v-x:null;return o.jsxs("div",{style:{padding:"10px 12px",background:P.surface,borderRadius:9,border:`1px solid ${P.border}`},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[o.jsxs("span",{style:{fontSize:12,color:P.textSecondary},children:[N.cliente,"  ",N.presentacion]}),o.jsx(kg,{text:`${$.emoji} ${$.label}`,color:$.color,bg:$.bg,border:$.border})]}),o.jsxs("div",{style:{display:"flex",gap:14},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:P.textMuted},children:"Rango estimado"}),o.jsx("div",{style:{fontSize:13,fontWeight:700,color:P.accentLight,fontFamily:"'DM Mono', monospace"},children:N.ingreso_estimado_min_usd?`${pr(N.ingreso_estimado_min_usd)}${pr(N.ingreso_estimado_max_usd)}`:`$${N.precio_estimado_min}$${N.precio_estimado_max}/caja`})]}),N.precio_real&&o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:P.textMuted},children:"Real"}),o.jsx("div",{style:{fontSize:13,fontWeight:700,color:P.green,fontFamily:"'DM Mono', monospace"},children:N.ingreso_real_usd?pr(N.ingreso_real_usd):`$${N.precio_real}/caja`})]})]}),z!==null&&x>0&&o.jsxs("div",{style:{marginTop:8,padding:"6px 10px",borderRadius:7,background:z>=0?P.greenDim:P.redDim,display:"flex",justifyContent:"space-between"},children:[o.jsx("span",{style:{fontSize:11,color:P.textMuted},children:"Margen bruto est. (mn)"}),o.jsxs("span",{style:{fontSize:12,fontWeight:700,color:z>=0?P.green:P.red,fontFamily:"'DM Mono', monospace"},children:[z>=0?"+":"",ze(z)," (",A==null?void 0:A.toFixed(1),"%)"]})]})]},N.id)}),C>0&&o.jsxs("div",{style:{padding:"8px 12px",background:P.greenDim,borderRadius:9,border:`1px solid ${P.greenBorder}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontSize:12,color:P.green},children:" Ingreso liquidado"}),o.jsx("span",{style:{fontSize:14,fontWeight:800,color:P.green,fontFamily:"'DM Mono', monospace"},children:ze(C)})]})]})]})]})]}),d.length>0&&o.jsxs(tt,{style:{marginTop:20},children:[o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:12},children:[" Detalle Gastos Sem. ",u,"/",c]}),o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Fecha","Categora","Descripcin","Proveedor","MXN","USD"].map(N=>o.jsx("th",{style:{textAlign:"left",padding:"7px 10px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase"},children:N},N))})}),o.jsx("tbody",{children:d.map(N=>{const $=N.monto_mxn??(N.monto_usd??0)*(N.tipo_cambio??n),z=N.monto_usd??(N.monto_mxn??0)/(N.tipo_cambio??n),T=Eu[N.categoria]??P.textSecondary;return o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`},children:[o.jsx("td",{style:{padding:"8px 10px",fontSize:12,color:P.textMuted},children:N.fecha}),o.jsx("td",{style:{padding:"8px 10px"},children:o.jsx("span",{style:{fontSize:11,fontWeight:700,color:T,background:T+"20",padding:"2px 8px",borderRadius:20},children:N.categoria})}),o.jsxs("td",{style:{padding:"8px 10px",fontSize:12,color:P.text},children:[N.descripcion,N.subcategoria&&o.jsxs("span",{style:{color:P.textMuted},children:["  ",N.subcategoria]})]}),o.jsx("td",{style:{padding:"8px 10px",fontSize:12,color:P.textMuted},children:N.proveedor??""}),o.jsxs("td",{style:{padding:"8px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.orange},children:["$",$.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("td",{style:{padding:"8px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.yellow},children:ze(z)})]},N.id)})})]})})]})]})}function Jie(){const{gastosOp:e,tipoCambio:t}=so(),[r,n]=h.useState("todo"),a=Ra(),i=h.useMemo(()=>{if(r==="todo")return e;const u=Ko(a),d=Nu(),f=parseInt(a.slice(5,7));return e.filter(p=>r==="semana"?p.semana_iso===u&&p.year_iso===d:r==="mes"?parseInt(p.fecha.slice(5,7))===f&&p.year_iso===d:!0)},[e,r,a]),s=h.useMemo(()=>qie(i,t),[i,t]),l=s.reduce((u,d)=>u+d.totalMXN,0),c=Math.max(...s.map(u=>u.totalMXN),1);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:8,marginBottom:20},children:[["semana","mes","todo"].map(u=>o.jsx("button",{onClick:()=>n(u),style:{padding:"8px 18px",borderRadius:9,border:`1.5px solid ${r===u?P.accent:P.border}`,background:r===u?P.accentDim:"transparent",color:r===u?P.accentLight:P.textSecondary,fontSize:13,fontWeight:600,cursor:"pointer"},children:u==="semana"?" Esta semana":u==="mes"?" Este mes":" Todo"},u)),o.jsxs("span",{style:{marginLeft:"auto",fontSize:12,color:P.textMuted,alignSelf:"center"},children:[i.length," registros"]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:12,marginBottom:20},children:[o.jsx(At,{emoji:"",label:"Total perodo",value:`$${(l/1e3).toFixed(1)}k`,sub:"MXN",color:P.orange}),o.jsx(At,{emoji:"",label:"En USD",value:ze(l/t),sub:`TC ${t.toFixed(2)}`,color:P.yellow}),o.jsx(At,{emoji:"",label:"Registros",value:i.length,color:P.accentLight}),o.jsx(At,{emoji:"",label:"Categoras activas",value:s.filter(u=>u.totalMXN>0).length,sub:`de ${Ks.length}`,color:P.textSecondary})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:20},children:" Distribucin de Costos"}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[s.map(({categoria:u,totalMXN:d,totalUSD:f,count:p})=>{const x=Eu[u],m=l>0?d/l*100:0;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5,alignItems:"baseline"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:600,color:x},children:u}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("span",{style:{fontSize:13,fontFamily:"'DM Mono', monospace",color:P.text},children:["$",d.toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})]}),o.jsxs("span",{style:{fontSize:11,color:P.textMuted,marginLeft:6},children:[m.toFixed(1),"%"]})]})]}),o.jsx(Pu,{value:d,max:c,color:x}),o.jsxs("div",{style:{fontSize:11,color:P.textMuted,marginTop:3,display:"flex",justifyContent:"space-between"},children:[o.jsxs("span",{children:[p," registro(s)"]}),o.jsx("span",{children:ze(f)})]})]},u)}),o.jsxs("div",{style:{borderTop:`2px solid ${P.border}`,paddingTop:12,display:"flex",justifyContent:"space-between"},children:[o.jsx("span",{style:{fontSize:14,fontWeight:700,color:P.text},children:"Total MXN"}),o.jsxs("span",{style:{fontSize:15,fontWeight:800,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["$",l.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:16},children:" Detalle por Categora"}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[s.filter(u=>u.totalMXN>0).map(({categoria:u,totalMXN:d,count:f})=>{const p=Eu[u],x={};return i.filter(m=>m.categoria===u).forEach(m=>{const y=m.subcategoria??"General";x[y]=(x[y]??0)+(m.monto_mxn??(m.monto_usd??0)*(m.tipo_cambio??t))}),o.jsxs("div",{style:{padding:"12px 14px",background:P.surface,borderRadius:10,border:`1px solid ${P.border}`},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[o.jsx("span",{style:{fontSize:13,fontWeight:700,color:p},children:u}),o.jsxs("span",{style:{fontSize:12,fontFamily:"'DM Mono', monospace",fontWeight:700,color:P.text},children:["$",d.toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),Object.entries(x).map(([m,y])=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,color:P.textMuted,padding:"2px 0"},children:[o.jsxs("span",{children:[" ",m]}),o.jsxs("span",{style:{fontFamily:"'DM Mono', monospace"},children:["$",y.toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})]})]},m)),o.jsxs("div",{style:{fontSize:11,color:P.textMuted,marginTop:5},children:[f," registro(s)"]})]},u)}),s.every(u=>u.totalMXN===0)&&o.jsx("div",{style:{textAlign:"center",padding:30,color:P.textMuted},children:"Sin gastos en este perodo"})]})]})]})]})}function Zie(){const[e,t]=h.useState("registro");return o.jsxs("div",{children:[o.jsx(Cg,{tabs:[{key:"registro",emoji:"",label:"Registro"},{key:"semana",emoji:"",label:"Por Semana"},{key:"categoria",emoji:"",label:"Por Categora"}],active:e,onSelect:t}),e==="registro"&&o.jsx(Xie,{}),e==="semana"&&o.jsx(Yie,{}),e==="categoria"&&o.jsx(Jie,{})]})}function Qie({semanas:e,loading:t}){const{tipoCambio:r}=so(),n=e.reduce((g,v)=>g+v.ingReal,0),a=e.reduce((g,v)=>g+v.ingEstMin,0),i=e.reduce((g,v)=>g+v.costoUSD,0),s=e.reduce((g,v)=>g+v.costoMXN,0),l=n>0?n:a,c=l-i,u=l>0?c/l*100:null,d=e.reduce((g,v)=>g+v.kgCosechados,0),f=e.reduce((g,v)=>g+(v.cajasVendidas||v.cajasEmpaque),0),p=d>0?s/d:null,x=f>0?i/f:null,m=e.length>0?e.reduce((g,v)=>g+v.mermaPct,0)/e.length:null,y=e.slice(-16),j=Math.max(...y.map(g=>Math.max(g.ingEstMin,g.ingReal,g.costoUSD)),1),b=g=>({padding:"14px 16px",background:P.card,borderRadius:12,border:`1px solid ${P.border}`});return t?o.jsx("div",{style:{textAlign:"center",padding:"60px",color:P.textMuted},children:"Calculando"}):o.jsxs("div",{children:[o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(155px, 1fr))",gap:12,marginBottom:22},children:[{emoji:"",label:"Cobrado",val:ze(n),sub:"liquidado confirmado",color:P.green},{emoji:"",label:"Estimado",val:pr(a),sub:"por liquidar (mn)",color:P.yellow},{emoji:"",label:"Costos",val:s>0?`$${(s/1e3).toFixed(1)}k MXN`:"",sub:i>0?ze(i):"sin registros",color:P.orange},{emoji:c>=0?"":"",label:"Margen bruto",val:u!=null?`${u.toFixed(1)}%`:"",sub:c!==0?(c>=0?"+":"")+ze(c):"",color:c>=0?P.green:P.red},{emoji:"",label:"Costo / kg",val:p?`$${p.toFixed(2)}`:"",sub:"MXN por kg cosechado",color:P.yellow},{emoji:"",label:"Costo / caja",val:x?ze(x):"",sub:"USD por caja vendida",color:P.yellow},{emoji:"",label:"Merma prom.",val:m!=null?`${m.toFixed(1)}%`:"",sub:"promedio del perodo",color:m!=null&&m>8?P.red:P.textSecondary},{emoji:"",label:"Semanas",val:String(e.length),sub:"con datos en el perodo",color:P.accentLight}].map(g=>o.jsxs("div",{style:b(g.color),children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:P.textMuted,letterSpacing:.5,marginBottom:6},children:[g.emoji," ",g.label.toUpperCase()]}),o.jsx("div",{style:{fontSize:20,fontWeight:800,color:g.color,fontFamily:"'DM Mono', monospace"},children:g.val}),o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginTop:3},children:g.sub})]},g.label))}),y.length>0?o.jsxs(tt,{style:{marginBottom:18},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:6},children:" Ingresos vs Costos  Semana a Semana"}),o.jsx("div",{style:{display:"flex",gap:18,marginBottom:18,flexWrap:"wrap"},children:[{color:P.accentLight,label:"Ingreso estimado"},{color:P.green,label:"Ingreso real (liquidado)"},{color:P.orange,label:"Costo total USD"}].map(g=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("div",{style:{width:10,height:10,borderRadius:3,background:g.color}}),o.jsx("span",{style:{fontSize:12,color:P.textMuted},children:g.label})]},g.label))}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:14},children:y.map(g=>{const v=g.ingEstMin/j*100,w=g.ingReal/j*100,C=g.costoUSD/j*100,k=g.margenUSD>=0;return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4,alignItems:"baseline"},children:[o.jsxs("span",{style:{fontSize:12,fontWeight:700,color:P.textSecondary,minWidth:80},children:["S",g.semana,"/",g.year]}),o.jsxs("div",{style:{display:"flex",gap:14},children:[g.ingReal>0&&o.jsxs("span",{style:{fontSize:11,color:P.green,fontFamily:"'DM Mono', monospace"},children:[" ",ze(g.ingReal)]}),g.ingEstMin>0&&g.ingReal===0&&o.jsxs("span",{style:{fontSize:11,color:P.accentLight,fontFamily:"'DM Mono', monospace"},children:["~",ze(g.ingEstMin)]}),g.costoUSD>0&&o.jsxs("span",{style:{fontSize:11,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["-",ze(g.costoUSD)]}),g.margenPct!=null&&o.jsxs("span",{style:{fontSize:11,fontWeight:700,color:k?P.green:P.red,fontFamily:"'DM Mono', monospace"},children:[k?"+":"",g.margenPct.toFixed(0),"%"]})]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3},children:[g.ingEstMin>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("div",{style:{width:6,flexShrink:0,fontSize:9,color:P.textMuted,textAlign:"right"},children:"E"}),o.jsx("div",{style:{flex:1,height:8,background:P.surface,borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{width:`${v}%`,height:"100%",background:P.accentLight+"aa",borderRadius:3,transition:"width .5s"}})})]}),g.ingReal>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("div",{style:{width:6,flexShrink:0,fontSize:9,color:P.textMuted,textAlign:"right"},children:"R"}),o.jsx("div",{style:{flex:1,height:8,background:P.surface,borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{width:`${w}%`,height:"100%",background:P.green,borderRadius:3,transition:"width .5s"}})})]}),g.costoUSD>0&&o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsx("div",{style:{width:6,flexShrink:0,fontSize:9,color:P.textMuted,textAlign:"right"},children:"C"}),o.jsx("div",{style:{flex:1,height:8,background:P.surface,borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{width:`${C}%`,height:"100%",background:P.orange+"cc",borderRadius:3,transition:"width .5s"}})})]})]})]},g.key)})}),e.length>16&&o.jsx("div",{style:{marginTop:12,fontSize:12,color:P.textMuted,textAlign:"center"},children:"Mostrando las ltimas 16 semanas del perodo. Cambia el perodo para ver ms detalle."})]}):o.jsx(tt,{children:o.jsx("div",{style:{textAlign:"center",padding:"50px",color:P.textMuted},children:"Sin datos en este perodo. Registra cuadres (F1), precios de venta (F2) y gastos (F3) para ver la grfica."})}),e.length>0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:14},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:13,fontWeight:700,color:P.textSecondary,marginBottom:10},children:" Salud Financiera"}),[{label:"Margen bruto",val:u,umbralOk:20,umbralWarn:10,unit:"%",fmt:g=>`${g.toFixed(1)}%`},{label:"Merma promedio",val:m,umbralOk:5,umbralWarn:10,invert:!0,unit:"%",fmt:g=>`${g.toFixed(1)}%`}].map(({label:g,val:v,umbralOk:w,umbralWarn:C,invert:k,fmt:S})=>{if(v==null)return null;const _=k?v<=w:v>=w,A=k?v<=C:v>=C,E=_?P.green:A?P.yellow:P.red,N=_?"":A?"":"";return o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:`1px solid ${P.border}`},children:[o.jsxs("span",{style:{fontSize:13,color:P.textSecondary},children:[N," ",g]}),o.jsx("span",{style:{fontSize:15,fontWeight:800,color:E,fontFamily:"'DM Mono', monospace"},children:S(v)})]},g)})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:13,fontWeight:700,color:P.textSecondary,marginBottom:10},children:" Totales del Perodo"}),[{label:"Kg cosechados",val:`${d.toLocaleString("es-MX",{maximumFractionDigits:0})} kg`,color:P.green},{label:"Cajas (vend/emp)",val:f.toLocaleString(),color:P.accentLight},{label:"Costos totales MXN",val:`$${s.toLocaleString("es-MX",{maximumFractionDigits:0})}`,color:P.orange},{label:"Tipo de cambio",val:`${r.toFixed(2)} MXN/USD`,color:P.textSecondary}].map(({label:g,val:v,color:w})=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"7px 0",borderBottom:`1px solid ${P.border}`},children:[o.jsx("span",{style:{fontSize:12,color:P.textMuted},children:g}),o.jsx("span",{style:{fontSize:13,fontWeight:700,color:w,fontFamily:"'DM Mono', monospace"},children:v})]},g))]})]})]})}function ese({semanas:e}){const{tipoCambio:t}=so(),r=e.reduce((g,v)=>g+v.ingReal,0),n=e.reduce((g,v)=>g+v.ingEstMin,0),a=e.reduce((g,v)=>g+v.costoNominaMXN,0)/t,i=e.reduce((g,v)=>g+v.costoInsumosMXN,0)/t,s=e.reduce((g,v)=>g+v.costoLogisticaMXN,0)/t,l=a+i+s,c=e.reduce((g,v)=>g+v.costoMXN,0),u=r+n,d=r-(a+i),f=u-l,p=r>0?d/r*100:null,x=u>0?f/u*100:null,m=e.reduce((g,v)=>g+v.kgCosechados,0),y=e.reduce((g,v)=>g+(v.cajasVendidas||v.cajasEmpaque),0),j=[{label:"Ingresos Liquidados (USD)",val:r,color:P.green,bold:!1},{label:"+ Ingresos Estimados pendientes (USD)",val:n,color:P.yellow},{label:"= TOTAL INGRESOS",val:u,color:P.accentLight,bold:!0,sep:!0,isSubtotal:!0},{label:" Nmina Cosecha + Empaque (MXNUSD)",val:-a,color:P.red,indent:!0},{label:" Insumos Campo + Materiales (MXNUSD)",val:-i,color:P.orange,indent:!0},{label:"= UTILIDAD BRUTA REAL",val:d,color:d>=0?P.green:P.red,bold:!0,sep:!0,isSubtotal:!0},{label:" Logstica / Exportacin (MXNUSD)",val:-s,color:P.purple,indent:!0},{label:"= EBITDA ESTIMADO",val:f,color:f>=0?P.green:P.red,bold:!0,sep:!0,isSubtotal:!0}],b=Math.max(...j.filter(g=>!g.isSubtotal).map(g=>Math.abs(g.val)),1);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:20},children:" Estado de Resultados"}),j.map((g,v)=>{const w=g.isSubtotal?0:Math.abs(g.val)/b*80,C=g.val<0;return o.jsxs("div",{style:{paddingTop:g.sep?12:0,marginTop:g.sep?8:0,borderTop:g.sep?`2px solid ${P.border}`:void 0,paddingBottom:10},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:g.isSubtotal?0:5},children:[o.jsx("span",{style:{fontSize:g.bold?14:12,fontWeight:g.bold?800:400,color:g.bold?g.color:P.textMuted,paddingLeft:g.indent?16:0},children:g.label}),o.jsx("span",{style:{fontSize:g.bold?16:13,fontWeight:g.bold?800:600,color:g.color,fontFamily:"'DM Mono', monospace"},children:g.val===0?"":(C?"-":"+")+ze(Math.abs(g.val))})]}),!g.isSubtotal&&Math.abs(g.val)>0&&o.jsx("div",{style:{height:6,background:P.surface,borderRadius:3,overflow:"hidden",marginLeft:g.indent?16:0},children:o.jsx("div",{style:{width:`${w}%`,height:"100%",background:g.color+(C?"bb":"99"),borderRadius:3}})}),g.isSubtotal&&g.label.includes("EBITDA")&&x!=null&&o.jsxs("div",{style:{display:"flex",gap:20,marginTop:8},children:[o.jsxs("div",{style:{padding:"8px 14px",borderRadius:8,background:f>=0?P.greenDim:P.redDim,border:`1px solid ${f>=0?P.greenBorder:P.redBorder}`,flex:1,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"Margen EBITDA"}),o.jsxs("div",{style:{fontSize:20,fontWeight:800,color:f>=0?P.green:P.red,fontFamily:"'DM Mono', monospace"},children:[x.toFixed(1),"%"]})]}),p!=null&&o.jsxs("div",{style:{padding:"8px 14px",borderRadius:8,background:p>=0?P.greenDim:P.redDim,border:`1px solid ${p>=0?P.greenBorder:P.redBorder}`,flex:1,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted},children:"Margen Bruto (liq)"}),o.jsxs("div",{style:{fontSize:20,fontWeight:800,color:p>=0?P.green:P.red,fontFamily:"'DM Mono', monospace"},children:[p.toFixed(1),"%"]})]})]})]},v)})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Estructura de Costos"}),[{label:"Nmina (Cosecha + Empaque)",mxn:a*t,usd:a,color:P.red},{label:"Insumos + Materiales",mxn:i*t,usd:i,color:P.orange},{label:"Logstica + Overhead",mxn:s*t,usd:s,color:P.purple}].map(({label:g,mxn:v,usd:w,color:C})=>{const k=c>0?v/c*100:0;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[o.jsx("span",{style:{fontSize:12,fontWeight:600,color:C},children:g}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("span",{style:{fontSize:12,fontFamily:"'DM Mono', monospace",color:P.text},children:["$",v.toLocaleString("es-MX",{maximumFractionDigits:0})]}),o.jsxs("span",{style:{fontSize:10,color:P.textMuted,marginLeft:6},children:[k.toFixed(0),"%"]})]})]}),o.jsx(Pu,{value:v,max:c,color:C}),o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginTop:2,textAlign:"right"},children:ze(w)})]},g)}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:10,borderTop:`2px solid ${P.border}`},children:[o.jsx("span",{style:{fontSize:13,fontWeight:700,color:P.text},children:"Total MXN"}),o.jsxs("span",{style:{fontSize:15,fontWeight:800,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["$",c.toLocaleString("es-MX",{maximumFractionDigits:0})," ",o.jsxs("span",{style:{fontSize:11,fontWeight:400,color:P.textMuted},children:["= ",ze(l)]})]})]})]}),o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Mtricas Unitarias"}),[{label:"Costo por kg cosechado",val:m>0?`$${(c/m).toFixed(2)} MXN`:"",sub:`${m.toFixed(0)} kg en perodo`},{label:"Costo por caja vendida",val:y>0?ze(l/y):"",sub:`${y} cajas`},{label:"Ingreso por caja (liq.)",val:r>0&&y>0?ze(r/y):"",sub:"solo liquidaciones"},{label:"Margen neto por caja",val:(r>0||n>0)&&y>0?ze((u-l)/y):"",sub:"ingreso - costo"}].map(({label:g,val:v,sub:w})=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",padding:"9px 0",borderBottom:`1px solid ${P.border}22`},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:12,color:P.textMuted},children:g}),o.jsx("div",{style:{fontSize:11,color:P.textMuted,opacity:.6},children:w})]}),o.jsx("span",{style:{fontSize:15,fontWeight:700,color:P.accentLight,fontFamily:"'DM Mono', monospace"},children:v})]},g))]})]})]})}function tse({semanas:e}){const[t,r]=h.useState("key"),[n,a]=h.useState(!1),i=h.useMemo(()=>[...e].sort((c,u)=>{const d=c[t]??0,f=u[t]??0;return n?d>f?1:-1:d<f?1:-1}),[e,t,n]),s=[{key:"key",label:"Semana",fmt:c=>`S${c.semana}/${c.year}`},{key:"kgCosechados",label:"Kg Cos.",fmt:c=>c.kgCosechados>0?c.kgCosechados.toFixed(0):""},{key:"kgMerma",label:"Kg Merma",fmt:c=>c.kgMerma>0?c.kgMerma.toFixed(0):"",color:c=>c.mermaPct>10?P.red:c.mermaPct>5?P.yellow:P.textMuted},{key:"mermaPct",label:"Merma %",fmt:c=>c.kgCosechados>0?c.mermaPct.toFixed(1)+"%":"",color:c=>c.mermaPct>10?P.red:c.mermaPct>5?P.yellow:P.green},{key:"cajasVendidas",label:"Cajas Vend.",fmt:c=>c.cajasVendidas>0?String(c.cajasVendidas):c.cajasEmpaque>0?`~${c.cajasEmpaque}`:""},{key:"ingReal",label:"Ing. Real",fmt:c=>c.ingReal>0?ze(c.ingReal):"",color:()=>P.green},{key:"ingEstMin",label:"Ing. Est.",fmt:c=>c.ingEstMin>0?ze(c.ingEstMin):"",color:()=>P.accentLight},{key:"costoUSD",label:"Costo USD",fmt:c=>c.costoUSD>0?ze(c.costoUSD):"",color:()=>P.orange},{key:"costoKg",label:"$/kg MXN",fmt:c=>c.costoKg?`$${c.costoKg.toFixed(2)}`:"",color:c=>(c.costoKg??0)>30?P.red:(c.costoKg??0)>20?P.yellow:P.textSecondary},{key:"costoCaja",label:"$/caja",fmt:c=>c.costoCaja?ze(c.costoCaja):"",color:()=>P.yellow},{key:"precioPromReal",label:"Precio prom.",fmt:c=>c.precioPromReal?ze(c.precioPromReal):c.precioPromEst>0?`~${ze(c.precioPromEst)}`:"",color:c=>c.precioPromReal?P.green:P.textMuted},{key:"margenPct",label:"Margen %",fmt:c=>c.margenPct!=null?`${c.margenPct.toFixed(1)}%`:"",color:c=>(c.margenPct??0)>=20?P.green:(c.margenPct??0)>=10?P.yellow:P.red}],l=c=>{c===t?a(!n):(r(c),a(!1))};return o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:6},children:" Eficiencia por Semana"}),o.jsx("div",{style:{fontSize:12,color:P.textMuted,marginBottom:16},children:"Click en columna para ordenar  Cruza datos de cuadres (F1), ventas (F2) y gastos (F3)"}),e.length===0?o.jsx("div",{style:{textAlign:"center",padding:"40px",color:P.textMuted},children:"Sin datos en el perodo seleccionado"}):o.jsx("div",{style:{overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:s.map(c=>o.jsxs("th",{onClick:()=>l(c.key),style:{textAlign:"left",padding:"8px 10px",fontSize:11,fontWeight:700,color:t===c.key?P.accentLight:P.textMuted,textTransform:"uppercase",letterSpacing:.5,cursor:"pointer",whiteSpace:"nowrap"},children:[c.label,t===c.key?n?" ":" ":""]},c.key))})}),o.jsx("tbody",{children:i.map(c=>o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}22`},children:s.map(u=>o.jsx("td",{style:{padding:"9px 10px",fontFamily:u.key==="key"?"inherit":"'DM Mono', monospace",fontSize:12,fontWeight:u.key==="key"?700:400,color:u.color?u.color(c):P.text,whiteSpace:"nowrap"},children:u.fmt(c)},u.key))},c.key))}),o.jsx("tfoot",{children:o.jsxs("tr",{style:{borderTop:`2px solid ${P.border}`,background:P.surface},children:[o.jsx("td",{style:{padding:"9px 10px",fontSize:12,fontWeight:700,color:P.textSecondary},children:"TOTAL / PROM."}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.green},children:e.reduce((c,u)=>c+u.kgCosechados,0).toFixed(0)}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.orange},children:e.reduce((c,u)=>c+u.kgMerma,0).toFixed(0)}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.yellow},children:e.length>0?(e.reduce((c,u)=>c+u.mermaPct,0)/e.length).toFixed(1)+"%":""}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12},children:e.reduce((c,u)=>c+u.cajasVendidas,0)}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.green,fontWeight:700},children:ze(e.reduce((c,u)=>c+u.ingReal,0))}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.accentLight},children:ze(e.reduce((c,u)=>c+u.ingEstMin,0))}),o.jsx("td",{style:{padding:"9px 10px",fontFamily:"'DM Mono', monospace",fontSize:12,color:P.orange,fontWeight:700},children:ze(e.reduce((c,u)=>c+u.costoUSD,0))}),o.jsx("td",{colSpan:4,style:{padding:"9px 10px",fontSize:11,color:P.textMuted},children:""})]})})]})})]})}function rse({semanas:e,periodo:t,tipoCambio:r}){const[n,a]=h.useState(!1),i=()=>{Vie(e,r,t),a(!0),setTimeout(()=>a(!1),3e3)},s=e.reduce((u,d)=>u+d.ingReal,0),l=e.reduce((u,d)=>u+d.costoMXN,0),c=["Semana / Ao","Kg cosechados, Kg empacados, Kg merma, Merma %","Cajas empaque, Cajas vendidas","Ingreso estimado mn/mx USD, Ingreso real USD","Precio promedio real y estimado USD/caja","Costo total MXN y USD","Costo nmina, insumos y logstica MXN (separados)","Costo por kg MXN, Costo por caja USD","Margen bruto USD y %","Tipo de cambio utilizado"];return o.jsxs("div",{style:{maxWidth:700},children:[o.jsxs(tt,{style:{marginBottom:20},children:[o.jsx("div",{style:{fontSize:15,fontWeight:700,color:P.text,marginBottom:16},children:" Exportar a CSV"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:20},children:[o.jsxs("div",{style:{padding:"14px 16px",background:P.surface,borderRadius:10,border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginBottom:4},children:"PERODO SELECCIONADO"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:P.accentLight},children:FI[t]})]}),o.jsxs("div",{style:{padding:"14px 16px",background:P.surface,borderRadius:10,border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginBottom:4},children:"SEMANAS EN EL ARCHIVO"}),o.jsxs("div",{style:{fontSize:16,fontWeight:700,color:P.text},children:[e.length," semanas"]})]}),o.jsxs("div",{style:{padding:"14px 16px",background:P.surface,borderRadius:10,border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginBottom:4},children:"INGRESOS REALES"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:P.green,fontFamily:"'DM Mono', monospace"},children:ze(s)})]}),o.jsxs("div",{style:{padding:"14px 16px",background:P.surface,borderRadius:10,border:`1px solid ${P.border}`},children:[o.jsx("div",{style:{fontSize:11,color:P.textMuted,marginBottom:4},children:"COSTOS TOTALES"}),o.jsxs("div",{style:{fontSize:16,fontWeight:700,color:P.orange,fontFamily:"'DM Mono', monospace"},children:["$",l.toLocaleString("es-MX",{maximumFractionDigits:0})," MXN"]})]})]}),o.jsxs("div",{style:{marginBottom:20},children:[o.jsx("div",{style:{fontSize:13,fontWeight:700,color:P.textSecondary,marginBottom:10},children:" Campos incluidos en el CSV"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:c.map((u,d)=>o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:P.accent,flexShrink:0}}),o.jsx("span",{style:{fontSize:13,color:P.textMuted},children:u})]},d))})]}),e.length===0?o.jsx("div",{style:{padding:"16px",background:P.yellowDim,borderRadius:9,border:`1px solid ${P.yellowBorder}`,fontSize:13,color:P.yellow},children:" No hay datos en el perodo seleccionado. Cambia el selector de perodo para exportar datos."}):o.jsx(Zn,{onClick:i,variant:n?"success":"primary",children:n?" Descargado":` Descargar CSV  ${e.length} semanas`}),o.jsxs("div",{style:{marginTop:10,fontSize:11,color:P.textMuted},children:["Formato: UTF-8 con BOM  Compatible con Excel, Google Sheets, Nmeros  Nombre: moray_resultados_",t,"_",new Date().toISOString().slice(0,10),".csv"]})]}),e.length>0&&o.jsxs(tt,{children:[o.jsx("div",{style:{fontSize:14,fontWeight:700,color:P.text,marginBottom:14},children:" Vista previa (primeras 5 filas)"}),o.jsxs("div",{style:{overflowX:"auto"},children:[o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[o.jsx("thead",{children:o.jsx("tr",{style:{borderBottom:`1px solid ${P.border}`},children:["Semana","Kg Cos.","Cajas Vend.","Ing. Est. USD","Ing. Real USD","Costo USD","Margen %"].map(u=>o.jsx("th",{style:{textAlign:"left",padding:"6px 10px",fontSize:11,fontWeight:700,color:P.textMuted,textTransform:"uppercase"},children:u},u))})}),o.jsx("tbody",{children:e.slice(0,5).map(u=>o.jsxs("tr",{style:{borderBottom:`1px solid ${P.border}22`},children:[o.jsxs("td",{style:{padding:"7px 10px",fontWeight:700},children:["S",u.semana,"/",u.year]}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace",color:P.green},children:u.kgCosechados>0?u.kgCosechados.toFixed(0):""}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace"},children:u.cajasVendidas||u.cajasEmpaque||""}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace",color:P.accentLight},children:u.ingEstMin>0?ze(u.ingEstMin):""}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace",color:P.green,fontWeight:u.ingReal>0?700:400},children:u.ingReal>0?ze(u.ingReal):""}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace",color:P.orange},children:u.costoUSD>0?ze(u.costoUSD):""}),o.jsx("td",{style:{padding:"7px 10px",fontFamily:"'DM Mono', monospace",fontWeight:700,color:(u.margenPct??0)>=0?P.green:P.red},children:u.margenPct!=null?u.margenPct.toFixed(1)+"%":""})]},u.key))})]}),e.length>5&&o.jsxs("div",{style:{textAlign:"center",padding:"10px",fontSize:12,color:P.textMuted},children:[" y ",e.length-5," filas ms en el archivo completo"]})]})]})]})}function nse(){const[e,t]=h.useState("resumen"),[r,n]=h.useState("ultimas_12"),{semanasPrecio:a,cuadres:i,gastosOp:s,tipoCambio:l,loading:c}=so(),u=Ra(),d=h.useMemo(()=>Gie(a,i,s,l),[a,i,s,l]),f=h.useMemo(()=>Kie(d,r,u),[d,r,u]);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:8,marginBottom:20,alignItems:"center",flexWrap:"wrap"},children:[o.jsx("span",{style:{fontSize:12,color:P.textMuted,fontWeight:600},children:"PERODO:"}),Object.entries(FI).map(([p,x])=>o.jsx("button",{onClick:()=>n(p),style:{padding:"7px 14px",borderRadius:9,cursor:"pointer",border:`1.5px solid ${r===p?P.accent:P.border}`,background:r===p?P.accentDim:"transparent",color:r===p?P.accentLight:P.textSecondary,fontSize:12,fontWeight:600},children:x},p)),o.jsxs("span",{style:{marginLeft:8,fontSize:12,color:P.textMuted},children:[f.length," semana",f.length!==1?"s":""]})]}),o.jsx(Cg,{tabs:[{key:"resumen",emoji:"",label:"Resumen"},{key:"pl",emoji:"",label:"P&L"},{key:"eficiencia",emoji:"",label:"Eficiencia"},{key:"exportar",emoji:"",label:"Exportar"}],active:e,onSelect:t}),e==="resumen"&&o.jsx(Qie,{semanas:f,loading:c}),e==="pl"&&o.jsx(ese,{semanas:f}),e==="eficiencia"&&o.jsx(tse,{semanas:f}),e==="exportar"&&o.jsx(rse,{semanas:f,periodo:r,tipoCambio:l})]})}function ose(){const[e,t]=h.useState("cuadre"),{loading:r}=so();return o.jsx("div",{style:{minHeight:"100vh",background:P.bg,padding:"32px 24px",fontFamily:"'Inter', system-ui, sans-serif"},children:o.jsxs("div",{style:{maxWidth:1340,margin:"0 auto"},children:[o.jsxs("div",{style:{marginBottom:24},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("h1",{style:{margin:0,fontSize:26,fontWeight:800,color:P.text},children:" Finanzas"}),r&&o.jsx("span",{style:{fontSize:12,color:P.textMuted,background:P.surface,padding:"3px 10px",borderRadius:20,border:`1px solid ${P.border}`},children:"Actualizando"})]}),o.jsx("p",{style:{margin:"5px 0 0",color:P.textMuted,fontSize:13},children:"Cuadre operativo  Tabulador FOB  Cobranza  Flujo de caja  Costos  P&L"})]}),o.jsx(Cg,{tabs:[{key:"cuadre",emoji:"",label:"Cuadre Diario"},{key:"ventas",emoji:"",label:"Ventas"},{key:"costos",emoji:"",label:"Costos"},{key:"resultados",emoji:"",label:"Resultados"}],active:e,onSelect:t}),e==="cuadre"&&o.jsx(Rie,{}),e==="ventas"&&o.jsx(Wie,{}),e==="costos"&&o.jsx(Zie,{}),e==="resultados"&&o.jsx(nse,{})]})})}function ase(){return o.jsx(Iie,{children:o.jsx(ose,{})})}function ise({almacenId:e,semanas:t,diasAlertaAnticipacion:r=3}){const[n,a]=h.useState([]),[i,s]=h.useState([]),[l,c]=h.useState([]),[u,d]=h.useState([]),[f,p]=h.useState(!0),[x,m]=h.useState(null),y=h.useCallback(async()=>{if(e){p(!0),m(null);try{let C=se.from("fum_programa").select("*, responsable:Users!fum_programa_responsable_id_fkey(name)").eq("almacen_id",e).order("fecha",{ascending:!0}).order("variedad",{ascending:!0});t!=null&&t.length&&(C=C.in("semana",t));const[{data:k,error:S},{data:_,error:A},{data:E,error:N}]=await Promise.all([C,se.from("Productos Moray").select("id, Nombre, categoria, unidad, dosis_ref_200l, costo_unitario, activo").eq("activo",!0).order("Nombre"),se.from("inventario_items").select("id, nombre, stock_actual, unidad, almacen_id").eq("almacen_id",e)]);if(S)throw S;if(A)throw A;if(N)throw N;const $=(_||[]).map(H=>({id:H.id,Nombre:H.Nombre,categoria:H.categoria||"Otro",unidad:H.unidad||"mL",dosis_ref_200l:H.dosis_ref_200l,costo_unitario:H.costo_unitario||0,activo:H.activo??!0})),z=(E||[]).map(H=>({id:H.id,nombre:H.nombre,stock_actual:H.stock_actual||0,unidad:H.unidad||"",almacen_id:H.almacen_id})),T=(k||[]).map(H=>{const B=$.find(V=>V.Nombre.toLowerCase()===H.producto_nombre.toLowerCase()),K=z.find(V=>V.nombre.toLowerCase()===H.producto_nombre.toLowerCase()),Z=H.dosis_200l*H.tambos/1e3,he=(K==null?void 0:K.stock_actual)??0,re=K!==void 0,X=Math.max(0,Z-he);return{...H,total_producto:Math.round(Z*1e3)/1e3,stock_inventario:he,inventario_vinculado:re,necesidad:Math.round(X*1e3)/1e3,costo_estimado:Math.round(Z*((B==null?void 0:B.costo_unitario)??0)*100)/100,costo_unitario:(B==null?void 0:B.costo_unitario)??0,unidad_producto:(B==null?void 0:B.unidad)??"mL",categoria_producto:(B==null?void 0:B.categoria)??"Otro"}}),I=new Date,L=new Date(I);L.setDate(L.getDate()+r);const D=I.toISOString().split("T")[0],O=L.toISOString().split("T")[0],F=T.filter(H=>H.fecha>=D&&H.fecha<=O&&H.estatus==="programada"),q={};for(const H of F)H.necesidad>0&&(q[H.producto_nombre]||(q[H.producto_nombre]={necesidad:0,fechas:[],stock:H.stock_inventario,unidad:H.unidad_producto}),q[H.producto_nombre].necesidad+=H.necesidad,q[H.producto_nombre].fechas.includes(H.fecha)||q[H.producto_nombre].fechas.push(H.fecha));const te=Object.entries(q).map(([H,B])=>({producto_nombre:H,necesidad_total:Math.round(B.necesidad*1e3)/1e3,stock_actual:B.stock,deficit:Math.round(B.necesidad*1e3)/1e3,unidad:B.unidad,fechas_afectadas:B.fechas}));a(T),s($),c(z),d(te)}catch(C){console.error("useFumigacionPrograma error:",C),m(C.message||"Error cargando programa")}finally{p(!1)}}},[e,t==null?void 0:t.join(","),r]);return h.useEffect(()=>{y()},[y]),{programa:n,productos:i,inventario:l,alertas:u,loading:f,error:x,refresh:y,crearEntrada:async C=>{const{error:k}=await se.from("fum_programa").insert(C);if(k)throw k;await y()},actualizarEntrada:async(C,k)=>{const{error:S}=await se.from("fum_programa").update(k).eq("id",C);if(S)throw S;await y()},eliminarEntrada:async C=>{const{error:k}=await se.from("fum_programa").delete().eq("id",C);if(k)throw k;await y()},eliminarVarios:async C=>{if(C.length===0)return;const{error:k}=await se.from("fum_programa").delete().in("id",C);if(k)throw k;await y()},actualizarEstatusVarios:async(C,k)=>{if(C.length===0)return;const{error:S}=await se.from("fum_programa").update({estatus:k}).in("id",C);if(S)throw S;await y()}}}function sse({almacenId:e,limit:t=50}){const[r,n]=h.useState([]),[a,i]=h.useState([]),[s,l]=h.useState(!0),[c,u]=h.useState(null),d=h.useCallback(async()=>{if(e){l(!0),u(null);try{const[{data:y,error:j},{data:b,error:g}]=await Promise.all([se.from("fum_aplicaciones").select(`
              *,
              responsable:Users!fum_aplicaciones_responsable_id_fkey(name),
              productos:fum_aplicacion_prods(*),
              docs:fum_aplicacion_docs(*),
              fumigadores:fum_fumigadores_dia(*, personal:"Personal Moray"("ID", "Nombre", "Categoria"))
            `).eq("almacen_id",e).order("fecha_inicio",{ascending:!1}).limit(t),se.from("Personal Moray").select('"ID", "Nombre", "Categoria", "Estado"').in("Categoria",["Fumigacin","Labores"]).eq("Estado","Activo").order("Nombre")]);if(j)throw j;if(g)throw g;n(y||[]),i((b||[]).map(v=>({ID:v.ID,Nombre:v.Nombre,Categoria:v.Categoria,Estado:v.Estado})))}catch(y){console.error("useFumigacionAplicaciones error:",y),u(y.message||"Error cargando aplicaciones")}finally{l(!1)}}},[e,t]);return h.useEffect(()=>{d()},[d]),{aplicaciones:r,personal:a,loading:s,error:c,refresh:d,crearAplicacion:async y=>{const{data:j,error:b}=await se.from("fum_aplicaciones").insert(y).select().single();if(b)throw b;return await d(),j},actualizarAplicacion:async(y,j)=>{const{error:b}=await se.from("fum_aplicaciones").update(j).eq("id",y);if(b)throw b;await d()},actualizarChecklist:async(y,j)=>{const{error:b}=await se.from("fum_aplicaciones").update(j).eq("id",y);if(b)throw b;n(g=>g.map(v=>v.id===y?{...v,...j}:v))},guardarFumigadores:async(y,j)=>{const b=j.map(v=>({aplicacion_id:y,personal_id:v.personal_id,fecha:v.fecha,tambos_realizados:v.tambos_realizados,sectores:v.sectores||[]})),{error:g}=await se.from("fum_fumigadores_dia").upsert(b,{onConflict:"aplicacion_id,personal_id"});if(g)throw g;await d()}}}const Co={BILOXI:{color:"#15803D",sectores:["1A","1B","1C","1D","1E","2A","2B"]},"AZRA 3S Y 5S":{color:"#7C3AED",sectores:["3A","3B","3C","5A","5B","5C"]},"AZRA 4S":{color:"#0D9488",sectores:["4A","4B","4C"]},"AZRA 6S Y 7S":{color:"#DC2626",sectores:["6A","6B","6C","6D","7A","7B","7C","7D","7E"]},GENERAL:{color:"#4B5563",sectores:[]},MAX:{color:"#1F2937",sectores:["2C","2D","2E"]}},cw={DRENCH:{color:"#7C3AED"},FOLIAR:{color:"#16A34A"},"TOMA DOMICILIARIA":{color:"#0D9488"},INMERSIN:{color:"#92400E"},GENERAL:{color:"#374151"},PODA:{color:"#DC2626"},"APORTE ESPECIAL (RIEGO)":{color:"#374151"}},lse=["Aplicacin para trips","Aplicacin para botrytis","Aplicacin para corinespora","Aplicacin para roya","Aplicacin para gusano","Aplicacin para mayate","Aplicacin nutritiva","Aplicacin preventiva","Poda","Aporte especial","Herbicida","Otro"],cse=["Fungicida","Insecticida","Bioestimulante","Coadyuvante","Biofbrica","Herbicida","Atrayente","AporteEspecial","Poda","Otro"],zI={Fungicida:"",Insecticida:"",Bioestimulante:"",Coadyuvante:"",Biofbrica:"",Herbicida:"",Atrayente:"",AporteEspecial:"",Poda:"",Otro:""},BI={Fungicida:"#7C3AED",Insecticida:"#DC2626",Bioestimulante:"#16A34A",Coadyuvante:"#0D9488",Biofbrica:"#0284C7",Herbicida:"#92400E",Atrayente:"#B45309",AporteEspecial:"#0369A1",Poda:"#374151",Otro:"#4B5563"},UI=["1A","1B","1C","1D","1E","2A","2B","2C","2D","2E","3A","3B","3C","4A","4B","4C","5A","5B","5C","6A","6B","6C","6D","7A","7B","7C","7D","7E"],dse=[{id:"inicio",icon:"",label:"Inicio de Jornada",items:[{key:"prog_dia",label:"Revisar programa de fumigacin del da",link:"Ver programa "},{key:"verificar_inv",label:"Verificar existencia de productos",link:"Ver inventario "},{key:"coord_equipo",label:"Convocar y coordinar equipo de fumigacin"},{key:"reg_clima",label:"Registrar condicin climtica del da"}]},{id:"preparacion",icon:"",label:"Preparacin",items:[{key:"epp_completo",label:"Supervisin EPP completo en equipo"},{key:"prep_caldo",label:"Preparar el caldo en el rea de fumigacin"},{key:"ph_ce",label:"Medir y registrar pH y CE del caldo"},{key:"aportes_toma",label:"Coordinar aportes por toma domiciliaria"},{key:"insp_inundacion",label:"Inspeccionar zonas propensas a inundacin",onlyIfLluvia:!0}]},{id:"durante",icon:"",label:"Durante el Da",items:[{key:"sup_campo",label:"Supervisin de fumigacin en campo"},{key:"avance_sec",label:"Verificar avance de sectores aplicados"},{key:"llena_tambos",label:"Coordinar llenado de tambos para maana"},{key:"rev_inventario",label:"Revisar inventario de productos",link:"Ver inventario "}]},{id:"cierre",icon:"",label:"Cierre del Da",items:[{key:"lavar_asper",label:"Fumigadores lavaron motoaspersoras con agua y jabn"},{key:"guardar_equipo",label:"Equipo guardado en cuarto de fumigacin"},{key:"epp_final",label:"EPP completo y en buen estado"},{key:"fotos_envases",label:"Fotos de envases vacos enviadas (WhatsApp)"},{key:"tambos_llenos",label:"Tambos llenos con agua para maana"},{key:"rev_refacciones",label:"Revisin de refacciones y equipo de fumigacin"},{key:"registrar_aplic",label:"Registrar aplicacin del da en el sistema",link:"Ir a registrar "}]}];function WI({almacenId:e,productos:t,onClose:r,onSave:n,initialData:a}){var we,ve;const i=!!a,{user:s}=Vo(),[l,c]=h.useState(!1),[u,d]=h.useState(null),[f,p]=h.useState((a==null?void 0:a.fecha)??new Date().toISOString().split("T")[0]),[x,m]=h.useState((a==null?void 0:a.variedad)??""),[y,j]=h.useState(new Set((a==null?void 0:a.sectores)??[])),[b,g]=h.useState((a==null?void 0:a.producto_nombre)??""),[v,w]=h.useState(""),[C,k]=h.useState(!1),[S,_]=h.useState(((we=a==null?void 0:a.dosis_200l)==null?void 0:we.toString())??""),[A,E]=h.useState(((ve=a==null?void 0:a.tambos)==null?void 0:ve.toString())??""),[N,$]=h.useState((a==null?void 0:a.metodo)??""),[z,T]=h.useState((a==null?void 0:a.objetivo)??""),[I,L]=h.useState((a==null?void 0:a.notas)??""),[D,O]=h.useState((a==null?void 0:a.responsable_id)??null),[F,q]=h.useState((a==null?void 0:a.estatus)??"programada"),[te,H]=h.useState([]),[B,K]=h.useState(0),Z=h.useRef(null),he=t.find(G=>G.Nombre===b),re=f?xy(new Date(f+"T12:00:00")):0,X=parseFloat(S)||0,V=parseInt(A)||0,J=X*V/1e3,ne=Math.max(0,J-B),Q=J*((he==null?void 0:he.costo_unitario)??0);h.useEffect(()=>{se.from("Users").select('"ID", name').eq("is_active",!0).order("name").then(({data:G})=>{G&&H(G.map(R=>({ID:R.ID,name:R.name})))})},[]),h.useEffect(()=>{!b||!e||se.from("inventario_items").select("stock_actual").eq("almacen_id",e).ilike("nombre",b).maybeSingle().then(({data:G})=>K((G==null?void 0:G.stock_actual)??0))},[b,e]),h.useEffect(()=>{if(!C)return;const G=R=>{Z.current&&!Z.current.contains(R.target)&&(k(!1),w(""))};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[C]);const me=G=>{m(G);const R=Co[G];R&&R.sectores.length>0?j(new Set(R.sectores)):j(new Set)},ue=G=>j(R=>{const Y=new Set(R);return Y.has(G)?Y.delete(G):Y.add(G),Y}),W=async()=>{if(d(null),!f){d("Selecciona una fecha");return}if(!x){d("Selecciona una variedad");return}if(!b){d("Selecciona un producto");return}if(!S||X<=0){d("Ingresa la dosis por 200L");return}if(!A||V<=0){d("Ingresa el nmero de tambos");return}if(!N){d("Selecciona el mtodo de aplicacin");return}c(!0);try{const G={almacen_id:e,semana:re,fecha:f,variedad:x,sectores:[...y],producto_nombre:b,dosis_200l:X,tambos:V,metodo:N,objetivo:z||null,estatus:F,responsable_id:D||null,notas:I||null};if(i)G.sheets_sync_id=a.sheets_sync_id??null,G.sheets_range=a.sheets_range??null,G.sheets_synced_at=a.sheets_synced_at??null,G.created_by=a.created_by??null;else{const R=s!=null&&s.id?parseInt(s.id):null;G.created_by=R&&!isNaN(R)?R:null,G.sheets_sync_id=null,G.sheets_range=null,G.sheets_synced_at=null}await n(G)}catch(G){d(G.message||"Error al guardar"),c(!1)}},ae=t.filter(G=>G.activo&&G.Nombre.toLowerCase().includes(v.toLowerCase()));return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-40",onClick:r}),o.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[500px] max-w-full bg-[#12131e]
        border-l border-[#252638] z-50 flex flex-col overflow-hidden
        animate-in slide-in-from-right duration-200`,children:[o.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-[#1c1d2e] flex-shrink-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"font-syne text-lg font-extrabold text-[#eceef5]",children:i?"Editar entrada":"Nueva entrada  Programa"}),o.jsx("p",{className:"text-xs text-[#7b7f9e] mt-1",children:"Una fila = un producto en una fecha/variedad"})]}),o.jsx("button",{onClick:r,className:`w-8 h-8 flex items-center justify-center rounded-lg border border-[#252638]
              text-[#7b7f9e] hover:text-[#eceef5] hover:bg-[#181929] transition-colors text-sm`,children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-5 space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Fecha"}),o.jsx("input",{type:"date",value:f,onChange:G=>p(G.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Semana ISO"}),o.jsxs("div",{className:`w-full px-3 py-2.5 bg-emerald-900/20 border border-emerald-800/40 rounded-lg
                font-mono text-sm font-bold text-emerald-400`,children:["Semana ",re||"","  ",f?new Date(f+"T12:00:00").getFullYear():""]})]})]}),i&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Estatus"}),o.jsx("div",{className:"flex gap-2",children:["programada","realizada","pospuesta","cancelada"].map(G=>{const Y={programada:{active:"bg-emerald-900/40 border-emerald-600/50",text:"text-emerald-400"},realizada:{active:"bg-indigo-900/40 border-indigo-600/50",text:"text-indigo-400"},pospuesta:{active:"bg-amber-900/40 border-amber-600/50",text:"text-amber-400"},cancelada:{active:"bg-red-900/40 border-red-600/50",text:"text-red-400"}}[G],ge=F===G;return o.jsx("button",{onClick:()=>q(G),className:`flex-1 py-2 rounded-lg border text-[11px] font-bold uppercase tracking-wide transition-all ${ge?`${Y.active} ${Y.text}`:"bg-[#0e0f1a] border-[#252638] text-[#3e4262] hover:border-[#2e3050]"}`,children:G},G)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Variedad"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Co).map(([G,R])=>o.jsxs("button",{onClick:()=>me(G),className:`flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm font-bold text-white
                    border-2 transition-all duration-100`,style:{background:R.color,borderColor:x===G?"rgba(255,255,255,0.4)":"transparent",opacity:x===G?1:.55,boxShadow:x===G?`0 0 0 3px ${R.color}33`:"none"},children:[o.jsx("span",{className:"w-2 h-2 rounded-full bg-white/60 flex-shrink-0"}),G]},G))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-1",children:["Sectores"," ",o.jsx("span",{className:"normal-case text-[#3e4262] font-normal tracking-normal",children:"(auto desde variedad  ajustables)"})]}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:UI.map(G=>{const R=y.has(G),Y=x?Co[x]:null;return o.jsx("button",{onClick:()=>ue(G),className:"px-2 py-1 rounded text-[11px] font-mono font-bold border-[1.5px] transition-all",style:{background:R?(Y==null?void 0:Y.color)??"#10b981":"#0e0f1a",borderColor:R?"transparent":"#252638",color:R?"#fff":"#7b7f9e"},children:G},G)})}),y.size>0&&o.jsxs("p",{className:"text-[10px] text-[#7b7f9e] mt-1.5",children:[y.size," sectores seleccionados"]})]}),o.jsxs("div",{className:"relative",ref:Z,children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Producto"}),o.jsxs("div",{className:`flex items-center gap-2 px-3 py-2.5 bg-[#0e0f1a] border border-[#252638]
                rounded-lg cursor-pointer hover:border-[#2e3050] transition-colors`,onClick:()=>k(!0),children:[o.jsx("span",{className:"text-sm text-[#3e4262]",children:""}),o.jsx("span",{className:`flex-1 text-sm ${b?"text-[#eceef5] font-medium":"text-[#3e4262]"}`,children:b||"Buscar producto..."}),he&&o.jsx("span",{className:"text-[9px] font-bold font-mono text-[#3e4262] bg-[#181929] px-1.5 py-0.5 rounded",children:he.categoria}),b&&o.jsx("button",{onClick:G=>{G.stopPropagation(),g(""),_("")},className:"text-[#3e4262] hover:text-[#7b7f9e] text-xs ml-1",children:""})]}),C&&o.jsxs("div",{className:`absolute z-50 left-0 right-0 top-full mt-1 bg-[#181929] border border-[#252638]
                rounded-lg shadow-2xl overflow-hidden max-h-64 flex flex-col`,children:[o.jsx("div",{className:"p-2 border-b border-[#1c1d2e]",children:o.jsx("input",{autoFocus:!0,type:"text",value:v,onChange:G=>w(G.target.value),placeholder:"Buscar...",className:`w-full bg-[#0e0f1a] border border-[#252638] rounded px-3 py-1.5
                      text-sm text-[#eceef5] outline-none focus:border-emerald-500`,onKeyDown:G=>{G.key==="Escape"&&(k(!1),w(""))}})}),o.jsxs("div",{className:"overflow-y-auto",children:[ae.map(G=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-2.5 hover:bg-[#1c1d2e]
                        cursor-pointer border-b border-[#1c1d2e]/50 last:border-none`,onMouseDown:R=>R.preventDefault(),onClick:()=>{var R;g(G.Nombre),_(((R=G.dosis_ref_200l)==null?void 0:R.toString())??""),w(""),k(!1)},children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-[#eceef5]",children:G.Nombre}),o.jsxs("div",{className:"text-[10px] text-[#3e4262] mt-0.5 font-mono",children:[G.categoria,"  ref: ",G.dosis_ref_200l??""," ",G.unidad,"/200L"]})]}),o.jsxs("div",{className:"text-xs font-mono font-semibold text-emerald-400",children:["$",G.costo_unitario,"/",G.unidad]})]},G.id)),ae.length===0&&o.jsx("div",{className:"text-center py-6 text-[#3e4262] text-sm",children:"Sin resultados"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:["Dosis por 200 L",he&&o.jsxs("span",{className:"ml-1 text-[#3e4262] font-normal normal-case tracking-normal",children:["(",he.unidad,")"]})]}),o.jsx("input",{type:"number",step:"0.01",value:S,onChange:G=>_(G.target.value),placeholder:"ej: 0.5",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Tambos (200 L c/u)"}),o.jsx("input",{type:"number",value:A,onChange:G=>E(G.target.value),placeholder:"ej: 5",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`})]})]}),X>0&&V>0&&o.jsxs("div",{className:"bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg p-4 space-y-3",children:[o.jsx("div",{className:"grid grid-cols-4 gap-2 text-center",children:[{label:"Total producto",value:`${J.toFixed(3)} ${(he==null?void 0:he.unidad)??""}`,color:"text-[#eceef5]"},{label:"En inventario",value:B>0?B.toFixed(2):"",color:B>=J?"text-emerald-400":"text-red-400"},{label:"Necesidad",value:ne<=0?" ok":ne.toFixed(3),color:ne<=0?"text-emerald-400":ne>J*.5?"text-red-400 font-bold":"text-amber-400"},{label:"Costo est.",value:`$${Q.toFixed(2)}`,color:"text-emerald-400 font-bold"}].map(G=>o.jsxs("div",{children:[o.jsx("div",{className:`font-mono text-base font-semibold ${G.color}`,children:G.value}),o.jsx("div",{className:"text-[9px] text-[#3e4262] mt-0.5 uppercase tracking-wider",children:G.label})]},G.label))}),b&&o.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium border
                  ${ne<=0?"bg-emerald-900/20 border-emerald-800/30 text-emerald-400":ne>J*.5?"bg-red-900/20 border-red-800/30 text-red-400":"bg-amber-900/20 border-amber-800/30 text-amber-400"}`,children:[o.jsx("span",{children:ne<=0?"":ne>J*.5?"":""}),o.jsx("span",{className:"flex-1",children:ne<=0?`Stock suficiente (${B.toFixed(2)} disponibles)`:`Faltan ${ne.toFixed(3)} ${(he==null?void 0:he.unidad)??""}  coordinar compra`})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Mtodo de aplicacin"}),o.jsxs("select",{value:N,onChange:G=>$(G.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`,children:[o.jsx("option",{value:"",children:"Seleccionar..."}),Object.keys(cw).map(G=>o.jsx("option",{value:G,children:G},G))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Objetivo / Nota"}),o.jsxs("select",{value:z,onChange:G=>T(G.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`,children:[o.jsx("option",{value:"",children:"Sin especificar"}),lse.map(G=>o.jsx("option",{value:G,children:G},G))]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Responsable"}),o.jsxs("select",{value:D??"",onChange:G=>O(G.target.value?Number(G.target.value):null),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`,children:[o.jsx("option",{value:"",children:"Sin asignar"}),te.map(G=>o.jsx("option",{value:G.ID,children:G.name},G.ID))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Notas"}),o.jsx("textarea",{value:I,onChange:G=>L(G.target.value),rows:2,placeholder:"Observaciones adicionales...",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors resize-none`})]}),u&&o.jsx("div",{className:`px-3 py-2.5 bg-red-900/20 border border-red-800/30 rounded-lg
              text-sm text-red-400 font-medium`,children:u})]}),o.jsxs("div",{className:"flex gap-2 px-6 py-4 border-t border-[#1c1d2e] flex-shrink-0",children:[o.jsx("button",{onClick:r,className:`px-4 py-2.5 rounded-lg border border-[#252638] text-[#7b7f9e]
              text-sm font-semibold hover:bg-[#181929] transition-colors`,children:"Cancelar"}),o.jsx("button",{onClick:W,disabled:l,className:`flex-1 py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400 disabled:opacity-60
              text-black text-sm font-bold transition-colors flex items-center justify-center gap-2`,children:l?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Guardando"]}):" Guardar entrada"})]})]})]})}const use=[{value:"realizada",label:" Realizada",color:"#818cf8"},{value:"programada",label:" Programada",color:"#10b981"},{value:"pospuesta",label:" Pospuesta",color:"#f59e0b"},{value:"cancelada",label:" Cancelada",color:"#ef4444"}];function fse({label:e,value:t,options:r,onChange:n,accentColor:a}){const[i,s]=h.useState(!1),l=h.useRef(null);h.useEffect(()=>{if(!i)return;const d=f=>{l.current&&!l.current.contains(f.target)&&s(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]);const c=r.find(d=>d.value===t),u=t!==""&&t!=="todos";return o.jsxs("div",{className:"relative",ref:l,children:[o.jsxs("button",{onClick:()=>s(d=>!d),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[11px] font-semibold
          transition-all duration-100 whitespace-nowrap ${u?"bg-emerald-900/30 border-emerald-700/50 text-emerald-300":"bg-[#12131e] border-[#1c1d2e] text-[#7b7f9e] hover:border-[#2e3050]"}`,style:u&&a?{color:a,borderColor:`${a}55`,background:`${a}18`}:{},children:[u&&(c==null?void 0:c.color)&&o.jsx("span",{className:"w-1.5 h-1.5 rounded-full flex-shrink-0",style:{background:c.color}}),o.jsx("span",{children:u?(c==null?void 0:c.label)??e:e}),o.jsx("svg",{className:`w-3 h-3 transition-transform ${i?"rotate-180":""}`,viewBox:"0 0 10 10",fill:"none",children:o.jsx("path",{d:"M2 3.5L5 6.5L8 3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]}),i&&o.jsx("div",{className:`absolute left-0 top-full mt-1.5 bg-[#181929] border border-[#252638]
          rounded-xl overflow-hidden shadow-2xl z-50 min-w-[160px]`,children:r.map(d=>o.jsxs("button",{onClick:()=>{n(d.value),s(!1)},className:`w-full flex items-center gap-2.5 px-3.5 py-2.5 text-[11px] font-semibold
                hover:bg-[#1c1d2e] transition-colors text-left ${t===d.value?"text-emerald-400":"text-[#7b7f9e]"}`,style:t===d.value&&d.color?{color:d.color}:{},children:[d.color&&o.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:d.color}}),d.label,t===d.value&&o.jsx("span",{className:"ml-auto text-[10px]",children:""})]},d.value))})]})}function hse({semanas:e,selected:t,onChange:r}){const[n,a]=h.useState(!1),i=h.useRef(null);h.useEffect(()=>{if(!n)return;const c=u=>{i.current&&!i.current.contains(u.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[n]);const s=c=>{const u=new Set(t);u.has(c)?u.delete(c):u.add(c),r(u)},l=t.size===0?"Semana":t.size===1?`S${[...t][0]}`:`${t.size} semanas`;return o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(c=>!c),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[11px] font-semibold
          transition-all duration-100 whitespace-nowrap ${t.size>0?"bg-emerald-900/30 border-emerald-700/50 text-emerald-300":"bg-[#12131e] border-[#1c1d2e] text-[#7b7f9e] hover:border-[#2e3050]"}`,children:[" ",l,o.jsx("svg",{className:`w-3 h-3 transition-transform ${n?"rotate-180":""}`,viewBox:"0 0 10 10",fill:"none",children:o.jsx("path",{d:"M2 3.5L5 6.5L8 3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]}),n&&o.jsxs("div",{className:`absolute left-0 top-full mt-1.5 bg-[#181929] border border-[#252638]
          rounded-xl overflow-hidden shadow-2xl z-50 min-w-[140px]`,children:[t.size>0&&o.jsx("button",{onClick:()=>r(new Set),className:`w-full px-3.5 py-2 text-[11px] text-[#3e4262] hover:text-[#7b7f9e]
                hover:bg-[#1c1d2e] transition-colors text-left border-b border-[#1c1d2e]`,children:"Limpiar filtro"}),o.jsx("div",{className:"flex flex-wrap gap-1 p-2",children:e.map(c=>o.jsxs("button",{onClick:()=>s(c),className:`px-2.5 py-1.5 rounded-lg text-[11px] font-bold border transition-all ${t.has(c)?"bg-emerald-900/40 border-emerald-600/50 text-emerald-400":"bg-[#0e0f1a] border-[#252638] text-[#7b7f9e] hover:border-[#2e3050]"}`,children:["S",c]},c))})]})]})}function pse({variedades:e,selected:t,onChange:r}){const[n,a]=h.useState(!1),i=h.useRef(null);h.useEffect(()=>{if(!n)return;const l=c=>{i.current&&!i.current.contains(c.target)&&a(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[n]);const s=t?Co[t]:null;return o.jsxs("div",{className:"relative",ref:i,children:[o.jsxs("button",{onClick:()=>a(l=>!l),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-[11px] font-semibold
          transition-all duration-100 whitespace-nowrap`,style:t&&s?{background:`${s.color}18`,borderColor:`${s.color}55`,color:s.color}:{background:"#12131e",borderColor:"#1c1d2e",color:"#7b7f9e"},children:[t&&s&&o.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:s.color}}),t||"Variedad",o.jsx("svg",{className:`w-3 h-3 transition-transform ${n?"rotate-180":""}`,viewBox:"0 0 10 10",fill:"none",children:o.jsx("path",{d:"M2 3.5L5 6.5L8 3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]}),n&&o.jsxs("div",{className:`absolute left-0 top-full mt-1.5 bg-[#181929] border border-[#252638]
          rounded-xl overflow-hidden shadow-2xl z-50 min-w-[180px]`,children:[t&&o.jsx("button",{onClick:()=>{r(""),a(!1)},className:`w-full px-3.5 py-2 text-[11px] text-[#3e4262] hover:text-[#7b7f9e]
                hover:bg-[#1c1d2e] transition-colors text-left border-b border-[#1c1d2e]`,children:"Todas las variedades"}),e.map(l=>{const c=Co[l];return o.jsxs("button",{onClick:()=>{r(l===t?"":l),a(!1)},className:`w-full flex items-center gap-2.5 px-3.5 py-2.5 text-[11px] font-semibold
                  hover:bg-[#1c1d2e] transition-colors text-left`,style:{color:(c==null?void 0:c.color)??"#7b7f9e"},children:[o.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:(c==null?void 0:c.color)??"#7b7f9e"}}),l,t===l&&o.jsx("span",{className:"ml-auto text-[10px]",children:""})]},l)})]})]})}function mse({estatus:e}){const t={programada:{bg:"rgba(16,185,129,.12)",color:"#10b981",label:" prog"},realizada:{bg:"rgba(99,102,241,.12)",color:"#818cf8",label:" real"},pospuesta:{bg:"rgba(245,158,11,.12)",color:"#f59e0b",label:" pospuesta"},cancelada:{bg:"rgba(239,68,68,.12)",color:"#ef4444",label:" canc"}},r=t[e]??t.programada;return o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold
      font-mono uppercase tracking-wide`,style:{background:r.bg,color:r.color},children:r.label})}function gse({programa:e,productos:t,alertas:r,almacenId:n,loading:a,onCrear:i,onActualizar:s,onEliminar:l,onEliminarVarios:c,onActualizarEstatusVarios:u,onVerDetalle:d}){const[f,p]=h.useState(new Set),[x,m]=h.useState(""),[y,j]=h.useState("todos"),[b,g]=h.useState(!1),[v,w]=h.useState(!1),[C,k]=h.useState(new Set),[S,_]=h.useState(!1),[A,E]=h.useState(!1),N=h.useRef(null);h.useEffect(()=>{if(!S)return;const K=Z=>{N.current&&!N.current.contains(Z.target)&&_(!1)};return document.addEventListener("mousedown",K),()=>document.removeEventListener("mousedown",K)},[S]);const $=h.useMemo(()=>[...new Set(e.map(K=>K.semana))].sort((K,Z)=>K-Z),[e]),z=h.useMemo(()=>[...new Set(e.map(K=>K.variedad))],[e]),T=h.useMemo(()=>e.filter(K=>!(f.size>0&&!f.has(K.semana)||x&&K.variedad!==x||y!=="todos"&&K.estatus!==y)),[e,f,x,y]),I=h.useMemo(()=>T.reduce((K,Z)=>K+Z.costo_estimado,0),[T]),L=h.useCallback(K=>k(Z=>{const he=new Set(Z);return he.has(K)?he.delete(K):he.add(K),he}),[]),D=()=>{C.size===T.length?k(new Set):k(new Set(T.map(K=>K.id)))},O=()=>{w(!1),k(new Set)},F=async()=>{if(confirm(`Eliminar ${C.size} entrada${C.size>1?"s":""}?`)){E(!0);try{await c([...C]),O()}finally{E(!1)}}},q=async K=>{E(!0),_(!1);try{await u([...C],K),O()}finally{E(!1)}},te=C.size===T.length&&T.length>0,H=C.size>0&&!te,B=[{value:"todos",label:"Todos"},{value:"programada",label:" Programada",color:"#10b981"},{value:"realizada",label:" Realizada",color:"#818cf8"},{value:"pospuesta",label:" Pospuesta",color:"#f59e0b"},{value:"cancelada",label:" Cancelada",color:"#ef4444"}];return o.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[r.length>0&&o.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-red-950/30 border-b border-red-800/30 flex-shrink-0",children:[o.jsx("span",{className:"text-base mt-0.5",children:""}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-xs font-bold text-red-400 uppercase tracking-wider mb-1.5",children:"Inventario insuficiente  prximos 3 das"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(K=>o.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-mono font-semibold
                    bg-red-900/40 border border-red-700/40 text-red-300`,children:[K.producto_nombre,"  faltan ",K.deficit.toFixed(2)," ",K.unidad]},K.producto_nombre))})]})]}),o.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 bg-[#0e0f1a] border-b border-[#1c1d2e]
        flex-shrink-0 flex-wrap`,children:[o.jsx(hse,{semanas:$,selected:f,onChange:p}),o.jsx(pse,{variedades:z,selected:x,onChange:m}),o.jsx(fse,{label:"Estatus",value:y,options:B,onChange:K=>j(K)}),o.jsx("div",{className:"w-px h-4 bg-[#1c1d2e] mx-1"}),o.jsxs("span",{className:"text-xs font-mono text-emerald-400 font-semibold",children:["$",I.toFixed(2)]}),o.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[v?o.jsx("button",{onClick:O,className:`px-3 py-1.5 rounded-lg border border-[#252638] text-[#7b7f9e]
                text-xs font-semibold hover:bg-[#181929] transition-colors`,children:"Cancelar"}):o.jsx("button",{onClick:()=>w(!0),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-[#252638]
                text-xs font-semibold text-[#7b7f9e] hover:text-[#eceef5] hover:border-[#2e3050] transition-all`,children:" Seleccionar"}),o.jsx("button",{onClick:()=>g(!0),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
              text-black text-xs font-bold transition-all duration-150`,children:" Nueva entrada"})]})]}),v&&C.size>0&&o.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 bg-indigo-950/40 border-b border-indigo-800/30
          flex-shrink-0 animate-in slide-in-from-top duration-150`,children:[o.jsxs("span",{className:"text-xs font-bold text-indigo-300",children:[C.size," seleccionada",C.size>1?"s":""]}),o.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[o.jsxs("div",{className:"relative",ref:N,children:[o.jsxs("button",{onClick:()=>_(K=>!K),disabled:A,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-indigo-500/20 border border-indigo-500/30
                  text-xs font-bold text-indigo-300 hover:bg-indigo-500/30 disabled:opacity-50 transition-all`,children:[" Cambiar estatus",o.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 10 10",fill:"none",children:o.jsx("path",{d:"M2 3.5L5 6.5L8 3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]}),S&&o.jsx("div",{className:`absolute right-0 top-full mt-1 bg-[#181929] border border-[#252638]
                  rounded-xl overflow-hidden shadow-2xl z-50 min-w-[180px]`,children:use.map(K=>o.jsxs("button",{onClick:()=>q(K.value),className:`w-full flex items-center gap-2.5 px-4 py-2.5 text-sm font-semibold
                        hover:bg-[#1c1d2e] transition-colors text-left`,style:{color:K.color},children:[o.jsx("span",{className:"w-2 h-2 rounded-full",style:{background:K.color}}),K.label]},K.value))})]}),o.jsxs("button",{onClick:F,disabled:A,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-red-500/15 border border-red-500/30
                text-xs font-bold text-red-400 hover:bg-red-500/25 disabled:opacity-50 transition-all`,children:[A?o.jsx("span",{className:"w-3.5 h-3.5 border-2 border-red-400/30 border-t-red-400 rounded-full animate-spin"}):"","Eliminar ",C.size]})]})]}),o.jsx("div",{className:"flex-1 overflow-auto",children:a?o.jsxs("div",{className:"flex items-center justify-center h-40 text-[#7b7f9e] text-sm gap-2",children:[o.jsx("span",{className:"w-4 h-4 border-2 border-[#3e4262] border-t-emerald-500 rounded-full animate-spin"}),"Cargando programa"]}):T.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-60 text-[#3e4262]",children:[o.jsx("div",{className:"text-5xl mb-4",children:""}),o.jsx("div",{className:"text-sm font-semibold text-[#7b7f9e]",children:"Sin entradas en el programa"}),o.jsx("div",{className:"text-xs mt-2",children:"Importa desde Google Sheets o crea una nueva entrada"})]}):o.jsxs("table",{className:"w-full border-collapse",style:{minWidth:"1140px"},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[v&&o.jsx("th",{className:`text-left px-3 py-2.5 text-[10px] font-bold
                    text-[#3e4262] uppercase tracking-wider bg-[#0e0f1a] border-b-2 border-[#1c1d2e] w-10`,children:o.jsx("button",{onClick:D,className:`w-4 h-4 rounded border flex items-center justify-center text-[9px] font-bold
                        transition-all ${te||H?"bg-indigo-500 border-indigo-400 text-white":"border-[#3e4262] hover:border-indigo-500"}`,children:te?"":H?"":""})}),["Semana","Fecha","Variedad","Producto","Dosis/200L","Total","Inventario","Necesidad","Mtodo","Tambos","Objetivo","Estatus","Costo Est."].map(K=>o.jsx("th",{className:`text-left px-3 py-2.5 text-[10px] font-bold
                      text-[#3e4262] uppercase tracking-wider bg-[#0e0f1a]
                      border-b-2 border-[#1c1d2e] whitespace-nowrap`,children:K},K))]})}),o.jsxs("tbody",{children:[T.map((K,Z)=>{var me;const he=Co[K.variedad],re=((me=cw[K.metodo])==null?void 0:me.color)??"#374151",X=T[Z-1],V=!X||X.semana!==K.semana,J=C.has(K.id),ne=K.inventario_vinculado?K.stock_inventario<=0?"text-red-400":K.stock_inventario<K.total_producto?"text-amber-400":"text-emerald-400":"text-[#3e4262]",Q=K.necesidad<=0?"text-emerald-400":K.necesidad>K.total_producto*.5?"text-red-400 font-bold":"text-amber-400";return o.jsxs("tr",{onClick:()=>v?L(K.id):d(K),className:`cursor-pointer transition-colors duration-75
                      ${V&&Z>0?"border-t-2 border-[#1c1d2e]":""}
                      ${J?"bg-indigo-900/20 hover:bg-indigo-900/30":"hover:bg-white/[0.022]"}`,children:[v&&o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",onClick:ue=>{ue.stopPropagation(),L(K.id)},children:o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center text-[9px] font-bold
                          transition-all ${J?"bg-indigo-500 border-indigo-400 text-white":"border-[#3e4262] hover:border-indigo-500"}`,children:J?"":""})}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:o.jsxs("span",{className:"font-mono text-[10px] font-semibold text-[#3e4262] bg-[#181929] px-2 py-1 rounded",children:["S",K.semana]})}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-[11px] text-[#7b7f9e] whitespace-nowrap",children:new Date(K.fecha+"T12:00:00").toLocaleDateString("es-MX",{day:"numeric",month:"short",year:"2-digit"})}),o.jsxs("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:[o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-1 rounded-full text-[11px] font-bold text-white",style:{background:(he==null?void 0:he.color)??"#374151"},children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-white/50"}),K.variedad]}),K.sectores.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[K.sectores.slice(0,5).map(ue=>o.jsx("span",{className:"text-[9px] font-mono font-bold px-1 py-px rounded border",style:{background:`${(he==null?void 0:he.color)??"#374151"}22`,color:(he==null?void 0:he.color)??"#374151",borderColor:`${(he==null?void 0:he.color)??"#374151"}44`},children:ue},ue)),K.sectores.length>5&&o.jsxs("span",{className:"text-[9px] text-[#3e4262]",children:["+",K.sectores.length-5]})]})]}),o.jsxs("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:[o.jsx("span",{className:"text-xs font-semibold text-[#eceef5]",children:K.producto_nombre}),o.jsx("span",{className:"ml-1.5 text-[9px] font-bold font-mono text-[#3e4262] bg-[#181929] px-1.5 py-px rounded uppercase",children:K.categoria_producto})]}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-xs text-[#eceef5]",children:K.dosis_200l}),o.jsxs("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-xs font-medium text-[#eceef5]",children:[K.total_producto.toFixed(3)," ",K.unidad_producto]}),o.jsx("td",{className:`px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-xs font-medium ${ne}`,children:K.inventario_vinculado?K.stock_inventario>0?K.stock_inventario.toFixed(2):"0":o.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded border
                          bg-[#181929] border-[#252638] text-[#3e4262] text-[9px] font-bold uppercase tracking-wide`,title:"Producto no registrado en inventario",children:["N/A ",o.jsx("span",{className:"text-[8px]",children:""})]})}),o.jsxs("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:[o.jsx("span",{className:`font-mono text-xs font-medium ${Q}`,children:K.inventario_vinculado?K.necesidad<=0?" ok":K.necesidad.toFixed(3):""}),K.inventario_vinculado&&K.necesidad>0&&o.jsx("div",{className:"w-12 h-1 mt-1 rounded-full bg-[#1c1d2e] overflow-hidden",children:o.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,K.necesidad/K.total_producto*100)}%`,background:K.necesidad>K.total_producto*.5?"#ef4444":"#f59e0b"}})})]}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:o.jsx("span",{className:"inline-block px-1.5 py-0.5 rounded text-[10px] font-bold font-mono text-white uppercase",style:{background:re},children:K.metodo.slice(0,12)})}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-xs text-[#eceef5]",children:K.tambos}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] text-[11px] text-[#7b7f9e] max-w-[130px] truncate",children:K.objetivo??""}),o.jsx("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e]",children:o.jsx(mse,{estatus:K.estatus})}),o.jsxs("td",{className:"px-3 py-2.5 border-b border-[#1c1d2e] font-mono text-xs font-semibold text-emerald-400",children:["$",K.costo_estimado.toFixed(2)]})]},K.id)}),o.jsxs("tr",{className:"bg-[#0e0f1a]",children:[o.jsxs("td",{colSpan:v?14:13,className:"px-3 py-2.5 text-[11px] font-bold text-[#7b7f9e] text-right",children:["TOTAL ESTIMADO (",T.length," entradas):"]}),o.jsxs("td",{className:"px-3 py-2.5 font-mono text-sm font-bold text-emerald-400",children:["$",I.toFixed(2)]})]})]})]})}),b&&o.jsx(WI,{almacenId:n,productos:t,onClose:()=>g(!1),onSave:async K=>{await i(K),g(!1)}})]})}function xse({aplicacion:e,personal:t,onClose:r,onActualizarChecklist:n,onGuardarFumigadores:a,onActualizar:i}){var I;const[s,l]=h.useState(new Set(["avance","checklist"])),[c,u]=h.useState(e.tambos_realizados),[d,f]=h.useState(new Set(e.sectores_completados)),[p,x]=h.useState({chk_aspersoras_lavadas:e.chk_aspersoras_lavadas,chk_equipo_guardado:e.chk_equipo_guardado,chk_epp_revisado:e.chk_epp_revisado,chk_envases_foto:e.chk_envases_foto,chk_tambos_llenos:e.chk_tambos_llenos}),[m,y]=h.useState(!1),[j,b]=h.useState(!1),[g,v]=h.useState(()=>{const L={};for(const D of e.fumigadores??[])L[D.personal_id]=D.tambos_realizados;return L}),[w,C]=h.useState(()=>new Set((e.fumigadores??[]).map(L=>L.personal_id))),k=Co[e.variedad],S=(e.productos??[]).reduce((L,D)=>L+(D.costo_total??0),0),_=Object.values(p).filter(Boolean).length,A=Math.round(_/5*100),E=e.tambos_programados>0?Math.round(c/e.tambos_programados*100):0,N=L=>{l(D=>{const O=new Set(D);return O.has(L)?O.delete(L):O.add(L),O})},$=async L=>{const D={...p,[L]:!p[L]};x(D),y(!0);try{await n(D)}finally{y(!1)}},z=async()=>{b(!0);try{const L=e.fecha_inicio.split("T")[0],D=[...w].map(O=>({personal_id:O,fecha:L,tambos_realizados:g[O]??0}));await a(D)}finally{b(!1)}},T=async()=>{await i({tambos_realizados:c,sectores_completados:[...d]})};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-40",onClick:r}),o.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[660px] max-w-full bg-[#12131e]
        border-l border-[#252638] z-50 flex flex-col overflow-hidden
        animate-in slide-in-from-right duration-200`,children:[o.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-[#1c1d2e] flex-shrink-0",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"font-syne text-lg font-extrabold text-[#eceef5]",children:[e.variedad," "," ",new Date(e.fecha_inicio).toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long"})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[o.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-bold text-white",style:{background:(k==null?void 0:k.color)??"#374151"},children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-white/50"}),e.variedad]}),o.jsxs("span",{className:"text-xs text-[#7b7f9e]",children:[((I=e.responsable)==null?void 0:I.name)??"Sin responsable","  ",e.clima]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"font-mono text-xl font-bold text-emerald-400",children:["$",S.toFixed(2)]}),o.jsx("div",{className:"text-[10px] text-[#3e4262]",children:"Costo total MXN"})]}),o.jsx("button",{onClick:r,className:`w-8 h-8 flex items-center justify-center rounded-lg
                border border-[#252638] text-[#7b7f9e] hover:text-[#eceef5]
                hover:bg-[#181929] transition-colors text-sm`,children:""})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-5 space-y-4",children:[o.jsxs(hd,{id:"avance",icon:"",title:"Avance de aplicacin",sub:`${d.size}/${e.sectores_programados.length} sectores  ${c}/${e.tambos_programados} tambos`,open:s.has("avance"),onToggle:()=>N("avance"),children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("div",{className:"text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Sectores completados"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.sectores_programados.map(L=>{const D=d.has(L);return o.jsxs("button",{onClick:()=>{f(O=>{const F=new Set(O);return F.has(L)?F.delete(L):F.add(L),F})},className:"px-2.5 py-1.5 rounded-lg text-[11px] font-mono font-bold border-[1.5px] transition-all",style:{background:D?(k==null?void 0:k.color)??"#10b981":"#0e0f1a",borderColor:D?"transparent":"#252638",color:D?"#fff":"#7b7f9e"},children:[D?" ":"",L]},L)})})]}),o.jsxs("div",{className:"flex items-center gap-4 p-3 bg-[#0e0f1a] rounded-lg border border-[#1c1d2e]",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"font-syne text-2xl font-extrabold text-[#eceef5]",children:[c," ",o.jsxs("span",{className:"text-[#3e4262] text-base",children:["/ ",e.tambos_programados]})]}),o.jsx("div",{className:"text-[10px] text-[#7b7f9e] mt-0.5",children:"Tambos realizados"})]}),o.jsx("div",{className:"flex-1 h-2 bg-[#1c1d2e] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-300",style:{width:`${Math.min(100,E)}%`}})}),o.jsx("input",{type:"number",min:0,max:e.tambos_programados+10,value:c,onChange:L=>u(parseInt(L.target.value)||0),className:`w-14 text-center py-1.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  font-mono text-sm font-bold text-[#eceef5] outline-none focus:border-emerald-500`})]}),o.jsx("button",{onClick:T,className:`mt-3 w-full py-2 rounded-lg bg-[#181929] border border-[#252638]
                text-sm font-semibold text-[#7b7f9e] hover:text-[#eceef5] hover:border-[#2e3050] transition-colors`,children:"Guardar avance"})]}),(e.productos??[]).length>0&&o.jsx(hd,{id:"productos",icon:"",title:"Productos aplicados",sub:`${e.productos.length} producto(s)`,open:s.has("productos"),onToggle:()=>N("productos"),children:o.jsxs("div",{className:"space-y-2",children:[e.productos.map(L=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-2.5
                      bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg`,children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold text-[#eceef5]",children:L.producto_nombre}),o.jsxs("div",{className:"text-[10px] font-mono text-[#3e4262] mt-0.5",children:[L.dosis_200l,"/",L.tambos,"  ",L.total_usado.toFixed(3)," total  ",L.metodo??""]})]}),o.jsxs("div",{className:"font-mono text-sm font-bold text-emerald-400",children:["$",L.costo_total.toFixed(2)]})]},L.id)),o.jsxs("div",{className:"flex justify-between px-3 py-2 bg-emerald-900/10 border border-emerald-800/20 rounded-lg",children:[o.jsx("span",{className:"text-xs font-bold text-[#7b7f9e]",children:"TOTAL"}),o.jsxs("span",{className:"font-mono text-sm font-bold text-emerald-400",children:["$",S.toFixed(2)]})]})]})}),o.jsxs(hd,{id:"checklist",icon:"",title:"Checklist de cierre",sub:`${_}/5  ${A}%`,open:s.has("checklist"),onToggle:()=>N("checklist"),rightExtra:o.jsxs("span",{className:"text-xs font-mono font-bold",style:{color:A>=100?"#10b981":A>50?"#f59e0b":"#ef4444"},children:[A,"%"]}),children:[m&&o.jsx("div",{className:"text-[10px] text-[#7b7f9e] mb-2 font-mono",children:"Guardando"}),o.jsx("div",{className:"space-y-2",children:[["chk_aspersoras_lavadas","Fumigadores lavaron motoaspersoras con agua y jabn"],["chk_equipo_guardado","Equipo guardado en cuarto de fumigacin"],["chk_epp_revisado","EPP completo y en buen estado"],["chk_envases_foto","Fotos de envases vacos enviadas (WhatsApp)"],["chk_tambos_llenos","Tambos llenos con agua para maana"]].map(([L,D])=>o.jsxs("button",{onClick:()=>$(L),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg border text-left
                    transition-colors duration-100 ${p[L]?"bg-emerald-900/20 border-emerald-800/30":"bg-[#0e0f1a] border-[#1c1d2e] hover:border-[#252638]"}`,children:[o.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center flex-shrink-0 transition-all ${p[L]?"bg-emerald-500 border-emerald-500":"border-[#252638]"}`,children:p[L]&&o.jsx("svg",{viewBox:"0 0 12 12",className:"w-3 h-3",fill:"none",stroke:"black",strokeWidth:"2.5",strokeLinecap:"round",children:o.jsx("polyline",{points:"2,6 5,9 10,3"})})}),o.jsx("span",{className:`text-sm font-medium flex-1 ${p[L]?"text-[#7b7f9e] line-through":"text-[#eceef5]"}`,children:D})]},L))})]}),o.jsxs(hd,{id:"docs",icon:"",title:"Evidencias",sub:`${(e.docs??[]).length}/2 subidas`,open:s.has("docs"),onToggle:()=>N("docs"),children:[o.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{tipo:"video",icon:"",title:"Video aplicacin",sub:"MP4, MOV  mx 100MB"},{tipo:"envases_vacios",icon:"",title:"Fotos envases vacos",sub:"JPG, PNG  mx 20MB"}].map(L=>{const D=(e.docs??[]).some(O=>O.tipo===L.tipo);return o.jsxs("label",{className:`flex flex-col items-center justify-center p-5 rounded-xl
                      border-2 border-dashed cursor-pointer text-center transition-colors duration-150 ${D?"bg-emerald-900/20 border-emerald-600/40":"bg-[#0e0f1a] border-[#252638] hover:border-emerald-600/30 hover:bg-emerald-900/10"}`,children:[o.jsx("input",{type:"file",className:"hidden",accept:L.tipo==="video"?"video/*":"image/*"}),o.jsx("div",{className:"text-2xl mb-2",children:L.icon}),o.jsx("div",{className:"text-xs font-bold text-[#eceef5]",children:L.title}),o.jsx("div",{className:"text-[10px] text-[#7b7f9e] mt-1",children:D?o.jsx("span",{className:"text-emerald-400",children:" Subido"}):L.sub})]},L.tipo)})}),o.jsxs("div",{className:`mt-3 px-3 py-2 bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg
              text-[10px] text-[#3e4262]`,children:["Los archivos se guardan en ",o.jsxs("code",{children:["fumigacion-docs/",e.almacen_id,"/",e.id,"/"]})]})]}),o.jsxs(hd,{id:"fumigadores",icon:"",title:"Fumigadores del da",sub:`${w.size} trabajadores`,open:s.has("fumigadores"),onToggle:()=>N("fumigadores"),children:[o.jsxs("div",{className:`mb-3 flex items-center gap-2 px-3 py-2 bg-emerald-900/10
              border border-emerald-800/20 rounded-lg text-[11px] text-emerald-400/80`,children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Los tambos registrados aqu se usarn para calcular el pago de destajo"})]}),o.jsx("div",{className:"space-y-1.5",children:t.map(L=>{const D=w.has(L.ID);return o.jsxs("div",{className:`flex items-center gap-3 px-3 py-2.5 rounded-lg border transition-colors ${D?"bg-[#181929] border-[#252638]":"bg-[#0e0f1a] border-[#1c1d2e] opacity-50"}`,children:[o.jsx("button",{onClick:()=>{C(O=>{const F=new Set(O);return F.has(L.ID)?F.delete(L.ID):F.add(L.ID),F})},className:`w-4 h-4 rounded border-2 flex items-center justify-center flex-shrink-0 transition-all ${D?"bg-emerald-500 border-emerald-500":"border-[#252638]"}`,children:D&&o.jsx("svg",{viewBox:"0 0 12 12",className:"w-2.5 h-2.5",fill:"none",stroke:"black",strokeWidth:"2.5",strokeLinecap:"round",children:o.jsx("polyline",{points:"2,6 5,9 10,3"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-sm font-semibold text-[#eceef5]",children:L.Nombre}),o.jsx("div",{className:`text-[10px] font-mono px-1.5 py-px rounded inline-block mt-0.5 ${L.Categoria==="Fumigacin"?"bg-emerald-900/30 text-emerald-400/70":"bg-[#252638] text-[#3e4262]"}`,children:L.Categoria})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("span",{className:"text-[10px] text-[#3e4262]",children:"tambos"}),o.jsx("input",{type:"number",min:0,value:g[L.ID]??0,onChange:O=>v(F=>({...F,[L.ID]:parseInt(O.target.value)||0})),disabled:!D,className:`w-12 text-center py-1 bg-[#0e0f1a] border border-[#252638] rounded
                          font-mono text-sm font-bold text-[#eceef5] outline-none
                          focus:border-emerald-500 disabled:opacity-30`})]})]},L.ID)})}),o.jsxs("div",{className:`flex justify-between items-center mt-3 px-3 py-2
              bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg`,children:[o.jsx("span",{className:"text-xs font-bold text-[#7b7f9e]",children:"Total tambos registrados"}),o.jsxs("span",{className:"font-mono text-sm font-bold text-emerald-400",children:[[...w].reduce((L,D)=>L+(g[D]??0),0)," tambos"]})]}),o.jsx("button",{onClick:z,disabled:j,className:`mt-3 w-full py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
                disabled:opacity-60 text-black text-sm font-bold transition-colors
                flex items-center justify-center gap-2`,children:j?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-3.5 h-3.5 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Guardando"]}):" Guardar fumigadores"})]})]})]})]})}function hd({id:e,icon:t,title:r,sub:n,open:a,onToggle:i,children:s,rightExtra:l}){return o.jsxs("div",{className:"bg-[#181929] border border-[#1c1d2e] rounded-xl overflow-hidden",children:[o.jsxs("button",{onClick:i,className:`w-full flex items-center justify-between px-4 py-3.5
          hover:bg-[#1c1d2e] transition-colors`,children:[o.jsxs("div",{className:"flex items-center gap-3 text-left",children:[o.jsx("span",{className:"text-base",children:t}),o.jsxs("div",{children:[o.jsx("div",{className:"font-syne text-sm font-bold text-[#eceef5]",children:r}),o.jsx("div",{className:"text-[11px] text-[#7b7f9e] mt-0.5",children:n})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[l,o.jsx("svg",{className:`w-4 h-4 text-[#3e4262] transition-transform duration-200 ${a?"rotate-180":""}`,viewBox:"0 0 16 16",fill:"none",children:o.jsx("path",{d:"M4 6l4 4 4-4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]})]}),a&&o.jsx("div",{className:"px-4 pb-4 border-t border-[#1c1d2e]",style:{paddingTop:"12px"},children:s})]})}function vse({almacenId:e,productos:t,onClose:r,onSave:n}){const{user:a}=Vo(),[i,s]=h.useState(!1),[l,c]=h.useState(null),[u,d]=h.useState(new Date().toISOString().split("T")[0]),[f,p]=h.useState(""),[x,m]=h.useState(new Set),[y,j]=h.useState(""),[b,g]=h.useState("despejado"),[v,w]=h.useState(""),[C,k]=h.useState(""),[S,_]=h.useState(null),[A,E]=h.useState(""),[N,$]=h.useState([]),[z,T]=h.useState([]),[I,L]=h.useState(""),[D,O]=h.useState(!1);h.useEffect(()=>{se.from("Users").select('"ID", name').eq("is_active",!0).order("name").then(({data:re})=>{re&&$(re.map(X=>({ID:X.ID,name:X.name})))}),a!=null&&a.id&&_(Number(a.id))},[]);const F=re=>{p(re);const X=Co[re];m(new Set(X!=null&&X.sectores.length?X.sectores:[]))},q=re=>m(X=>{const V=new Set(X);return V.has(re)?V.delete(re):V.add(re),V}),te=re=>{if(z.find(V=>V.producto_nombre===re))return;const X=t.find(V=>V.Nombre===re);T(V=>[...V,{producto_nombre:re,dosis_200l:(X==null?void 0:X.dosis_ref_200l)??0,tambos:parseInt(y)||1,metodo:"FOLIAR"}]),L(""),O(!1)},H=(re,X,V)=>T(J=>J.map((ne,Q)=>Q===re?{...ne,[X]:V}:ne)),B=re=>T(X=>X.filter((V,J)=>J!==re)),K=async()=>{if(c(null),!f){c("Selecciona una variedad");return}if(x.size===0){c("Selecciona al menos un sector");return}if(!y||parseInt(y)<=0){c("Ingresa el nmero de tambos");return}if(z.length===0){c("Agrega al menos un producto");return}s(!0);try{const re=parseInt(y);await n({almacen_id:e,fecha_inicio:u,fecha_fin:null,variedad:f,sectores_programados:[...x],sectores_completados:[],tambos_programados:re,tambos_realizados:0,ph_caldo:v?parseFloat(v):null,ce_caldo:C?parseFloat(C):null,clima:b,responsable_id:S,notas:A||null,programa_ids:null,chk_aspersoras_lavadas:!1,chk_equipo_guardado:!1,chk_epp_revisado:!1,chk_envases_foto:!1,chk_tambos_llenos:!1,_productos:z.map(X=>{const V=t.find(ne=>ne.Nombre===X.producto_nombre),J=X.dosis_200l*X.tambos/1e3;return{producto_nombre:X.producto_nombre,categoria:(V==null?void 0:V.categoria)??null,dosis_200l:X.dosis_200l,tambos:X.tambos,total_usado:Math.round(J*1e3)/1e3,metodo:X.metodo||null,costo_unitario:(V==null?void 0:V.costo_unitario)??0,costo_total:Math.round(J*((V==null?void 0:V.costo_unitario)??0)*100)/100,es_base:!0}})})}catch(re){c(re.message||"Error al guardar"),s(!1)}},Z=t.filter(re=>re.activo&&re.Nombre.toLowerCase().includes(I.toLowerCase())&&!z.find(X=>X.producto_nombre===re.Nombre)),he=Co[f];return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-40",onClick:r}),o.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[520px] max-w-full bg-[#12131e]
        border-l border-[#252638] z-50 flex flex-col overflow-hidden
        animate-in slide-in-from-right duration-200`,children:[o.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-[#1c1d2e] flex-shrink-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"font-syne text-lg font-extrabold text-[#eceef5]",children:"Registrar aplicacin"}),o.jsx("p",{className:"text-xs text-[#7b7f9e] mt-1",children:"Datos generales + productos aplicados"})]}),o.jsx("button",{onClick:r,className:`w-8 h-8 flex items-center justify-center rounded-lg
              border border-[#252638] text-[#7b7f9e] hover:text-[#eceef5]
              hover:bg-[#181929] transition-colors text-sm`,children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-5 space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Fecha de aplicacin"}),o.jsx("input",{type:"date",value:u,onChange:re=>d(re.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Condicin climtica"}),o.jsx("div",{className:"flex gap-1.5",children:[{key:"despejado",emoji:""},{key:"parcial",emoji:""},{key:"lluvia",emoji:""}].map(re=>o.jsx("button",{onClick:()=>g(re.key),className:`flex-1 py-2.5 rounded-lg border text-sm transition-all ${b===re.key?"bg-[#252638] border-emerald-600/50 text-[#eceef5]":"bg-[#0e0f1a] border-[#252638] text-[#3e4262] hover:border-[#2e3050]"}`,children:re.emoji},re.key))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Variedad"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Co).map(([re,X])=>o.jsx("button",{onClick:()=>F(re),className:"px-3 py-1.5 rounded-full border text-[11px] font-bold transition-all",style:{background:f===re?`${X.color}25`:"#0e0f1a",borderColor:f===re?`${X.color}70`:"#252638",color:f===re?X.color:"#7b7f9e"},children:re},re))})]}),f&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:["Sectores programados (",x.size," seleccionados)"]}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:UI.map(re=>{const X=x.has(re);return o.jsx("button",{onClick:()=>q(re),className:"w-10 h-8 rounded text-[10px] font-mono font-bold border transition-all",style:{background:X?`${(he==null?void 0:he.color)??"#374151"}22`:"#0e0f1a",borderColor:X?`${(he==null?void 0:he.color)??"#374151"}60`:"#252638",color:X?(he==null?void 0:he.color)??"#374151":"#3e4262"},children:re},re)})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Tambos programados"}),o.jsx("input",{type:"number",value:y,onChange:re=>j(re.target.value),placeholder:"ej: 5",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"pH del caldo"}),o.jsx("input",{type:"number",step:"0.1",value:v,onChange:re=>w(re.target.value),placeholder:"ej: 6.5",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"CE del caldo"}),o.jsx("input",{type:"number",step:"0.01",value:C,onChange:re=>k(re.target.value),placeholder:"ej: 1.2",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Productos aplicados"}),o.jsxs("div",{className:"relative mb-3",children:[o.jsxs("div",{className:`flex items-center gap-2 px-3 py-2.5 bg-[#0e0f1a] border border-[#252638]
                rounded-lg focus-within:border-emerald-500 transition-colors`,children:[o.jsx("span",{className:"text-[#3e4262] text-sm",children:""}),o.jsx("input",{type:"text",value:I,onChange:re=>{L(re.target.value),O(!0)},onFocus:()=>O(!0),placeholder:"Buscar y agregar producto...",className:"flex-1 bg-transparent text-sm text-[#eceef5] outline-none placeholder:text-[#3e4262]"})]}),D&&I&&o.jsxs("div",{className:`absolute z-20 left-0 right-0 top-full mt-1 bg-[#181929]
                  border border-[#252638] rounded-xl overflow-hidden shadow-2xl max-h-48 overflow-y-auto`,children:[Z.slice(0,10).map(re=>o.jsxs("button",{onMouseDown:()=>te(re.Nombre),className:`w-full flex items-center gap-3 px-4 py-2.5 text-sm font-medium
                        text-[#eceef5] hover:bg-[#1c1d2e] transition-colors text-left`,children:[o.jsx("span",{className:"flex-1 truncate",children:re.Nombre}),o.jsxs("span",{className:"text-[10px] font-mono text-[#3e4262]",children:[re.dosis_ref_200l," ",re.unidad,"/200L"]})]},re.id)),Z.length===0&&o.jsx("div",{className:"text-center py-4 text-[#3e4262] text-sm",children:"Sin resultados"})]})]}),z.length===0?o.jsx("div",{className:"text-center py-5 text-[#3e4262] text-xs border border-dashed border-[#252638] rounded-xl",children:"Sin productos. Busca y agrega productos arriba."}):o.jsx("div",{className:"space-y-2",children:z.map((re,X)=>{const V=re.dosis_200l*re.tambos/1e3,J=t.find(ne=>ne.Nombre===re.producto_nombre);return o.jsxs("div",{className:"bg-[#0e0f1a] border border-[#1c1d2e] rounded-xl p-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-xs font-semibold text-[#eceef5] truncate flex-1 mr-2",children:re.producto_nombre}),o.jsxs("span",{className:"font-mono text-[10px] text-emerald-400 font-bold mr-2",children:[V.toFixed(3)," ",J==null?void 0:J.unidad]}),o.jsx("button",{onClick:()=>B(X),className:"text-[#3e4262] hover:text-red-400 transition-colors text-xs",children:""})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-[9px] text-[#3e4262] uppercase mb-1",children:"Dosis /200L"}),o.jsx("input",{type:"number",step:"0.01",value:re.dosis_200l,onChange:ne=>H(X,"dosis_200l",parseFloat(ne.target.value)||0),className:`w-full px-2 py-1.5 bg-[#181929] border border-[#252638] rounded
                              text-[#eceef5] text-xs font-mono outline-none focus:border-emerald-500`})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[9px] text-[#3e4262] uppercase mb-1",children:"Tambos"}),o.jsx("input",{type:"number",value:re.tambos,onChange:ne=>H(X,"tambos",parseInt(ne.target.value)||0),className:`w-full px-2 py-1.5 bg-[#181929] border border-[#252638] rounded
                              text-[#eceef5] text-xs font-mono outline-none focus:border-emerald-500`})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[9px] text-[#3e4262] uppercase mb-1",children:"Mtodo"}),o.jsx("select",{value:re.metodo,onChange:ne=>H(X,"metodo",ne.target.value),className:`w-full px-2 py-1.5 bg-[#181929] border border-[#252638] rounded
                              text-[#eceef5] text-xs outline-none focus:border-emerald-500`,children:Object.keys(cw).map(ne=>o.jsx("option",{value:ne,children:ne},ne))})]})]})]},X)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Responsable"}),o.jsxs("select",{value:S??"",onChange:re=>_(re.target.value?Number(re.target.value):null),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`,children:[o.jsx("option",{value:"",children:"Sin asignar"}),N.map(re=>o.jsx("option",{value:re.ID,children:re.name},re.ID))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Notas"}),o.jsx("textarea",{value:A,onChange:re=>E(re.target.value),rows:2,placeholder:"Observaciones...",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors resize-none`})]}),l&&o.jsx("div",{className:`px-3 py-2.5 bg-red-900/20 border border-red-800/30 rounded-lg
              text-sm text-red-400 font-medium`,children:l})]}),o.jsxs("div",{className:"flex gap-2 px-6 py-4 border-t border-[#1c1d2e] flex-shrink-0",children:[o.jsx("button",{onClick:r,className:`px-4 py-2.5 rounded-lg border border-[#252638] text-[#7b7f9e]
              text-sm font-semibold hover:bg-[#181929] transition-colors`,children:"Cancelar"}),o.jsx("button",{onClick:K,disabled:i,className:`flex-1 py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
              disabled:opacity-60 text-black text-sm font-bold transition-colors
              flex items-center justify-center gap-2`,children:i?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Guardando"]}):" Registrar aplicacin"})]})]})]})}function yse({aplicaciones:e,personal:t,productos:r,loading:n,almacenId:a,onCrear:i,onActualizar:s,onActualizarChecklist:l,onGuardarFumigadores:c}){const[u,d]=h.useState(null),[f,p]=h.useState(!1);return o.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[o.jsxs("div",{className:`flex items-center justify-between px-4 py-2.5
        bg-[#0e0f1a] border-b border-[#1c1d2e] flex-shrink-0`,children:[o.jsxs("span",{className:"text-xs text-[#7b7f9e]",children:[e.length," aplicacin",e.length!==1?"es":""," registrada",e.length!==1?"s":""]}),o.jsx("button",{onClick:()=>p(!0),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-emerald-500
            hover:bg-emerald-400 text-black text-xs font-bold transition-all duration-150`,children:" Registrar aplicacin"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:n?o.jsx("div",{className:"flex items-center justify-center h-40 text-[#7b7f9e] text-sm",children:"Cargando aplicaciones"}):e.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-60 text-[#3e4262]",children:[o.jsx("div",{className:"text-5xl mb-4",children:""}),o.jsx("div",{className:"text-sm font-semibold text-[#7b7f9e]",children:"Sin aplicaciones registradas"}),o.jsx("div",{className:"text-xs mt-2",children:"Registra la primera usando el botn de arriba"})]}):e.map(x=>{var v;const m=Co[x.variedad],y=[x.chk_aspersoras_lavadas,x.chk_equipo_guardado,x.chk_epp_revisado,x.chk_envases_foto,x.chk_tambos_llenos].filter(Boolean).length,j=x.tambos_programados>0?Math.round(x.tambos_realizados/x.tambos_programados*100):0,b=(x.productos??[]).reduce((w,C)=>w+(C.costo_total??0),0),g=(x.docs??[]).length;return o.jsxs("div",{onClick:()=>d(x),className:`bg-[#13141f] border border-[#1c1d2e] rounded-xl p-4 cursor-pointer
                  hover:border-[#252638] transition-colors duration-100`,children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-syne text-base font-extrabold text-[#eceef5]",children:new Date(x.fecha_inicio).toLocaleDateString("es-MX",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),o.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[o.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full
                        text-[11px] font-bold text-white`,style:{background:(m==null?void 0:m.color)??"#374151"},children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-white/50"}),x.variedad]}),o.jsx("span",{className:"text-xs text-[#7b7f9e]",children:((v=x.responsable)==null?void 0:v.name)??"Sin responsable"})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"font-mono text-lg font-bold text-emerald-400",children:["$",b.toFixed(0)]}),o.jsx("div",{className:"text-[10px] text-[#3e4262] mt-0.5",children:"Costo total"})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[x.sectores_completados.map(w=>o.jsxs("span",{className:"text-[10px] font-mono font-bold px-1.5 py-0.5 rounded border",style:{background:`${(m==null?void 0:m.color)??"#374151"}22`,color:(m==null?void 0:m.color)??"#374151",borderColor:`${(m==null?void 0:m.color)??"#374151"}44`},children:[" ",w]},w)),x.sectores_programados.filter(w=>!x.sectores_completados.includes(w)).map(w=>o.jsx("span",{className:"text-[10px] font-mono font-bold px-1.5 py-0.5 rounded border border-[#252638] text-[#3e4262]",children:w},w))]}),o.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[o.jsx(nh,{label:"Tambos",value:`${x.tambos_realizados}/${x.tambos_programados}`,sub:`${j}%`,color:j>=100?"text-emerald-400":"text-amber-400"}),o.jsx(nh,{label:"Checklist",value:`${y}/5`,sub:y===5?"completo":"pendiente",color:y===5?"text-emerald-400":"text-amber-400"}),o.jsx(nh,{label:"Evidencias",value:g>0?`${g} docs`:"",sub:g>=2?"ok":"falta subir",color:g>=2?"text-emerald-400":"text-[#3e4262]"}),o.jsx(nh,{label:"Clima",value:x.ph_caldo?`pH ${x.ph_caldo}`:"",sub:x.clima,color:"text-[#7b7f9e]"})]})]},x.id)})}),u&&o.jsx(xse,{aplicacion:u,personal:t,onClose:()=>d(null),onActualizarChecklist:async x=>{await l(u.id,x),d(m=>m?{...m,...x}:null)},onGuardarFumigadores:async x=>{await c(u.id,x)},onActualizar:async x=>{await s(u.id,x),d(m=>m?{...m,...x}:null)}}),f&&o.jsx(vse,{almacenId:a,productos:r,onClose:()=>p(!1),onSave:async x=>{const m=await i(x);return p(!1),m}})]})}function nh({label:e,value:t,sub:r,color:n}){return o.jsxs("div",{children:[o.jsx("div",{className:"text-[10px] font-bold text-[#3e4262] uppercase tracking-wider",children:e}),o.jsx("div",{className:`font-mono text-sm font-semibold mt-0.5 ${n}`,children:t}),o.jsx("div",{className:"text-[10px] text-[#3e4262]",children:r})]})}function bse({alertas:e,almacenId:t,onIrAPrograma:r,onIrAAplicaciones:n}){const{user:a}=Vo(),i=new Date().toISOString().split("T")[0],[s,l]=h.useState("despejado"),[c,u]=h.useState(null),[d,f]=h.useState([]),[p,x]=h.useState({}),[m,y]=h.useState(new Set(["inicio"])),[j,b]=h.useState(!1),[g,v]=h.useState(!1),[w,C]=h.useState(""),k=dse.map(I=>({...I,items:I.items.filter(L=>!L.onlyIfLluvia||s==="lluvia")})),S=k.reduce((I,L)=>I+L.items.length,0),_=Object.values(p).filter(Boolean).length,A=S>0?Math.round(_/S*100):0;h.useEffect(()=>{se.from("Users").select('"ID", name').eq("is_active",!0).order("name").then(({data:I})=>{I&&f(I.map(L=>({ID:L.ID,name:L.name})))}),a!=null&&a.id&&u(Number(a.id))},[]),h.useEffect(()=>{t&&se.from("fum_jornadas").select("*").eq("fecha",i).eq("almacen_id",t).maybeSingle().then(({data:I})=>{I&&(l(I.clima??"despejado"),x(I.items_completados??{}),C(I.notas_cierre??""),I.responsable_id&&u(I.responsable_id),I.cerrada_at&&v(!0))})},[t,i]);const E=I=>{y(L=>{const D=new Set(L);return D.has(I)?D.delete(I):D.add(I),D})},N=I=>{g||x(L=>({...L,[I]:!L[I]}))},$=async()=>{b(!0);try{await se.from("fum_jornadas").upsert({fecha:i,almacen_id:t,responsable_id:c,clima:s,items_completados:p,notas_cierre:w||null,cerrada_at:new Date().toISOString()},{onConflict:"fecha,almacen_id"}),v(!0)}catch(I){console.error("Error cerrando jornada:",I)}finally{b(!1)}},z=S-_,T=new Date().toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long"});return o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.jsxs("div",{className:`bg-gradient-to-br from-emerald-900/20 to-emerald-900/5
        border border-emerald-800/30 rounded-2xl p-5`,children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-syne text-lg font-extrabold text-[#eceef5] capitalize",children:T}),o.jsxs("div",{className:"text-sm text-[#7b7f9e] mt-1",children:[_,"/",S," tems completados",g&&o.jsx("span",{className:`ml-2 px-2 py-0.5 bg-emerald-900/40 text-emerald-400
                  text-[10px] font-bold font-mono rounded-full border border-emerald-800/40`,children:"CERRADA"})]}),o.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[o.jsx("div",{className:"w-40 h-2 bg-[#1c1d2e] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-400",style:{width:`${A}%`}})}),o.jsxs("span",{className:"font-mono text-sm font-bold text-emerald-400",children:[A,"%"]})]})]}),o.jsx("div",{className:"flex flex-col gap-2",children:[{key:"despejado",emoji:"",label:"Sin lluvia"},{key:"parcial",emoji:"",label:"Parcial"},{key:"lluvia",emoji:"",label:"Llovi"}].map(I=>o.jsxs("button",{onClick:()=>l(I.key),className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg border text-xs
                  font-semibold transition-all duration-100 ${s===I.key?I.key==="lluvia"?"bg-blue-900/30 border-blue-700/40 text-blue-400":I.key==="parcial"?"bg-[#252638] border-[#2e3050] text-[#7b7f9e]":"bg-amber-900/20 border-amber-700/30 text-amber-400":"bg-[#0e0f1a] border-[#1c1d2e] text-[#3e4262] hover:border-[#252638]"}`,children:[I.emoji," ",I.label]},I.key))})]}),o.jsxs("select",{value:c??"",onChange:I=>u(I.target.value?Number(I.target.value):null),className:`mt-3 w-full px-3 py-2 bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg
            text-sm text-[#eceef5] outline-none focus:border-emerald-500 transition-colors`,children:[o.jsx("option",{value:"",children:"Seleccionar responsable..."}),d.map(I=>o.jsx("option",{value:I.ID,children:I.name},I.ID))]})]}),e.length>0&&o.jsxs("button",{onClick:r,className:`w-full flex items-start gap-3 px-4 py-3.5
            bg-red-900/20 border border-red-800/30 rounded-xl text-left
            hover:bg-red-900/30 transition-colors`,children:[o.jsx("span",{className:"text-xl mt-0.5",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-sm font-bold text-red-400",children:"Revisar inventario URGENTE  hoy"}),o.jsxs("div",{className:"text-xs text-[#7b7f9e] mt-1",children:[e.length," producto",e.length>1?"s":""," sin stock suficiente para los prximos 3 das."," ",o.jsx("span",{className:"text-red-400/70",children:e.map(I=>I.producto_nombre).join(", ")})]})]}),o.jsx("span",{className:"text-[#3e4262] text-sm",children:""})]}),k.map(I=>{const L=I.items.filter(O=>p[O.key]).length,D=m.has(I.id);return o.jsxs("div",{className:"bg-[#181929] border border-[#1c1d2e] rounded-xl overflow-hidden",children:[o.jsxs("button",{onClick:()=>E(I.id),className:`w-full flex items-center justify-between px-4 py-3.5
                hover:bg-[#1c1d2e] transition-colors`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-base",children:I.icon}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-syne text-sm font-bold text-[#eceef5]",children:I.label}),o.jsxs("div",{className:"text-[11px] text-[#7b7f9e] mt-0.5",children:[L,"/",I.items.length," completados"]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("svg",{className:"w-7 h-7 -rotate-90",viewBox:"0 0 28 28",children:[o.jsx("circle",{cx:"14",cy:"14",r:"11",fill:"none",stroke:"#1c1d2e",strokeWidth:"3"}),L>0&&o.jsx("circle",{cx:"14",cy:"14",r:"11",fill:"none",stroke:"#10b981",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:2*Math.PI*11,strokeDashoffset:2*Math.PI*11*(1-L/I.items.length),className:"transition-all duration-400"})]}),o.jsx("svg",{className:`w-4 h-4 text-[#3e4262] transition-transform duration-200 ${D?"rotate-180":""}`,viewBox:"0 0 16 16",fill:"none",children:o.jsx("path",{d:"M4 6l4 4 4-4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]})]}),D&&o.jsx("div",{className:"border-t border-[#1c1d2e] divide-y divide-[#1c1d2e]",children:I.items.map(O=>{const F=p[O.key];return o.jsxs("button",{onClick:()=>{O.link&&O.key==="registrar_aplic"?n():O.link&&(O.key==="prog_dia"||O.key==="verificar_inv"||O.key==="rev_inventario")?r():N(O.key)},className:`w-full flex items-start gap-3 px-4 py-3 text-left transition-colors
                        ${F?"bg-emerald-900/10":"hover:bg-[#0e0f1a]"}`,children:[o.jsx("div",{className:`mt-0.5 w-5 h-5 rounded-md border-2 flex items-center justify-center
                          flex-shrink-0 transition-all ${F?"bg-emerald-500 border-emerald-500":"border-[#252638]"}`,children:F&&o.jsx("svg",{viewBox:"0 0 12 12",className:"w-3 h-3",fill:"none",stroke:"black",strokeWidth:"2.5",strokeLinecap:"round",children:o.jsx("polyline",{points:"2,6 5,9 10,3"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:`text-sm font-medium ${F?"text-[#7b7f9e] line-through":"text-[#eceef5]"}`,children:[O.label,O.onlyIfLluvia&&o.jsx("span",{className:`ml-2 px-1.5 py-0.5 bg-blue-900/30 text-blue-400/70
                              text-[9px] font-bold font-mono rounded border border-blue-800/20`,children:" si llovi"})]}),O.link&&o.jsx("div",{className:"text-xs text-emerald-500 mt-0.5 font-semibold",children:O.link})]})]},O.key)})})]},I.id)}),o.jsxs("div",{className:"bg-[#181929] border border-[#1c1d2e] rounded-xl p-5",children:[z>0&&!g&&o.jsxs("div",{className:`flex items-center gap-2 px-3 py-2.5 bg-amber-900/20
            border border-amber-800/30 rounded-lg text-xs text-amber-400 font-medium mb-4`,children:[" ",z," tem",z>1?"s":""," sin completar. Puedes cerrar la jornada de todas formas."]}),g?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("div",{className:"text-3xl mb-2",children:""}),o.jsx("div",{className:"font-syne text-base font-bold text-emerald-400",children:"Jornada cerrada"}),o.jsxs("div",{className:"text-xs text-[#7b7f9e] mt-1",children:[_,"/",S," tems completados"]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-syne text-2xl font-extrabold text-emerald-400",children:_}),o.jsx("div",{className:"text-[10px] text-[#3e4262] uppercase tracking-wider mt-0.5",children:"Completados"})]}),o.jsxs("div",{children:[o.jsx("div",{className:`font-syne text-2xl font-extrabold ${z>0?"text-amber-400":"text-emerald-400"}`,children:z}),o.jsx("div",{className:"text-[10px] text-[#3e4262] uppercase tracking-wider mt-0.5",children:"Pendientes"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-syne text-2xl font-extrabold text-blue-400",children:[A,"%"]}),o.jsx("div",{className:"text-[10px] text-[#3e4262] uppercase tracking-wider mt-0.5",children:"Avance"})]})]}),o.jsx("textarea",{value:w,onChange:I=>C(I.target.value),rows:2,placeholder:"Notas de cierre (opcional)...",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg
                text-sm text-[#eceef5] outline-none focus:border-emerald-500 resize-none
                transition-colors mb-3`}),o.jsx("button",{onClick:$,disabled:j,className:`w-full py-3 rounded-xl bg-emerald-500 hover:bg-emerald-400
                disabled:opacity-60 text-black font-syne text-sm font-bold
                transition-colors flex items-center justify-center gap-2`,children:j?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Cerrando jornada"]}):z===0?" Cerrar jornada":" Cerrar con pendientes"})]})]}),o.jsx("div",{className:"h-6"})," "]})}function jse({productos:e,onRefresh:t}){const[r,n]=h.useState(""),[a,i]=h.useState(null),[s,l]=h.useState(!1),c=e.filter(u=>u.Nombre.toLowerCase().includes(r.toLowerCase())||u.categoria.toLowerCase().includes(r.toLowerCase()));return o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:`flex-1 flex items-center gap-2 px-3 py-2.5 bg-[#0e0f1a]
          border border-[#1c1d2e] rounded-lg`,children:[o.jsx("span",{className:"text-[#3e4262]",children:""}),o.jsx("input",{type:"text",value:r,onChange:u=>n(u.target.value),placeholder:"Buscar producto...",className:"flex-1 bg-transparent text-sm text-[#eceef5] outline-none placeholder:text-[#3e4262]"})]}),o.jsx("button",{onClick:()=>{i(null),l(!0)},className:`px-4 py-2.5 bg-emerald-500 hover:bg-emerald-400 text-black
            text-sm font-bold rounded-lg transition-colors`,children:"+ Nuevo"})]}),o.jsxs("div",{className:"space-y-2",children:[c.map(u=>{const d=zI[u.categoria]??"",f=BI[u.categoria]??"#4B5563";return o.jsxs("div",{className:`flex items-center gap-3 bg-[#181929] border border-[#1c1d2e]
                rounded-xl p-3.5 hover:border-[#252638] transition-colors cursor-pointer`,onClick:()=>{i(u),l(!0)},children:[o.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-lg flex-shrink-0",style:{background:`${f}22`},children:d}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-semibold text-[#eceef5] truncate",children:u.Nombre}),o.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[o.jsx("span",{className:"text-[10px] font-bold font-mono",style:{color:f},children:u.categoria}),o.jsxs("span",{className:"text-[10px] text-[#3e4262] font-mono",children:["ref: ",u.dosis_ref_200l??""," ",u.unidad,"/200L"]})]})]}),o.jsxs("div",{className:"text-right flex-shrink-0",children:[o.jsxs("div",{className:"font-mono text-sm font-bold text-emerald-400",children:["$",u.costo_unitario]}),o.jsxs("div",{className:"text-[10px] text-[#3e4262] mt-0.5",children:["/",u.unidad]})]}),o.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${u.activo?"bg-emerald-500":"bg-[#3e4262]"}`})]},u.id)}),c.length===0&&o.jsxs("div",{className:"text-center py-12 text-[#3e4262]",children:[o.jsx("div",{className:"text-4xl mb-3",children:""}),o.jsx("div",{className:"text-sm",children:"Sin productos que coincidan"})]})]}),s&&o.jsx(wse,{producto:a,onClose:()=>l(!1),onSaved:()=>{l(!1),t()}})]})}function wse({producto:e,onClose:t,onSaved:r}){var g,v;const[n,a]=h.useState((e==null?void 0:e.Nombre)??""),[i,s]=h.useState((e==null?void 0:e.categoria)??"Otro"),[l,c]=h.useState((e==null?void 0:e.unidad)??"mL"),[u,d]=h.useState(((g=e==null?void 0:e.dosis_ref_200l)==null?void 0:g.toString())??""),[f,p]=h.useState(((v=e==null?void 0:e.costo_unitario)==null?void 0:v.toString())??"0"),[x,m]=h.useState((e==null?void 0:e.activo)??!0),[y,j]=h.useState(!1),b=async()=>{if(!n.trim()){oe.error("El nombre es requerido");return}j(!0);try{const w={categoria:i,unidad:l,dosis_ref_200l:u?parseFloat(u):null,costo_unitario:parseFloat(f)||0,activo:x};if(e){const{error:C}=await se.from("Productos Moray").update(w).eq("id",e.id);if(C)throw C;oe.success("Producto actualizado")}else{const{error:C}=await se.from("Productos Moray").insert({...w,Nombre:n.trim()});if(C)throw C;oe.success("Producto creado")}r()}catch(w){oe.error(w.message||"Error al guardar")}finally{j(!1)}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-40",onClick:t}),o.jsxs("div",{className:`fixed right-0 top-0 bottom-0 w-[420px] max-w-full bg-[#12131e]
        border-l border-[#252638] z-50 flex flex-col animate-in slide-in-from-right duration-200`,children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-[#1c1d2e]",children:[o.jsx("div",{className:"font-syne text-base font-extrabold text-[#eceef5]",children:e?"Editar producto":"Nuevo producto"}),o.jsx("button",{onClick:t,className:`w-7 h-7 flex items-center justify-center rounded-lg border border-[#252638]
              text-[#7b7f9e] hover:text-[#eceef5] text-sm transition-colors`,children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-5 py-5 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Nombre del producto"}),o.jsx("input",{type:"text",value:n,onChange:w=>a(w.target.value),disabled:!!e,className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm outline-none focus:border-emerald-500 disabled:opacity-50`,placeholder:"Nombre exacto del producto"}),e&&o.jsx("div",{className:"text-[10px] text-[#3e4262] mt-1",children:"El nombre no se puede cambiar para mantener la integridad con el historial"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Categora"}),o.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:cse.map(w=>{const C=zI[w]??"",k=BI[w]??"#4B5563";return o.jsxs("button",{onClick:()=>s(w),className:`flex items-center gap-2 px-2.5 py-2 rounded-lg border text-xs
                      font-semibold transition-all`,style:{background:i===w?`${k}20`:"#0e0f1a",borderColor:i===w?`${k}60`:"#252638",color:i===w?k:"#7b7f9e"},children:[C," ",w]},w)})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Unidad"}),o.jsx("select",{value:l,onChange:w=>c(w.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm outline-none focus:border-emerald-500`,children:["mL","g","L","kg"].map(w=>o.jsx("option",{children:w},w))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Dosis ref. /200L"}),o.jsx("input",{type:"number",step:"0.01",value:u,onChange:w=>d(w.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                  text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500`,placeholder:"ej: 500"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:["Costo unitario (MXN / ",l,")"]}),o.jsx("input",{type:"number",step:"0.01",value:f,onChange:w=>p(w.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500`,placeholder:"0.00"})]}),o.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[o.jsx("div",{onClick:()=>m(!x),className:`w-10 h-6 rounded-full border-2 flex items-center transition-all ${x?"bg-emerald-500 border-emerald-500":"bg-[#1c1d2e] border-[#252638]"}`,children:o.jsx("div",{className:`w-4 h-4 rounded-full bg-white transition-transform mx-0.5 ${x?"translate-x-4":"translate-x-0"}`})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold text-[#eceef5]",children:"Producto activo"}),o.jsx("div",{className:"text-[10px] text-[#3e4262]",children:"Inactivo = no aparece en selectores de programa"})]})]})]}),o.jsxs("div",{className:"flex gap-2 px-5 py-4 border-t border-[#1c1d2e]",children:[o.jsx("button",{onClick:t,className:`px-4 py-2.5 border border-[#252638] rounded-lg text-sm font-semibold
              text-[#7b7f9e] hover:bg-[#181929] transition-colors`,children:"Cancelar"}),o.jsx("button",{onClick:b,disabled:y,className:`flex-1 py-2.5 bg-emerald-500 hover:bg-emerald-400 disabled:opacity-60
              text-black text-sm font-bold rounded-lg transition-colors
              flex items-center justify-center gap-2`,children:y?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Guardando"]}):" Guardar"})]})]})]})}async function Sse(e){const{data:t,error:r}=await se.from("fum_sheets_config").select("*").eq("almacen_id",e).eq("activo",!0).maybeSingle();return r?(console.error("getSheetsConfig error:",r),null):t}async function kse(e,t){const{error:r}=await se.from("fum_sheets_config").upsert({almacen_id:e,spreadsheet_id:t.spreadsheetId,sheet_name:t.sheetName,data_start_row:t.dataStartRow,activo:!0},{onConflict:"almacen_id"});if(r)throw r}async function Cse(e,t){var f,p,x;const{almacenId:r,spreadsheetId:n,sheetName:a="Programa",dataStartRow:i=2,dryRun:s=!1,filterSemana:l}=e,{data:c,error:u}=await se.functions.invoke("sheets-sync",{body:{almacen_id:r,spreadsheet_id:n,sheet_name:a,data_start_row:i,dry_run:s,...l!=null?{filter_semana:l}:{}}});if(u){const m=typeof u=="object"&&"context"in u?await((p=(f=u.context)==null?void 0:f.json)==null?void 0:p.call(f)):null;throw new Error(((x=m==null?void 0:m.errores)==null?void 0:x[0])??u.message??"Error invocando sheets-sync")}const d=c;return t==null||t(),d}function _se(e){const t=e.trim();if(!t.includes("/"))return t.length>10?t:null;const r=t.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);return(r==null?void 0:r[1])??null}function Ase({almacenId:e,almacenNombre:t,semanasDisponibles:r,onClose:n,onSyncComplete:a}){const[i,s]=h.useState("config"),[l,c]=h.useState(!0),[u,d]=h.useState(null),[f,p]=h.useState(""),[x,m]=h.useState("Programa"),[y,j]=h.useState("2"),[b,g]=h.useState(!1),[v,w]=h.useState(null),[C,k]=h.useState(null),[S,_]=h.useState(null),[A,E]=h.useState(null);h.useEffect(()=>{Sse(e).then(T=>{T&&(d(T),p(T.spreadsheet_id),m(T.sheet_name),j(String(T.data_start_row))),c(!1)})},[e]);const N=async()=>{E(null);const T=_se(f);if(!T){E("URL o ID del Spreadsheet invlido.");return}const I=parseInt(y)||2;if(I<1||I>100){E("La fila de inicio debe estar entre 1 y 100.");return}try{await kse(e,{spreadsheetId:T,sheetName:x.trim()||"Programa",dataStartRow:I})}catch(L){E(`Error guardando config: ${L.message}`);return}s("syncing"),_(null);try{const L=await Cse({almacenId:e,spreadsheetId:T,sheetName:x.trim()||"Programa",dataStartRow:I,dryRun:b,filterSemana:v??void 0},a);k(L),s("result")}catch(L){_(L.message??"Error desconocido"),s("result")}},$=(()=>{const T=new Date,I=new Date(T.getFullYear(),0,1);return Math.ceil(((T.getTime()-I.getTime())/864e5+I.getDay()+1)/7)})(),z=r.length>0?r:Array.from({length:10},(T,I)=>$+I);return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-40",onClick:i!=="syncing"?n:void 0}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:`w-full max-w-[520px] bg-[#12131e] border border-[#252638] rounded-2xl
          shadow-2xl flex flex-col overflow-hidden animate-in fade-in zoom-in-95 duration-200`,children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-[#1c1d2e]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-[#0e3a25] text-base",children:""}),o.jsxs("div",{children:[o.jsx("div",{className:"font-syne font-extrabold text-[#eceef5] text-sm",children:"Sync Google Sheets"}),o.jsx("div",{className:"text-[10px] text-[#3e4262] mt-px",children:t})]})]}),i!=="syncing"&&o.jsx("button",{onClick:n,className:`w-8 h-8 flex items-center justify-center rounded-lg border border-[#252638]
                  text-[#7b7f9e] hover:text-[#eceef5] hover:bg-[#181929] transition-colors text-sm`,children:""})]}),i==="config"&&o.jsxs("div",{className:"px-6 py-5 space-y-5 overflow-y-auto max-h-[80vh]",children:[o.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-blue-900/10 border border-blue-800/20 rounded-xl",children:[o.jsx("span",{className:"text-sm mt-0.5 flex-shrink-0",children:""}),o.jsxs("div",{className:"text-[11px] text-blue-300/80 space-y-1",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Columnas esperadas:"})," A=Semana  B=Fecha (DD/MM/YYYY)  C=Variedad  D=Producto  E=Dosis/200L  I=Mtodo  J=Tambos"]}),o.jsxs("div",{children:["El Sheets debe estar ",o.jsx("strong",{children:"compartido como Lector"})," con el email de la Service Account."]})]})]}),(u==null?void 0:u.last_synced_at)&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-emerald-900/10 border border-emerald-800/20 rounded-lg",children:[o.jsx("span",{className:"text-emerald-400 text-xs",children:""}),o.jsxs("span",{className:"text-[11px] text-emerald-400/80",children:["ltimo sync: ",new Date(u.last_synced_at).toLocaleString("es-MX"),u.last_sync_rows!=null&&`  ${u.last_sync_rows} filas`]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"URL o ID del Google Spreadsheet *"}),o.jsx("input",{type:"text",value:f,onChange:T=>{p(T.target.value),E(null)},placeholder:"https://docs.google.com/spreadsheets/d/1BxiMVs.../edit",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                    text-[#eceef5] text-xs font-mono outline-none focus:border-emerald-500 transition-colors
                    placeholder:text-[#2e3050]`}),o.jsxs("div",{className:"text-[10px] text-[#3e4262] mt-1.5",children:["Pega la URL completa o solo el ID entre ",o.jsx("code",{children:"/d/"})," y ",o.jsx("code",{children:"/edit"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"Nombre de la pestaa"}),o.jsx("input",{type:"text",value:x,onChange:T=>m(T.target.value),placeholder:"Programa",className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                      text-[#eceef5] text-sm outline-none focus:border-emerald-500 transition-colors`})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider mb-2",children:"1 fila de datos"}),o.jsx("input",{type:"number",min:"1",max:"100",value:y,onChange:T=>j(T.target.value),className:`w-full px-3 py-2.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                      text-[#eceef5] text-sm font-mono outline-none focus:border-emerald-500 transition-colors`}),o.jsx("div",{className:"text-[10px] text-[#3e4262] mt-1",children:"fila 1 = encabezados"})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"text-[11px] font-bold text-[#7b7f9e] uppercase tracking-wider",children:"Filtrar por semana"}),v!==null&&o.jsx("button",{onClick:()=>w(null),className:"text-[10px] text-[#3e4262] hover:text-[#7b7f9e] transition-colors",children:"Limpiar  importar todas"})]}),o.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border mb-3 text-[11px] transition-all ${v!==null?"bg-amber-900/15 border-amber-700/30 text-amber-300":"bg-[#0e0f1a] border-[#1c1d2e] text-[#3e4262]"}`,children:[o.jsx("span",{children:v!==null?"":""}),v!==null?`Solo se importarn filas donde Semana = ${v}`:"Se importarn todas las semanas del Sheets"]}),o.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[z.map(T=>o.jsxs("button",{onClick:()=>w(v===T?null:T),className:`px-3 py-1.5 rounded-full text-[11px] font-bold border transition-all duration-100 ${v===T?"bg-amber-500/20 border-amber-500/50 text-amber-400":"bg-[#0e0f1a] border-[#252638] text-[#7b7f9e] hover:border-[#2e3050] hover:text-[#eceef5]"}`,children:["S",T]},T)),o.jsxs("div",{className:"flex items-center gap-1.5 pl-1",children:[o.jsx("span",{className:"text-[10px] text-[#3e4262]",children:"otra:"}),o.jsx("input",{type:"number",min:"1",max:"53",value:v!==null&&!z.includes(v)?v:"",onChange:T=>{const I=parseInt(T.target.value);w(I>=1&&I<=53?I:null)},placeholder:"",className:`w-12 px-2 py-1.5 bg-[#0e0f1a] border border-[#252638] rounded-lg
                        text-[#eceef5] text-[11px] font-mono text-center outline-none
                        focus:border-amber-500 transition-colors`})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-[#0e0f1a] border border-[#1c1d2e] rounded-lg",children:[o.jsx("button",{onClick:()=>g(T=>!T),className:`relative w-9 h-5 rounded-full transition-colors flex-shrink-0 ${b?"bg-amber-500":"bg-[#252638]"}`,children:o.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform ${b?"translate-x-4":""}`})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold text-[#eceef5]",children:"Modo simulacin (dry run)"}),o.jsx("div",{className:"text-[10px] text-[#3e4262]",children:"Muestra cuntas filas se importaran sin escribir en la base de datos"})]})]}),A&&o.jsx("div",{className:"px-3 py-2.5 bg-red-900/20 border border-red-800/30 rounded-lg text-sm text-red-400",children:A}),o.jsxs("div",{className:"flex gap-2 pt-1",children:[o.jsx("button",{onClick:n,className:`px-4 py-2.5 rounded-lg border border-[#252638] text-[#7b7f9e]
                    text-sm font-semibold hover:bg-[#181929] transition-colors`,children:"Cancelar"}),o.jsx("button",{onClick:N,disabled:!f.trim()||l,className:`flex-1 py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
                    disabled:opacity-50 disabled:cursor-not-allowed text-black text-sm font-bold
                    transition-colors flex items-center justify-center gap-2`,children:b?" Simular sync":v!==null?` Sync semana ${v}`:" Sincronizar todas"})]})]}),i==="syncing"&&o.jsxs("div",{className:"px-6 py-12 flex flex-col items-center gap-5",children:[o.jsxs("div",{className:"relative w-16 h-16",children:[o.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-[#1c1d2e]"}),o.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-emerald-500 border-t-transparent animate-spin"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-2xl",children:""})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"font-syne font-bold text-[#eceef5] text-base",children:v!==null?`Importando semana ${v}`:"Sincronizando"}),o.jsx("div",{className:"text-xs text-[#7b7f9e] mt-2 max-w-xs",children:"Leyendo el Google Sheets e importando filas a la base de datos."})]}),o.jsx("div",{className:"w-full max-w-xs space-y-2",children:["Autenticando con Google...","Leyendo programa del Sheets...","Importando a fum_programa..."].map((T,I)=>o.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-[#3e4262]",children:[o.jsx("span",{className:`w-4 h-4 rounded-full border border-[#252638] flex items-center justify-center
                      text-[9px] flex-shrink-0 animate-pulse`,children:I+1}),T]},I))})]}),i==="result"&&o.jsxs("div",{className:"px-6 py-5 space-y-4",children:[S&&o.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-red-900/20 border border-red-800/30 rounded-xl",children:[o.jsx("span",{className:"text-red-400 text-lg flex-shrink-0",children:""}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-bold text-red-400",children:"Error en la sincronizacin"}),o.jsx("div",{className:"text-xs text-red-400/70 mt-1",children:S}),o.jsx("div",{className:"text-[10px] text-[#3e4262] mt-2",children:"Verifica el secret GOOGLE_SERVICE_ACCOUNT_JSON y que el Sheets est compartido."})]})]}),C&&!S&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl border ${C.dry_run?"bg-amber-900/20 border-amber-800/30":C.errores.length===0?"bg-emerald-900/20 border-emerald-800/30":"bg-yellow-900/20 border-yellow-800/30"}`,children:[o.jsx("span",{className:"text-2xl flex-shrink-0",children:C.dry_run?"":C.errores.length===0?"":""}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm font-bold text-[#eceef5]",children:[C.dry_run?"Simulacin completada":"Sync completado",v!==null&&o.jsxs("span",{className:"ml-2 text-[11px] font-mono text-amber-400",children:[" semana ",v]})]}),o.jsxs("div",{className:"text-[10px] text-[#7b7f9e] mt-0.5",children:[new Date(C.synced_at).toLocaleString("es-MX"),C.total_filas_leidas!=null&&`  ${C.total_filas_leidas} filas ledas`]})]})]}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:C.dry_run?"A importar":"Creadas",value:C.creadas,color:"text-emerald-400",bg:"bg-emerald-900/10 border-emerald-800/20"},{label:"Actualizadas",value:C.actualizadas,color:"text-blue-400",bg:"bg-blue-900/10 border-blue-800/20"},{label:"Sin cambios",value:C.sin_cambios,color:"text-[#7b7f9e]",bg:"bg-[#0e0f1a] border-[#1c1d2e]"}].map(T=>o.jsxs("div",{className:`${T.bg} border rounded-xl p-3 text-center`,children:[o.jsx("div",{className:`font-mono text-2xl font-bold ${T.color}`,children:T.value}),o.jsx("div",{className:"text-[10px] text-[#3e4262] uppercase tracking-wider mt-1",children:T.label})]},T.label))}),C.errores.length>0&&o.jsxs("div",{className:"bg-[#0e0f1a] border border-[#1c1d2e] rounded-xl p-3",children:[o.jsxs("div",{className:"text-[10px] font-bold text-amber-400 uppercase tracking-wider mb-2",children:["Advertencias (",C.errores.length,")"]}),o.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:C.errores.map((T,I)=>o.jsxs("div",{className:"text-[10px] text-[#7b7f9e] font-mono leading-relaxed",children:[" ",T]},I))})]})]}),o.jsx("div",{className:"flex gap-2 pt-1",children:C&&!C.dry_run&&!S?o.jsx("button",{onClick:n,className:`flex-1 py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
                      text-black text-sm font-bold transition-colors`,children:"Cerrar  ver programa actualizado"}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:n,className:`px-4 py-2.5 rounded-lg border border-[#252638] text-[#7b7f9e]
                        text-sm font-semibold hover:bg-[#181929] transition-colors`,children:"Cerrar"}),o.jsx("button",{onClick:()=>{_(null),k(null),s("config")},className:`flex-1 py-2.5 rounded-lg bg-emerald-500 hover:bg-emerald-400
                        text-black text-sm font-bold transition-colors`,children:S?"Reintentar":"Sync real"})]})})]})]})})]})}const Ese={moray:"inventario.rancho.moray",mojave:"inventario.rancho.mojave",lapena:"inventario.rancho.lapena"},FA={moray:"#10b981",mojave:"#f59e0b",lapena:"#6366f1"};function Nse(){const{canView:e,isAdmin:t}=_c(),[r,n]=h.useState("programa"),[a,i]=h.useState([]),[s,l]=h.useState(null),[c,u]=h.useState(!1),[d,f]=h.useState(null),[p,x]=h.useState(!1);h.useEffect(()=>{se.from("almacenes").select("*").eq("activo",!0).order("nombre").then(({data:L})=>{const D=L||[],O=t?D:D.filter(F=>e(Ese[F.slug]??""));i(O),O.length>0&&l(O[0])})},[t]);const{programa:m,productos:y,alertas:j,loading:b,crearEntrada:g,actualizarEntrada:v,eliminarEntrada:w,eliminarVarios:C,actualizarEstatusVarios:k,refresh:S}=ise({almacenId:(s==null?void 0:s.id)??null}),{aplicaciones:_,personal:A,loading:E,crearAplicacion:N,actualizarAplicacion:$,actualizarChecklist:z,guardarFumigadores:T}=sse({almacenId:(s==null?void 0:s.id)??null});if(!s)return o.jsxs("div",{className:"flex flex-col items-center justify-center h-60 text-[#3e4262]",children:[o.jsx("div",{className:"text-4xl mb-3",children:""}),o.jsx("div",{className:"text-sm font-semibold text-[#7b7f9e]",children:"Cargando mdulo de fumigacin"})]});const I=FA[s.slug]??"#10b981";return o.jsxs("div",{className:"flex flex-col h-full bg-[#08090f] text-[#eceef5]",children:[o.jsxs("div",{className:`flex items-center justify-between px-5 py-3.5
        bg-[#0e0f1a] border-b border-[#1c1d2e] flex-shrink-0`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center text-base",style:{background:`linear-gradient(135deg, #064e3b, ${I})`},children:""}),o.jsxs("div",{children:[o.jsxs("div",{className:"font-syne font-extrabold text-base text-[#eceef5]",children:["Fumiga",o.jsx("span",{style:{color:I},children:"cin"})]}),o.jsx("div",{className:"text-[10px] font-mono text-[#3e4262] uppercase tracking-wider",children:new Date().toLocaleDateString("es-MX",{weekday:"short",day:"numeric",month:"short"}).toUpperCase()})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[j.length>0&&o.jsxs("button",{onClick:()=>n("programa"),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold
                bg-red-900/20 border border-red-800/30 text-red-400
                animate-pulse`,children:[" ",j.length," sin stock"]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>u(!c),className:`flex items-center gap-2 px-3 py-1.5 rounded-full border text-xs font-semibold
                transition-all`,style:{background:`${I}15`,borderColor:`${I}40`,color:I},children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{background:I}}),s.nombre,o.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 10 10",fill:"none",children:o.jsx("path",{d:"M2 3.5L5 6.5L8 3.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})]}),c&&o.jsx("div",{className:`absolute right-0 top-full mt-1.5 bg-[#181929] border border-[#252638]
                  rounded-xl overflow-hidden shadow-2xl z-50 min-w-[160px]`,onMouseLeave:()=>u(!1),children:a.map(L=>{const D=FA[L.slug]??"#10b981";return o.jsxs("button",{onClick:()=>{l(L),u(!1)},className:`w-full flex items-center gap-2.5 px-4 py-2.5 text-sm font-semibold
                        hover:bg-[#1c1d2e] transition-colors text-left`,style:{color:s.id===L.id?D:"#7b7f9e"},children:[o.jsx("span",{className:"w-2 h-2 rounded-full",style:{background:D}}),L.nombre]},L.id)})})]}),o.jsx("button",{onClick:()=>x(!0),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border border-[#252638]
              text-xs font-semibold text-[#7b7f9e] hover:text-[#eceef5] hover:border-[#2e3050]
              transition-all duration-150`,title:"Sincronizar con Google Sheets",children:" Sync Sheets"})]})]}),j.length>0&&r==="programa"&&o.jsxs("div",{className:`flex items-start gap-3 px-4 py-2.5 flex-shrink-0
          bg-red-950/30 border-b border-red-900/30`,children:[o.jsx("span",{className:"text-sm mt-0.5",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-xs font-bold text-red-400 uppercase tracking-wider",children:"Inventario insuficiente  prximas 72h"}),o.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:j.map(L=>o.jsxs("span",{className:`text-[10px] font-mono font-semibold px-2 py-0.5 rounded
                    bg-red-900/30 border border-red-800/30 text-red-300`,children:[L.producto_nombre,"  ",L.deficit.toFixed(2)," ",L.unidad]},L.producto_nombre))})]})]}),o.jsx("div",{className:"flex border-b border-[#1c1d2e] flex-shrink-0 bg-[#0e0f1a]",style:{"--accent":I},children:[{key:"programa",icon:"",label:"Programa"},{key:"aplicaciones",icon:"",label:"Aplicaciones"},{key:"jornada",icon:"",label:"Jornada"},{key:"catalogo",icon:"",label:"Catlogo"}].map(L=>{const D=r===L.key;return o.jsxs("button",{onClick:()=>n(L.key),className:`flex items-center gap-2 px-5 py-3.5 text-sm font-medium
                border-b-[2.5px] -mb-px transition-all duration-150`,style:{color:D?I:"#3e4262",borderBottomColor:D?I:"transparent"},children:[o.jsx("span",{className:"text-sm",children:L.icon}),L.label,L.key==="jornada"&&j.length>0&&o.jsx("span",{className:`px-1.5 py-px rounded-full text-[10px] font-bold
                  bg-red-900/40 text-red-400 font-mono`,children:j.length})]},L.key)})}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[r==="programa"&&o.jsx(gse,{programa:m,productos:y,alertas:j,almacenId:s.id,loading:b,onCrear:g,onActualizar:v,onEliminar:w,onEliminarVarios:C,onActualizarEstatusVarios:k,onVerDetalle:L=>f(L)}),d&&o.jsx(WI,{almacenId:s.id,productos:y,initialData:d,onClose:()=>f(null),onSave:async L=>{await v(d.id,L),f(null)}}),r==="aplicaciones"&&o.jsx(yse,{aplicaciones:_,personal:A,productos:y,loading:E,almacenId:s.id,onCrear:N,onActualizar:$,onActualizarChecklist:z,onGuardarFumigadores:T}),r==="jornada"&&o.jsx(bse,{alertas:j,almacenId:s.id,onIrAPrograma:()=>n("programa"),onIrAAplicaciones:()=>n("aplicaciones")}),r==="catalogo"&&o.jsx(jse,{productos:y,onRefresh:S})]}),p&&s&&o.jsx(Ase,{almacenId:s.id,almacenNombre:s.nombre,semanasDisponibles:[...new Set(m.map(L=>L.semana))].sort((L,D)=>L-D),onClose:()=>x(!1),onSyncComplete:()=>{S(),n("programa")}})]})}const Pse=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Mse={lat:20.7066066,lng:-103.9314381},Ose={mapTypeId:"satellite",zoom:17,mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0};function Tse(){var g;const[e,t]=h.useState(null),[r,n]=h.useState(new Set),[a,i]=h.useState(null),[s,l]=h.useState(null),[c,u]=h.useState(""),[d,f]=h.useState(null),[p,x]=h.useState(null);h.useEffect(()=>{const v=window.location.hash,w=v.includes("?")?v.split("?")[1]:"",C=new URLSearchParams(w),k=C.get("tipo"),S=C.get("laborId");k&&u(k.toUpperCase()),S&&f(parseInt(S))},[]),h.useEffect(()=>{fetch("/tunnels.json").then(v=>v.json()).then(v=>t(v)).catch(v=>console.error("Error loading GeoJSON:",v))},[]),h.useEffect(()=>{const v=w=>{var C;((C=w.data)==null?void 0:C.type)==="ACTUALIZAR_POLIGONOS_MAPA"&&Array.isArray(w.data.secciones)&&n(new Set(w.data.secciones))};return window.addEventListener("message",v),()=>window.removeEventListener("message",v)},[]),h.useEffect(()=>{if(!d)return;(async()=>{var S;const{data:w,error:C}=await Pse.from("Labores Personal").select("Seccion").eq("id",d).single();if(C){console.error("Error fetching labor sections:",C);return}const k=((S=w==null?void 0:w.Seccion)==null?void 0:S.split(",").map(_=>_.trim()).filter(Boolean))||[];n(new Set(k))})()},[d]),h.useEffect(()=>{window.parent.postMessage({type:"SECCIONES_MAPA",secciones:Array.from(r)},"*")},[r]);const m=v=>{var C;n(k=>{const S=new Set(k);return S.has(v)?S.delete(v):S.add(v),S});const w=e==null?void 0:e.features.find(k=>{var S;return((S=k.properties)==null?void 0:S.name)===v});if((C=w==null?void 0:w.geometry)!=null&&C.coordinates){const k=w.geometry.coordinates[0],[S,_]=k[0];l({name:v,position:{lat:_,lng:S}})}},y=v=>v[0].map(([w,C])=>({lat:C,lng:w})),j=v=>{const w=c.split(",").map(A=>A.trim().toUpperCase()),C=v.toUpperCase(),k=/^[1-8][A-F] TUNEL \d+$/.test(C),S=C.startsWith("CAMINO"),_=C.startsWith("PERIFERIA");return k&&w.includes("TUNELES")||S&&w.includes("CAMINOS")||_&&w.includes("PERIFERIA")},b=v=>r.has(v)?"#22c55e":a===v?"#b45309":"#f59e0b";return o.jsx("div",{className:"w-full h-screen",children:o.jsxs(A0,{mapContainerClassName:"w-full h-full",center:Mse,zoom:17,onClick:()=>{l(null)},options:Ose,children:[(g=e==null?void 0:e.features)==null?void 0:g.filter(v=>{var w;return v.geometry.type==="Polygon"&&j((w=v.properties)==null?void 0:w.name)}).map(v=>{const w=v.properties.name,C=y(v.geometry.coordinates);return o.jsx(gm,{paths:C,options:{fillColor:b(w),fillOpacity:.6,strokeColor:b(w),strokeOpacity:1,strokeWeight:2},onClick:k=>{var S;if(k.domEvent.shiftKey){const _=e==null?void 0:e.features.find(A=>{var E;return((E=A.properties)==null?void 0:E.name)===w});if((S=_==null?void 0:_.geometry)!=null&&S.coordinates){const A=_.geometry.coordinates[0],[E,N]=A[0];l({name:w,position:{lat:N,lng:E}})}}else l(null),m(w)},onMouseOver:()=>i(w),onMouseOut:()=>i(null)},v.id)}),s&&o.jsx(fu,{position:s.position,onCloseClick:()=>l(null),options:{pixelOffset:new google.maps.Size(0,-30)},children:o.jsx("div",{className:"bg-black text-white px-2 py-1 rounded text-sm font-medium",children:s.name})})]})})}const zA=Br("https://sznlajobhjmzuvletzjd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6bmxham9iaGptenV2bGV0empkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxNzk1NDYsImV4cCI6MjA1ODc1NTU0Nn0.A1xdSXi1sR1Bt6o55h7DJHG50erT_EtTBPd0tKnmJUg"),Lse={lat:20.7066066,lng:-103.9314381},Dse={mapTypeId:"satellite",zoom:17,mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0};function Ise(){var _;const[e,t]=h.useState(null),[r,n]=h.useState(new Set),[a,i]=h.useState(null),[s,l]=h.useState(null),[c,u]=h.useState(""),[d,f]=h.useState(null),[p,x]=h.useState(new Set),[m,y]=h.useState(new Set),[j,b]=h.useState(null),[g,v]=h.useState(null);h.useEffect(()=>{const A=window.location.hash,E=A.includes("?")?A.split("?")[1]:"",N=new URLSearchParams(E),$=N.get("tipo"),z=N.get("laborId");$&&u($.toUpperCase()),z&&f(parseInt(z))},[]),h.useEffect(()=>{fetch("/tunnels.json").then(A=>A.json()).then(A=>t(A)).catch(A=>console.error("Error loading GeoJSON:",A))},[]);const w={"1A":[1,25],"1B":[1,23],"1C":[1,24],"1D":[1,20],"1E":[1,17],"1F":[1,23],"2A":[1,20],"2B":[1,20],"2C":[1,20],"2D":[1,22],"2E":[1,26],"3A":[1,25],"3B":[1,20],"3C":[1,20],"4A":[1,23],"4B":[1,20],"4C":[1,20],"5A":[1,22],"5B":[1,20],"5C":[1,20],"6A":[1,29],"6B":[15,28],"6C":[1,38],"6D":[1,37],"7A":[1,14],"7B":[1,29],"7C":[1,35],"7D":[1,25],"7E":[1,19],"8A":[1,25],"8B":[1,23],"8C":[1,24],"8D":[1,20],"8E":[1,17],"8F":[1,23]};h.useEffect(()=>{const A=E=>{var N,$;if(((N=E.data)==null?void 0:N.type)==="ACTUALIZAR_POLIGONOS_MAPA"&&Array.isArray(E.data.secciones)&&n(new Set(E.data.secciones)),(($=E.data)==null?void 0:$.type)==="SOLICITAR_TUNELES_SECTOR"&&typeof E.data.sector=="string"){const z=E.data.sector.trim(),[T,I]=w[z]||[0,0],L=I>=T?I-T+1:0;window.parent.postMessage({type:"RESPUESTA_TUNELES_SECTOR",sector:z,cantidad:L},"*")}};return window.addEventListener("message",A),()=>window.removeEventListener("message",A)},[]),h.useEffect(()=>{if(!d)return;(async()=>{const{data:E,error:N}=await zA.from("Labores Personal").select('Seccion, "Nombre Labor"').eq("id",d).single();if(N||!E){console.error("Error obteniendo labor:",N);return}const $=E["Nombre Labor"],z=q=>{const te=[];for(const H of q){const B=H.match(/^([1-8][A-F])$/);if(B&&w[B[1]]){const[K,Z]=w[B[1]];for(let he=K;he<=Z;he++)te.push(`${B[1]} Tunel ${he}`)}else te.push(H)}return te},T=(E.Seccion||"").split(",").map(q=>q.trim()).filter(Boolean),I=z(T),{data:L,error:D}=await zA.from("Muestreos Labores").select("Seccion").eq("Nombre Labor",$);if(D){console.error("Error obteniendo secciones muestreadas:",D);return}const O=L.map(q=>q.Seccion||"").flatMap(q=>q.split(",")).map(q=>q.trim()).filter(Boolean),F=z(O);x(new Set(I)),y(new Set(F))})()},[d]),h.useEffect(()=>{window.parent.postMessage({type:"SECCIONES_MAPA",secciones:Array.from(r)},"*")},[r]);const C=A=>{var N;if(!p.has(A))return;n($=>{const z=new Set($);return z.has(A)?z.delete(A):z.add(A),z});const E=e==null?void 0:e.features.find($=>{var z;return((z=$.properties)==null?void 0:z.name)===A});if((N=E==null?void 0:E.geometry)!=null&&N.coordinates){const $=E.geometry.coordinates[0],[z,T]=$[0];l({name:A,position:{lat:T,lng:z}})}},k=A=>A[0].map(([E,N])=>({lat:N,lng:E})),S=A=>r.has(A)?"#22c55e":m.has(A)?"#15803d":p.has(A)?"#f59e0b":a===A?"#b45309":"#9CA3AF";return o.jsx("div",{className:"w-full h-screen",children:o.jsxs(A0,{mapContainerClassName:"w-full h-full",center:Lse,zoom:17,onClick:()=>{l(null)},options:Dse,children:[(_=e==null?void 0:e.features)==null?void 0:_.filter(A=>{var N,$;const E=($=(N=A.properties)==null?void 0:N.name)==null?void 0:$.trim();return A.geometry.type==="Polygon"&&E&&(p.has(E)||m.has(E)||r.has(E))}).map(A=>{const E=A.properties.name,N=k(A.geometry.coordinates);return o.jsx(gm,{paths:N,options:{fillColor:S(E),fillOpacity:.6,strokeColor:S(E),strokeOpacity:1,strokeWeight:2},onClick:()=>C(E),onMouseOver:()=>i(E),onMouseOut:()=>i(null)},A.id)}),s&&o.jsx(fu,{position:s.position,onCloseClick:()=>l(null),options:{pixelOffset:new google.maps.Size(0,-30)},children:o.jsx("div",{className:"bg-black text-white px-2 py-1 rounded text-sm font-medium",children:s.name})})]})})}function $se(){const{session:e,loading:t}=xM();return t?o.jsx("div",{className:"min-h-screen bg-pattern flex items-center justify-center",children:o.jsx("div",{className:"text-white text-xl",children:"Cargando aplicacin"})}):o.jsx(WR,{children:o.jsx(OP,{googleMapsApiKey:"AIzaSyB7iovPC8x-f2qi20GH5mRD3QMlE4C3rn8",children:o.jsxs("div",{className:"min-h-screen bg-pattern text-white",children:[o.jsx(M0,{position:"top-right"}),o.jsxs(LR,{children:[o.jsx(gt,{path:"/",element:e?o.jsx(ho,{to:"/app/mapa",replace:!0}):o.jsx(e7,{})}),o.jsx(gt,{path:"/login",element:e?o.jsx(ho,{to:"/app/mapa",replace:!0}):o.jsx(P7,{})}),o.jsx(gt,{path:"/app/labores-map",element:e?o.jsx(Tse,{}):o.jsx(ho,{to:"/login",replace:!0})}),o.jsx(gt,{path:"/app/form-labores-map",element:e?o.jsx(Ise,{}):o.jsx(ho,{to:"/login",replace:!0})}),o.jsxs(gt,{path:"/app",element:e?o.jsx(D7,{}):o.jsx(ho,{to:"/login",replace:!0}),children:[o.jsx(gt,{path:"mapa",element:o.jsx(K7,{})}),o.jsx(gt,{path:"muestreos",element:o.jsx(i9,{})}),o.jsx(gt,{path:"estrategia/personal",element:o.jsx(B7,{})}),o.jsx(gt,{path:"estrategia/personal/planeacion",element:o.jsx(tae,{})}),o.jsx(gt,{path:"operacion/nutricion/tanques",element:o.jsx(jae,{})}),o.jsx(gt,{path:"operacion/fumigacion",element:o.jsx(Nse,{})}),o.jsx(gt,{path:"administracion",element:o.jsx(U7,{})}),o.jsx(gt,{path:"reportes",element:o.jsx(zoe,{})}),o.jsx(gt,{path:"operacion/empaque",element:o.jsx(fae,{})}),o.jsx(gt,{path:"operacion/inventario",element:o.jsx(Tae,{})}),o.jsx(gt,{path:"finanzas",element:o.jsx(ase,{})}),o.jsx(gt,{path:"operacion/exportacion",element:o.jsx(Oie,{})}),o.jsxs(gt,{path:"operacion/cosecha",element:o.jsx(Fae,{}),children:[o.jsx(gt,{index:!0,element:o.jsx(ho,{to:"registro",replace:!0})}),o.jsx(gt,{path:"registro",element:o.jsx(Vae,{})}),o.jsx(gt,{path:"reportes",element:o.jsx(iie,{})})]}),o.jsxs(gt,{path:"configuracion",element:o.jsx($ae,{}),children:[o.jsx(gt,{index:!0,element:o.jsx(ho,{to:"usuarios",replace:!0})}),o.jsx(gt,{path:"usuarios",element:o.jsx(Goe,{})}),o.jsx(gt,{path:"roles",element:o.jsx(Xoe,{})}),o.jsx(gt,{path:"solicitudes",element:o.jsx(eae,{})})]})]}),o.jsx(gt,{path:"*",element:o.jsx(ho,{to:e?"/app/mapa":"/login",replace:!0})})]})]})})})}const Rse=new B$;sP(document.getElementById("root")).render(o.jsx(h.StrictMode,{children:o.jsxs(W$,{client:Rse,children:[" ",o.jsx($se,{})]})}));
